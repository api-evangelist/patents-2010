---

title: Method and apparatus for authentication token-based service redirection
abstract: A method, apparatus, and computer readable medium is provided. According to an embodiment, a method includes, receiving a message from a client. The method further includes, forwarding the message to a first service when the message includes an authentication token, where the authentication token indicates that the client can access the first service. The method further includes, forwarding the message to a second service when the message excludes the authentication token. The receiving the message from the client and the forwarding the message to the first service occur over a confidential channel.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08332626&OS=08332626&RS=08332626
owner: Ntrepid Corporation
number: 08332626
owner_city: Herndon
owner_country: US
publication_date: 20100415
---
Embodiments of the present invention generally relate to computer systems. More specifically certain embodiments of the present invention relate to computer systems which utilize a sequential stream oriented protocol.

Cryptographic protocols such as Secured Sockets Layer SSL Transport Layer Security TLS Internet Protocol Security IPSec and OpenVPN can provide security for communications over networks such as the Internet. One type of security that a cryptographic protocol can provide is client authentication. For example a client may wish to access a server over a sequential stream oriented protocol. However the server may only allow legitimate clients to access services that reside on the server and thus can require a mechanism for authenticating clients. The cryptographic protocol may allow a server to request authentication of a client. In response to the request if the client is a legitimate client the client can present a certificate via the cryptographic protocol which indicates that the client is a legitimate client. The server then can authenticate the certificate and allow the client access to the server and the services that reside on the server. The cryptographic protocol may also allow a client to volunteer a certificate to the server without the server requesting that the client provide a certificate.

However in cryptographic protocols client authentication is an all or nothing endeavor. Either the server authenticates the client and allows the client to access the server and all the services of the server or the server fails to authenticate the client and the client is denied access to the server and all the services of the server. Currently cryptographic protocols do not provide the capability of forwarding an unauthenticated client away from a service of the server that is protected to another service of the server that is accessible to all clients.

According to an embodiment of the invention a method includes receiving a message from a client. The method further includes forwarding the message to a first service when the message includes an authentication token where the authentication token indicates that the client can access the first service. The method further includes forwarding the message to a second service when the message excludes the authentication token. The receiving of the message from the client and the forwarding of the message to the first service occur over a confidential channel.

According to another embodiment an apparatus includes a memory configured to store instructions and a processor configured to execute the instructions stored on the memory. The processor is further configured when executing the instructions stored on the memory to receive a message from a client. The processor is further configured when executing the instructions stored on the memory to forward the message to a first service when the message includes an authentication token where the authentication token indicates that the client can access the first service. The processor is further configured when executing the instructions stored on the memory to forward the message to a second service when the message excludes the authentication token. The processor is further configured when executing the instructions stored on the memory to receive the message from the client and to forward the message to the first service over a confidential channel.

According to another embodiment a computer readable medium having a computer program stored thereon that when executed by a processor causes the processor to implement a method. The method includes receiving a message from a client. The method further includes forwarding the message to a first service when the message includes an authentication token where the authentication token indicates that the client can access the first service. The method further includes forwarding the message to a second service when the message excludes the authentication token. The receiving of the message from the client and the forwarding of the message to the first service occur over a confidential channel.

It will be readily understood that the components of the present invention as generally described and illustrated in the figures herein may be arranged and designed in a wide variety of different configurations. Thus the following detailed description of the embodiments of a method apparatus and computer readable medium as represented in the attached figures is not intended to limit the scope of the invention as claimed but is merely representative of selected embodiments of the invention.

The features structures or characteristics of the invention described throughout this specification may be combined in any suitable manner in one or more embodiments. For example the usage of the phrases certain embodiments some embodiments or other similar language throughout this specification refers to the fact that a particular feature structure or characteristic described in connection with the embodiment may be included in at least one embodiment of the present invention. Thus appearances of the phrases in certain embodiments in some embodiments in other embodiments or other similar language throughout this specification do not necessarily all refer to the same group of embodiments and the described features structures or characteristics may be combined in any suitable manner in one or more embodiments.

A service or web service as understood by one of ordinary skill in the art is a software application designed to support interoperable machine to machine interaction over a network. A service can have an interface described in a machine processable format. A system can interact with a service by sending messages over a sequential stream oriented protocol such as Hypertext Transfer Protocol HTTP . Examples of services are Big Web services and RESTful services. Big Web services are services that follow a Simple Object Access Protocol SOAP standard and use Extensible Markup Language XML messages. RESTful services are services that utilize a Representational State Transfer REST style of software architecture where clients are separate from servers by a uniform interface.

According to an embodiment of the invention services can be divided into two classes. The first class of services is a class of services that are made available only to authenticated clients. The second class of services is a class of services that are made available to all clients whether they are authenticated or not. Furthermore according to an embodiment an application router can authenticate a client based on an authentication token and can route the client to either the first class of services or the second class of services depending on whether the application router is able to authenticate the client. In the embodiment an exchange between the application router and the client can occur over a confidential channel. Because of the confidential channel other clients cannot become aware of the content of the exchange between the application router and the client.

A client such as clients and can be any computer system or software application that accesses a service on a remote computer system. For example in a client can be a desktop computer laptop computer personal computer user terminal personal digital assistant portable computer tablet computer or any other computer system that is known in the art that resides outside of private network . As another example in clients and each can be a web browser a media player an executive dashboard an e mail client a word processor application or any other software application that is known in the art that originates outside of private network .

Private network is a computer network that is not directly connected to the Internet. Thus Internet Protocol IP packets or messages directed towards private network must pass through application router . Likewise IP packets or messages originating from private network and directed towards the Internet must also pass through application router . Private network can be a local access network LAN a wide access network WAN a personal area network PAN a home area network HAN a campus area network CAN a metropolitan area network MAN a global area network GAN a storage area network SAN a virtual private network VPN a wireless network a wireless LAN a HomePNA a power line communication network a G.hn network a Bluetooth network an optical fiber network an Ethernet network an active networking network a client server network a peer to peer network a bus network a star network a ring network a mesh network a star bus network a tree network a hierarchical topology network or any other type of computer network that is known in the art.

A client such as clients and can connect to application router over a sequential stream oriented protocol. The sequential stream oriented protocol can be a protocol carried by a transmission control protocol TCP such as HTTP Extensible Messaging and Presence Protocol XMPP Simple Mail Transfer Protocol SMTP Domain Name System DNS Post Office Protocol POP File Transfer Protocol FTP Remote Procedure Call RPC Internet Message Access Protocol IMAP Lightweight Directory Access Protocol LDAP Unix to Unix Copy UUCP Network Time Protocol NTP Internet Relay Chat IRC SOCKS Point to Point Protocol PPP Network File System NFS Subversion SVN Inter Asterisk Protocol IAX Session Initiation Protocol SIP mySQL protocol Oracle protocol PostgreSQL protocol X11 any chat protocol such as MSN Yahoo and Facebook or any other sequential stream oriented protocol known in the art.

Application router is a software application or service that runs on a server and is part of private network . According to an embodiment of the invention application router can authenticate a client that is outside of private network and route a request to connect from the client to one of multiple services within private network based on the authentication of the client as will be discussed in more detail. Therefore application router can be considered a router for an application layer rather than a physical layer. In an embodiment application router is run on a server that is part of private network but is exposed to the outside of private network so that clients outside of private network can send connection requests to application router over any sequential stream oriented protocol. In an embodiment the server containing application router can be exposed to the outside of private network by opening one or more ports of the server and allowing packets or messages to be received by the server containing application router over a sequential stream oriented protocol. Furthermore according to an embodiment an exchange between a client and application router occurs on a confidential channel so that other clients do not become aware of the content of the exchange. A confidential channel as understood by one of ordinary skill in the art is a communication channel that is resistant to interception by a third party. Making a channel confidential can be accomplished in many different ways. As an example a channel can be made confidential by encrypting the content such as IP packets and messages that are transmitted over the channel.

Private service servers and are servers that are within private network but are not exposed to the outside of private network . This means that clients outside of private network cannot send connections requests directly to private service services and . Private service servers and can each have a service or a class of services which runs on the server. A service can receive a request over a protocol and provide a response over the protocol. For example the service can receive an HTTP request over an HTTP protocol and respond with a web page over the HTTP protocol. As another example the service can receive a chat request over a chat protocol such as MSN Yahoo and Facebook and the service can initiate a chat window over the chat protocol in response to the chat request.

A computer readable medium may be any available medium that can be accessed by processor . Computer readable medium may include both a volatile and nonvolatile medium a removable and non removable medium and a storage medium. A storage medium may include RAM flash memory ROM erasable programmable read only memory EPROM electrically erasable programmable read only memory EEPROM registers hard disk a removable disk a compact disk read only memory CD ROM or any other form of storage medium known in the art.

Processor can also be operatively coupled via bus to a display such as a Liquid Crystal Display LCD . Display can display information to the user. A keyboard and a cursor control device such as a computer mouse can also be operatively coupled to bus to enable the user to interface with apparatus .

According to one embodiment memory can store software modules that may provide functionality when executed by processor . The modules can include an operating system an application router module as well as other functional modules . Operating system can provide an operating system functionality for apparatus . Application router module can provide functionality for authenticating a client and routing a request to connect from the client to one of multiple services based on the authentication of the client as will be described in more detail below. Apparatus can also be part of a larger system. Thus apparatus can include one or more additional functional modules to include additional functionality for the system.

Processor can also be operatively coupled via bus to a database . Database can store data in an integrated collection of logically related records or files. Database can be an operational database an analytical database a data warehouse a distributed database an end user database an external database a navigational database an in memory database a document oriented database a real time database a relational database an object oriented database or any other database known in the art.

At step client sends a connection request to application router . In an embodiment the request can be a request for a data stream according to a protocol. According to the embodiment the request includes a prefix. The prefix is an example of an authentication token that both client and application router can recognize as entitling client to access a specific service or a specific class of services. The prefix can be any structure of a fixed length that is attached to the request. For example the prefix can be an XML packet a binary data stream a text string or a set of data that is known both to client and application router .

In an embodiment client can request and receive the prefix from application router at some point before client sends a connection request at step . In another embodiment the prefix is stored locally at client . In another embodiment the prefix is stored at some other location and is requested by client before client sends a connection request to application router step . In an embodiment of the invention the prefix can be stored in a configuration file a database a lookup table or can be embedded within a service.

After application router receives the connection request from client application router evaluates whether the connection request includes the prefix. In this embodiment the connection request does include the prefix so application router determines that client can access the requested service. In this embodiment client requests to connect to the service run at private service server . Thus at step application router forwards the connection request to private service server . According to the embodiment forwarding the connection request to private service server also includes creating a connection between client and private service server so that client and private service server can transfer data. In the embodiment client can be unaware of the forwarding and it can appear to client that it is directly communicating with private service server .

In an embodiment of the invention private service server is a private service server running a covert service. In this embodiment the covert service running on private service server is only exposed to properly authenticated clients. If a client does not include a prefix with its connection request then the client is not authenticated and the covert service is not exposed to that client. Thus the covert service cannot be discovered by an intruder through means such as eavesdropping on an interaction with that service. In another embodiment of the invention private service server is a private service server running a class of covert services. The class of covert services is only exposed to authenticated clients. Thus an authenticated client can access any service of the class of covert services running on private service server .

At step private service server sends a message to client which initiates a provision of a service running on private service server to client . In an embodiment of the invention the provision of the service can include providing a web page to client . In another embodiment the provision of the service can include initiating a chat session between private service server and client . According to an embodiment the provision of the service can include transferring data between private service server and client . In an embodiment of the invention the service is a covert service and is exposed to client whereas the covert service is not exposed to other unauthenticated clients. In another embodiment the service is one of a class of covert services where the class of covert services is exposed to client and the class of covert services is not exposed to other unauthenticated clients.

According to the embodiment the connection request sent by client the forwarding of the connection request by application router and the sending of the message by private service server to client can each occur over a confidential channel. Because each exchange occurs over a confidential channel other clients cannot observe the prefix or observe the interaction with private service server and cannot become aware of private service server . In one embodiment of the invention the confidential channel is made confidential by encrypting the connection request sent by client encrypting the forwarded connection request sent by application router and encrypting the message sent by private service server to client .

While in the illustrated embodiment a connection request does not include a prefix in an alternate embodiment the connection request can include a prefix but the prefix is not the correct prefix that identifies that a client can access a requested service. In this alternate embodiment the signaling flow is the same as in the embodiment where the connection request does not include a prefix as will be described in more detail.

At step client sends a connection request to application router . In an embodiment the request can be a request for a data stream according to a protocol. According to this embodiment unlike the embodiment illustrated in the request does not include a prefix.

After application router receives the connection request from client application router evaluates whether the connection request includes the prefix. In this embodiment the connection request does not include the prefix so application router determines that client cannot access the requested service and instead can access an alternate service or an alternate class of services. In this embodiment client requests to connect to the service run at private service server . Thus at step application router forwards the connection request to private service server rather than private service server . According to the embodiment forwarding the connection request to private service server also includes creating a connection between client and private service server so that client and private service server can transfer data. In the embodiment client can be unaware of the forwarding and it can appear to client that it is directly communicating with private service server .

In an embodiment of the invention private service server is a private service server running a public service that is an alternate to a covert service running on private service server . In this embodiment the alternate service running on private service server is exposed to any client that can access private network regardless of whether the client is properly authenticated using the prefix. Thus even if an intruder eavesdrops on an unsecured interaction with application router the intruder can only discover the alternate service running on private service server and cannot discover the covert service running on private service server . In another embodiment of the invention private service server is a private service server running a class of alternate services. The class of alternative services is exposed to any client that can access private network regardless of whether the client is properly authenticated using the prefix.

At step private service server sends a message to client which initiates a provision of a service running on private service server to client . In an embodiment of the invention the provision of the service can include providing a web page to client . In another embodiment the provision of the service can include initiating a chat session between private service server and client . According to an embodiment the provision of the service can include transferring data between private service server and client . In an embodiment of the invention the service is an alternative service to a covert service and is a service that can be exposed to any client that has access to private network regardless of whether the client is authenticated by application router based on the authentication or lack thereof. This is contrast to the covert service that runs on private service server which is only exposed to clients that are authenticated by application router based on the authentication. In another embodiment the service is one of a class of alternate services where the class of alternate services can be exposed to any client that has access to private network regardless of whether the client is authenticated by application router based on the authentication or lack thereof.

At step client sends a connection request to application router . In an embodiment the request can be a request for a data stream according to a protocol. According to the embodiment the request includes a certificate. A certificate is another example of an authentication token that both client and application router can recognize as entitling client to access a specific service or a specific class of services. In cryptographic protocols such as SSL TLS IPSec and OpenVPN a certificate also identified as a public key certificate a digital certificate and an identity certificate can be an electronic document which uses a digital signature to bind together a public key with an identity. The identity can include information such as a client s name organization or address. The certificate can be used to verify that a public key belongs to the client and thus authenticate the client that provides the certificate.

In an alternate embodiment not shown in client can hold off on sending the certificate until application router requests the certificate and instead merely sends a connection request. In this embodiment once application router requests the certificate client sends the certificate to application router as described above.

After application router receives the connection request application router determines whether the connection request includes a certificate and if so authenticates the certificate. In this embodiment the connection request does include the certificate and the certificate is an valid certificate so application router determines that client can access the requested service. In this embodiment client requests to connect to the service run at private service server . Thus at step application router forwards the connection request to private service server . According to the embodiment forwarding the connection request to private service server also includes creating a connection between client and private service server so that client and private service server can transfer data. In the embodiment client can be unaware of the forwarding and it can appear to client that it is directly communicating with private service server .

In an embodiment of the invention private service server is a private service server running a covert service. In this embodiment the covert service running on private service server is only exposed to properly authenticated clients. If a client does not include a certificate with its connection request then the client is not authenticated and the covert service is not exposed to that client. Thus the covert service cannot be discovered by an intruder through means such as eavesdropping on an interaction with that service. In another embodiment of the invention private service server is a private service server running a class of covert services. The class of covert services is only exposed to authenticated clients. Thus an authenticated client can access any service of the class of covert services running on private service server .

At step private service server sends a message to client which initiates a provision of a service running on private service server to client . In an embodiment of the invention the provision of the service can include providing a web page to client . In another embodiment the provision of the service can include initiating a chat session between private service server and client . According to an embodiment the provision of the service can include transferring data between private service server and client . In an embodiment of the invention the service is a covert service and is exposed to client whereas the covert service is not exposed to other unauthenticated clients. In another embodiment the service is one of a class of covert services where the class of covert services is exposed to client and the class of covert services is not exposed to other unauthenticated clients.

According to the embodiment the connection request sent by client the forwarding of the connection request by application router and the sending of the message by private service server to client can each occur over a confidential channel. Because each exchange occurs over a confidential channel other clients cannot observe the certificate or observe the interaction with private service server and cannot become aware of private service server . In one embodiment of the invention the confidential channel is made confidential by encrypting the connection request sent by client encrypting the forwarded connection request sent by application router and encrypting the message sent by private service server to client .

While in the illustrated embodiment a connection request does not include a certificate in an alternate embodiment the connection request can include a certificate but the certificate is not the correct certificate that identifies that a client can access a requested service. In this alternate embodiment the signaling flow is the same as in the embodiment where the connection request does not include a certificate as will be described in more detail.

At step client sends a connection request to application router . In an embodiment the request can be a request for a data stream according to a protocol. In this embodiment the connection request does not include a certificate.

After application router receives the connection request application router determines whether the connection request includes the certificate. In this embodiment the connection request does not include the certificate so application router determines that client cannot access the requested service and instead can access an alternate service. In this embodiment client requests to connect to the service run at private service server . Thus at step application router forwards the connection request to private service server rather than private service server . According to the embodiment forwarding the connection request to private service server also includes creating a connection between client and private service server so that client and private service server can transfer data. In the embodiment client can be unaware of the forwarding and it can appear to client that it is directly communicating with private service server .

In an embodiment of the invention private service server is a private service server running a public service that is an alternate to a covert service running on private service server . In this embodiment the alternate service running on private service server is exposed to any client that can access private network regardless of whether the client is properly authenticated using the certificate. Thus even if an intruder eavesdrops on an interaction with application router the intruder can only discover the alternate service running on private service server and cannot discover the covert service running on private service server . In another embodiment of the invention private service server is a private service server running a class of alternate services. The class of alternative services is exposed to any client that can access private network regardless of whether the client is properly authenticated using the certificate.

At step private service server sends a message to client which initiates a provision of a service running on private service server to client . In an embodiment of the invention the provision of the service can include providing a web page to client . In another embodiment the provision of the service can include initiating a chat session between private service server and client . According to an embodiment the provision of the service can include transferring data between private service server and client . In an embodiment of the invention the service is an alternative service to a covert service and is a service that can be exposed to any client that has access to private network regardless of whether the client is authenticated by application router based on the authentication or lack thereof. This is contrast to the covert service that runs on private service server which is only exposed to clients that are authenticated by application router based on the authentication. In another embodiment the service is one of a class of alternate services where the class of alternate services can be exposed to any client that has access to private network regardless of whether the client authenticated by application router based on the authentication or lack thereof.

If the message includes the authentication token the message is forwarded to a first service at step . In an embodiment of the invention the first service is a covert service only exposed to clients which provide the authentication token and thus are properly authenticated to access the covert service. If the message does not include the authentication token the message is forwarded to a second service at step . In an embodiment of the invention the second service is a public service that is exposed to any client and is an alternate to the covert service. The method then completes at step . According to the embodiment the receiving the message from the client and the forwarding the message to the first service occur over a confidential channel. The channel can be made confidential by encrypting the message.

The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware in a computer program executed by a processor or in a combination of the two. A computer program may be embodied on a computer readable medium such as a storage medium. For example a computer program may reside in RAM flash memory ROM EPROM EEPROM registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium may be coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an application specific integrated circuit ASIC . In the alternative the processor and the storage medium may reside as discrete components.

One having ordinary skill in the art will readily understand that the invention as discussed above may be practiced with steps in a different order and or with hardware elements in configurations which are different than those which are disclosed. Therefore although the invention has been described based upon these preferred embodiments it would be apparent to those of skill in the art that certain modifications variations and alternative constructions would be apparent while remaining within the spirit and scope of the invention. In order to determine the metes and bounds of the invention therefore reference should be made to the appended claims.

