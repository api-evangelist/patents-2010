---

title: Out-of-band authentication of e-mail messages
abstract: Technologies are described herein for providing out-of-band authentication of an e-mail message. A recipient of an e-mail message purporting to be from an organization forwards the e-mail message or submits its content to that organization for authentication. The authenticity of the e-mail message is determined based on authentication data, such as outgoing message logs or authentication keys, maintained at the source of the e-mail message. Upon authenticating the e-mail message, the recipient is informed of the authenticity of the e-mail message.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08966621&OS=08966621&RS=08966621
owner: Amazon Technologies, Inc.
number: 08966621
owner_city: Seattle
owner_country: US
publication_date: 20101221
---
 Phishing is the process by which a perpetrator fraudulently attempts to acquire user identifiable and or sensitive information. such as user names passwords credit card numbers social security numbers and the like through an electronic communication such as an e mail message. The e mail message may purport to be from a company or organization with which the recipient has a relationship and may direct the recipient to reply to the message with the sensitive information or click on an embedded link that takes the recipient to a fake website masquerading as the legitimate website of the organization. There the recipient may be prompted to enter their sensitive information such as user name password etc. which may be recorded and later used by the perpetrator of the phishing scheme to defraud the recipient and or the organization.

Banks financial service companies online transaction or payment processors online merchants social media sites and their customers may be frequent targets of such phishing e mails. The phishing e mails may be formatted in such a way that it is difficult for the recipient to determine its authenticity even upon close inspection. For example the phishing e mail may be a copy of a legitimate e mail message sent by the organization with all of the text terms and logos intact. The origin e mail address of the phishing e mail may be spoofed to hide the actual identity of the sender and the displayed uniform resource locator URL for any links embedded in the message may be misrepresented so that the actual target websites are not apparent or discoverable.

Technologies for prevention of origin address spoofing and securing e mail content such as Sender Policy Framework SPF Secure Multipurpose Internet Mail Extensions S MIME and DomainKeys Identified Mail DKIM may provide some protection against phishing attacks. However such protection technologies may require support for the associated frameworks and or protocols in the recipient s e mail client program and or the e mail transport system and may not be widely implemented. Further because these types of technologies are in band i.e. rely on content or data embedded the phishing e mail itself these technologies may be vulnerable to similar spoofs and misrepresentations.

The following detailed description is directed to technologies for providing out of band authentication of an e mail message. Utilizing the technologies described herein a recipient of an e mail message purporting to be from an organization may forward the message or the content therein directly to that organization for authentication. The organization may then authenticate the e mail message using authentication data such as outgoing message logs or authentication keys stored at the organization and respond to the recipient with an indication of the authenticity of the e mail message. Authenticating the e mail message at the source allows the organization to keep the authentication data private and not rely solely on information embedded in outgoing e mail messages.

The technologies described herein provide for an out of band approach to e mail authentication that may utilize context clues from the e mail message such as the from address the message body content or user input to determine the claimed source of the message but relies on a user initiated or programmatic verification directly with the claimed source organization through an external channel. This out of band approach to e mail authentication makes spoofing of the authentication mechanism s very difficult. It will be appreciated that the out of band authentication methods described herein may also be utilized as an alternative to or in conjunction with other in band methods such as DKIM SPF S MIME or the like that rely on the content of the e mail message to verify the messages authenticity. By allowing a recipient to authenticate a suspicious e mail message before the recipient replies with the requested information or clicks on embedded links incidents of phishing attacks and frauds may be reduced.

It should be appreciated that the subject matter presented herein may be implemented as a computer process a computer controlled apparatus a computing system or an article of manufacture such as a computer readable storage medium. These and various other features will become apparent from a reading of the following disclosure and a review of the associated drawings.

While the subject matter described herein is presented in the general context of program modules that execute on one or more computing devices those skilled in the art will recognize that other implementations may be performed in combination with other types of program modules. Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that the subject matter described herein may be practiced on or in conjunction with other computer system configurations beyond those described below including multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers handheld computers personal digital assistants cellular telephone devices electronic book readers special purposed hardware devices network appliances and the like. The embodiments described herein may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote memory storage devices.

In the following detailed description references are made to the accompanying drawings that form a part hereof and that show by way of illustration specific embodiments or examples. The drawings herein are not drawn to scale. Like numerals represent like elements throughout the several figures.

The e mail authentication system may be implemented and maintained by an organization that sends e mail messages to customers that may include information regarding transactions or accounts of the customer such as a bank a financial service company an online transaction or payment processor an online merchant a social media website or the like. Alternatively the e mail authentication system may be implemented by a provider of e mail services such as an Internet service provider ISP or an e mail application hosting company which provides e mail services to organizations like those described above. The e mail authentication system provides facilities that allow recipients of an e mail message purporting to be from the organization to authenticate the e mail message. In a further embodiment the e mail authentication system may be implemented by a third party service provider that provides message authentication services to other organizations. E mail messages sent by or on behalf of the other organizations may first be routed through the e mail authentication system to allow the messages to be mutated logged or otherwise processed to provide the out of band authentication services in a manner described herein.

The e mail authentication system may include a number of application servers that provide various e mail authentication services and other e mail services to the organization. The application servers may execute a number of modules in order to provide the services. The modules may execute on a single application server or in parallel across multiple application servers in the e mail authentication system . In addition each module may consist of a number of subcomponents executing on different application servers or other computing devices in the e mail authentication system . The modules may be implemented as software hardware or any combination of the two.

In one embodiment an e mail authentication module executes on the application servers . The e mail authentication module is configured to authenticate the content of an e mail message received from a recipient and inform the recipient of the messages authenticity. The e mail authentication module may receive the e mail message from a recipient computer over a network . The e mail message may include a message header containing the information identifying the origin of the message such as an origin e mail address from address one or more recipient e mail addresses to addresses a subject for the message a unique identifier for the message or the like. The e mail message may further include a message body containing the content of the message. The content may include text HTML XML attachments or other content in multipurpose Internet mail extensions MIME attachments for example.

The recipient computer may be a personal computer PC such as a desktop workstation laptop or notebook a personal digital assistant PDA a wireless telephone device an electronic book reader a game console a set top box a consumer electronics device a remote server computer or any other computing device capable of connecting to the network . The network may be a local area network LAN a wide area network WAN the Internet or any other networking topology known in the art that connects the recipient computer to the e mail authentication system .

According to one embodiment the e mail authentication module receives the e mail message through one or more e mail servers in the e mail authentication system . The e mail servers may be configured to receive e mail messages forwarded to an authentication e mail address monitored by the organization. The authentication e mail address may be defined such that it is easy to remember and relates the purpose of the address in a meaningful way such as verify companyname.com or didwesendit companyname.com. The authentication e mail address may also be based on an Internet wide standard established for e mail authentication such as verify at the domain name of the organization.

A recipient of an e mail message purporting to be from the organization may utilize an e mail client program executing on the recipient computer to forward the e mail message to the authentication e mail address of the organization for authentication. According to one embodiment the authentication e mail address is not referenced in the content of the e mail message as a link or provided as a reply address to outgoing e mail messages in order to prevent spoofing of the authentication e mail address and subversion of the authentication mechanism.

According to another embodiment the e mail authentication module receives the e mail message through one or more Web servers in the e mail authentication system . The Web servers may implement an authentication website or other online application that allows customers to submit the content of suspect e mail messages to the organization for authentication. A recipient of an e mail message purporting to be from the organization may utilize a browser application executing on the recipient computer to access the authentication website and copy and paste the content of the e mail message from their e mail client program into a text field or other control on the website. The recipient may then submit the pasted content of the e mail message for authentication.

As in the case of the authentication e mail address the Web address or URL of the authentication website may be an easy to remember address such as http verify.companyname.com or http companyname.com didwesendit. In one embodiment the Web address of the authentication website is not embedded as a link in the content of the outgoing e mail messages in order to prevent spoofing of the authentication mechanism by the actual sender of the e mail.

In a further embodiment the e mail authentication module may implement a message verification protocol that provides a number of channels for the submission of e mail messages for verification including receiving e mail messages forwarded to the authentication e mail address messages submitted through the authentication website and messages submitted through other Web services or application programming interfaces APIs defined by the message verification protocol. Mail user agents MUAs such as the e mail client program executing on the recipient computer may implement a programmatic method of out of band e mail message verification based on the defined message verification protocol. For example as shown in an e mail client program may present a control such a pushbutton in the program s user interface that allows a user to submit a received e mail message to the e mail authentication module for verification of its authenticity.

The e mail client program may determine the organization purporting to be the sender of the e mail message from the content or context of the message and configure the pushbutton or other control to submit the message to the e mail authentication module through one of the channels defined by the message verification protocol when the pushbutton is selected by the user. For example the e mail client program may submit the e mail message for verification by forwarding the message to the standard authentication e mail address for that organization by submitting the content of the message through an authentication website for the organization or by submitting the message through other Web services or APIs implemented by the e mail authentication module of the organization according to the message verification protocol.

According to embodiments the pushbutton or other control implemented in the e mail client program may operate out of band i.e. does not rely on data or code embedded in the e mail message to trigger the button or configure the submission channel in order to prevent spoofing of the authentication mechanism by the actual sender of the e mail message. In another embodiment the e mail client program shows the determined source organization of the message to the user as further shown in the pushbutton in before the out of band message verification process is initiated. This may provide further information to the user that the message is being verified with the correct organization through the programmatic process implemented by the e mail client program. If multiple source organizations are implied by the content or context of the e mail message the e mail client program may allow the user to choose the correct organization with which to authenticate the message or it may submit the e mail message to the multiple organizations simultaneously to verify the message opportunistically. It will be appreciated that the user interface of the e mail client program may implement different user interface components and or controls for showing the determined source organization to the user and for initiating the out of band verification process with the source organization beyond those shown in and described herein. It is intended for this application to include all such implementations.

Upon receiving the e mail message from the recipient computer the e mail authentication module verifies that the message was sent by the organization using a methodology such as those described below in regard to . The e mail authentication module may utilize authentication data such as logs of messages sent by the organization or authentication keys to authenticate the e mail message as will be further described below. The authentication data may be stored in a database or other data storage system in the e mail authentication system .

Once the authenticity of the received e mail message has been established the e mail authentication module informs the user of the results of authentication. For example if the e mail message for authentication was received via the e mail servers the e mail authentication module may send a reply message to the recipient indicating whether the message was authentic. If the e mail message was submitted for authentication through the authentication website executing on the Web servers the e mail authentication module may provide a near instant response to the recipient submitting the content of the message through the authentication website of the authenticity of the e mail message. It will be appreciated that other methods of informing the recipient that the e mail message is or is not authentic may be utilized by the e mail authentication module . According to a further embodiment if the e mail message is determined not be authentic the e mail authentication module may also archive the e mail message for later analysis and or further action by the organization.

Specifically shows one example of data elements that may be stored in the authentication data . As described above the authentication data may contain data utilized by the e mail authentication module to verify that the e mail message received from the recipient computer was sent by the organization. According to one embodiment the authentication data contains a log of e mail messages sent by or on behalf of the organization. For example the authentication data may contain an e mail record A N referred to herein generally as e mail record corresponding to each e mail message sent by or for the organization.

The e mail record may contain basic information from the corresponding e mail message including the from address indicating the origin of the e mail the to address indicating the intended recipient s and a timestamp indicating when the message was sent. The e mail authentication module may utilize these values to locate a corresponding e mail record for a received e mail message in order to authenticate the message. In one embodiment the e mail record may also contain the original message content from the corresponding e mail message . The e mail authentication module may utilize the original message content to ensure that an e mail message being authenticated has not been altered nor had content added to it as will be described below in regard to . The e mail record may further contain any attachments that were included in the corresponding e mail message . This may allow the e mail authentication module to detect an unauthorized attachment contained in an otherwise authentic e mail message for example. In one embodiment the attachments data element in the e mail record may simply indicate a number of attachments that were included in the corresponding e mail message .

Alternatively or additionally the e mail record may contain a message signature . The message signature may contain a representative value of the original content of the corresponding e mail message . For example the message signature may contain a hash value generated from the content. Storing the message signature instead of the original message content in the e mail record may decrease storage requirements in the authentication data as well as increase the processing speed of authenticating the content of an e mail message received for authentication. It will be appreciated that the e mail record may contain additional data elements beyond those shown in and described above that represent attributes of the corresponding outgoing e mail messages sent by or on behalf of the organization. In addition the authentication data may contain other data utilized by the e mail authentication module and or other modules of the e mail authentication system to authenticate received e mail messages as will be described further below.

Turning now to additional details will be provided regarding the embodiments presented herein for providing out of band authentication of an e mail message. It should be appreciated that the logical operations described herein are implemented 1 as a sequence of computer implemented acts or program modules running on a computing system and or 2 as interconnected machine logic circuits or circuit modules within the computing system. The implementation is a matter of choice dependent on the performance and other requirements of the computing system. Accordingly the logical operations described herein are referred to variously as operations structural devices acts or modules. These operations structural devices acts and modules may be implemented in software in firmware in special purpose digital logic and any combination thereof. It should also be appreciated that more or fewer operations may be performed than shown in the figures and described herein. These operations may also be performed in parallel or in a different order than those described herein.

From operation the routine proceeds to operation where the e mail authentication module parses the original e mail message from the forwarded e mail. As further described above the e mail message purporting to be from the organization may be forwarded to the authentication e mail address by the recipient using the e mail client program executing on the recipient computer . The original e mail message may be forwarded as an attachment or in line depending on the e mail client program. The e mail authentication module parses the forwarded e mail to determine the portions that represent the original e mail message . The e mail authentication module may attempt to parse both the header and message content of the original e mail message from the forwarded e mail.

It will be appreciated that the e mail authentication module may utilize knowledge of the various forwarding mechanisms such as indentation delineation delimiters or the like of various e mail client programs to parse the original e mail message from the forwarded e mail. In one embodiment the original e mail message may contain specific content delimiters around the message content added to the e mail message went sent. The e mail authentication module may utilize these content delimiters to identify the message content in the original e mail message as well as determine if additional content has been added to the e mail message as will be described below.

The routine proceeds from operation to operation where the e mail authentication module attempts to locate a corresponding e mail record in the authentication data for the e mail message . The e mail record may be located in the authentication data based the from address the to address and or the timestamp parsed from the e mail message for example. At operation if an e mail record corresponding to the e mail message is not found the routine proceeds to operation where the e mail authentication module responds to the recipient indicating that the e mail message is not authentic. For example the e mail authentication module may respond to the forwarded e mail with a message indicating that the original e mail message received by the recipient is not authentic. From operation the routine ends.

If at operation an e mail record corresponding to the e mail message is found the routine may proceed to operation where the e mail authentication module determines if the content of the e mail message matches the original content of the e mail message sent by the organization by comparing data from the message header and or content of the e mail message with the data stored in the located e mail record according to embodiments. In one embodiment the e mail authentication module compares the content of the e mail message parsed from the forwarded e mail to the original message content from the corresponding e mail record . In another embodiment the e mail authentication module hashes or encodes the content of the e mail message parsed from the forwarded e mail to compute a message signature and then compares the newly computed message signature to the message signature stored in the corresponding e mail record . It will be appreciated that hashing the content of the e mail message and comparing the hash value to the previously stored message signature may allow for a more efficient authentication process but may not permit enumeration of the actual changes made to the content of the message.

In additional embodiments the e mail authentication module may further compare the headers and or other portions of the e mail message to attributes stored in the corresponding e mail record to determine if the e mail message is authentic. If it is determined that the content of the e mail message does not match the original message content of the e mail message as sent the routine proceeds from operation to operation where the e mail authentication module responds to the recipient indicating that the e mail message is not authentic as described above. According to a further embodiment the e mail authentication module may also instruct the recipient regarding a secure message center website or other location where the recipient may go to read the original message content corresponding to the e mail message . From operation the routine ends.

If the e mail authentication module determines that the content of the e mail message matches the original message content of the e mail message as sent the routine proceeds from operation to operation where the e mail authentication module determines if additional content outside the original message content of the e mail message has been added. For example the e mail authentication module may check the attachments stored in the e mail record against any attachments in the received e mail message to determine if attachments that were not originally included in the e mail message were later added potentially with malicious intent. The e mail authentication module may also check if content or data were embedded in the e mail message outside of the content delimiters discussed above in regard to operation .

If additional content has been added to the message then the routine proceeds from operation to operation where the e mail authentication module responds to the recipient that the received e mail message has additional content added after the original e mail message was sent. For example the e mail authentication module may respond to the forwarded e mail with an indication that the original e mail message received by the recipient has the added content and instructing the recipient to visit a secure message center website or other location to read the original message content . If however additional content has not been added to the message then the routine proceeds from operation to operation where the e mail authentication module responds to the recipient indicating that the received e mail message is authentic. From operations or the routine ends.

From operation the routine proceeds to operation where the e mail authentication module extracts a message signature embedded in the e mail message at the time the message was sent. According to one embodiment a message signature may be generated from a private key and or a hash of the original message content and embedded in all outgoing e mail messages sent from or on behalf of the organization. The message signature may be included in a header of the e mail message or encoded in text or in an image and embedded in content of the message for example. Upon receiving the e mail message the e mail authentication module locates the encoded message signature embedded in the message and decodes the original signature value.

The routine proceeds from operation to operation where the e mail authentication module re generates the message signature for the e mail message using the private key and or hash of the message content or the received e mail message in the same manner as when the message was originally sent. The routine then proceeds to operation where the message signature extracted from the e mail message and the re generated message signature are compared. If the two message signatures are not the same then the operation proceeds from operation to operation where the e mail authentication module informs the recipient that the e mail message is not authentic. For example the e mail authentication module may transmit a message through the authentication application to the recipient indicating that the message is not authentic. If however the two message signatures are the same then the routine proceeds from operation to operation where the e mail authentication module informs the recipient that the e mail message is authentic. From operations or the routine ends.

The computer includes a baseboard or motherboard which is a printed circuit board to which a multitude of components or devices may be connected by way of a system bus or other electrical communication paths. In one illustrative embodiment one or more central processing units CPUs operate in conjunction with a chipset . The CPUs are standard programmable processors that perform arithmetic and logical operations necessary for the operation of the computer .

The CPUs perform the necessary operations by transitioning from one discrete physical state to the next through the manipulation of switching elements that differentiate between and change these states. Switching elements may generally include electronic circuits that maintain one of two binary states such as flip flops and electronic circuits that provide an output state based on the logical combination of the states of one or more other switching elements such as logic gates. These basic switching elements may be combined to create more complex logic circuits including registers adders subtractors arithmetic logic units floating point units and the like.

The chipset provides an interface between the CPUs and the remainder of the components and devices on the baseboard. The chipset may provide an interface to a random access memory RAM used as the main memory in the computer . The chipset may further provide an interface to a computer readable storage medium such as a read only memory ROM or non volatile RAM NVRAM for storing basic routines that that help to startup the computer and to transfer information between the various components and devices. The ROM or NVRAM may also store other software components necessary for the operation of the computer in accordance with the embodiments described herein.

According to various embodiments the computer may operate in a networked environment using logical connections to remote computing devices and computer systems through the network such as a local area network LAN a wide area network WAN the Internet or any other networking topology known in the art that connects the computer to remote computers. The chipset includes functionality for providing network connectivity through a network interface controller NIC such as a gigabit Ethernet adapter. The NIC is capable of connecting the computer to other computing devices over the network such as other application servers the recipient computer a data storage system in the e mail authentication system and the like. It should be appreciated that any number of NICs may be present in the computer connecting the computer to other types of networks and remote computer systems.

The computer may be connected to a mass storage device that provides non volatile storage for the computer. The mass storage device may store system programs application programs other program modules and data which are described in greater detail herein. The mass storage device may be connected to the computer through a storage controller connected to the chipset . The mass storage device may consist of one or more physical storage units. The storage controller may interface with the physical storage units through a serial attached SCSI SAS interface a serial advanced technology attachment SATA interface a fiber channel FC interface or other standard interface for physically connecting and transferring data between computers and physical storage devices.

The computer may store data on the mass storage device by transforming the physical state of the physical storage units to reflect the information being stored. The specific transformation of physical state may depend on various factors in different implementations of this description. Examples of such factors may include but are not limited to the technology used to implement the physical storage units whether the mass storage device is characterized as primary or secondary storage and the like. For example the computer may store information to the mass storage device by issuing instructions through the storage controller to alter the magnetic characteristics of a particular location within a magnetic disk drive unit the reflective or refractive characteristics of a particular location in an optical storage unit or the electrical characteristics of a particular capacitor transistor or other discrete component in a solid state storage unit. Other transformations of physical media are possible without departing from the scope and spirit of the present description with the foregoing examples provided only to facilitate this description. The computer may further read information from the mass storage device by detecting the physical states or characteristics of one or more particular locations within the physical storage units.

In addition to the mass storage device described above the computer may have access to other computer readable media to store and retrieve information such as program modules data structures or other data. It should be appreciated by those skilled in the art that computer readable media may be any available media that can be accessed by the computer including computer readable storage media and communications media. Communications media includes transitory signals. Computer readable storage media includes volatile and non volatile removable and non removable storage media implemented in any method or technology. For example computer readable storage media includes but is not limited to RAM ROM erasable programmable ROM EPROM electrically erasable programmable ROM EEPROM flash memory or other solid state memory technology compact disc ROM CD ROM digital versatile disk DVD high definition DVD HD DVD BLU RAY or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium that can be used to store the desired information in a non transitory fashion.

The mass storage device may store an operating system utilized to control the operation of the computer . According to one embodiment the operating system comprises the LINUX operating system. According to another embodiment the operating system comprises the WINDOWS SERVER operating system from MICROSOFT Corporation of Redmond Wash. According to further embodiments the operating system may comprise the UNIX or SOLARIS operating systems. It should be appreciated that other operating systems may also be utilized.

The mass storage device may store other system or application programs and data utilized by the computer such as the e mail authentication module described above in regard to . In one embodiment the mass storage device or other computer readable storage media may be encoded with computer executable instructions that when loaded into the computer may transform the computer from a general purpose computing system into a special purpose computer capable of implementing the embodiments described herein. These computer executable instructions transform the computer by specifying how the CPUs transition between states as described above. According to one embodiment the computer may have access to computer readable storage media storing computer executable instructions that when executed by the computer perform the routines or for providing out of band authentication of an e mail message as described above in regard to .

The computer may also include an input output controller for receiving and processing input from a number of input devices such as a keyboard the mouse a touchpad a touch screen an electronic stylus or other type of input device. Similarly the input output controller may provide output to a display such as a computer monitor a flat panel display a digital projector a printer a plotter or other type of output device. It will be appreciated that the computer may not include all of the components shown in may include other components that are not explicitly shown in or may utilize an architecture completely different than that shown in .

Based on the foregoing it should be appreciated that technologies for providing out of band authentication of an e mail message are presented herein. Although the subject matter presented herein has been described in language specific to computer structural features methodological acts and computer readable media it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features acts or media described herein. Rather the specific features acts and mediums are disclosed as example forms of implementing the claims.

The subject matter described above is provided by way of illustration only and should not be construed as limiting. Furthermore the claimed subject matter is not limited to implementations that solve any or all disadvantages noted in any part of this disclosure. Various modifications and changes may be made to the subject matter described herein without following the example embodiments and applications illustrated and described and without departing from the true spirit and scope of the present invention which is set forth in the following claims.

