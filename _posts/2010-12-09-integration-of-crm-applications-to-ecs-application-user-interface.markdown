---

title: Integration of CRM applications to ECS application user interface
abstract: CRM application controls and functionality for multiple CRM applications/instances are integrated with an ECS application user interface by designating a single CRM application/instance as primary and providing synchronization and rich client control capabilities. Other CRM applications/instances are set up as secondary within the ECS user interface employing a single CRM connection module and a single state manager. Accessing a secondary CRM application/instance activates relevant controls applicable to that CRM application/instance without a user having to logout and login to the ECS client.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08756254&OS=08756254&RS=08756254
owner: Microsoft Corporation
number: 08756254
owner_city: Redmond
owner_country: US
publication_date: 20101209
---
Customer Relationship Management CRM solutions provide tools and capabilities needed to create and maintain a clear picture of customers from first contact through purchase and post sales. For complex organizations a CRM system may provide features and capabilities to help improve the way sales marketing and or customer service organizations target new customers manage marketing campaigns and drive sales activities. CRM systems may include many components hardware and software utilized individually or in a shared manner by users internal or external to an organization.

CRM systems are an example of computing systems where data associated with entities such as persons organizations accounts and similar ones are maintained for various purposes. Some of the information collected and maintained by CRM applications instances of CRM applications may also be collected or consumed by other common applications such as email contact and or scheduling ECS applications for example Outlook by Microsoft Corporation of Redmond Wash. . Access to data and or functionality of a CRM application instance may be provided from within a user interface of an ECS application through an add in module or similar arrangement where specific controls may be provided as part of the ECS application user interface controls.

CRM applications instances are typically organization specific. In other words configuration setup data credentials etc. for a user s access to a CRM application instance for a particular organization may be different if the same user has access to a CRM application instance for another organization. For example a consultant may have access to the CRM systems of multiple companies. Even though all companies may use the same CRM application the consultant would have to log in using different credentials and access different sets of data for each company. Thus a user may have access to a CRM application instance through the user interface of their ECS application but would have to logout and login each time they want to navigate through the CRM data of a different organization application and or instance of CRM application.

This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to exclusively identify key features or essential features of the claimed subject matter nor is it intended as an aid in determining the scope of the claimed subject matter.

Embodiments are directed to integration of CRM application instance controls for multiple organizations with an ECS application user interface. According to some embodiments a single CRM application instance may be designated as primary providing synchronization and rich client control capabilities. Other CRM applications instances may be set up as secondary within the ECS user interface employing a single CRM connection module and a single state manager. Accessing a secondary CRM application instance may activate relevant controls applicable to that CRM application instance without a user having to logout and login to the ECS client. Each CRM application instance may be represented as a distinct messaging architecture data store e.g. a Messaging Application Programming Interface MAPI store .

These and other features and advantages will be apparent from a reading of the following detailed description and a review of the associated drawings. It is to be understood that both the foregoing general description and the following detailed description are explanatory and do not restrict aspects as claimed.

As briefly described above multiple CRM application instance controls may be integrated with an ECS application user interface by designating a single CRM application instance as primary to provide synchronization and rich client control capabilities and designating other CRM application instance as secondary. A single state manager may manage each CRM application instance context with the ECS application user interface having integrated CRM controls that are automatically customized for each CRM application instance. In the following detailed description references are made to the accompanying drawings that form a part hereof and in which are shown by way of illustrations specific embodiments or examples. These aspects may be combined other aspects may be utilized and structural changes may be made without departing from the spirit or scope of the present disclosure. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined by the appended claims and their equivalents.

While the embodiments will be described in the general context of program modules that execute in conjunction with an application program that runs on an operating system on a computing device those skilled in the art will recognize that aspects may also be implemented in combination with other program modules.

Generally program modules include routines programs components data structures and other types of structures that perform particular tasks or implement particular abstract data types. Moreover those skilled in the art will appreciate that embodiments may be practiced with other computer system configurations including hand held devices multiprocessor systems microprocessor based or programmable consumer electronics minicomputers mainframe computers and comparable computing devices. Embodiments may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote memory storage devices.

Embodiments may be implemented as a computer implemented process method a computing system or as an article of manufacture such as a computer program product or computer readable media. The computer program product may be a computer storage medium readable by a computer system and encoding a computer program that comprises instructions for causing a computer or computing system to perform example process es . The computer readable storage medium can for example be implemented via one or more of a volatile computer memory a non volatile memory a hard drive a flash drive a floppy disk or a compact disk and comparable media.

Throughout this specification the term platform may be a combination of software and hardware components for providing CRM and or email contact scheduling based services. Examples of platforms include but are not limited to a hosted service executed over a plurality of servers an application executed on a single computing device and comparable systems. The term server generally refers to a computing device executing one or more software programs typically in a networked environment. However a server may also be implemented as a virtual server software programs executed on one or more computing devices viewed as a server on the network. More detail on these technologies and example operations is provided below.

The combined term ECS application is used herein to collectively describe hosted and or local applications that provide email scheduling contact management calendaring and similar services. An example of such applications is Outlook by Microsoft Corp. of Redmond Wash. Such applications may provide one or more of the above listed functionality through a number of user interfaces. They may be executed on a server as a hosted service and accessed by users through thin clients such as browsers or locally executed client applications. Some of the services may be provided online others may be provided offline. For simplicity such applications are referred to collectively as ECS applications.

Referring to diagram illustrates a networked environment where CRM and ECS applications may be integrated according to some embodiments. The computing devices and computing environments shown in diagram are for illustration purposes. Embodiments may be implemented in various local networked and similar computing environments employing a variety of computing devices and systems.

In an example environment illustrated in diagram users may access CRM applications executed on CRM servers through a browser or client application executed on their computing devices via network s . CRM applications may be different instances of a CRM system and or each associated with a different organization. Alternatively a single CRM application instance may enable a user to access data and functionality for different organizations through different credentials. The users may also access email contact management and or scheduling services managed by an ECS application executed on server through the same or different browser or client application executed on their computing devices via network s . Some of the tasks associated with the ECS services may be performed online while others may be performed offline. In case of dedicated client applications the client application is sometimes referred to as offline client when it is operating without a connection to the ECS application . When the client application is in contact with the ECS application it may be referred to as online client.

Both ECS application and CRM applications may collect and consume similar information such as contact information appointment meeting information email data and comparable data. Access to at least some of the functionality and data of the CRM applications may be provided through the user interface of the ECS application e.g. through a rich client or browser based access with custom control elements enabling a user to integrate the functionality such as email consolidation follow up operations conditional formatting and similar functionality through the ECS user interface. Without this functionality a user may have to open two separate applications and manually perform the operations.

In case of multi CRM application instance connections however users are typically assigned distinct credentials. Thus in order to access data and functionality for different CRM applications instances a user may have to open different instances of the client application or altogether different applications. In a system according to embodiments an integration module within the ECS application client or service may integrate access to CRM application instance functionality and data within the same ECS application user interface. One of the CRM applications instances may be designated as primary providing synchronization and rich client control capabilities. Other CRM applications instances may be set up as secondary within the ECS user interface employing a single CRM connection module and a single state manager. Accessing a secondary CRM application instance may activate relevant controls applicable to that CRM application instance without a user having to logout and login to the ECS client.

Conventional synchronization approaches rely on messaging architecture and a Component Object Model such as Messaging Application Programming Interface MAPI RPC on change events. A system according to embodiments may represent each CRM application instance as a MAPI data store associated with different server identifiers e.g. Uniform Resource Locator URL and or different credentials. When a different CRM application instance is requested by the user the controls of the user interface may be updated to include elements actions applicable to the requested CRM application instance.

Thus each CRM application instance s information or Organization Context may be assigned an identifier e.g. a unique key for retrieval from repository store. A separate MAPI store may be used for each CRM application instance configured in a user s profile. A one to one relation may be established between each MAPI store and corresponding Organization Context. An appropriate Organization Context may be made available from a current MAPI folder in the ECS user interface. For non CRM folders like ECS Inbox the primary Organization Context may be used for any actions. Any transaction data processing or action may be associated with a corresponding Organization Context activating appropriate sub user interfaces within the ECS user interface and connecting to respective CRM server s with the proper credentials.

According to other embodiments each Organization Context may have its own State e.g. Enable Disable and Offline and transition between these states may not affect any other Organization Context state s . For example Organization Context may be in Disable state but another one in Enabled or Offline state. ECS data store s may be made Organization Context sensitive and store and or retrieve data based on Organization Context identifier.

According to some embodiments data such as CRM contacts and CRM activities may be exchanged and synchronized between the online and offline versions of an ECS client CRM application in addition to providing access to different CRM functionalities through the sub user interfaces. Computing devices and through which the users may access the ECS and or CRM applications may be any computing device including but not limited to desktop computers laptop computers servers handheld computers vehicle mount computers smart phones and comparable devices.

The client organization context when it is first created may start up the state manager . The state manager which may also be started by control UI loader module activation may be reference counted to ensure no more than one instance of it exists. The client organization context may encapsulate the current state of the state manager for a particular CRM application instance including an online offline state a location identifier for connection an enable disable state an authentication state and comparable ones. Multiple CRM application instance contexts may each be in a different connectivity state based on connectivity. According to some embodiments the client organization context may have a static factory method to return the client context for a given CRM application instance identifier. Client organization context may read all the configuration information such as location identifiers offline state etc. from the configuration data provider in order to support simultaneous multiple configured organizations. The client organization context may also expose state change events to allow other components to react to connectivity state changes.

State manager may include a dictionary of CRM application instance contexts. In each cycle the state manager may iterate through all the CRM applications instances in the dictionary and evaluate the result of the state engine for a CRM application instance and raise the appropriate events. In case a new store starts between two state manager cycles the thread may be awakened prematurely to process the new organization. CRM applications instances in the dictionary may be reset to unprocessed when the thread is awakened due to a timeout or a network event. When a manual event for go online or offline is triggered the state manager cycle may be completed if it is in progress and restarted for the primary CRM application instance. Some of the operations in the state manager for example go offline start background synchronization etc. may be handled as a special case for the primary CRM application instance so that these processes are not started for secondary CRM applications instances.

The client configuration information may provide information about the overall configuration of the client for example whether the client has been configured and the identifier of the primary CRM application instance . The client configuration information and the client organization context may use the data provider to read and write data.

Boot cache manager may manage the life cycle of the UI configuration file. Whenever a request for the UI configuration file is received boot cache manager may load it up from disk if it is not already in memory while asynchronously checking with the appropriate server for an updated copy. If there is no persisted copy of the UI configuration file boot cache manager may return an empty UI configuration file. The boot cache manager may also synchronize with the state manager before connecting to the CRM service . Whenever it receives an updated copy of the UI configuration file boot cache manager may raise a refresh event that consumers need to register for and process appropriately.

When the MAPI store starts up it may query the boot cache manager for the current UI configuration file to be able to return the set of folders to ECS application . Whenever MAPI store receives a Refresh event from the boot cache manager the store may react by returning an appropriate set of folders to the ECS application. When the MAPI store needs any data it may retrieve the appropriate data store from the client organization context . If the client organization context claims that the CRM application instance is connected then the data store may use the CRM service which takes client organization context as a parameter to construct a CRM service object. Data store may be able to make requests using the CRM service object. The complexity between connecting to the local CRM server or remote CRM server based on online state or authorization mechanism may be abstracted by the CRM service .

The control UI loader module may manage the lifecycle of the control UI infrastructure that is returned to ECS application. According to some embodiments the control UI loader module may be a light weight add in module that is responsible for returning the UI configuration file to the ECS application. The control UI loader module may be registered as a load on demand add in for example and loaded by the state manager when it reaches the Enabled state. In addition a Refresh event from the boot cache manager which may detect a change in the UI configuration file definition may also cause the control UI loader module to be reloaded. The control UI loader module may consume the UI configuration file definition returned by the boot cache manager for the CRM application instance whose MAPI store is currently added to the ECS profile.

Each folder in the MAPI store may point to a local web page that hosts a shell loader that houses a web browser control. The shell loader may query the client organization context for the current state of the CRM application instance and redirect the inner web browser to either the online or the offline page based on the current online state. If the CRM application instance is disconnected or still loading the shell loader may display an appropriate user interface presenting a message to the user.

Unmanaged objects may include a CRM module user interface handler state manager and client organization context wrapper . State manager may remain as a singleton class in both managed and unmanaged sides . A managed wrapper for state manager may support select event mechanisms for raising state events. State manager may fire following events base on final status of each execution Disabled Enabled Online Offline Network Connected Disconnected and comparable ones.

On the managed side MAPI store may a store data abstraction layer for CRM connection. Store data abstraction layer may use state manager to determine the CRM server status. CRM module and MAPI store may try to start state manager but one of them may lose depending on which state manager has already been started by the other one. Client organization context may read configuration information such as location identifiers offline state etc. from configuration database in order to support simultaneous multiple configured CRM applications instances. Connection to a local CRM server or a remote CRM server may be abstracted by the store data abstraction layer based on online state information from state manager or authorization mechanism .

The examples in have been described with specific configurations and components. Embodiments are not limited to systems according to these example configurations and components. Integration of multiple CRM applications instances and ECS application user interfaces may be implemented in configurations using other types of components processes and configurations in a similar manner using the principles described herein.

Client applications executed on any of the client devices may facilitate communications with an ECS application executed on one or more of servers and one or more CRM applications executed on server or other servers . An integration module executed in conjunction with a client ECS application one any one of the client devices may facilitate integration of CRM application controls for a plurality of CRM applications instances into an ECS application user interface such that a user can seamlessly navigate through the controls and functionality of CRM applications for different organizations as discussed previously. The CRM and or ECS applications may retrieve relevant data from data store s directly or through database server and provide requested services e.g. document editing to the user s through client devices .

Network s may comprise any topology of servers clients Internet service providers and communication media. A system according to embodiments may have a static or dynamic topology. Network s may include secure networks such as an enterprise network an unsecure network such as a wireless open network or the Internet. Network s may also coordinate communication over other networks such as Public Switched Telephone Network PSTN or cellular networks. Furthermore network s may include short range wireless networks such as Bluetooth or similar ones. Network s provide communication between the nodes described herein. By way of example and not limitation network s may include wireless media such as acoustic RF infrared and other wireless media.

Many other configurations of computing devices applications data sources and data distribution systems may be employed to implement a platform providing integration between ECS user interface and multiple CRM applications instances. Furthermore the networked environments discussed in are for illustration purposes only. Embodiments are not limited to the example applications modules or processes.

ECS application may provide email scheduling contact management and comparable services in conjunction with a hosted service. Integration module may integrate controls for multiple CRM applications instances with an ECS application user interface setting up a single CRM application instance as primary providing synchronization and rich client control capabilities. Other CRM applications instances may be set up as secondary CRM applications instances within the ECS user interface employing a single CRM connection module and a single state manager. ECS application and integration module may be separate applications or integrated modules of a hosted service. This basic configuration is illustrated in by those components within dashed line .

Computing device may have additional features or functionality. For example the computing device may also include additional data storage devices removable and or non removable such as for example magnetic disks optical disks or tape. Such additional storage is illustrated in by removable storage and non removable storage . Computer readable storage media may include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. System memory removable storage and non removable storage are all examples of computer readable storage media. Computer readable storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computing device . Any such computer readable storage media may be part of computing device . Computing device may also have input device s such as keyboard mouse pen voice input device touch input device and comparable input devices. Output device s such as a display speakers printer and other types of output devices may also be included. These devices are well known in the art and need not be discussed at length here.

Computing device may also contain communication connections that allow the device to communicate with other devices such as over a wired or wireless network in a distributed computing environment a satellite link a cellular link a short range network and comparable mechanisms. Other devices may include computer device s that execute communication applications web servers and comparable devices. Communication connection s is one example of communication media. Communication media can include therein computer readable instructions data structures program modules or other data. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media.

Example embodiments also include methods. These methods can be implemented in any number of ways including the structures described in this document. One such way is by machine operations of devices of the type described in this document.

Another optional way is for one or more of the individual operations of the methods to be performed in conjunction with one or more human operators performing some. These human operators need not be collocated with each other but each can be only with a machine that performs a portion of the program.

Process begins with operation where a CRM integration module is loaded in an ECS application to provide integration of CRM connectivity and functionality with one or more CRM servers and thereby CRM applications instances . At operation a CRM application instance may be designated as the primary for synchronization and rich client control capabilities. Other CRM applications instances may be set up as secondary within the ECS user interface employing the same CRM connection module and a single state manager. According to other embodiments the primary and secondary designations may not be necessary. One of the plurality of CRM applications instances may be selected automatically through manual selection or through a combination of both. Some functions may determine the instance automatically others may require manual selection. For example a user may receive an email from a person the system may determine the originating person is in the CRM system and set the context of the email and subsequent operations to the CRM system. According to another example implementation a user may receive an email from a person choose to track the person in CRM and may be prompted for which instance.

At operation different CRM applications instances may be represented within the ECS application as distinct MAPI stores. Of course other messaging architecture store types may also be used. The states of the CRM services associated with the different CRM applications instances may be managed by the state manager at operation with each CRM application instance being associated with a different instance of the state manager.

At operation a sub user interface may be provided within the user interface controls of the ECS application for a requested CRM application instance. Available data functionality and or configuration may be different for different CRM applications instances. Thus in response to the user requesting connection to a specific CRM application instance the sub user interface may be modified with custom controls for that CRM application instance. At operation relevant CRM functionality may be provided through the presented sub user interface to the user within the overall ECS application user interface.

The operations included in process are for illustration purposes. Seamless integration of multiple CRM applications instances into ECS application user interface may be implemented by similar processes with fewer or additional steps as well as in different order of operations using the principles described herein.

The above specification examples and data provide a complete description of the manufacture and use of the composition of the embodiments. Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims and embodiments.

