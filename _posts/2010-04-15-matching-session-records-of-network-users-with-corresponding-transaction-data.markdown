---

title: Matching session records of network users with corresponding transaction data
abstract: A system for collecting data regarding network behaviors of users is disclosed. In one embodiment, the system combines session records of users with corresponding transaction records reflective of e-commerce transactions. The session records may, for example, be generated by one or more collection engines deployed by one or more Internet Service Providers. The transaction records may, for example, be obtained through interactions with one or more merchant web sites. By combining these two types of information, the system can, for example, identify a set of user actions that led to a particular purchase transaction.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07971260&OS=07971260&RS=07971260
owner: Hitwise Pty. Ltd.
number: 07971260
owner_city: Melbourne Victoria
owner_country: AU
publication_date: 20100415
---
This application is a continuation of U.S. application Ser. No. 11 980 036 filed Oct. 30 2007 now U.S. Pat. No. 7 752 944 which is a continuation of U.S. application Ser. No. 11 236 482 filed Sep. 27 2005 now U.S. Pat. No. 7 360 251 which is a continuation of U.S. application Ser. No. 09 608 136 filed Jun. 30 2000 now U.S. Pat. No. 6 983 379 .

This invention relates to a system and method for collecting computer network traffic particularly Internet traffic in a manner that does not associate personally identifiable information with network usage data and creating online behavior profiles that are unassociated with individual users. Specifically the system and method of the invention will permit Internet service providers ISP and online merchants to monitor transactions made over a secure or encrypted link such as the Secure Socket Layer SSL and to create behavior profiles without violating customer confidentiality.

The Internet has rapidly grown into a center for conducting commerce with unprecedented efficiency and commercial advantage however the Internet also presents numerous new challenges to the development and execution of appropriate business models and processes. To design and implement effective marketing and business plans companies need to gain a better understanding of consumer behavior and preferences while they are conducting Internet commerce.

In the current Internet world it has become desirable for service providers and merchants to obtain specific information about Internet users for the purpose of improving the marketing of products and services and tailoring products and services to meet the requirements of specific customer types. In order to obtain the most effective data it is desirable to aggregate usage data from companies that provide Internet access to their employees and from ISPs that provide access to subscribers.

However the collection of Internet transaction data raises many concerns about consumer confidentiality and privacy. First participating companies and ISPs desire to maintain the confidentiality of their business information such as the number of subscribers the geographical locations of each subscriber and general usage data.

Additionally many users are averse to having their actions monitored and tracked. Security concerns about the Internet have prevented many users from completing online transactions. Other users have completely stayed away from the Internet because of fears that their private information might become available to third parties in an uncontrolled manner.

Therefore it is desirable to obtain detailed information about the behavior of users while ensuring subscriber employee and company privacy.

Today there are several major approaches to collecting Internet transaction data. The first is through traditional polling techniques. In this method user behavior profiles are developed from users answers to questionnaires regarding their Internet use. Unfortunately this technique suffers from bias and fails to provide the detail that marketers need.

The next approach to collecting network transaction data is by using logfiles generated by network devices such as Web servers and proxies. Logfiles provide increased detail and accuracy compared to polling techniques. Additionally Web server logfiles alone are ineffective in characterizing user behavior because they only contain the cross section Internet traffic going to that Web server the Web server logfiles are unable to accurately capture the behavior of a consumer who accesses multiple Web sites to assist in making purchasing decisions.

The last general approach to collecting network transaction data involves the use of unique identifiers called cookies inserted into an Internet browser. When the user accesses a Web site on the Internet the Web server can read the inserted cookie to obtain the unique identifier and then store details about the current transaction associated with the unique identifier. This method fails to capture Internet usage for users that have cookies disabled on their browsers and also fails to capture Internet usage on Web sites that do not participate in capturing and aggregating usage data. Since the captured data is not complete any behavior profile created using the data cannot be representative of Internet usage in the aggregate.

In building accurate user profiles it is desirable to know the behavior and actions that lead up to a purchase. For example it would be desirable to know that many users searched one online merchant site for books to purchase and then went to a different online merchant site to make the actual purchase. Since most transactions made on the Internet employ some security mechanism such as SSL to protect sensitive customer information e.g. credit card numbers addresses and purchase information it can be difficult for a monitoring system to determine whether a purchase was made much less determine what was purchased.

It becomes desirable therefore to provide a method and system where such information can be obtained while still maintaining the confidentiality of the customer e.g. by characterizing such data in such a manner that it is free of personally identifiable information .

The present invention comprises among other things a system for monitoring network behavior of users. The system includes a first collection engine that is operative to monitor network traffic at an Internet Service Provider location and based thereon to generate session records representing browsing sessions of users. The system also includes a second collection engine that comprises code residing on a server of a merchant site. The second collection engine is operative to generate transaction records reflective of e commerce transactions completed by users via interactions with the merchant site including transaction records containing transaction information that is not available to the first collection engine. The system further includes a computer system that is operative to match session records generated by the first collection engine with corresponding transaction records generated by the second collection engine based at least in part on information reflective of IP addresses associated with the session records and transaction records.

The first embodiment of the present invention provides a system and method for collecting network transaction data without associating personally identifiable information with such data. According to this embodiment users log on to an Internet Service Provider ISP in the conventional manner in order to access the Internet . Once connected a user can use a network browser such as Microsoft Internet Explorer or Netscape Communicator to access Web servers on the Internet .

According to an embodiment of the present invention a collection engine is coupled to the ISP in such a manner that the collection engine can monitor packets sent between users and the Internet . The collection engine is a passive device that monitors network traffic collecting data about network transactions and recording them in a database.

If the connection is encrypted using SSL then collection engine can identify the IP addresses of the hosts involved in the transaction however the engine cannot view the contents of the encrypted datastream and thus cannot determine whether a transaction is completed. In order to determine whether the user completes a transaction a merchant collection engine records the IP addresses of a host completing the transaction along with a transaction code in a database.

In the preferred embodiment the merchant collection engine is implemented as a software application running on a merchant Web server. The software includes two components 1 a daemon for listening and responding to User Datagram Protocol UDP status requests and 2 script implemented using the Common Gateway Interface CGI for logging transaction code information. The script is integrated into the merchant s purchasing system and will vary depending on the configuration of the merchant s system. For example if the merchant uses an Active Server Page ASP written in Visual Basic a line can be added to the current system to run a script that logs the transaction. The script takes as input the transaction code and the IP address of the purchasing host.

The merchant collection engine can be implemented in many different ways. In additional embodiments of the present invention the merchant collection engine runs on a multi tier application server or on a separate server machine. Also in additional embodiments the merchant collection engine is implemented using the Netscape Server Application Programming Interface NSAPI Microsoft s Internet Server Application Programming Interface ISAPI Java servlets or any other Web server technology.

The transaction code can represent any information that a merchant wishes. In the preferred embodiment of the present invention transaction codes must be chosen such as not to compromise the privacy of users. For example in the preferred embodiment the transaction code includes two characters. The first character represents the category or categories for the order. The character is a hexadecimal represented by a series of bits each bit signifying a category as shown in Table 1.

Thus an order including a purchase of books and electronics would have bits and set. Thus the first character would be the binary representation 0011 which is equivalent to 3. If an order includes office supplies and electronics the first character would be 1010 or A.

The second character represents the method of payment used by the purchaser according to Table 2. Thus the two character transaction code 3D represents that a customer purchased books and electronics using a Visa card. One of ordinary skill in the art will readily appreciate an abundance of data that can be encoded in a transaction code other than that shown in this representative example. Additional embodiments use multiple transaction codes.

In an additional embodiment a three character transaction code is used representing a price range as shown in Table 3. In order for the collection engine to create online behavioral profiles that are unassociated with individual users the present invention uses an anonymized identifier to represent an individual user. In this embodiment of the present invention the anonymized identifier is obtained from the username of the individual user. However to maintain user anonymity it is imperative that the original username cannot be obtained from the anonymized identifier. The present embodiment applies a one way hashing function to the login usernames. One way hashing functions such as Message Digest 4 MD4 Message Digest 5 MD5 Secure Hashing Algorithm 1 SHA 1 etc. are commonly used in cryptography applications including digital signatures.

When a user logged on to an ISP accesses a Web page located on a server the user s workstation opens a network connection to the desired server using the Internet Protocol IP . The network packets sent between workstation and server contain the network address of both devices however the packets do not contain a username. Thus the collection engine needs to associate a unique identifier with a network IP address to record the transaction without tracing it to the individual user.

In order to create a unique identifier and associate it with an IP address the collection engine needs to obtain a username. In one embodiment of the present invention the collection engine monitors the network for packets containing authentication information that associate a user identifier with an IP address. For example if the ISP is using RADIUS to authenticate users then the RADIUS server sends an authentication timestamp containing a username associated with an IP address whenever a user successfully logs on to the network.

In alternative embodiments of the present invention other authentication mechanisms may be used. In most cases the user identifier and IP address are sent across the network unencrypted and can be obtained by the collection engine however some authentication mechanisms may use encryption or may not be sent across the network. In some instances the access server is configured to suggest an IP address to the RADIUS server if the address is not taken the RADIUS server sends back a packet allowing the assignment. In these cases one of ordinary skill in the art using conventional software development techniques can develop software to obtain the user identifier IP address correlation. Some other methods that are commonly used to assign IP addresses to users are Dynamic Host Configuration Protocol DHCP and Bootp.

In one embodiment of the present invention a collection engine is an Intel based computer running Linux . In order to maintain a high degree of security the operating system is hardened using conventional techniques. For example the inetd daemon and other unnecessary daemons are disabled to limit the possibility that an unauthorized user could gain access to the system. The collection engine also includes one or more network interface cards NIC that allow the operating system to send and receive information across a computer network.

In some embodiments of the present invention Internet network traffic and authentication network traffic may be sent across different networks. In this case the collection engine can use multiple NICs to monitor packets sent across the different networks. Additionally a site may wish to monitor user activity on multiple networks. The collection engine can monitor as many sites as the situation demands and the hardware supports.

Using the network and hardware configuration discussed above we now turn to the software implementation of the collection engine . In accordance with the present invention application software is installed that has been developed in a manner that is conventional and well known to those of ordinary skill in the art at the point of presence POP location with an ISP.

The software includes a process that monitors packets sent across the device s network interfaces as shown in . This embodiment of the present invention begins by waiting for a network packet to be received. When a network packet is received in block relevant data is extracted from the packet in block . The relevant data depends on the protocol of the received packet. For example if the packet is a RADIUS packet the relevant data would include a user identifier an IP address and the time of authentication. If the packet is an HTTP packet the system extracts the relevant header information including the size of the packet and the source and destination IP addresses and records this information along with the date and time of the request. In addition the system also records the requested Uniform Resource Locator URL . For other packet types the system extracts information including the source and destination IP addresses the source and destination ports the size of the packet and the time of transmission.

In the preferred embodiment of the present invention the collection engine is aware of several standard protocols including HTTP FTP RealAudio RealVideo and Windows Media . When network interactions are made using one of these protocols the collection engine can collect additional information such as the name of the files requested.

One embodiment of the present invention also provides additional capabilities to track user sessions. For example when a user is browsing a Web site the user makes a series of separate requests to a Web server. In fact a user may make several separate requests to a Web server in order to show a single Web page. When analyzing the behavior of a user to create a profile it is useful to think of the related requests in terms of a single session instead of as multiple sessions. For example when a user requests a Web page the text of that Web page is downloaded along with each image referenced by that page. The user may then browse multiple pages within that Web site.

In one embodiment of the present invention the collection engine records the beginning of an interaction in a datastore when an initial HTTP network connection is opened. The system also records the time when that interaction was opened. Additional HTTP requests are determined to be within the same interaction until the interaction ends. In one embodiment of the present invention interactions end after an inactivity period. In an additional embodiment of the present invention interactions remain active for Transmission Control Protocol TCP connections until the connection is closed using TCP flow control mechanisms.

Once data has been collected by a collection engine the data can be aggregated with data collected by other collection engines. For example an ISP may have multiple POPs and may use a collection engine to collect data at each POP. The resulting data can then be aggregated by a central aggregation server .

In one embodiment of the present invention an aggregation server is connected to the Internet through a conventional mechanism. Additionally one or more collection engines are connected to the Internet as well as one or more merchant collection engines . The aggregation server can access each of the collection engines and merchant collection engines to configure and maintain them as well as to receive network transaction data.

As discussed above efforts are taken to maintain the security of each collection engine . For this reason a secure mechanism for logging on to collection engines and merchant collection engines and a secure mechanism to retrieve data are desirable. One embodiment of the present invention uses the Secure Shell SSH to provide strong authentication. This helps prevent unauthorized access to the server. SSH also provides a mechanism for encrypting the datastreams between collection engines and an aggregation server . One of ordinary skill in the art will appreciate that many additional forms of secure login can be used including one time password systems and Kerberos 

As stated above the aggregation server performs two major tasks 1 configuration and management of collection engines and merchant collection engines and 2 aggregating data from the engines.

In one embodiment of the present invention the aggregation server monitors each collection engine using a protocol based on the User Datagram Protocol UDP . Every five minutes a collection engine sends a UDP packet to the aggregation server signifying that the collection engine is still alive. Additionally the UDP packet also specifies the amount of data collected and the number of users currently using the system. In this manner the aggregation server can be alerted when a collection engine crashes loses its network connection or stops collecting data. This permits the effective management of the collection engines from a central aggregation server .

Additionally the aggregation server monitors each merchant collection engine using a UDP based protocol in a manner similar to that used with collection engines . In one embodiment the UDP based protocol specifies the number of transactions recorded and the number of transactions pending.

In alternative embodiments of the present invention the collection engines and the merchant collection engines implement a Simple Network Management Protocol SNMP Management Information Base MIB . The MIB includes information such as the time the server has been active the amount of data stored on the server and the number of active users and network sessions.

The aggregation server also performs the additional task of collecting and aggregating data from the various collection engines and merchant collection engines . The data is collected once per day by the aggregation server through a secure SSH connection as discussed above. The data is then initially validated so that corrupt packet information is removed and the data is sorted to facilitate loading into the central datastore.

In some embodiments of the present invention the collection engines and do not have enough storage to permit one collection every twenty four 24 hours. In these cases the aggregation server can collect data from the collection engine more often than every 24 hours. In one embodiment of the present invention the UDP based management protocol discussed above can be used to determine when a collection needs to be scheduled. In addition to the information discussed above the UDP based management protocol also includes the percentage of collection storage that has been used. A threshold can be set to initiate a collection. For example if a collection engine or a merchant collection engine sends a UDP based management protocol packet stating that it has used 70 of its storage capacity then the aggregation server can initiate the process of aggregating the data from that collection engine as discussed above.

In one embodiment of the present invention aggregation server is a Sun Enterprise 6500 server with sixteen 16 Sparc Ultra II processors and four 4 Fiber Channel connections to an EMC disk array. The aggregation server includes an Oracle database that is configured to store data retrieved from the various collection engines and .

In one embodiment of the present invention the aggregation server stores the following information that is retrieved from the various collection engines 1 ISP a representation of an ISP that collects data 2 POP a representation for a particular point of presence within an ISP 3 AID an anonymized user identifier 4 Start Date the date and time that an interaction began 5 End Date the date and time that an interaction ended 6 Remote IP the IP address of remote host e.g. the IP address of a Web server being accessed by a user 7 Remote Port the port of the remote computer that is being accessed 8 Packets To the total number of packets sent during the interaction 9 Bytes To the total number of bytes sent to the remote server during an interaction 10 Packets From the total number of packets received from the remote computer 11 Bytes From the total number of bytes received from the remote computer and 12 IP Protocol the protocol code used during the interaction. For example shows a typical data table for the aggregation server.

Protocols such as the Hypertext Transfer Protocol HTTP and the File Transfer Protocol FTP contain additional information that can be useful in describing user behavior. One embodiment of the present invention collects additional information for these protocols. For example shows a representative data table containing additional HTTP information as follows 1 HTTP Host the hostname sent as part of the HTTP request 2 HTTP URL the Uniform Resource Locator requested 3 HTTP Version the HTTP version sent as part of the request.

The various embodiments of the present invention discussed above maintain the anonymity of the user by creating and using an anonymized identifier however the URL used in an HTTP request may contain identifying data. One embodiment of the present invention attempts to strip identifying data from URLs before storing them. According to this embodiment the system searches for the following words within a URL SID username login and password . If these are found the system strips the associated identifying information. For example if the URL were cgibin shop.exe username bob then the system would strip bob from the URL so that this identifying information would not be stored in the aggregated database.

In one embodiment of the present invention the aggregation server includes a database associating anonymized identifiers with a classification. For example in one embodiment the classification is the physical location of the user. This information is determined using the address of the user. There are commercial applications available that will translate a well formed address into a Census block code identifying the general location of that address.

In another embodiment of the present invention anonymized identifiers are associated with job functions. For example a company may wish to monitor how classes of employees are using computer network resources. An anonymized identifier representing a single employee can be associated with a job function classification so that network utilization by employees with the same job function classification can be aggregated. One of ordinary skill in the art will readily appreciate that other classification systems can be used with the present invention.

The transaction codes collected from the merchant collection engines are associated with anonymized identifiers by matching IP addresses associated with transaction codes and those associated with anonymized identifiers. In this manner the system can record information about transactions made across the Web.

For example if a user logs on to the Internet through an ISP he she is assigned a dynamic IP address. The collection engine stores the IP address or the hashed IP address of the user and associates it with an anonymized identifier. Then every connection made by that user is logged together with other information including the IP address the anonymized identifier the time the destination IP address and the protocol being used. If the user accesses Amazon.com and makes a purchase the collection engine does not know whether a purchase was made or not however the collection engine can determine all of the Web sites visited during the user s session.

The aggregation server retrieves all the information about the user s connections to Amazon.com from the collection engine however that collection engine cannot determine whether a purchase was made. If Amazon.com were running a merchant collection engine then a transaction code containing information about the purchase would have been logged. The aggregation server can collect the information from both collection engines and aggregate it into a single database so that the data can be analyzed to determine the actions that led to a purchase.

As discussed above various embodiments of the present invention permit the collection of network utilization data while ensuring the privacy of individual users. In the embodiments discussed above the system maintains the IP addresses of users in order to match data collected on the client side with data collected on the merchant side. The use of IP addresses alone can weaken the privacy protection features of various embodiments of the present invention by providing an identifier that can possibly be traced to a particular user. In this embodiment the IP addresses are hashed in a manner analogous to user identifiers.

Embodiments of the present invention have now been generally described in a non limiting matter. It will be appreciated that these examples are merely illustrative of the present invention which is defined by the following claims. Many variations and modifications will be apparent to those of ordinary skill in the art.

