---

title: Teachable object contour mapping for biology image region partition
abstract: A teachable object contour mapping method for region partition receives an object boundary and a teaching image. An object contour mapping recipe creation is performed using the object boundary and the teaching image to generate object contour mapping recipe output. An object contour mapping is applied to an application image using the object contour mapping recipe and the application image to generate object contour map output. An object region partition using the object contour map to generate object region partition output. An updateable object contour mapping method receives a contour mapping recipe and a validation image. An object contour mapping is performed using the object contour mapping recipe and the validation image to generate validation contour map output. An object region partition receives a region mask to generate validation object region partition output. A boundary correction is performed using the validation object region partition to generate corrected object boundary output. An update contour mapping is performed using the corrected object boundary, the validation image and the contour mapping recipe to generate updated contour mapping recipe output.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09122951&OS=09122951&RS=09122951
owner: DRVision Technologies LLC
number: 09122951
owner_city: Bellevue
owner_country: US
publication_date: 20101101
---
This work was supported by U.S. Government grant numbers 6R44 MH075498 03 awarded by the National Institutes of Mental Health. The U.S. Government may have certain rights in the invention.

Biology image recognition the computer extraction of regions containing biological objects such as tissue cellular and subcellular components bacteria viruses of interest in microscopy images is a fundamental step in quantitative microscopy which has broad applications and markets in basic research drug discovery and disease diagnosis. Biology image recognition consists of two major steps 1 a biological region segmentation step Lee J S J. Learnable object segmentation U.S. Pat. No. 7 203 360 Apr. 10 2007 followed by 2 a region partitioning step. Biology region segmentation identifies the regions in the image where biological objects of interest occupy. Region partitioning identifies the individual objects among the segmented regions for individual object counting and measurements.

Biological objects such as live cells often exist in aggregates colonies rather than in isolation. Therefore it is important to separate them from the acquired images of the biological objects for characterization and measurements. Region partitioning step separates individual biology regions to enable individual biology characterization. It enables biological object counting for comprehensive individual biological object morphological characterization and for biological object type classification population statistics and for image cytometry. These have broad applications in basic research cancer research toxicology and drug discovery.

Currently most users perform biology image recognition using standard image processing software such as Zeiss AxioVision Nikon s NIS Elements Olympus cellSens ImageJ Metamorph ImagePro Slidebook Imaris Volocity etc. custom scripts programming or by hand. It is difficult to apply standard image processing software functions to perform biology image recognition. As a result the majority of biology recognition is performed either manually or using a simple intensity threshold that has very limited applications. Some software supports plug ins. Yet plug ins developed in one lab for image recognition rarely work for the application of a second lab. The users have to modify the algorithm parameters or even the code itself.

Biology image recognition products have been developed recently for high content screening applications. However they are coupled to specific instrument platforms cell types and reagents. They are not flexible for broad applications. The current immature microscopy biology recognition tools impose cost barriers on scientists and the image based scientific discovery process. The cost in skilled labor for manual recognition and custom script development is high. A greater cost is that of experiments foregone or data uncollected due to problems related to image recognition.

Prior art region partition methods relying on a simple but unrealistic assumption that is the background has the lowest intensity and the objects have smooth and stable intensity distribution with the lowest values at boundary and highest values around the center of the objects. Unfortunately this assumption does not match the reality of biological objects. Special dyes are often used to stain biological objects to match the intensity distribution assumptions. However special staining causes toxic effect that cannot be widely used in live object experiments. Also object aggregation creates problem of separation due to obscuration and boundary overlapping.

Special prior art algorithms were programmed to handle specialized situation yet they are not general purpose and cannot be flexibly adopted to other applications Niels VAN VLIET Image Segmentation Applied to Cytology Technical Report no 0303 Laboratoire de Recherche et D veloppement de l Epita June 2003 . There is a strong need for a general purpose new method that 1 can handle broad range of applications not just custom algorithm for specialized applications 2 objects that do not have smooth and stable intensity distribution 3 objects that overlap 

The current invention provides an object contour mapping method using soft fitting for smooth and stable intensity distribution to enable accurate region partition. The object contour mapping method is teachable so it allows easy tailoring for a broad range of applications. The current invention further uses a multi resolution approach to encode the spatial correlations and contexts through the spatial integration into low resolution for effective and efficient fitting. The invention also includes a multiple guided partition method for efficient and effective region partition. The teaching image may not be representative of an application. The teaching can be updated by an updated teaching of the current invention. This is important for creating a contour mapping recipe that has stable performance across a broad range of application images

The primary objective of the invention is to provide teachable object contour mapping method for smooth and stable intensity distribution to enhance all prior art region separation methods. The second objective of this invention is to provide a teachable region partition method for biology image recognition method for broad range of applications. The third objective of the invention is to allow the proper separation of objects even when they overlap and have different sizes. The fourth object is to provide an updateable teaching method to allows a contour mapping recipe that has stable performance across a broad range of application images.

A teachable object contour mapping method for region partition receives an object boundary and a teaching image. An object contour mapping recipe creation is performed using the object boundary and the teaching image to generate object contour mapping recipe output. An object contour mapping is applied to an application image using the object contour mapping recipe and the application image to generate object contour map output. An object region partition using the object contour map to generate object region partition output. An updateable object contour mapping method receives a contour mapping recipe and a validation image. An object contour mapping is performed using the object contour mapping recipe and the validation image to generate validation contour map output. An object region partition receives a region mask to generate validation object region partition output. A boundary correction is performed using the validation object region partition to generate corrected object boundary output. An update contour mapping is performed using the corrected object boundary the validation image and the contour mapping recipe to generate updated contour mapping recipe output.

Biology image region segmentation identifies the regions in computer images where biological objects of interest occupy. Object partitioning in biological image recognition is the process of identifying individual objects in segmented regions. shows a phase contrast biological image of cells and shows its biological object segmentation region and C shows its region partitioning result . The current invention addresses the region partitioning process. Computer image region partition process inputs an image and the segmented objects of interest region and identifies the individual objects among the segmented regions for individual object counting and measurements. The region segmentation step could also create individual object regions from input image directly without the input of the objects of interest region mask.

The application scenario of the teachable region partition method is shown in . It consists of a teaching phase and an application phase. As shown in the teaching phase inputs object boundary and teaching image . It then performs an object contour mapping recipe creation step . The output of the object contour mapping recipe creation step is an object contour mapping recipe . The object contour mapping recipe contains the instructions for a computer to perform object contour mapping on an application image during the application phase. This creates an object contour map . The object contour map has smooth and stable intensity distribution with generally the lowest values at boundary and highest values around the center of the objects. The object contour map can be processed by an object region partition step to generate at least one object region partition output .

An alternative application scenario of the teachable region partition method includes an update teaching step as shown in . Under this scenario the object contour mapping recipe creation step inputs object boundary and teaching image for teaching. This step generates object contour mapping recipe . The object contour mapping recipe is used to perform object contour mapping on a validation image . The validation image should be different from the teaching image or contain new teaching regions of the same image. This creates a validation contour map . The validation contour map processed by an object region partition step to generate at least one validation object region partition . The validation object region partition may contain erroneous partition boundary. This is corrected by a boundary correction step to generate a corrected object boundary . The corrected object boundary the contour mapping recipe and the validation image are used by an update contour mapping step to generate an updated contour mapping recipe . The update teaching process could be applied multiple times on the same or a different validation image in an iterative fashion.

Note that the teaching phase only needs to be performed once and the taught recipe can be applied multiple times for new images during the application phase. In a preferred embodiment of the invention the above application scenarios are implemented by a computer and the data are stored in computer memory or disks.

The object contour mapping recipe creation step is the essential process during the teaching phase. It consists of an object contour reference map creation step and a soft fitting step as shown in .

In one embodiment of the invention the object boundary input could be created by modifying an input region mask using computer. In another embodiment of the invention the object boundary input could be created by user drawing when simultaneously viewing the teaching image from a computer display.

The object boundary can be simply created by user drawing while simultaneously viewing the teaching image from a computer display as shown in . Not all boundaries need to be drawn the user drawn boundaries could be from a few selected objects. But the boundary for each selected object needed to be completely enclosed.

The reference object contour map is an ideal representation of object having smooth and stable intensity distribution with the lowest values at boundary and highest values around the center of the objects. This is generated by the object contour reference map creation step . To assure good separation of overlapping objects the object contour reference map is self calibrated. That is each object has similar low and high values regardless of its size. As shown in the object contour reference map creation step inputs an object boundary and first performs object center region creation and then performs reference mapping using the object boundary and the object center region .

In one embodiment of the invention the object center region creation is performed by an inner distance transformation of the object from the object boundary . The inner distance transformation encodes the distance value of each point inside the object to its closest object boundary . Those ordinary skilled in the art should recognize that different distance metric could be applied such as Norm 0 Norm 1 Norm 2 Norm infinity Eucledian distance etc. The distance transformation is a well known image processing operation that can be implemented by a two pass dynamic programming like method See Lee J S J et. al. Method for adaptive image region partition and morphologic processing U.S. Pat. No. 7 813 580 Oct. 12 2010 . The location having the maximum distance value is the candidate object center region . If multiple maximum locations exist a center selection rule is defined. In one embodiment of the invention the maximum location that is closest to the centroid of the object is chosen as the center. If multiple maximum points having equal distance to the centroid the object center region can be arbitrarily selected among them.

In one embodiment of the invention the outer distance map of the object center region Dist outer center is combined with the inner distance map within the object boundary Dist inner object to create object contour reference map Map reference as follows Map reference height Dist inner object Dist inner object Dist outer center 

Where x and y are position indices of the map and height is the reference height that is common to each object. This allows the proper separation of objects even when they overlap and have different sizes.

Soft fitting finds the optimal relationship between the object contour reference map and teaching image for the teaching region of the teaching image corresponding to the object boundary input. It consists of a feature generation a feature selection and a fitting step as shown in . The feature generation step inputs fitting image and object contour reference map to generate a set of comprehensive image features for the feature selection step . The fitting image will be the teaching image if a single resolution processing is performed. It will be the residual image if it is operated in a multi resolution fashion. The feature selection step inputs the fitting image and the object contour reference map and selects the optimal combination of features selected features for fitting. The fitting step fits the selected features with object contour reference map to create the object contour mapping recipe .

Characterization features associated with each image pixel is extracted. The extracted feature vectors will be used for fitting. In one embodiment of the invention the features are derived from the grayscale intensity of the fitting image. In addition to the original grayscale intensity a pixel neighborhood such as 3 3 5 5 7 7 etc. is defined. The grayscale intensity statistics such as mean standard deviation skewness kurtosis and other statistics such as cooccurrence matrix based texture measurements facet model parameters and facet model parameter derived features can be derived. Moreover pre processing of the grayscale intensity can be performed before gathering the statistics. The pre processing includes point operations such as logarithm conversion for optical density measurement or filtering such as edge enhancement by linear or morphological gradient operator that includes dark edge bright edge and general edge enhancement.

When the input image is a color image color transformation may be applied to convert the color image into multi bands of grayscale images. In one embodiment of the invention the multiple bands includes the following images R Red channel G Green channel B Blue channel R G R G R R G B G R G B B R G B R G R B G B G R B G B R etc.

The intensity space features with and without pre processing can be generated for each band of the image. The characterization features could be performed in multi resolution representation of the input image to characterize the patterns in different scales. Those ordinary skilled in the art should recognize that other feature spaces such as temporal space or different focal planes could be used and they are all within the scope of this invention.

The fitting performance could degrade in the presence of irrelevant or redundant information. The aim of the feature selection step is to find a subset of features for fitting that could result in better performance than using all features.

In one embodiment of the invention the feature selection is performed sequentially by the following steps 

Step 1 set an initial feature count K. K should be a small number as large K will have too many unique K feature combinations.

Step 3 performs fitting of all feature combinations to the object contour reference map and gets the fitting errors. In one embodiment of the invention the linear regression method is used. The linear regression method fits the linear model of input feature combination for each point in the map F to output object contour reference map m.

Suppose we have n points in the map and we have p features per point from the input feature combination then the linear model is 

The above fitting method treats all points in the object contour reference map equally. In another embodiment of the invention user can input different weights for different points in the map. In this case we have another n 1 weight vector w representing the different weights for each pixel. Then the linear regression can be formulated as the following Least Square problem arg min 

Those ordinary skilled in the art should recognize that other methods of feature selection can be used such as the filter approach and the wrapper approach.

The fitting step takes the selected features from the feature selection step to fit with the object contour reference map. The fitting coefficients along with the selected feature indices are stored in the object contour mapping recipe for the application phase. For update teaching some intermediate fitting data may also be stored in the recipe. In the application phase selected features are calculated and combined into a contour map using the fitting coefficients stored in the recipe and cell partitioning is performed based on the contour map.

In one embodiment of the invention the linear regression method as described above is used for fitting. In another embodiment of the invention nonlinear models such as exponential functions logarithmic functions trigonometric functions power functions Gaussian function and Lorentzian curve can be used and nonlinear regression method using iterative optimization scheme or nonlinear least square methods can be used for the fitting step. Those skilled in the art should recognize that the nonlinear least square methods include Gauss Newton method gradient methods and direct search methods etc.

In another embodiment of the invention a multi resolution soft fitting method is used. The multi resolution soft fitting method has advantage of encoding the spatial correlations and contexts through the spatial integration into low resolution. In the multi resolution soft fitting method the fitting image I is down sampled progressively up to level K. This yields the following images I I . . . I. Where I I and Iis a down sample version of I. In one embodiment of the invention a low pass filtering proceeds the down sampling operation and the down sampling is by a factor of 2 at each level. Similarly the object contour reference map m is down sampled to level K m m . . . m.

The soft fitting is performed from the lowest resolution level K first and progressively toward the higher resolution level. In the lowest resolution level Iand mare used as fitting image and object contour reference map for soft fitting using the operation as described in . It performs feature generation for level K and fitting to output the object contour mapping recipe at level K.

At a subsequent level q from K 1 to 0 the image Iis used as the fitting image yet the object contour reference map mis not directly used. Instead a residual between mand the q 1 th level fitting result is used. In this way the q th level fitting can make up for the imperfect fitting from the q 1 th level. That is we use where F is the selected feature matrix at level q 1 is the fitting coefficients at level q 1 and is the up sampling function that up samples the image at level q 1 to the same size as level q. In one embodiment of the invention the up sampling includes pixel replication followed by a low pass filtering. III. Object Contour Mapping

As shown in the object contour mapping recipe contains the instructions for a computer to perform object contour mapping to an application image during the application phase. This creates an object contour map . The object contour mapping step computes the selected feature for the application image and uses the feature values F and fitting coefficients to calculate the desired output F . If the object contour mapping recipe contains multi resolution soft fitting coefficients the computation is performed in a multi resolution fashion from lowest resolution level to the highest resolution level as follows for 1 . . . 1 

The process starts from the lowest level where is computed and up sampled by one level then one level higher F is computed and up sampled level K result is added to create and then the sum is u sampled to be added again. This process is repeated until level 0 where the final result is created by 

Note that the above fitting coefficients can be replaced by when the weighting factor is assigned for each pixels during teaching phase.

The object contour map has smooth and stable intensity distribution with generally the lowest values at boundary and highest values around the center of the objects. The object contour map can be processed by an object region partition step to generate at least one object region partition output.

In one embodiment of the invention the object region partition is performed by a guided partition method as shown in . A seed detection step is performed on the object contour map to generate seeds . The seeds can be detected by finding the maximum regions of the object contour map . In one embodiment of the invention the maximum region can be detected by finding the map points whose intensity values are equal to the intensity dilated map. This could be followed by false maximum such as flat region or fragmented regions rejection. The seeds can be used by the zone of influence region generation step See U.S. Pat. No. 7 580 556 Image region partitioning using pre labeled regions . The boundary between the zones can be detected by edge detection to generate zone of influence boundary . The zone of influence boundary can be used to cut the region mask for partition. The cutting operation separates region mask using the zone of influence boundary .

In another embodiment of the invention a multiple guided partition method can be applied by an iterative procedure based on the guided partition method at each iteration. The multiple guided partition method consists of the following steps 

Those skilled in the art should recognize other region partition method such as watershed transformation method and graph partitioning method can be applied to the object contour map and achieved improved partition results due to the smooth and stable intensity distribution of the object contour map.

The teaching image may not be representative of an application. Therefore updated teaching is important for creating an updated contour mapping recipe that has stable performance across a broad range of application images. This can be accomplished by the alternative application scenario of the current invention as shown in . In this scenario validation image is applied to the object contour mapping recipe that is created initially using the teaching image . It is preferred that the validation image is a significantly different image from the teaching image even though both of them are from the same application. Alternatively the validation image could be the same as the teaching image but there are un taught regions that are significantly different from the taught regions. The object contour mapping of the validation image generates a validation contour map . The validation contour map along with the input region mask can be processed through the object region partition step to generate validation object region partition .

The validation object region partition can be reviewed by human to perform boundary correction . The boundary correction step corrects the incorrectly partitioned region by a user using computer graphical user interface. This generates a corrected object boundary for update contour mapping step .

In one embodiment of the invention the update contour mapping is performed by weighted linear combination. In this case the update teaching does not require the training image for the creation of the initial contour mapping recipe. It only needs the fitting coefficients for the update. Let the original teaching image region contains n points with an average weight of . Let the validation image teaching region contains l points with an average weight of and an object contour mapping recipe creation step applies to only the corrected object boundary and validation image create a fitting coefficients . Then the fitting coefficients for the updated contour mapping recipe is 

When multi resolution soft fitting is used the fitting coefficients are updated at each of the multi resolution level. The updated can be performed with or without weighting factors. and

In another embodiment of the invention the update contour mapping updates FF and Fm In this case the vectors are saved in the object contour mapping recipe so they could be easily updated. When the object contour mapping recipe creation step applies to only the corrected object boundary and validation image it creates FF and Fm . This is combined with FF and Fm for update by the following rule 

When multi resolution soft fitting is used the fitting coefficients are updated at each resolution level. The updated can be performed with or without weighting factors.

The invention has been described herein in considerable detail in order to comply with the Patent Statutes and to provide those skilled in the art with the information needed to apply the novel principles and to construct and use such specialized components as are required. However it is to be understood that the inventions can be carried out by specifically different equipment and devices and that various modifications both as to the equipment details and operating procedures can be accomplished without departing from the scope of the invention itself.

