---

title: Method, apparatus, and computer-readable storage medium for removing flickering in video images of objects illuminated by ambient lighting and screen light
abstract: A method, apparatus, and computer-readable storage medium for removing flickering from a video of an object illuminated by a screen that operates on a refresh rate value (f) among a first value set including screen compatible refresh rate values, and an ambient lighting that operates on a certain line frequency value (f) captured by a camera with a certain exposure time value (t) among a second value set including camera compatible exposure time values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08294784&OS=08294784&RS=08294784
owner: Cisco Technology, Inc.
number: 08294784
owner_city: San Jose
owner_country: US
publication_date: 20101222
---
The present application claims the benefit under 35 U.S.C. 119 from U.S. Provisional Application No. 61 291 617 filed Dec. 31 2009 and claims priority to Norwegian Patent Application No. 20093588 filed Dec. 23 2009 which are both herein incorporated by reference in their entirety.

The present disclosure relates to a method apparatus and computer readable storage medium that remove flickering in video images of objects illuminated by ambient lighting and screen light.

In order to have a meeting involving participants not located in the same area a number of technological systems are available. These systems may include video conferencing web conferencing and audio conferencing.

A realistic substitute for real meetings is high end video conferencing systems. Conventional video conferencing systems comprise a number of endpoints communicating real time video audio and or data streams over WAN LAN and or circuit switched networks. The endpoints include one or more monitors cameras microphones and or data capture devices and a codec which encodes and decodes outgoing and incoming streams respectively.

Video conference systems are used throughout the business community for point to point audio and visual communication between individuals. The users of video conferencing systems may sit in workplace environments such as a personal office or a cubical small or large meeting rooms board rooms or the like. Video conference applications installed on multi purpose computers have contributed to spreading the use of personal video conferencing even more.

The flickering is caused by the exposure time i.e. integration time of the camera to record each individual frame in a video picture combined with the frequencies of the ambient lighting and the refresh rate frequency of the screen illuminating objects captured by the camera . A screen contains thousands of illuminative pixels in array. Visual content is displayed by successively applying voltage on each pixel in a pixel line from left to right for each line from the top of the screen and downwards. The refresh rate of the screen is therefore the frequency of illuminating the pixels in the whole screen from top left to bottom right.

Depending on the refresh rate of the screen in question the refresh rate of the screen may cause its own flickering even if the camera is optimized for the normal ambient environment. Furthermore with the advent of larger and high intensity emissive displays indirect illumination caused by such emitters may cause flickering in all or portions of the image seen by the camera .

It may be desirable for the integration time to be as long as possible i.e. maximally responding to the frame rate 1 framerate to maximize signal to noise S N ratio in a resulting footage. However due to line frequency of 50 Hz 60 Hz in the United States 400 Hz in airplanes for example lamps operating at mains Alternating Current AC exhibit intensity variations at double the line frequency. To avoid flickering i.e. phantom intensity variations over time which may look like flickering or line rolling an approach is to select an appropriate integration time for the environment with the aim of overcoming the problem during capture. The relationship that ensures cameras do not beat against a global cyclical stimuli f is Integration time 2 where 0 1 2 . . .

The result of adjusting the integration time according to this equation is that the camera will capture integer numbers of half light wavelengths thereby avoiding variations of light intensity among captured frames.

As already mentioned flickering is not only caused by ambient light. In situations when captured objects are positioned close to relatively big screens as discussed above the illumination contribution from the screen may be considerable and if the integration time is adapted to ambient light only flickering may occur due to the refresh rate of the screen .

A method device and computer readable storage medium for removing flickering from a video of an object illuminated by a screen that operates on a refresh rate value f among a first value set including screen compatible refresh rate values and an ambient lighting that operates on a certain line frequency value f captured by a camera with a certain exposure time value t among a second value set including camera compatible exposure time values. The method includes first determining whether a non zero integer number n exists so that t n 2f second determining when the non zero integer number n exists whether non zero integer numbers for k and l exist so that kf lf calculating when the non zero integer numbers for k and l do not exist a third value set including values for ffulfilling kf lf where k and l are non zero integer numbers and determining whether one or more values in the third value set is equal to one or more values in the first value set and assigning when the one or more values in the third value set is equal to one or more values in the first value set fto one of the one or more values in the third value set that is equal to one or more values in the first value set and implementing tas the exposure time of the camera and fas the refresh rate of the screen.

As should be apparent a number of advantageous features and benefits are available by way of the disclosed embodiments and extensions thereof. It is to be understood that any embodiment can be constructed to include one or more features or benefits of embodiments disclosed herein but not others. Accordingly it is to be understood that the embodiments discussed herein are provided as examples and are not to be construed as limiting particularly since embodiments can be formed to practice the invention that do not include each of the features of the disclosed examples.

According to an embodiment of the present disclosure the distractive illuminative flickering due to discrepancy between line frequency screen updating rate and camera exposure time for example in video conferencing and video recording is removed by a method of adjusting the screen updating rate and the camera exposure time to achieve a flickering free experience of the video captured by the camera.

Furthermore according to an embodiment of the present disclosure a computer readable storage medium may cause a computer to perform the aforementioned method of adjusting the screen updating rate and the camera exposure time to achieve a flickering free experience of video captured by a camera.

In addition according to an embodiment of the present disclosure the distractive illuminative flickering due to discrepancy between line frequency screen updating rate and camera exposure time for example in video conferencing and video recording is removed by an apparatus which adjusts the screen updating rate and the camera exposure time to achieve a flickering free experience of the video captured by the camera. The apparatus may be a video conference terminal a video recording device or the like.

It is assumed that both the screen refresh rate and camera exposure time at least to a certain extent are adjustable from data routines through driving devices of the screen and the camera respectively. This is generally the case in videoconferencing between general purpose computers having a software videoconferencing client installed and a camera either plugged into a Universal Serial Bus USB port or integrated in the computer s screen . It could likewise also be the situation for video recording units when the recorded objects are positioned close to a screen .

Web cameras for example may have Application Programming Interfaces APIs enabling interaction with other software much in the same way that a user interface facilitates interaction between humans and computers. This also applies for both external and internal screens. For example by entering into the Control Panel of a Microsoft Windows operating system a user can manually select the refresh rate of the screen or the exposure time of the camera normally between fixed compatible values. Likewise through an API associated with the screen or the camera a software routine may make the same selection by directing certain requests or instructions interpretable for the APIs.

The line frequency of the ambient lighting is predefined but has a substantial impact on the selection of screen refresh rate and camera exposure time according to the present disclosure. However the line frequency of the ambient lighting may vary between countries regions and settings and thus should be measured by the camera for example before the actual selection occurs. A method of optical measurement of line frequency is known in the art for example as described in U.S. Pat. No. 5 394 217 Method and apparatus for determining line frequency and detecting variable frequency light sources to Gaboury et al. Alternatively the line frequency may also be measured directly from the power line input of the video conferencing device or may be predefined.

The example of may start with preparation steps to . The camera exposure time may be set to a default time and the screen refresh rate may be set to a default rate. The aforementioned default values are captured and allocated in steps and to tand f respectively so that the default values become the selected values if the values in combination with the line frequency provide flickering free video captured by the camera without any modifications. The line frequency may not be known and thus may be measured for example optically by the camera before being assigning to f as noted in step . As noted above screens may be compatible with limited numbers of allowed refresh rates. Thus in step the compatible screen refresh rates are captured from the driver unit of the screen and placed in a set of possible refresh rate values .

In decision step it is determined whether the flickering free equation t n 2f where n is a non zero integer number has a solution with the current value for t i.e. the default camera exposure time determined in step . If there is no solution i.e. a non zero integer number n does not exist No at step the process proceeds to step where tis changed to an alternative value which is not tested in the process before. In step tis modified to the highest not parsed value satisfying t n 2f where n is a non zero integer number. The selected value for tmay be as high as possible for example. However the selection may also be based on other considerations provided that a potential exposure time that has not been tested earlier in the process is selected.

If in decision step it appears that t n 2fhas a solution i.e. a non zero integer number n does exist Yes at step decision step then determines whether there is one or more solutions of the equation kf lf where k and l are non zero integer numbers with current f i.e. the default screen refresh rate determined in step . This test reveals if a least common multiple of l fand l fexists. If a least common multiple exists it may be deducted that the general flickering free equation Integration time 2 where 1 2 3 . . . has a solution for both fand f and there will be no flickering contribution either from the screen or the ambient light with the corresponding exposure time integration time .

If decision step is positive Yes at step the process is terminated and current fand tare selected to be the screen refresh rate and camera exposure time respectively. If the values are not equal to the default values the values are modified in the associated driver units for example by sending a request to the associated API for changing to the selected value s .

If decision step is negative No at step the process proceeds to step where a set of possible values for ffulfilling the equation kf lf where k and l are non zero integer numbers is determined. The process then proceeds to decision step which determines whether there are one or more values in set corresponding to one or more values of compatible screen refresh rates already fetched in preparation step . If there are no corresponding values No at step the process turns back to step to select an alternative exposure time t . However if it appears that and have common values the process proceeds to step where the highest common value of the sets and is allocated as f. In this example the highest value is selected assuming that a highest possible screen refresh rate is preferred. Alternatively in another embodiment the aforementioned selection may also be based on other considerations. The basic goal is to reach a value being present in both sets of values.

Next the process is terminated at step where current fand tare selected to be the screen refresh rate and camera exposure time respectively. The aforementioned values are then modified in the associated driver units for example by sending a request to the associated API for changing to the selected value s .

The computer system may also include special purpose logic devices e.g. application specific integrated circuits ASICs or configurable logic devices e.g. simple programmable logic devices SPLDs complex programmable logic devices CPLDs and field programmable gate arrays FPGAs .

The computer system may also include a display controller coupled to the bus to control a display such as the screen for displaying information to a computer user. The computer system includes input devices such as a keyboard and a pointing device for interacting with a computer user and providing information to the processor . The pointing device for example may be a mouse a trackball a finger for a touch screen sensor or a pointing stick for communicating direction information and command selections to the processor and for controlling cursor movement on the display .

The computer system performs a portion or all of the processing steps of the present disclosure for example the steps of in response to the processor executing one or more sequences of one or more instructions contained in a memory such as the main memory . Such instructions may be read into the main memory from another computer readable medium such as a hard disk or a removable media drive . One or more processors in a multi processing arrangement may also be employed to execute the sequences of instructions contained in main memory . In alternative embodiments hard wired circuitry may be used in place of or in combination with software instructions. Thus embodiments are not limited to any specific combination of hardware circuitry and software.

As stated above the computer system includes at least one computer readable medium or memory for holding instructions programmed according to the teachings of the present disclosure and for containing data structures tables records or other data described herein. Examples of computer readable media are compact discs hard disks floppy disks tape magneto optical disks PROMs EPROM EEPROM flash EPROM DRAM SRAM SDRAM or any other magnetic medium compact discs e.g. CD ROM or any other optical medium punch cards paper tape or other physical medium with patterns of holes.

Stored on any one or on a combination of computer readable media the present disclosure includes software for controlling the computer system for driving a device or devices for implementing the invention and for enabling the computer system to interact with a human user. Such software may include but is not limited to device drivers operating systems and applications software. Such computer readable media further includes the computer program product of the present disclosure for performing all or a portion if processing is distributed of the processing performed in implementing the invention.

The computer code devices of the present embodiments may be any interpretable or executable code mechanism including but not limited to scripts interpretable programs dynamic link libraries DLLs Java classes and complete executable programs. Moreover parts of the processing of the present embodiments may be distributed for better performance reliability and or cost.

The term computer readable medium as used herein refers to any non transitory medium that participates in providing instructions to the processor for execution. A computer readable medium may take many forms including but not limited to non volatile media or volatile media. Non volatile media includes for example optical magnetic disks and magneto optical disks such as the hard disk or the removable media drive . Volatile media includes dynamic memory such as the main memory . Transmission media on the contrary includes coaxial cables copper wire and fiber optics including the wires that make up the bus . Transmission media may also take the form of acoustic or light waves such as those generated during radio wave and infrared data communications.

Various forms of computer readable media may be involved in carrying out one or more sequences of one or more instructions to processor for execution. For example the instructions may initially be carried on a magnetic disk of a remote computer. The remote computer can load the instructions for implementing all or a portion of the present disclosure remotely into a dynamic memory and send the instructions over a telephone line using a modem. A modem local to the computer system may receive the data on the telephone line and place the data on the bus . The bus carries the data to the main memory from which the processor retrieves and executes the instructions. The instructions received by the main memory may optionally be stored on storage device or either before or after execution by processor .

The computer system also includes a communication interface coupled to the bus . The communication interface provides a two way data communication coupling to a network link that is connected to for example a local area network LAN or to another communications network such as the Internet. For example the communication interface may be a network interface card to attach to any packet switched LAN. As another example the communication interface may be an integrated services digital network ISDN card. Wireless links may also be implemented. In any such implementation the communication interface sends and receives electrical electromagnetic or optical signals that carry digital data streams representing various types of information.

The network link typically provides data communication through one or more networks to other data devices. For example the network link may provide a connection to another computer through a local network e.g. a LAN or through equipment operated by a service provider which provides communication services through a communications network . The local network and the communications network use for example electrical electromagnetic or optical signals that carry digital data streams and the associated physical layer e.g. CAT 5 cable coaxial cable optical fiber etc. . The signals through the various networks and the signals on the network link and through the communication interface which carry the digital data to and from the computer system may be implemented in baseband signals or carrier wave based signals. The baseband signals convey the digital data as unmodulated electrical pulses that are descriptive of a stream of digital data bits where the term bits is to be construed broadly to mean symbol where each symbol conveys at least one or more information bits. The digital data may also be used to modulate a carrier wave such as with amplitude phase and or frequency shift keyed signals that are propagated over a conductive media or transmitted as electromagnetic waves through a propagation medium. Thus the digital data may be sent as unmodulated baseband data through a wired communication channel and or sent within a predetermined frequency band different than baseband by modulating a carrier wave. The computer system can transmit and receive data including program code through the network s and the network link and the communication interface . Moreover the network link may provide a connection through a LAN to a mobile device such as a personal digital assistant PDA laptop computer or cellular telephone.

Further it should be appreciated that the exemplary embodiments of the present disclosure are not limited to the exemplary embodiments shown and described above. While this invention has been described in conjunction with exemplary embodiments outlined above various alternatives modifications variations and or improvements whether known or that are or may be presently unforeseen may become apparent. Accordingly the exemplary embodiments of the present disclosure as set forth above are intended to be illustrative not limiting. The various changes may be made without departing from the spirit and scope of the invention. Therefore the disclosure is intended to embrace all now known or later developed alternatives modifications variations and or improvements.

