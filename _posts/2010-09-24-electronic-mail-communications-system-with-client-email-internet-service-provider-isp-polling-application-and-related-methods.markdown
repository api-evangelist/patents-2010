---

title: Electronic mail communications system with client email internet service provider (ISP) polling application and related methods
abstract: An electronic mail (email) communications system may include a mobile wireless communications device, a wireless communications network connected to the Internet, and an Internet Service Provider (ISP) server connected to the Internet for receiving emails for a given user. The system may further include an email proxy server connected to the Internet for pushing emails from the ISP server to the mobile wireless communications device via the wireless communications network. A user computer may be connected to the Internet and may include a client email application for periodically polling the ISP server to detect new emails. The client email application may also send new email notifications to the email proxy server upon detection of new emails to cause the email proxy server to push the new emails to the mobile wireless communications device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08065363&OS=08065363&RS=08065363
owner: Research In Motion Research Limited
number: 08065363
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20100924
---
This application is a continuation of Ser. No. 11 426 668 filed Jun. 27 2006 now U.S. Pat. No. 7 805 489 the entire disclosure of which is hereby incorporated herein by reference.

The present invention relates to the field of communications systems and more particularly to wireless electronic mail email communications systems and related methods.

Electronic mail email has become an integral part of business and personal communications. As such many users have multiple email accounts for work and home use. Moreover with the increased availability of mobile cellular and wireless local area network LAN devices that can send and receive emails many users wirelessly access emails stored in source mailboxes of different email storage servers e.g. corporate email storage server Yahoo Hotmail AOL etc. .

One approach for delivering emails to a user s mobile wireless communications device is to use an email proxy server to retrieve new emails from an email storage server s e g. an ISP server associated with the user s email account and then forward the emails to the user s wireless handheld device. One challenge of doing so is knowing when to check the email storage server for new messages. Typically this is done periodically because the email proxy server will not otherwise know when a new message arrives. Yet if the period of polling is too short this may place a significant burden on the email proxy server particularly if it has to check multiple email servers for numerous users.

Another approach to forwarding emails to wireless handheld devices is provided by a client application called SMS4Mail. This program checks and filters email accounts and sends Short Message Service SMS messages to a user s mobile phone. The program can handle up to twenty POP3 e mail accounts and it may also send the SMS messages to multiple mobile phones at the same time. Various criteria may be used for filtering incoming e mails to be sent to the mobile phone such as From and Subject fields. Users also have the option to limit the maximum number of SMS messages for one day. Moreover an SMS message is only to be sent once for each email which meets the specified filtering criteria.

While such systems may be advantageous for notifying users on their mobile phone when new messages are available SMS messages are limited to a relatively small number of characters so while a user will receive an indication of a new email if the email is fairly long the user will only be able to see the very first part of the message. Moreover many wireless network i.e. cellular carriers charge for each SMS message which may make such an approach undesirably expensive for some users.

The present description is made with reference to the accompanying drawings in which preferred embodiments are shown. However many different embodiments may be used and thus the description should not be construed as limited to the embodiments set forth herein. Rather these embodiments are provided so that this disclosure will be thorough and complete. Like numbers refer to like elements throughout and prime notation and multiple prime notation are used to indicate similar elements or steps in alternate embodiments.

Generally speaking an electronic mail email communications system may include at least one mobile wireless communications device a wireless communications network connected to the Internet and an Internet Service Provider ISP server connected to the Internet for receiving emails for a given user. The system may further include an email proxy server connected to the Internet for pushing emails from the ISP server to the at least one mobile wireless communications device via the wireless communications network. In addition the system may further include a user computer connected to the Internet and including a client email application for periodically polling the ISP server to detect new emails. The client email application may also send new email notifications to the email proxy server upon detection of new emails to cause the email proxy server to push the new emails to the mobile wireless communications device. This advantageously relieves the workload of the email proxy server as it need not poll the ISP server for new emails since the client application already does so.

By way of example each email may have a respective unique identification UID associated therewith and the user computer may poll the ISP for new emails based upon the UIDs. The new email notifications may include the UIDs of the new emails.

Furthermore the client email application may establish a semi permanent Hyper Text Transfer Protocol HTTP connection with the email proxy server for sending new email notifications. Moreover the email proxy server may periodically poll the ISP server to detect new emails if the semi permanent HTTP connection with the client email application is terminated to thereby provide a fallback so that the given user will continue to have email pushed to the mobile wireless communications device if the semi permanent connection with the client email application is lost. In particular the client email application may initiate the semi permanent connection using an HTTP GET request and the client email application may also send the new email notifications using an HTTP POST request.

The client email application may further provide an operational status confirmation notification to the email proxy server after a period during which no new email notifications are sent. For example this may be done so that the email proxy server knows that the client email application is still connected via the semi permanent HTTP connection and operating properly and that the lack of communication is simply a result of there being no new email messages at the ISP server. In addition the client email application period of polling may be user selectable. Also the wireless communications network may be a cellular communications network for example.

An email communications method aspect may include installing a client email application on a user computer connected to the Internet and periodically polling an ISP server connected to the Internet to detect new emails for a given user using the client email application. The method may further include sending new email notifications to an email proxy server using the client email application upon detection of new emails and pushing copies of the emails from the ISP server to a mobile wireless communications device of the given user via a wireless communications network using the email proxy server.

A computer readable medium having computer executable instructions may be for causing a user computer connected to the Internet to perform steps including periodically polling an ISP server connected to the Internet to detect new emails for a given user and sending new email notifications to an email proxy server upon detection of new emails. This advantageously causes the email proxy server to push copies of the emails from the ISP server to a mobile wireless communications device of the given user via a wireless communications network.

Referring initially to an email communications system and associated method are now described. The system illustratively includes a mobile wireless communications device a wireless communications network connected to the Internet and an Internet Service Provider ISP server connected to the Internet for receiving emails for a given user. By way of example the mobile wireless communications device may be a cellular device which is capable of sending and receiving emails and the wireless communications network may be a cellular network as will be appreciated by those skilled in the art.

Other types of mobile wireless communications devices and mobile wireless communications networks may be used such as a wireless local area network WLAN e.g. IEEE 802.11x Bluetooth etc. . Moreover it should also be noted that only a single wireless communications device wireless communications network and ISP server are shown in the illustrated example for clarity of reference but in an actual implementation there may be numerous ISP servers networks e.g. cellular carriers networks mobile devices and even email proxy servers as well 

The system further illustratively includes an email proxy server connected to the Internet for pushing the emails from the ISP server to the mobile wireless communications device via the wireless communications network . By push it is meant that the email proxy server sends emails to the mobile wireless communications device without the device having to initiate a check for new emails or send a request to download new emails such as through an SMS command for example . Sending emails could include directly sending the stored emails or sending copies thereof. The email proxy server may be an aggregation server that aggregates emails from one or more user email accounts e.g. GMail Hotmail AOL corporate account etc. to a single convenient target email box here the user s mobile wireless communications device as will be appreciated by those skilled in the art.

The system also illustratively includes a user computer connected to the Internet and including a client email application . In particular the user computer could be a stand alone computer that is connected to the Internet through the user s ISP gateway. In addition the user computer could also be connected together with other computers in a network such as in a LAN e.g. at a corporation and or be located in a protected computer environment e.g. behind a network firewall . The client email application is installed by a user or network administrator as the case may be on the user computer Blocks . To this end the client email application may be implemented with a software module or program installed on the user computer as will be appreciated by those skilled in the art.

Regardless of the location of the user computer by accessing the Internet the client email application advantageously polls the ISP server on a periodic basis to detect new emails for the user at Block . In certain email aggregation systems the email proxy server is ordinarily responsible for polling the ISP server for new mails for a plurality of different user accounts in practice there may typically be several ISPs each with numerous user accounts to be polled as noted above . As a result the load on the email proxy server or servers may become extremely burdensome as the number of system users grows if the period at which the server polls for new email is set too short.

However in the system the client email application which is installed on the user computer advantageously performs the polling function for the email proxy server . That is the client email application handles polling for new emails for a respective user ISP email account. This advantageously relieves the workload of the email proxy server as it no longer has to poll the ISP server for new emails since the client email application already does so.

Another significant advantage of using the client email application to perform the polling operation is that this may allow the user to set his preferred interval for polling. That is the user can advantageously set a very short interval for polling for new messages e.g. every minute or less if the user requires prompt access to emails. By comparison the email proxy server may practically only be able to poll at a relatively high interval e.g. every fifteen minutes due to the increased load of polling for numerous users at more frequent intervals. Thus using the client email application to individually poll for only the user s emails rather than relying upon the email proxy server which would perform shared polling for numerous users gives the user more flexibility in setting his desired polling interval. By way of example the user may set the polling interval via a graphical user interface GUI control window for the client email application software as will be appreciated by those skilled in the art.

Once the client email application detects that a new email s is available on the ISP server for the given user the client email application sends a new email notification to the email proxy server at Blocks and . This advantageously causes the email proxy server to push the new emails to the mobile wireless communications device Block thus concluding the illustrated method Block .

Turning now to additional operational and method aspects of the client email application and email proxy server respectively are now described. After installation of the client email application on the user computer the client email application is assigned a global unique identifier GUID which is also saved in a knowledge base not shown for use by the email proxy server . The client email application may supply this GUID in communications with the email proxy server for authentication purposes.

In some embodiments the user may manually initiate a session of the client email application on the user computer . For example the user may run the client email application upon leaving the office for the evening or for an extended period. In other embodiments the client email application may be implemented as a background program that operates whenever the operating system OS e.g. Windows NT etc. of the user computer is running and is transparent to the user. That is as long as the OS is running the client email application will run in the background to automatically begin performing the operations discussed above.

To this end the client email application opens or initiates a connection to the email proxy server at Block and identifies itself uniquely by supplying the GUID. By way of example the client email application may initiate the connection by sending an HTTP GET request to the email proxy server . The client email application may also provide additional HTTP headers therein such as data specifying the globally unique identifier GUID to the HTTP server for example. The email proxy server may thereby establish with the client email application a semi permanent connection that is available for the client email application to send new email notifications to the email proxy server.

By establishing the semi permanent connection the client email application and the email proxy server may advantageously communicate using standard HTTP requests to avoid being blocked by a firewall or other network security programs. That is because the client email application and the email proxy server advantageously communicate using HTTP requests communications therebetween appear as normal HTTP i.e. Internet traffic to a firewall program which typically allows such communications to proceed where other communications e.g. file transfers etc. are otherwise blocked as will be appreciated by those skilled in the art. Of course in some embodiments the client email application and the email proxy server need not necessarily establish the semi permanent HTTP connection and may communicate using other techniques as will also be appreciated by those skilled in the art.

Each email stored on the ISP server may have a respective unique identification UID associated therewith which may be a number or alphanumeric string for example. As such the client email application may poll the ISP server for new emails based upon the UIDs. That is the client email application may record a list of current email UIDs stored on the ISP server after it polls the ISP server. When the client email application next polls the ISP server it can thus compare a newly received list of emails on the ISP server with the previously stored list to determine if there are any differences i.e. any new UIDs that were not present in the previously stored list . If so the client email application determines that a new email s is available at Blocks and can send the new email notification to the email proxy server .

The client email application may format the new email notifications as HTTP POST requests for example to send to the email proxy server at Block . This essentially reverses the traditional client server relationship between the client email application and the email proxy server in that a client application typically only sends HTTP GET requests to a server and it is the server that responds with HTTP POST requests. In this way the email proxy server may also advantageously send work jobs to the client email application via an HTTP POST request responsive to the HTTP GET request used by the client email application to initiate the semi permanent connection .

By way of example one work job may be to reconcile a corporate email account inbox with the inbox on the mobile wireless communications device if the user computer is within a corporate network environment. In this way the client email application may be used not only to poll for emails on one or more of the user s ISP emails accounts but may also be used to poll for emails on the user s corporate account and respective new email notifications for each account may be sent to the email proxy server . The client email application may also be used to reconcile the user s emails on the ISP server if such functionality is supported by the ISP.

The new email notifications may include the UIDs of the newly located emails in some embodiments which allows the email proxy server to request from the ISP server the particular new emails that it needs to push to the mobile wireless communications device . However the UIDs need not be included in the new email notifications in all embodiments and the email proxy server may also use a previously stored list of UIDs to determine which emails stored on the ISP server are new and need to be pushed to the device . Of course other approaches for determining new emails may be used such as by date e.g. all emails with a received date time later than the last check date time etc. as will be appreciated by those skilled in the art.

Once the semi permanent connection between the email proxy server and the client email application is established the email proxy server monitors the connection to make sure that the client email application is still operational and providing notifications when available. The way in which the email proxy server knows that the client email application is still operational and connected is by a receiving a new email notification or b receiving an operational status confirmation notification as discussed above That is the email proxy server will expect to receive one of these two types of notifications from the client email application within a certain period of time e g. 15 minutes and if it does not it will consider the semi permanent connection terminated at Block . When a new email notification or operational status confirmation notification is received at Block the email proxy server pushes copies of the new emails to the mobile wireless handheld device at Block .

However if the semi permanent connection is terminated and the email proxy server and the client email application are no longer able to communicate via the Internet the email proxy server may advantageously begin periodically polling the ISP server to detect new emails at Block . As such this advantageously provides a fallback so that the given user will continue to have email pushed to the mobile wireless communications device even though the semi permanent connection with the client email application is lost.

In accordance with another advantageous aspect a computer readable medium may have computer executable instructions for causing the user computer to perform steps including periodically polling the ISP server to detect new emails for a given user and sending new email notifications to the email proxy server upon detection of new emails. This advantageously causes the email proxy server to push copies of the new emails from the ISP server to the mobile wireless communications device of the given user via the wireless communications network as discussed further above.

Referring now to an exemplary direct access DA email distribution and synchronization system is now described which may be used to provide the above described email proxy server functions. The system allows direct access to different mail sources allowing messages to be transferred directly to a mobile wireless handheld device from a source mailbox. As a result different mail stores need not be used for integrated external source mail accounts and a permanent copy of an email in a local email store is not required.

Although this diagram depicts objects as functionally separate such depiction is merely for illustrative purposes. It will be apparent to those skilled in the art that the objects portrayed in this figure can be arbitrarily combined or divided into separate software firmware or hardware components. Furthermore it will also be apparent to those skilled in the art that such objects regardless of how they are combined or divided can execute on the same computing device or can be arbitrarily distributed among different computing devices connected by one or more networks.

The direct access system enables email users or subscribers to have email from third party email services pushed to various mobile wireless communications devices . Users need not create a handheld email account to gain direct access to an existing external email account. The direct access system may operate without performing aggregation as used in some prior art systems in which emails are aggregated from multiple different source mailboxes to a single target mailbox. In other words email need not be stored in an intermediate target mailbox but instead may advantageously be accessed directly from a source mail store.

As illustrated in the direct access system illustratively includes a Web client WC engine and a mobile office platform MOP . These Web client engine and mobile office platform operate together to provide users with direct access to their email from mobile wireless communications devices via one or more wireless communications networks for example. Both the Web client engine and the mobile office platform may be located at the same location or at separate locations and implemented in one or more servers. The web client engine illustratively includes a port agent for communicating with the wireless communications devices via the wireless communications network s a worker a supervisor and an attachment server which will be discussed further below. An alert server is shown in dashed lines and in one preferred embodiment is not used but could be part of the system in yet other embodiments.

The mobile office platform illustratively includes a DA proxy and a proxy application programming interface API and a cache cooperating with the DA proxy. The mobile office platform also illustratively includes a load balance and cache LBAC module an event server a universal proxy UP Servlet an AggCron module a mobile office platform MOP engine and a database DB engine which will be discussed in further detail below. The Least Recently Used LRU cache caches new messages and can release messages and objects that were least recently used.

The supervisor processes new mail notifications that it receives from the direct access proxy . It then assigns a job in the form of a User Datagram Protocol UDP packet to the least loaded worker according to the most recent UDP heartbeat the supervisor has received. For purposes of this description heartbeat is a tool that monitors the state of the server. Additionally the supervisor will receive a new service book request from the direct access proxy to send service books to the mobile wireless communication device for new or changed accounts. A service book can be a class that could contain all service records currently defined. This class can be used to maintain a collection of information about the device such as connection information or services such as an email address of the account.

The worker is an intermediary processing agent between the supervisor and the port agent and responsible for most processing in the Web client engine . It will retrieve e mail from a universal proxy via a direct access proxy and format e mail in Compressed Multipurpose Internet Mail Extension CMIME as a type of Multipurpose Internet Mail Extension and send it to the port agent for further processing. Its responsibilities include the following tasks 1 messages sent to and received from the handheld 2 message reply forward and more requests 3 Over The Air Folder Management operation OTAFM 4 attachment viewing and 5 service book.

The port agent acts as a transport layer between the infrastructure and the rest of the Web client engine . It is responsible for delivering packets to and from the mobile wireless communications device. To support different integrated mailboxes with one device more than one service book can be used and each service book can be associated with one integrated mailbox. A port agent can include one Server Relay Protocol SRP connection to a relay but it can also handle multiple SRP connections and each connection may have a unique Globally Unique Identifier GUID associated with a service book. The attachment server provides service for document attachment conversion requests from workers .

The direct access proxy provides a Web based Distributed Authoring and Versioning WebDAV interface that is used by the worker to access account and mailbox information. This provides functionality to create change and move documents on a remote server e.g. a Web server. The direct access proxy typically will present an asynchronous interface to its clients. The LBAC module is used by a notification server and the Web client engine components to locate the proper DA proxy for the handling of a request. The universal proxy Servlet abstracts access to disparate mail stores into a common protocol. The event server responds to notifications of new messages from corporate servers and or mail service providers which may be received via the Internet for example. The notifications are communicated to the direct access proxy by the AggCron module and the event server so that it may initiate checking for new mail on source mailboxes of the mail service providers and or corporate servers . The proxy API can be a Simple Object Access Protocol SOAP Daemon and is the primary interface with a database which is the primary data store for the mobile office platform . The AggCron module may also periodically initiate polling for new messages as well.

The LBAC module is used by a notification server and the Web client engine components to locate the proper DA proxy for the handling of a request. The universal proxy servelet abstracts access to disparate mail stores into a common protocol. The event server responds to notifications of new messages from corporate servers and or mail service providers which may be received via the Internet for example. The notifications are communicated to the Web client engine by the AggCron module so that it may initiate checking for new mail on source mailboxes of the mail service providers and or corporate servers . The proxy API SOAP Daemon is the primary interface with a database which is the primary data store for the mobile office platform . The AggCron module may also periodically initiate polling for new messages as well.

The identifier module provides a centralized authentication service for the direct access system and other services. An authentication handshake may be provided between an ID service and direct access system to ensure that users have the proper credentials before they are allowed access to the direct access system . The ability to switch from managing a Web client to a direct access system or vice versa may occur without requiring the user to re enter any login credentials. Any Web client and direct access may share session management information on behalf of a user.

The WAP proxy provides a wireless markup language WML based user interface for configuring source mailboxes with the mobile office platform . The HTML proxy provides an HTML based user interface for configuring of source mailboxes in the MOP . The proxy API SOAP Daemon is the primary interface with the database . The engine is a protocol translator that connects to a source mailbox to validate configuration parameters. The database is the primary user data store for the mobile office platform .

The engine machine illustratively includes a direct access proxy HTML proxy WAP proxy PDS module UP Servlet LBAC module a send mail module an secure mail client SMC server a secure sockets layer SSL proxy an aggregation engine and event server . The SMC server cooperates with corresponding SMC modules resident on certain corporate networks for example to convey email data between the mobile office platform and source mailboxes. The database machine may include an aggregation application programming interface API as a SOAP Daemon an administration console an aggregation database the AggCron module an SMC directory server and a send mail module .

The various components of the Web client engine may be configured to run on different machines or servers. The component binaries and configuration files may either be placed in a directory on the network or placed on a local disk that can be accessed to allow the appropriate components to run from each machine. In accordance with one exemplary implementation deployment may include one supervisor two workers and one port agent for supporting 30 000 external source mailboxes although other configurations may also be used. Actual production deployment may depend on the results of load performance and stress testing as will be appreciated by those skilled in the art.

For the mobile office platform direct access components modules and various functions machines are typically installed in two configurations namely engine machines and database machines . While these machines may have all of the above described components installed on them not all of these components need be active in all applications e.g. aggregation may be used with systems that do not support push technology etc. . Once again actual production deployment may depend on the results of load performance and stress testing.

The mobile office platform architecture in one known technique advantageously uses a set of device language specific extensible Stylesheet Language XSL files which transform application data into presentation information. In one non limiting example a build process takes a non localized XSL file and generates a localized XSL file for each supported language. When the XSL file is used it is compiled in memory and cached for repeated use. The purpose of pre localizing and caching the templates is to reduce the CPU cycles required to generate a presentation page.

Branding may also be performed. Initially a localized XSL file may build a WAP application to access aggregated email accounts. A WAP proxy application may be localizable and support multiple WAP devices. For each logical page of an application a device specific XSL file may be created which may be localized for each language country supported. This rendering scheme may support not only WAP devices but also SMTP HTML and POP proxies for example. In branding each page of a given application may be customized for each different brand.

The branding of a page may be accomplished through XSL file imports including the use of a Java application programming interface API for XML processing JAXP feature to resolve the imports dynamically. This need not require that each combined page brand template be compiled and cached. By way of example in a sample template directory first and second pages for a single language country may be combined with branded counterparts to generate a plurality of distinct template combinations. It is also possible to profile memory requirements of an application by loading templates for a single language device application and brand. An HTML device may include a set of templates that are large compared to other devices.

In one known technique the mobile office platform advantageously builds process and takes non localized files and language specific property files and combines them to make each non localized XSL file into an XSL file for each supported language. A separate XSL file for each language need not be used and the language factor may be removed from the memory usage equation. A JAXP API may be used to extend XSL file with Java classes. The extensions may take various forms for example including extension elements and extension functions. A template may be transformed by creating and initializing an extension object with a locale and passing an object to a transformer. The system can remove multiple imports and use less memory. HTML templates can use template importing to enable template reuse much like Java classes and reuse other Java classes through a mechanism like derivation or importing.

In the direct access system users receive email on their mobile wireless communications devices from multiple external accounts and when replying to a received message the reply to and sent from address integrity is preserved. For example for a user that has an integrated Yahoo account user yahoo.com and a POP3 account user pop3.com if they receive an email at user yahoo.com their replies generated from the device will appear to come from user yahoo.com. Similarly if a user receives an email at user pop3.com their replies will appear to come from user pop3.com.

Selection of the sent from address is also available to a user that composes new messages. The user will have the ability to select the sent from address when composing a new message. Depending on the source mailbox type and protocol the message may also be sent through the source mail service. This functionality can be supported by sending a configuration for each source mailbox for example as a non limiting example a service book for each source mailbox to the mobile wireless communications device .

As noted above a service book is a class that may include all service records currently defined. This class may be used to maintain a collection of information about the device such as connection information. The service book may be used to manage HTTP connections and mail CMIME information such as account and hierachy. At mobile wireless communications devices a delete service book request may be sent when a source mailbox is removed from the account. The service book may also be resent to the device with a viewable name that gives the user some indication that the selection is no longer valid.

A sent items folder may also be synchronized. Any device originated sent messages may be propagated to a source account and stored in a sent mail folder for example. Also messages deleted on the device may correspondingly be deleted from the source mailbox . Another example is that device originated marking of a message as read or unread on the device may similarly be propagated to the source mailbox . While the foregoing features are described as source dependent and synchronizing one way in some embodiments certain synchronization features may in addition or instead propagate from the source mailbox account to the handheld device as will be appreciated by those skilled in the art.

When available the mail service provider or corporate mail server may be used for submission of outgoing messages. While this may not be possible for all mail service providers or servers it is preferrably used when available as it may provide several advantages. For example subscribers to AOL will get the benefit of AOL specific features like parental controls. Furthermore AOL and Yahoo users as non limiting examples will see messages in their sent items folder and messages routed in this manner may be more compliant with new spam policies such as Sender Policy Framework SPF and Sender Id. In addition messages sent via corporate mail servers will have proper name resolution both at the global address list level and the personal level. It should be understood however that the use of the mail service provider to deliver mail may be dependant on partner agreements and or protocol depending upon the given implementation.

The architecture described above also advantageously allows for features such as on demand retrieval of message bodies and attachments and multiple folder support. Moreover a this is spam button or indicator may be used allowing company labels and other service provider specific features when supported by an underlying protocol as will be appreciated by those skilled in the art.

One particular advantage of the direct access system is that a user need not configure an account before integrating additional accounts. However a standalone email address may be used and this address advantageously need not be tied to a mailbox size which the subscriber is required to manage. For example the email account may be managed by an administrator and any mail could be purged from the system after a pre determined period of time i.e. time based auto aging with no mailbox limit for all users .

Additionally all aspects of any integrated email account creation settings and options may advantageously be available to the user from their mobile wireless communications device Thus users need not visit an HTML site and change a setting create a filter or perform similar functions for example. Of course an HTML site may optionally be used.

As a system Internet email service with the direct access system grows ongoing emphasis may advantageously be placed on the administrative site to provide additional information to carrier administrators support teams and similar functions. However in some instances a mail connector may be installed on a personal computer and this functionality may not always be available from the mobile wireless communications device.

The Web client engine may advantageously support different features including message to handheld MTH message from handheld MFH forward reply a message request to view more for a large message e.g. larger than 2K request viewing message attachment and over the air folder management OTAFM . These functions are explained below.

For an MTH function each email account integrated for a user is linked with the user device through a Web client service book. For each new message that arrives in the Web client user mailbox a notification that contains the new message information will typically be sent to a Web client engine supervisor component which in turn will assign the job to an available worker with the least load in the system. The chosen worker will validate the user information and retrieve the new message from the user source mailbox and deliver it to the user device.

In an MFH function MFH messages associated with a Web client service book are processed by the Web client engine and delivered to the Internet by the worker via the simple mail transfer protocol SMTP or native outbox. If a user turns on the option to save the sent message to the sent items folder the direct access proxy will save a copy of the sent message to this folder.

In a Forward Reply More function the user can forward or reply an MTH or MFH message from the mobile wireless communications device as long as the original message still existed in the direct access proxy cache or in user mailbox. For MTH the worker may send the first 2K for example or the whole message whatever is less to the user device. If the message is larger than 2K the user can request MORE to view the next 2K of the message. In this case the worker will process the More request by retrieving the original message from the user source mailbox and send back the 2K that the device requests. Of course in some embodiments more than 2K of message text or the entire message may be sent.

In an attachment viewing function a user can view a message attachment of a popular document format e.g. MS Word MS Power Point MS Excel Word Perfect PDF text etc. or image format GIF JPEG etc . Upon receiving the attachment viewing request which is implemented in a form of the More request in this example the worker can fetch the original message from the user source mailbox via the direct access proxy extract the requested attachment process it and send result back to the user device. The processing requires that the original message has not been deleted from the user Web client mailbox.

In the save sent message to sent items folder function if the user turns this option on the worker places a copy of each MFH message sent from the user device in the user sent items folder in the mailbox. In over the air folder management the Web client OTAFM service maintains any messages and folders in the user mailbox synchronized with the user device over the air.

Whenever a message in the user source mailbox is Moved Deleted the associated message on the device may also be Moved Deleted accordingly and vice versa. When a message is Moved Deleted on the device the associated message in the user Web client mailbox may also be Moved Deleted accordingly. Similarly when a folder is Added Removed Renamed from the user Web client mailbox the associated folder on the device may be Added Removed Renamed and vice versa.

The system may advantageously support different subsets of various messaging features. For example in the message to handheld function the mobile office platform may be responsible for connecting to the various source mailboxes to detect new emails. For each new mail a notification is sent to the Web client engine and based on this notification the supervisor chooses one of the workers to process that email. The chosen worker will fetch additional account information and the contents of the mail message from the direct access proxy and deliver it to the user device .

In a message sent from handheld function the MFH could be given to the direct access proxy from the Web client worker . In turn the mobile office platform delivers a message to the Internet by sending through a native outbox or sending it via SMTP. It should be understood however that the native outbox whenever possible may provide a better user experience especially when taking into account current anti spam initiatives such as SPF and sender Id.

In a message deleted from handheld function when a message is deleted from the device the Web client engine notifies the mobile office platform via the direct access proxy . As such the mobile office platform can delete the same message on the source mailbox.

When handling More Forward Reply Attachment viewing requests the Web client worker may request an original mail from the direct access proxy . It will then process the request and send the results to the mobile wireless communications device . The architecture may additionally support on demand retrieval of message parts and other upgrades for example.

Upon the integration of a new source mailbox the service book notification from the alert server may be sent to the supervisor which assigns this notification to a worker for sending out a service record to the device. Each source mailbox may be associated with a unique service record. In this way each MPH message is linked with a source mailbox based on the service record on the device.

The system may also poll the integrated external mailboxes periodically to check for new mail and to access any messages. The system may further incorporate optimizations for polling bandwidth from an aggregation component allowing a quick poll. The system can also advantageously support a large active user base and incorporate a rapidly growing user base.

The topology of load balancing can be based on the size of a component s queue and its throughput. These load statistics can be monitored by a mechanism in one example called the UDP Heartbeat as described before. If a component is overloaded or has a large queue size the component will have less chance to get an assigned job from other components. In contrast a component will get more assigned jobs if it completes more jobs in the last few hours than other components. With this mechanism the load could distribute over heterogeneous machine hardware i.e. components running on less power machines will be assigned fewer jobs than those on machines with more power hardware.

General load balancing for any mobile office platform components can be accomplished through the use of a load balancer module for example a BIG IP module produced by F5 Networks of Seattle Wash. BIG IP can provide load balancing and intelligent layer switching and can handle traffic routing from the Internet to any customer interfacing components such as the WAP and HTML proxies. The use of a BIG IP or similar module may provide the application with pooling capabilities fault tolerance and session management as will be appreciated by those skilled in the art.

Typically access to a single source mailbox can be from a single direct access proxy over a persistent connection. Any requests on behalf of a particular user could persist to the same machine in the same direct access clustered partition. As certain components are system wide and will be handling work for users across many partitions these components can be designed to determine which direct access partition to communicate with on a request by request basis.

The load balancer and cache LBAC may support this function. The LBAC is a system wide component that can perform two important functions. The first of these function is that it provides a mapping from the device PIN to a particular direct access proxy while caching the information in memory for both fast access and to save load on the central database. Secondly as the direct access proxy will be run in clustered partitions the LBAC may distribute the load across all direct access proxies within any partition.

The LBAC can be formed of different components. For example the code which performs the load balancing can be an extended version of a secure mail connector. The code can also perform lookups to the central database and cache the results LBAC .

In one non limiting example when a worker requires that a direct access proxy perform work it provides the LBAC with a device PIN. The LBAC will discover which partition that PIN is associated with by looking in its cache or retrieving the partition identifier from a central database and caching the result . Once the partition is known the LBAC then consults its cache to see which direct access proxy in that partition has been designated to handle requests for that PIN. If no mapping exists the LBAC requests the PDS to create a new association on the least loaded DA proxy again caching the result . Finally the LBAC responds to the worker with the connection information for the proper direct access proxy to handle that particular request.

The secure mail connector may run in failover pairs where one is an active master and the other is a secondary standby. Internal data structures may be replicated in real time from the master to the standby. Multiple LBACs can be run for scalability and fault tolerance but typically would require an external connection balancing component such as the BIG IP component as explained before.

A receiving component in the Web client engine saves the job that has been assigned to it from other components to a job store on the disk before processing. It can update the status of the job and remove the job from the job store when the job processing is completed. In case of component failure or if the process is restarted it can recover the jobs from the job store and based on the current statuses of these jobs continue processing these jobs to the next state saving the time to reprocess them from the beginning.

Any recovery from the standpoint of MTH MFH can be achieved through current polling behavior and on the Web client engine recovery mechanisms. From within the mail office platform components until a message has been successfully delivered to a Web client engine that message is not recorded in the partition database . During the next polling interval the system can again discover the message and attempt to notify the Web client engine . For new mail events if an event is lost the system can pick up that message upon receiving the next event or during the next polling interval. For sources supporting notifications this interval could be set at six hours as one non limiting example. For messages sent from the Web client engine and for messages that have been accepted by the Web client engine recovery can be handled by different Web client engine components.

The Web client engine may advantageously be horizontally and vertically scalable. Multiple supervisors can be registered configured with direct access proxies to provide the distribution of the notification load and the availability of engine service. Multiple workers and port agents can run on the same machine or across multiple machines to distribute load and achieve redundancy. As the number of users grows new components can be added to the system to achieve high horizontal scalability.

It is possible for a new component to be added to or removed from the system automatically without down time. Traffic can automatically be delegated to a new component and diverted away from failed components. Each component within the mobile office platform can be deployed multiple times to achieve horizontal scalability. To achieve vertical scalability each mobile office platform component can be a multi threaded process with a configurable number of threads to scale under heavy load. Pools of connections can be used to reduce the overhead of maintaining too many open connections.

One example of a hand held mobile wireless communications device that may be used in accordance the system is further described in the example below with reference to . The device illustratively includes a housing a keypad and an output device . The output device shown is a display which is preferably a full graphic LCD. Other types of output devices may alternatively be utilized. A processing device is contained within the housing and is coupled between the keypad and the display . The processing device controls the operation of the display as well as the overall operation of the mobile device in response to actuation of keys on the keypad by the user.

The housing may be elongated vertically or may take on other sizes and shapes including clamshell housing structures . The keypad may include a mode selection key or other hardware or software for switching between text entry and telephony entry.

In addition to the processing device other parts of the mobile device are shown schematically in . These include a communications subsystem a short range communications subsystem the keypad and the display along with other input output devices and as well as memory devices and various other device subsystems . The mobile device is preferably a two way RF communications device having voice and data communications capabilities. In addition the mobile device preferably has the capability to communicate with other computer systems via the Internet 

Operating system software executed by the processing device is preferably stored in a persistent store such as the flash memory but may be stored in other types of memory devices such as a read only memory ROM or similar storage element. In addition system software specific device applications or parts thereof may be temporarily loaded into a volatile store such as the random access memory RAM . Communications signals received by the mobile device may also be stored in the RAM .

The processing device in addition to its operating system functions enables execution of software applications A N on the device . A predetermined set of applications that control basic device operations such as data and voice communications A and B may be installed on the device during manufacture. In addition a personal information manager PIM application may be installed during manufacture. The PIM is preferably capable of organizing and managing data items such as e mail calendar events voice mails appointments and task items. The PIM application is also preferably capable of sending and receiving data items via a wireless network . Preferably the PIM data items are seamlessly integrated synchronized and updated via the wireless network with the device user s corresponding data items stored or associated with a host computer system.

Communication functions including data and voice communications are performed through the communications subsystem and possibly through the short range communications subsystem. The communications subsystem includes a receiver a transmitter and one or more antennas and . In addition the communications subsystem also includes a processing module such as a digital signal processor DSP and local oscillators LOs . The specific design and implementation of the communications subsystem is dependent upon the communications network in which the mobile device is intended to operate. For example a mobile device may include a communications subsystem designed to operate with the Mobitex Data TAG or General Packet Radio Service GPRS mobile data communications networks and also designed to operate with any of a variety of voice communications networks such as AMPS TDMA CDMA PCS GSM etc. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Network access requirements vary depending upon the type of communication system. For example in the Mobitex and DataTAC networks mobile devices are registered on the network using a unique personal identification number or PIN associated with each device. In GPRS networks however network access is associated with a subscriber or user of a device. A GPRS device therefore requires a subscriber identity module commonly referred to as a SIM card in order to operate on a GPRS network.

When required network registration or activation procedures have been completed the mobile device may send and receive communications signals over the communication network . Signals received from the communications network by the antenna are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows the DSP to perform more complex communications functions such as demodulation and decoding. In a similar manner signals to be transmitted to the network are processed e.g. modulated and encoded by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network or networks via the antenna .

In addition to processing communications signals the DSP provides for control of the receiver and the transmitter . For example gains applied to communications signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP .

In a data communications mode a received signal such as a text message or web page download is processed by the communications subsystem and is input to the processing device . The received signal is then further processed by the processing device for an output to the display or alternatively to some other auxiliary I O device . A device user may also compose data items such as e mail messages using the keypad and or some other auxiliary I O device such as a touchpad a rocker switch a thumb wheel or some other type of input device. The composed data items may then be transmitted over the communications network via the communications subsystem .

In a voice communications mode overall operation of the device is substantially similar to the data communications mode except that received signals are output to a speaker and signals for transmission are generated by a microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the device . In addition the display may also be utilized in voice communications mode for example to display the identity of a calling party the duration of a voice call or other voice call related information.

The short range communications subsystem enables communication between the mobile device and other proximate systems or devices which need not necessarily be similar devices. For example the short range communications subsystem may include an infrared device and associated circuits and components or a Bluetooth communications module to provide for communication with similarly enabled systems and devices.

Many modifications and other embodiments will come to the mind of one skilled in the art having the benefit of the teachings presented in the foregoing descriptions and the associated drawings. Therefore it is understood that various modifications and embodiments are intended to be included within the scope of the appended claims.

