---

title: Document managing apparatus, document managing system, and document managing method
abstract: A disclosed device includes a document managing apparatus including an image data acquiring unit acquiring original data of original documents in a predetermined layout, a layout information storing unit storing IDs and layout information, an original document determining unit determining the IDs of the original documents, a partial area information storing unit storing partial area information for the original data respectively for the IDs, a partial area extracting unit, an arrangement information storing unit storing arrangement information on paper in association with the IDs respectively for the partial areas, a synthetic image data generating unit forming synthetic image data in conformity with the arrangement information and forming identification information into the synthetic image data, a data accumulating unit causing a data storing unit to store the identification information and the original data, and a printing unit that prints a synthetic document having the synthetic image data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08310689&OS=08310689&RS=08310689
owner: Ricoh Company, Ltd.
number: 08310689
owner_city: Tokyo
owner_country: JP
publication_date: 20100218
---
The present invention generally relates to a document managing apparatus for managing a correspondence relationship between image data of an input document and a printed document and more specifically a document managing apparatus a document managing system and a document managing method which are capable of identifying an input document based in a printed document.

The more information systems and networks prevail the more exchanges of information among companies and among departments in a company are conducted in a mode of sending and receiving electronic documents via networks. However a mode of exchanging information with fax is still popular because of ease in handling paper media and a high penetration of telephone circuits and fax machines as the infrastructure. There is introduced an information entry system called an image workflow which uses handling of the image data as digital data when a received fax is processed for acceptance or the like. Therefore it becomes possible to efficiently confirm the content of an application with a received fax in a confirmatory operation. However although image data may be displayed on a display in the image workflow a reduced display is desired in displaying an ordinary fax image a format size of A4 in 200 dpi on an ordinary display because of limits of the size and the resolution of an ordinary display. Then visibility becomes insufficient. Therefore the image workflow does not sufficiently prevail.

For example Patent Document 1 discloses a technique of easily associating electronic documents with paper documents in a workflow using both of the electronic documents and paper documents. Patent Document 1 discloses a business support system of storing document identification codes which enable a user to uniquely identify documents produced along with actions of the work flow control information for controlling the document and document links for accessing the documents. Further Document 1 discloses a business support system which attaches control information to the documents produced along with the workflow.

Further Patent Document 2 discloses techniques by which when an input image and a form image are synthesized and printed the form image is encoded the synthesized image having the encoded form image embedded in it is printed the synthesized image formed by synthesizing the form image is scanned and the form image is restored printed and registered. According to Patent Document 2 the convenience of printing using the form image is improved and the capability of reusing the form image is also improved.

Patent Document 3 discloses a document processing apparatus for printing a form used in a workflow system using paper documents handwriting characters or the like in the form and scanning the form by a scanner. With this document processing apparatus it is determined whether an entry area is filled in conformity with a form definition identified by an ID embedded in the form and an output is obtainable in correspondence with the filled content in the entry area. Further the document processing apparatus is capable of instructing to synthesize another form and a content written by hand as one output mode.

The image workflows may have a problem that the capability of handling the image data is not sufficiently considered. For example it is not possible to designate a part of a document even though access to every document is possible in the business support system disclosed in Patent Document 1. When only a part of the image data is necessary it is not possible to extract only that part. Therefore when the number of manuscripts is plural it is unavoidable to print all of the image data in the manuscripts and the consumption amount of papers becomes huge.

In the technique disclosed in Patent Document 2 since the data to be restored are encoded and embedded it is unnecessary to prepare a system of managing the restoration data. Meanwhile the size of the encoded and embedded area is determined and all of the data to be restored are not always embedded. It is possible to print the written content into plural forms in the document managing apparatus disclosed in Patent Document 3. However restoration of original data is not considered. Therefore the convenience is spoiled when all of the image data become necessary.

Accordingly embodiments of the present invention may provide a novel and useful document managing apparatus document managing system and document managing method solving one or more of the problems discussed above.

One aspect of the embodiments of the present invention may be to provide a document managing apparatus including an image data acquiring unit e.g. fax receiving unit and image receiving unit configured to acquire original image data of original documents a layout of the original documents in the original image data being defined a layout information storing unit e.g. form definition list configured to store document IDs for uniquely identifying the original documents and layout information for determining the layout of the original documents an original document determining unit form definition managing unit configured to determine the document IDs of the original documents by comparing the layout information with the layout in the original image data a partial area information storing unit form definition list configured to store partial area information designating partial areas of the original image data respectively for the document IDs a partial area extracting unit e.g. form processing unit configured to extract the partial areas of the original image data designated by the partial area information an arrangement information storing unit e.g. input and output correspondence table configured to store arrangement information on paper in association with the document IDs respectively for the partial areas a synthetic image data generating unit e.g. document generating unit configured to form synthetic image data on which the partial areas are arranged in conformity with the arrangement information and form identification information which uniquely identifies the synthetic image data into the synthetic image data a data accumulating unit e.g. data accumulating unit configured to cause a data storing unit e.g. contents data database to store the identification information in association with the original image data and a printing unit configured to print a synthetic document on which the synthetic image data are formed.

Additional objects and advantages of the embodiments will be set forth in part in the description which follows and in part will be obvious from the description or may be learned by practice of the invention. Objects and advantages of the invention will be realized and attained by means of the elements and combinations particularly pointed out in the appended claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory only and are not restrictive of the invention as claimed.

Hereinafter reference characters may typically designate as follows operating unit fax receiving unit form processing unit data accumulating unit contents data database image receiving unit form definition managing unit form definition list relevant form managing unit input and output correspondence table document generating unit image scanning unit image sending unit printing unit contents ID managing table digital multifunction peripheral digital MFP document processing server network fax machine telephone network document managing system DID data ID CD contents data CDID contents data ID CDID each each contents data ID EA entry area IA insertion area SI of EA scan image of entry area SI scan image all OII all original image data OII original image data SII synthetic image data SII including symbol synthetic image data including a symbol FID form ID input FID input form ID output FID output form ID AID area ID output PID output paper ID SDD synthetic document data instruction of generating SDD instruction of generating synthetic document data and FDF form definition file.

The synthetic document printing mode illustrated in is described. The original document A is for example a document hereinafter it may be referred to as a form having a predetermined layout such as a questionnaire for business use and a guarantee certificate. The original document A is a document or a group of documents used in a business operation. The number of the documents in the original document A is one or more. There is no upper limit to the number. Referring to and the number of the group of the documents in the original document A is 3. The document managing system previously defines positional information of entry areas a to d which are to be extracted based on the layout of the original document A in advance.

When a digital multifunction peripheral DIGITAL MFP acquires original image data as electronic data via a telephone network or a network the digital multifunction peripheral DIGITAL MFP determines the layout of the original image data and extracts the entry areas a to d from the original image data based on positions and sizes of the entry areas a to d which are defined for the form. Specifically copy data of the entry areas are acquired. The original image data are stored in a document processing server not illustrated or the digital multifunction peripheral DIGITAL MFP .

The document managing system previously defines positional information of the entry areas a to d of the original document A in advance. The document managing system identifies the original document A based on the layout. Then the entry areas a to d are arranged in image data of a sheet of paper. The image data are referred to as synthetic image data . A symbol for example a bar code is formed and arranged in the synthetic image data in order to be identified in a later stage.

The document managing system prints the synthetic image data or sends these data to a personal computer PC of a user. Then the document managing system is capable of printing the synthetic image data to paper. Hereinafter paper having the synthetic image data printed on it is referred to as synthetic document . Since only the entry areas a to d desired by the user among the plural original image data are synthesized it is possible to limit the consumption amount of paper for printing and handling of the paper media becomes easy.

Referring to the original document printing mode is described. When the digital multifunction peripheral scans the synthetic document having the synthetic image data printed on it the digital multifunction peripheral inversely transforms the symbol and identifies the original document A. Then the digital multifunction peripheral reads the original image data of the original document A from the document processing server or the digital multifunction peripheral . When there is any appended document related to the original image data the appended document is also printed. The restored original documents to are the same as the original document A that has been scanned. For convenience of explanation the restored document is referred to as a restored original document . Hereinafter restored original document designates any one a part or all of the restored original documents to .

As described it is possible to restore the original document A including the entry areas a to d which are arranged in the synthetic document by scanning the synthetic document with a scanner. When it is difficult for a user to read the synthetic document or when the user wishes to read all of the synthetic document the user can easily obtain the restored original documents .

There are several modes for the document processing server to acquire the original image data. There are the mode of receiving the original image data from the fax machine the mode that the digital multifunction peripheral scans the original image data of the original document A and sends the original image data of the original document A to the document processing server and the mode of sending the original image data from a personal computer not illustrated .

The user utilizes the document processing server by operating the digital multifunction peripheral . For example the user may set printing of either the synthetic document or the restored original document on the digital multifunction peripheral . Hereinafter an operation mode of printing the synthetic document is referred to as a synthetic document printing mode and an operation mode of printing the restored original document is referred to as an original document printing mode.

When the document processing server receives the original image data from the fax machine located outside in the synthetic document printing mode the document processing server generates the synthetic image data by synthesizing entry areas of the original image data and sends the synthetic image data to the digital multifunction peripheral DIGITAL MFP designated by the user. The digital multifunction peripheral DIGITAL MFP prints the synthetic image data on paper. Thus the user may obtain the synthetic document .

Next when the document processing server scans a paper document set by a user on a feeder of the digital multifunction peripheral DIGITAL MFP in the synthetic document printing mode the original image data are received from the digital multifunction peripheral DIGITAL MFP in a manner similar to the above case where the fax machine is used. The document processing server generates the synthetic image data from the original image data obtained by scanning the paper document and sends the scanned data to the digital multifunction peripheral designated by the user. The digital multifunction peripheral DIGITAL MFP prints the synthetic image data on paper. Thus the user may obtain the synthetic document .

Next when a user sets the synthetic document on the feeder of the digital multifunction peripheral DIGITAL MFP and the synthetic document is scanned in the original document printing mode the document processing server receives the synthetic image data of the synthetic document . The document processing server reads the original image data from which the entry areas are extracted from a hard disk drive HDD and sends the original image data to the digital multifunction peripheral designated by the user. The digital multifunction peripheral prints the synthetic image data on paper. Thus the user may acquire restored original document to .

The CPU totally controls the document processing server by reading a document managing program from the HDD and executing a code described in the read document managing program . The RAM is a working area used by the CPU in executing the document managing program . The RAM may be a volatile memory such as a DRAM. The ROM stores a Basic Input Output System BIOS and a device driver enabling minimally accessing to hardware such as a mouse and a keyboard. By calling a bootloader from the BIOS it is possible to start up an operating system OS . The HDD stores files such as the document managing program the OS and a form definition file described later. Instead of the HDD a Solid State Drive SSD may be used.

The input unit may be a mouse a keyboard or the like enabling an administrator to input instructions of operating the document processing server . The display controlling unit is connected to a display . The display controlling unit receives a request for drawing using an Application Program Interface API from the document managing program and the OS and displays a Graphical User Interface GUI screen having a predetermined resolution or graphic mode and a predetermined number of colors on the display . The recording medium mounting unit is configured so that an optical disk medium such as a CD ROM and a DVD ROM and a memory card such as a flash memory are detachable. The recording medium mounting unit is used when the data are read from the memory card and the data are written in the memory card . The document managing program is stored in the memory card and distributed. When installed on the HDD the document managing program is read from the memory card . The document managing program may be downloaded into the document processing server from a server not illustrated connected to the network .

The communication unit is an interface for connecting to the network such as a LAN or the Internet. For example the communication unit includes an Ethernet card ETHERNET upper case is a registered trademark . The communication unit receives data generated in conformity with HTTP FTP or the like by a predetermined application program for example a program executed by the digital multifunction peripheral . The communication unit processes transmission data in conformity with a protocol stipulated in the physical layer and the data link layer of the OSI reference model and sends the processed transmission data to the network . When the router installed in the network handles the routing of the transmission data in conformity with TCP IP the transmission data are sent to the digital multifunction peripheral . A fax communication unit compresses image data with the MH MR or MMR coding and modulates the compressed image data in conformity with a G3 type facsimile recommended by ITU T ITU telecommunication standardization sector or the like. Then the fax communication unit sends the modulated image data via for example a telephone network or an ISDN line. When the sent image data are received on a receiving side the sent image data undertake data decompression error correction or the like on the receiving side to restore the image data.

The HDD is s storage unit configured to store image data programs font data forms or the like. Instead of the HDD an SSD may be installed. An operating unit is a user interface which receives an input operation from a user and displays menus or states for the user. The operating unit may be integrally formed with a touch panel. The operating unit has a keyboard including numeric pads a start button a reset button a copy button a scanner button and a fax button. The communication unit is an interface for connecting the digital multifunction peripheral to the network such as the LAN or the Internet in a manner similar to the communication unit of the document processing server .

The fax communication unit is capable of sending and receiving the image data via the telephone network in a manner similar to the fax communication unit of the document processing server . A scanner optically scans a manuscript mounted on a contact glass applies A D transformation to a reflected light from the manuscript and applies image processing such as an error diffusion and a gamma transformation to the A D transformed image data. Thus the image data having a predetermined resolution or graphic mode is generated. For example an electrophotographic process using laser beams is used. Specifically a toner image formed on a photoconductive drum is transferred to the paper and the transferred image is fixed by heat and pressure by a fixing unit.

The digital multifunction peripheral may not have all functions of the plotter the scanner and the fax communication unit . In use of the digital multifunction peripheral having the scanner the document processing server may generate synthetic image data of the synthetic document . Once the synthetic image data are generated it is possible to print the synthetic image data with a printer other than the digital multifunction peripheral which has scanned the original image data.

The functional block of the digital multifunction peripheral is described below. The order of explanations does not always match an actual process.

The operating unit of the digital multifunction peripheral DIGITAL MFP is used by a user in order to input various operations as described above. In Embodiment 1 the operating unit specifically provides a selection key for a user of selecting the synthetic document printing mode and the original document printing mode.

In the synthetic document printing mode the image scanning unit causes a scanner to scan the original document A set on the feeder of the scanner generates the original image data and sends the data to an image sending unit . Therefore a main component of the image scanning unit is the scanner . In the synthetic document printing mode the digital multifunction peripheral DIGITAL MFP does not print the scanned image data as is with the plotter. The image scanning unit receives a report of whether the original document is successfully sent to the document processing server from the image sending unit . When the image scanning unit fails to scan the original document A or receives a report of unsuccessfully sending the original document the image scanning unit reports the operating unit that the image is unsuccessfully scanned or read.

The image sending unit sends the original image data received from the image scanning unit to the document processing server via the network . Therefore the image sending unit is mainly configured by the communication unit . When the image sending unit unsuccessfully sends the original image the event is reported to the image scanning unit .

The document processing server undertakes two major functions. One is a synthetic document generating function and the other is an original image data reading function. When the digital multifunction peripheral sends the image data in the synthetic document printing mode or the fax receiving unit receives the original data the synthetic document generating function is provided. When the digital multifunction peripheral sends the image data in the restored original document printing mode the original image data reading function is provided. Therefore the operation mode of the digital multifunction peripheral DIGITAL MFP is send to the document processing server together with the image data.

The document processing server may receive the original image data by fax first case or from the digital multifunction peripheral DIGITAL MFP second case . The fax receiving unit receives the original image data sent from a telephone circuit or the like and sends the received original image data to a form processing unit . Therefore the fax receiving unit is mainly configured by a fax communication unit . The fax receiving unit may detect that the original image data are used to generate the synthetic image data in a case where the original image data are sent to a predetermined fax number. The fax receiving unit may detect that the original image data are used to generate the synthetic image data in a case where the user pushes a predetermined number or a pound key allocated to inform sending of the original image data before and after the fax transmission. The fax receiving unit sends the received image data to the form processing unit .

Further the image receiving unit sends the original image data sent from the digital multifunction peripheral DIGITAL MFP via the network and sends the received original data to the form processing unit . Therefore the image sending unit is mainly configured by the communication unit .

The form definition managing unit manages a unique form ID identifier allocated to every form an image dictionary for identifying images of the original image data of the forms and a form definition file used for processing the forms in a manner associating the unique form ID the image dictionary and the form definition file. Hereinafter the associated list is referred to as a form definition list . When the form definition managing unit receives the original image data from the form processing unit the form ID identifier and the form definition file are returned to the form processing unit . Here a location of the form definition file may be returned instead of the form definition file itself.

The form definition managing unit judges an original document A using measures such as a pattern matching. Then the form ID of the image data of the original document A received from the form processing unit is determined.

When the original document A is configured by plural pages it is possible to determine the original document A with only the first page e.g. a book cover or an indispensable page or the original document A. Meanwhile it is possible to determine the original document A by matching patterns of the image data of all the pages A.

It is not always necessary to provide frame borders on the layout of the original document A. schematically illustrates the determination of the original document A having no frame border. Referring to texts are described on the original document A. However there is no frame border surrounding the texts. In this case the form definition managing unit recognizes the circumscribed rectangles of the texts and the texts are replaced by the circumscribed rectangles. Then the form definition managing unit compares the original image data in the circumscribed rectangles with layout information of the image dictionary. Since the frame borders are unnecessary a degree of freedom may become higher in the layout of the original document A.

It is possible to print a one dimensional bar code or a two dimensional bar code which was previously present on the original document A. In this case the read bar code is decoded and the original document A may be determined without conducting the above described pattern matching.

Referring back to the form definition managing unit acquires the output form ID described later from a document generating unit . The form definition file associated to the output form ID or the form definition file location is read from a form definition list . Then the read form definition file or the read form definition file location is returned to the document generating unit .

The form processing unit is described below. The form processing unit acquires the form ID and the form definition file corresponding to original image data sent from the fax receiving unit or the image receiving unit from the form definition managing unit . When the form definition managing unit is not capable of determining the original document A or the original document A is not registered in the form definition list the form definition managing unit reports the event to the form processing unit .

When the original image data are already registered the form processing unit processes the original image data in conformity with the form definition described in the form definition file. illustrates an example of the form definition described in the form definition file FDF . illustrates the form definition described using tags. The name of the form is defined from to . designates the file name of the form as an example of a layout defined by the form definition file and a location where the file are stored. Entry areas of the first page of the form are defined in to . When the original document includes plural pages and the entry areas are read from the pages the first page and the succeeding pages are defined in a manner similar thereto.

The user may write in the entry areas on the forms. The entry areas may be a partial area in which the user does not write a character or a number or an area in which a character or a number is mechanically printed by a printer connected to or integrated in a word processor or the like.

The position size processing method or the like is defined in . For example the area ID uniquely identifying the entry area is rid 0001 . The name of the entry area is FULL NAME in which a full name of a person who has made the entry of the form is described. The position of the entry area is for example coordinates 167 164 from the origin at the upper left apex of the image data. The size of the entry area is a width of 130 and a height of 25 from the coordinates 167 164 . Further the processing method is defined as image storage . The compulsory input is defined as true said differently the entry is mandatory. Such processing of the areas is defined for each of the entry areas.

In the form definition file an area which is not processed is defined in thru . When necessary it is possible to define the position size or processing method of the entry area for this area.

The form processing unit determines processing of the entry area EA based on the described content of the processing method. When the processing method is image storage the entry area is copied and stored or is extracted . The read image of the entry area EA extracted from the image data becomes content data described later. When the processing method performs recognizing check it is determined whether the entry area EA has any entry or a check mark. When the processing method performs recognizing character the entry area EA is applied with Optical Character Recognition OCR to transform a written character or symbol to a character code.

The form processing unit carries out processes in conformity with description of the form definition file FDF and sends a scanned image of the entry area EA the original image data the form ID FID and the area ID AID to the data accumulating unit . The data accumulating unit handles the scanned images of the entry area SI of EA as the contents data as described later and gives the contents data ID CDID for uniquely identifying the contents data CD to the scanned images SI . The form processing unit receives a content data ID CDID from the data accumulating unit .

After the form processing unit receives the contents data ID CDID the form processing unit sends the document generating unit an instruction of generating the synthetic document data the contents data IDs CDID the form ID FID and area ID AID of the original document A determined from the original image data.

The relevant form managing unit manages an input form ID input FID and an output form ID output FID while associating the input form ID input FID and the output form ID output FID . The input form ID input FID is the same as the form ID FID . The output form ID output FID is an identifier of the form definition file FDF which designates the layout of the synthetic document . Said differently the form definition file FDF designates the layout of the synthetic document . The input form ID input FID and the output form ID output FID are registered in the relevant form managing unit after the input form ID input FID and the output form ID output FID are associated by the administrator of the document managing system .

When the document generating unit receives the instruction of generating the synthetic document data SDD and the contents data IDs CDID from the form processing unit the form ID FID or the input form ID input FID is sent to the relevant form managing unit . Then the output form ID output FID of the form definition file FDF defining the layout of the synthetic document to be printed is acquired.

The document generating unit sends the acquired output form ID output FID to the form definition managing unit and acquires the form definition file FDF of the synthetic image data. The document generating unit may maintain the form definition file FDF . illustrates an example of a form definition for the synthetic image data.

The name Incident Accident Report of the synthetic document is defined from to . Background information used at a time of generating the synthetic image data SII is defined in . Insertion areas IA of the first page of the form are defined in to . The position and size of the synthetic image data SII and area ID AID of an entry area EA to be inserted are defined in . For example the process of synthesizing the contents data having the form ID FID of formId 00001 and the area ID AID of rId 0001 is defined in an area having the width of 80 and the height of 20 from the coordinates 40 260 . Referring to the insertion positions and sizes of the entry areas EA are defined.

The background information of a design file form1.pdf in the form definition file is described below. Design files such as the design file form1.pdf correspond to or are included in designing image data recited in claims. and illustrate background information of several form definition files FDF . is the most simple background information. The background of is white and the contents data CD are inserted into the background.

For example there is a case where predetermined contents data are emphasized and output to the synthetic documents. In this case as illustrated in it is possible to designate the background having a highlighted frame as the design file. Referring to the highlighted frame is depicted at lower left of the background information. By determining the highlighted frame to surround the insertion area IA it is possible to arrange the contents data CD to be emphasized in the highlighted frame . The highlighted frame may be colored. For example the color is red in and other colors may also be used.

In a case where the user makes entries by hand in the entry areas EA of the form being original document A the user may fail to make one or some entries by mistake or forgetting. There may be both of a compulsory entry area like a name and a noncompulsory entry area like sex and age. If it is possible for the user to determine whether the entry areas EA are the compulsory entry area of the noncompulsory entry area and what contents are planned to be inserted the convenience of the document managing system may be improved.

Referring to there are described in the background messages indicating whether the contents data CD are planned to be compulsorily inserted. As a result of the insertion the contents data corresponding to the entry areas B C and D are inserted. However the contents data corresponding to the entry area A are not inserted. Therefore the user may read the message indicating COMPULSORY INSERTION described in the background. Therefore the user may immediately determine that the compulsory insertion of the contents is not carried out.

When a blank entry area is inserted as empty contents data colored white the message on the background is replaced by white pixels and may not be scanned. Therefore contents data with semitransparent displays are inserted by the document generating unit for example. It may also be determined whether the entry area has an entry based on a ratio of black pixels occupying the entry area. When it is determined that the entry does not exist the contents data are not inserted.

Referring to there are described in the background messages indicating the content of the contents data. Therefore the user may determine what contents are not inserted.

Referring back to the document generating unit reports the contents data ID CDID to the data accumulating unit when there is a combination of the form ID FID and the area ID AID designated in the form definition file FDF of the synthetic image data SII among the area IDs AID and the form IDs FID corresponding to the contents data ID CDID received from the form processing unit . The document generating unit acquires the contents data CD corresponding to the contents data IDs CDID and the contents data location from the data accumulating unit .

The document generating unit synthesizes the contents data CD to appear at a position designated by the form definition file FDF of the synthetic image data SII . When the contents data CD corresponding to all the contents data IDs CDID received from the form processing unit are inserted the synthetic image data SII are completely generated.

There is a case where the size of the contents data CD and the size of the area where the contents data are inserted are different when the document generating unit inserts the contents data. Therefore the document generating unit compares the size of the contents data CD and the size of the area where the contents data are inserted. When the size of the contents data CD is larger that the size of the area the contents data are reduced. The reduction may be conducted by thinning out pixels of the contents data CD in response to a ratio between the size of the contents data and the size of the insertion area IA . Further when the size of the contents data CD is smaller than the size of the area where the contents data are inserted the contents data may be enlarged in response to the ratio between the size of the contents data CD and the size of the insertion area IA .

The document generating unit generates an output paper ID output PID for uniquely identifying the synthetic image data SII transforms the output paper ID output PID into a symbol which is readable by a machine like a QR code and forms the synthetic image data SII by arranging the symbol at a predetermined position of the synthetic image data. The document generating unit sends the contents data ID CDID used for the generated output paper ID output PID and the synthetic image data to the data accumulating unit . The document generating unit sends the generated synthetic image data SII to the digital multifunction peripheral DIGITAL MFP . It is possible to form a symbol like a background pattern on an entire face of synthetic image data SII instead of forming a symbol like a bar code on a part of the synthetic image data. It is also possible to form a symbol like a digital watermark and a micro character which are difficult to perceive with the naked eye.

The data accumulating unit manages the contents data CD and information related to the contents data such as the form ID FID of the original image data OII of the original document A the area ID AID and the output paper ID output PID . illustrates an example of a contents ID managing table . The contents ID managing table is managed by the data accumulating unit . The contents data location where the contents data are stored an original data location the area ID AID the input form ID input FID and the output paper ID output PID are stored in contents data IDs CDID .

The data accumulating unit generates the contents data ID for uniquely identifying the contents data when the data accumulating unit receives the contents data send out of the form processing unit the area ID AID of the contents data CD the original image data OII of the contents data CD and the form ID FID of the original image data. Then the data accumulating unit stores the contents data ID CDID the contents data the area ID AID the original image data OII and the form ID FID in the contents data database and returns the generated contents data ID to the form processing unit .

The original data location is unique to the same original image data. Therefore when plural contents data are extracted from predetermined original image data the same information is stored in the corresponding original image data location. The original data location also stores the area ID AID indicative of which entry area EA of the original document A the input form ID input FID acquired by identifying the original image data OII and the output paper ID output PID for identifying the synthetic image data SII generated by synthesizing the contents data.

When the data accumulating unit receives the contents data ID CDID and the output paper ID output PID from the document generating unit the data accumulating unit stores the received output paper ID in a column of the output paper ID and a row corresponding to the contents data ID of .

Referring back to the printing unit prints the synthetic image data SII received from the document processing server on paper. Therefore the printing unit is mainly configured by the plotter . The format of the synthetic image data SII may be a pdf file printer job languages like PostScript raster data or the like.

Referring to the digital multifunction peripheral DIGITAL MFP which scans the original document A is different from the digital multifunction peripheral DIGITAL MFP which prints the synthetic image data SII . However these digital multifunction peripherals may be the same.

A configuration that the document managing system prints a restored original document is described. illustrates an example of a functional block chart of the document managing system in an original document printing mode. The synthetic document is scanned by the image scanning unit of the digital multifunction peripheral DIGITAL MFP . The synthetic image data SII are sent to the document processing server . The document processing server receives the synthetic image data SII and the original image data OII associated in the contents ID managing table to the digital multifunction peripheral . The digital multifunction peripheral DIGITAL MFP prints the original image data OII on paper to output the restored original document .

When the restored original document is printed the user touches PRINT RESTORED ORIGINAL DOCUMENT between the selection keys displayed on the operating unit illustrated in . Then the digital multifunction peripheral DIGITAL MFP changes to the original document printing mode.

In the original document printing mode the image scanning unit scans the synthetic document set on the feeder of the scanner generates the synthetic image data SII and sends the synthetic image data to the image sending unit . In the original document printing mode the digital multifunction peripheral DIGITAL MFP does not print the scanned synthetic image data SII as is with the plotter . The image scanning unit receives a report of whether the synthetic document is successfully sent to the document processing server from the image sending unit . When the image scanning unit fails to scan the synthetic document or receives the report of unsuccessfully sending the synthetic document the image scanning unit reports the operating unit that the image is unsuccessfully scanned or sent.

The image sending unit sends the original image data received from the image scanning unit to the document processing server via the network . When the image sending unit unsuccessfully sends the original image data OII the event is reported to the image scanning unit . Referring to the digital multifunction peripheral DIGITAL MFP sends the synthetic image data SII to the document processing server . Instead the fax machine may send the synthetic image data SII to the document processing server . In consideration of the case of using the fax machine it is preferable that the symbol is printed a bit larger so that the symbol can be scanned in a resolution of for example 200 dpi.

The image receiving unit of the document processing server receives the synthetic image data SII sent via the network and sends the received synthetic image data SII to an image processing unit .

The image processing unit searches for the symbol which is the result of transforming the output paper ID output PID in synthetic image data SII sent from the image receiving unit . The image processing unit searches for a candidate area where the symbol may be placed. Depending on whether the symbol of the output paper ID output PID is searched success or failure of searching the symbol is reported to the digital multifunction peripheral output PID . The digital multifunction peripheral output PID displays the success or the failure of searching on the operating unit . The candidate area is in for example predetermined ranges from four corners of the synthetic image data SII . A known technique may be used for searching the symbol . For example edges of reference patterns placed in three corners of the symbol are transformed into 1 and 0 from a predetermined direction the reference pattern is found using the pattern made of 1 and 0 . When the reference pattern is found the symbol may be successfully searched.

When the image processing unit successfully searches the symbol the output paper ID output PID is acquired by inversely transforming the symbol . The output paper ID acquired by the image processing unit is sent to the data accumulating unit . The data accumulating unit refers to the contents ID managing table using the output paper ID as a key. Then the data accumulating unit reads all original image data locations associated with the output paper IDs output PID from the contents ID managing table and reads the original image data OII from the contents data database . There is a case where plural contents data sets are inserted from the same original image data OII to one synthetic image data SII . Therefore the data accumulating unit removes redundant original image data sets. As described the original image data are acquired from the output paper ID output PID of the synthetic image data SII .

When the image processing unit receives the original image data OII from the data accumulating unit all of the image data are sent to the digital multifunction peripheral DIGITAL MFP . The digital multifunction peripheral receives all of the original image data OII and the printing unit prints all of the original image data on paper. In this way for example three original documents to are printed from one sheet of the synthetic document .

The image receiving unit or the fax receiving unit sends the original image data to the form processing unit in step S. The form processing unit sends the original image data OII to the form definition managing unit in step S. In this way the form definition managing unit determines the original document A from the original image data based on an image dictionary designated by the form definition list . Then the form definition managing unit determines the scanned form ID FID of the original document A. The form definition managing unit reads the form definition file FDF associated with the form ID FID from the form definition list or the location of the associated form definition file FDF . The form definition managing unit sends the form ID FID and the form definition file FDF to the form processing unit in step S.

The form processing unit extracts the entry areas based on the form definition file in step S. The form processing unit reads the area IDs AID described in the form definition file FDF when the entry areas EA are extracted.

The form processing unit sends the scanned images SI of the entry areas the original image data OII the form ID FID and the area ID AID to the data accumulating unit in step S.

The data accumulating unit provides the scanned images with contents data IDs CDID and sends the provided contents data IDs to the form processing unit . Hereinafter the scanned image SI is referred to as the contents data CD . The data accumulating unit stores the contents data location the original data location the area ID AID and the input form ID input FID in the contents data database while associating the contents data location the original data location the area ID AID and the input form ID input FID .

The form processing unit sends an instruction of generating the synthetic document data SDD the contents data IDs CDID the form ID FID and the area ID AID to the document generating unit in step S.

The document generating unit sends the form ID FID as the input form ID input FID to the relevant form managing unit in step S. The relevant form managing unit refers to the input and output correspondence table reads the output form ID output FID and sends the output form ID to the document generating unit .

The document generating unit sends the output form ID output FID to the form definition managing unit in step S. The form definition managing unit reads the form definition file FDF associated with the form ID FID by referring to the form definition list or the location of the associated form definition file FDF . The form definition managing unit sends the form definition file FDF to the document generating unit in step S.

The document generating unit identifies the contents data IDs CDID based on the form ID FID and the area ID AID which are sent from the form processing unit by referring to the form definition file FDF respectively for the insertion areas IA designated by the form IDs FID and the area IDs AID in step S. Further the contents data IDs CDID are sent to the data accumulating unit in step S.

The data accumulating unit reads the contents data CD from the contents data database based on the contents data location associated with the contents data ID by referring to the contents ID managing table .

The document generating unit generates the synthetic image data SII by placing the contents data based on the form definition file FDF in step S.

The document generating unit generates the output paper ID output PID which uniquely identifies the synthetic document in step S. The symbol is superposed on the synthetic image data SII in step S.

The document generating unit sends the generated output paper ID output PID to the data accumulating unit in Step S. Thus the data accumulating unit registers the output paper ID output PID in the contents data IDs CDID of the contents placed in the synthetic image data SII .

The document generating unit sends the synthetic image data SII on which the symbol of the output paper ID output PID is superposed to the digital multifunction peripheral in step S. Then the digital multifunction peripheral DIGITAL MFP outputs the synthetic document by printing the synthetic image data SII on paper in step S.

The image processing unit detects the symbol form a predetermined position of the transforms the synthetic image data SII and transforms the symbol to the output paper ID output PID in step S.

The image processing unit sends the output paper ID output PID to the data accumulating unit in step S. The data accumulating unit reads all the original image data all OII associated with the output paper ID output PID from the contents data CD database by referring to the contents ID managing table and sends all the image data to the image processing unit .

The image processing unit avoids redundancy of the original image data and sends the original image data to the digital multifunction peripheral DIGITAL MFP in step S. Then the digital multifunction peripheral prints the original image data on paper to output the restored original document in step S.

As described the document managing system may output synthetic documents formed by gathering only areas required by a user when plural sheets are contained in the original document. Therefore it is possible to prevent the printing of documents which are not required from being printed so that the number of the paper documents is reduced. Therefore handling in printing the documents becomes easier.

Further restored original documents having contents included in a synthetic document may be printed after the synthetic document is scanned by a user with a digital multifunction peripheral DIGITAL MFP . It is possible to obtain the original documents when the synthetic document is illegible.

In Embodiment 1 the document processing server synthesizes the original document A and restores the original document A using the symbol of the synthetic image data SII . However the image data of Embodiment 1 may be managed by only the digital multifunction peripheral DIGITAL MFP .

When is compared with an image scanning unit an operating unit and a printing unit are accommodated in the digital multifunction peripheral . Functions provided by the document managing system of Embodiment 2 are the same as those provided by the document managing system of Embodiment 1 including the document processing server . The original image data OII are sent from a fax sending portion to the digital multifunction peripheral digital MFP . Alternatively the image scanning unit of the digital multifunction peripheral digital MFP scans the original document A to acquire the original image data OII . The digital multifunction peripheral digital MFP generates the synthetic image data SII . Further the same digital multifunction peripheral prints the synthetic image data SII on paper and outputs the synthetic document .

Since the digital multifunction peripheral outputs the original image data OII and the synthetic document a time for the digital multifunction peripheral of communicating with the document processing server may be eliminated. Thus a waiting time for a user may be shortened.

It is also possible that plural digital multifunction peripherals DIGITAL MFP are connected to a network .

In this case one of the plural digital multifunction peripherals scans an original document A original image data OII of the original document A are sent to another one of the plural digital multifunction peripherals . Further the other one of the plural digital multifunction peripherals generates synthetic image data SII and outputs the synthetic document .

Alternatively one of the plural digital multifunction peripheral scans an original document A and generates synthetic image data SII from original image data OII of the original document A. One of the plural digital multifunction peripheral sends the synthetic image data to another one of the plural digital multifunction peripheral . Then the other one of the plural digital multifunction peripheral outputs the synthetic document .

When is compared with an image scanning unit an operating unit and a printing unit are accommodated in the digital multifunction peripheral . Functions provided by the document managing system of Embodiment 2 are the same as those provided by the document managing system of Embodiment 1 including the document processing server . Said differently the image scanning unit of the digital multifunction peripheral scans the synthetic document and the data accumulating unit identifies the original data. The same digital multifunction peripheral DIGITAL MFP prints the original image data on paper to output the restored original document .

Since the digital multifunction peripheral scans the synthetic document and outputs the restored original document a time for the digital multifunction peripheral of communicating with the document processing server may be eliminated. Thus a waiting time for the user may be shortened.

It is also possible that plural digital multifunction peripherals are connected to the network . In this case one of the plural digital multifunction peripherals scans the synthetic document to acquire the synthetic image data SII . The acquired original image data are sent to another one of the plural digital multifunction peripherals . The other one of the plural digital multifunction peripherals identifies the original image data and outputs the restored original document .

With the document managing system of Embodiment 2 a time from scanning of the original document A to outputting of the synthetic document and a time from scanning the synthetic document to outputting of the restored original document are shortened. Thus a waiting time for the user can be shortened.

In Embodiment 3 a preferred modified example of the document managing system of Embodiments 1 and 2 is described.

All image data are printed as the restored original document after the synthetic document is printed and scanned by the scanner in Embodiments 1 and 2. However there is a case where all the original documents A related to contents data included in the synthetic document are not necessarily output. In this case it is convenient for a user to enable the user selecting the original document A to be printed.

The user visually recognizes the thumbnail image and selects a page of the original document to be printed in . Referring to thumbnail images corresponding to pages P the first page and P the second page are selected. When the user finishes to select the page the user touches a button OK . The digital multifunction peripheral DIGITAL MFP prints only P and P of the original image data of the original document A on paper and outputs restored original document and .

The user may select between displaying of the thumbnail images and printing of the restored original document without displaying the thumbnail images when the user selects the original document printing mode in .

In the modified example when the original document or the restored original document having the contents data included in the synthetic document is printed it is possible to reduce the consumption amount of paper.

In Embodiments 1 and 2 the entry areas are extracted using the form definition file FDF and the entry areas are rearranged on the synthetic image data. However it is also possible to rearrange entire original image data without extracting the entry areas.

The form processing unit sends the original image data OII to a document generating unit . The document generating unit reduces the image data generates the synthetic image data SII and provides the synthetic image data SII with an output paper ID output PID . The document generating unit sends the output paper ID output PID to the data accumulating unit . The data accumulating unit registers the output paper ID output PID in association with a form ID FID .

It becomes unnecessary to extract entry areas EA manage using a contents data ID and rearrange the contents data. Therefore it is sufficient that a contents ID managing table registers only an original data location an input form ID input FID and an output paper ID output PID . Since there is no change in a functional block of an original document printing mode from that described in the above the description is omitted.

Referring to in a case where the number of pages of the original document A is 4 or more there is described the number of pages of the original document which have not been printed on the synthetic document as designated by the reference sign . With this a user may know how many pages of the original document are unprinted. Because the number of pages of the original document A is described in a form definition file FDF the form processing unit may report the number of pages of the original document A to the data accumulating unit . With this the data accumulating unit may register the number of pages of the original document A in the contents database in association with for example contents data ID CDID .

In the original document printing mode the document generating unit acquires the number of pages of the original document A from the data accumulating unit and compares the acquired number with the number of pages of the original document A aggregated into a predetermined sheet of paper. In a case where the original document has 14 pages and 4 pages of the original document A are aggregated to a sheet of paper 10 pages of the original document A remain unprinted. The document generating unit generates information indicative of the number of pages of the original document A and the number obtained by subtracting the remaining pages from the pages of the original document A. The information is formed into the synthetic image data SII . The position of adding the information is described in the form definition file FDF .

Referring to there is displayed Total number of pages is 14. 10 pages are remaining. The user may provide a material of determining whether the restored original document is printed based on the number of pages.

This modified example 2 becomes more effective by combining modified example 2 with modified example 1.

Said differently when the user makes the digital multifunction peripheral digital MFP scan the synthetic document the digital multifunction peripheral digital MFP prints the synthetic document illustrated in and displays Total number of pages is 14. 10 pages are remaining. on the operating unit . The user may know the remaining number of pages by the display of the operating unit . Further the digital multifunction peripheral DIGITAL MFP may display thumbnail images of the all pages on the operating unit while enabling scrolling the thumbnail images. The user can selectively print a desired page from the pages of the original document even though the number of pages of the original document is large. Then the user can reduce the consumption amount of papers.

With this modified example it is possible to print the restored original document with a simple configuration when the number of pages of the original document is small. Meanwhile when the number of pages of the original document is large it is possible to print the original document or the restored original document while enabling the user to easily know the total number of pages and reducing the consumption amount.

As described it is possible to provide the document managing apparatus which extracts a partial area necessary for the business operation and provide the partial area and which easily provides the original document of it when necessary.

All examples and conditional language recited herein are intended for pedagogical purposes to aid the reader in understanding the principles of the invention and the concepts contributed by the inventor to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a showing of the superiority or inferiority of the invention. Although the embodiment of the present invention has been described in detail it should be understood that various changes substitutions and alterations could be made thereto without departing from the spirit and scope of the invention.

This patent application is based on Japanese Priority Patent Application No. 2009 046562 filed on Feb. 27 2009 the entire contents of which are hereby incorporated herein by reference.

