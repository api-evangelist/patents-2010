---

title: Mobility service clustering using network service segments
abstract: Described in an example embodiment herein is a Mobility Service Engine (MSE) cluster comprising an MSE Cluster Master and at least one MSE Cluster Slave. The MSE Master is configured to define Network Service Segments. The MSE Master of the cluster distributes the Network Service Segments to slaves within the cluster. The network is configured to forward data to the correct Network Service Segment.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08396956&OS=08396956&RS=08396956
owner: Cisco Technology, Inc.
number: 08396956
owner_city: San Jose
owner_country: US
publication_date: 20100929
---
This application is a continuation of U.S. application Ser. No. 12 174 792 filed on Jul. 17 2008 now U.S. Pat. No. 7 827 270 that claims the benefit of priority of U.S. Provisional Application No. 60 984 115 filed Oct. 31 2007.

This application is generally directed to providing network services using a to cluster design that can enable services to be distributed and balanced within the cluster.

Mobility services are a set of value added services that leverage a unified network infrastructure. Mobility services may include but are not limited to location tracking voice handoff between different mobile networks and passive RFID radio frequency identification location tracking . In small simple networks mobility services can be provided by a single device which can be a standalone device or a device such as an access point AP controller router etc. that is configured to also provide mobility services. However in larger networks mobility services may be provided by several devices and or co located within several infrastructure nodes which can make determining the appropriate device handling a mobility service problematic. For example a plurality of backend servers can be employed for providing services such as asset tracking voice routing and call handoff. A mobility service engine MSE provides a unified Application Programming Interface API to applications and servers providing services. The MSE also provide a unified protocol for applications and servers communicating with devices and controllers. A single MSE may provide multiple mobility services.

The following presents a simplified overview of the example embodiments in order to provide a basic understanding of some aspects of the example embodiments. This overview is not an extensive overview of the example embodiments. It is intended to neither identify key or critical elements of the example embodiments nor delineate the scope of the appended claims. Its sole purpose is to present some concepts of the example embodiments in a simplified form as a prelude to the more detailed description that is presented later.

Described in an example embodiment herein is a Mobility Service Engine MSE cluster comprising a MSE Cluster Master and at least one MSE Cluster Slave. The MSE Master is configured to define Network Service Segments. A NSS is a cohesive grouping that provides one or more mobility services across a set of related infrastructure nodes such as Access Points APs . The MSE Master of the cluster distributes the Network Service Segments to slaves within the cluster. The slaves then distribute assignments to the network. Whenever service traffic for a particular NSS occurs in the network the network infrastructure looks up the mapping of NSS to MSE Slave and then forwards relevant service data for that NSS to that MSE Slave.

In an example embodiment there is disclosed herein an apparatus comprising a communication interface and logic configured to receive data from the communication interface. The logic is configured to acquire data representative of at least one MSE cluster slave belonging to a mobility service cluster via the communication interface. The logic is further configured to acquire physical layout data. The logic is configured to form at least one network service segment based on the physical layout data.

In an example embodiment there is disclosed herein a system comprising a MSE cluster master a first MSE cluster slave in communication with the MSE cluster master and a second MSE cluster slave in communication with the MSE cluster master. A first controller is in communication with the first MSE cluster slave and the second MSE cluster slave and a second controller is in communication with the first MSE cluster slave and the second MSE cluster slave. The MSE cluster master logic is configured to acquire data representative of at least one MSE cluster slave belonging to a mobility service cluster via the communication interface. The MSE cluster master is configured to acquire physical layout data comprising areas serviced by infrastructure nodes coupled to the first controller and areas serviced by infrastructure nodes coupled to the second controller. The MSE cluster master is configured to form at least one network service segment the network service segment is a cohesive grouping that provides at least one mobility service across a set of related infrastructure nodes. The MSE cluster master is further configured to assign the network service segment to a cluster slave selected from the group consisting of the first MSE cluster slave and the second MSE cluster slave to service. The selected cluster slave is configured to communicate a routing path to the cluster master to the controllers having infrastructure nodes belonging to the network service segment.

Disclosed herein in an example embodiment is a method that comprises determining MSE slaves belonging to a cluster determining all devices managed by the cluster and receiving radio frequency neighbor environment data from controllers associated with the cluster. A plurality of network service segments are formed for the cluster based on the radio frequency environment. The network service segment is a cohesive grouping that provides at least one mobility service across a set of related infrastructure nodes. Each of the plurality of network service segments is assigned to not more than one of the MSE slaves.

This description provides examples not intended to limit the scope of the appended claims. The figures generally indicate the features of the examples where it is understood and appreciated that like reference numerals are used to refer to like elements.

Described in an example embodiment herein is a Mobility Service Engine MSE cluster comprising a MSE Cluster Master which can be selected or assigned and at least one MSE Cluster Slave. The network is organized into physical areas for example building floor areas within a floor outdoor parking lots etc. provided with a particular service. A NSS is a cohesive grouping that provides one or more mobility services across a set of related infrastructure nodes such as Access Points APs . The NSS for each service may be formed differently depending on the individual service requirements. For example an NSS in an area with a high concentration of APs and or mobile devices can be smaller than a NSS with a lower concentration of APs and or mobile devices. As another example a NSS for tracking associated devices may be smaller than a NSS for tracking rogue devices. Once a NSS is formed the Master MSE assigns the NSS to a particular Slave MSE. The Slave MSE then informs the set of devices for the NSS such as controllers and switches and or Access Points that it will be responsible for the NSS and that those devices should forward relevant data for the service to the Slave MSE. Disclosed in an example embodiment herein is an algorithm for performing auto assignment.

A MSE is a platform that can run a variety of services such as location tracking voice handoff spectrum analysis passive RFID Radio Frequency Identification . A collection of mobility server clusters can be connected to provide geographically distributed mobility services.

In an example embodiment an MSE cluster comprises a MSE Cluster Master and one or more MSE cluster slaves. The physical network is organized into Network Service Segments that are auto assigned by the MSE Cluster Master. The auto assignment will organize the network based on the service e.g. location for clients location for rogues etc. into Network Service Segments.

For example a MSE Cluster Master determines all MSE Cluster Slaves within the cluster. The MSE Cluster Master also determines all network devices controllers access points etc. managed by the cluster. The MSE Cluster Master is configured with the physical environment for example campus buildings outdoor areas etc. . The configuration can be received via a management system such as for example a Wireless Controller System. The MSE Cluster Master determines the RF neighbor environment from the controllers. The MSE Cluster Master performs an auto assignment algorithm to form Network Service Segments for each service type serviced by the cluster. The auto assignment algorithm defines the physical boundaries for each NSS. The MSE Cluster Master distributes the Network Service Segments to the MSE Cluster Slaves.

The MSE Cluster Slaves configure controllers switches etc. that are part of their NSS to forward data for their NSS. A controller may belong to more than one NSS. Controllers will maintain a mapping of AP Data to NSS Slave.

Controllers forward appropriate service data e.g. measurements to the MSE Cluster Slave servicing the NSS. MSE Cluster Slaves receive the data and process the data e.g. calculate perform a service store etc. . The MSE Cluster Master monitors the load of NSS processing on each MSE Cluster Slave and determines dynamically whether to redistribute Network Service Segments across MSE Cluster Slaves to ensure that the load is evenly distributed. If a MSE Cluster Slaves fails the MSE Cluster Master can automatically redistribute the Network Service Segments assigned to the failed slave to one or more active MSE Cluster Slaves.

In an example embodiment the MSE Cluster Master forms one or more Network Service Segments from all Access Points APs and Switch ports. For example a simple indoor network with one building may have one NSS. Complex or large indoor environments may result in multiple Network Service Segments. As will be illustrated in an example embodiment herein outdoor areas between buildings may be considered a separate NSS and may overlap indoor areas. A NSS can be service specific for example one NSS for location one NSS for voice handoff etc.

Cluster . Mobility Service Cluster comprises a single Master Mobility Server Engine MSE Cluster Master or M MSE and one or more Slave Mobility Server Engines MSE Cluster saves or S MSE . Although the example in shows three S MSEs this should not be construed as limiting the size of a Mobility Service Cluster as the number of S MSEs illustrated in is merely for ease of illustration as the number of S MSEs can be any physically realizable number.

The Master MSE is a logical entity. The Master MSE can reside on any node within a cluster or may be instituted on a separate dedicated hardware engine. Logic as used herein includes but is not limited to hardware firmware software and or combinations of each to perform a function s or an action s and or to cause a function or action from another component. For example based on a desired application or need logic may include a software controlled microprocessor discrete logic such as an application specific integrated circuit ASIC a programmable programmed logic device memory device containing instructions or the like or combinational logic embodied in hardware. Logic may also be fully embodied as software. Slave MSEs are also logical entities and like Master MSE can reside on any node within a cluster or may be instituted on a separate dedicated hardware engine.

The Mobility Service Cluster can provide services to infrastructure nodes and or tracked devices coupled to the Network Infrastructure employing any network communication protocol. Mobility Service Cluster can use a cluster communication protocol to communicate with Management applications and or location based applications . The services being provided and or the network elements that are receiving services may be distributed across multiple MSE platforms.

In an example embodiment Master MSE acquires RF neighbor maps from controllers not shown see for example in the network managed by the mobility server cluster. The Master MSE is configured to combine the RF neighbor maps with the physical layout e.g. building of the network. Where possible the Master MSE keeps adjacent floors of a building within the same NSS. Master MSE determines the active service s for the MSE Cluster NSS. Master MSE employs an algorithm to evenly divide the NSS across the set of S MSEs . In an example embodiment where possible the Master MSE assigns NSS within the same proximity to the same S MSE.

For example Master MSE may form one or more NSS from all APs and switch ports not shown . For example for a simple indoor one building Master MSE may form one NSS. This provides the simplest NSS environment wherein all switches and or APs belong to the same NSS. For a complex indoor one building network Master MSE may form multiple NSS. Typically multiple NSS are formed for large buildings or buildings with large AP Switch port counts. In addition outdoor areas are considered. A NSS may overlap where indoor and outdoor areas are physically close see e.g. . In an example embodiment a NSS is service specific. For example one NSS may be employed for location services one NSS for voice handoff and another NSS for passive handoff etc.

In an example embodiment each NSS is assigned to a single S MSE. In particular embodiments the NSS is assigned to multiple S MSE s for example if the NSS is too large to be serviced by a single S MSE. Multiple NSS may be assigned to the same S MSE. For each mobility server cluster all switches controllers network designs and APs are configured on the M MSE . The configurations are communicated to the appropriate S MSE. Each S MSE pushes its NSS list to each controller that is currently managing APs belonging to the NSS. Each AP will be configured with NSS assignments by the controller.

In an example embodiment whenever a measurement or relevant information is retrieved on a NSS the controllers forward the data to the appropriate MSE providing the location service registered for the NSS. If a single AP is in multiple NSS the measurement data is sent to all MSE running location service. Each controller may be communicating with multiple S MSE at the same time but for different NSS.

In operation when a tracked element appears on multiple MSEs all MSEs process the service for the tracked element e.g. calculated location or determine voice handoff events . S MSEs periodically pass confidence factor data time and number of measurements to the M MSE . M MSE decides which S MSE provides primary service to the tracked element. The M MSE notifies all secondary service providers to forward data to the primary service provider for the tracked element. Forwarding rules can be aged out on each S MSE automatically if no data is received after a configurable time period.

In an example embodiment the mapping of APs to NSS is periodically refreshed for network topology changes based on the RF neighbor reports plus AP to controller mappings by processing logic . A mobility domain is a group of mobility groups where a mobility group is a set of controllers that support fast roaming. All controllers in a mobility domain have NSS mappings. APs locally store NSS mappings in non volatile memory and provide them to a controller when connecting to the controller. An S MSE detects topology changes and updates the master. The M MSE should receive either directly or indirectly topology change updates from controllers and S MSEs. In particular embodiments a NSS does not cross mobility domain boundaries. For example when an AP joins a new controller the new controller receives the NSS mappings for the AP and the Controller contacts S MSE. The S MSE and or M MSE can determine whether the AP should remain with the same NSS or be assigned to another NSS.

In an example embodiment the Master MSE provides Master MSE functions described herein. For example all configurations for the cluster are configured on the M MSE . The Master MSE synchronizes the configuration as necessary with the set of S MSEs . The Master MSE can provide directory services. For example the Master MSE can provide a directory lookup for all tracked devices and on which S MSE the tracked device is currently located and which service is being provided by which slave and which clients are using which services. A network design is the definition of a physical environment of the network such as campuses buildings floors areas and their physical dimensions. The Master MSE can provide a directory lookup for all network designs and parts of controllers that each S MSE is currently tracking. The Master MSE can also provide auto assignment. For example the Master MSE can automatically determine which S MSE manages which parts of the physical and network topology. The Master MSE provides for Load Balancing. For example the M MSE load balances across the set of S MSEs in the cluster based on network and physical environment active monitoring and feeds this data into the auto assignment algorithms. Master MSE can also provide for High Availability HA for M MSE functions. Master MSE can also provide redundancy control. Upon detection of S MSE failure Master MSE can perform standby coordination with another S MSE in the cluster. Master MSE can be suitably configured to maintain history data. The history data including tracked device information location roaming etc is aggregated by Master MSE . Master MSE can also provide Time Synchronization. For example Master MSE can provide a central time synchronization function so that all S MSE are in sync when reporting time for live or historical data.

In an example embodiment the Master MSE provides an Application Programming Interface API . External applications communicate with the Master MSE to manage the cluster query cluster information or subscribe to events. Queries and subscriptions are pushed to the appropriate set of S MSE based on the scope of query or subscription. If a query or subscription is for an area or floor then Master MSE uses the directory services to map the query to the correct S MSE that is tracking that floor. For queries that may span multiple S MSE Master MSE provides aggregation query capability.

In an example embodiment Master MSE is managed by a Wireless Control System WCS a suitable Wireless Control System is available from Cisco Systems Inc. 170 West Tasman Drive San Jose Calif. 95134 hereinafter Cisco . The Master MSE comprises a central configuration database that includes all network designs controllers switches APs. The Master MSE has a central directory of S MSE IP address authentication credentials etc. This data could be configured by WCS and pushed to the Master MSE . Alternatively this data could be auto discovered by using DNS and having each mobility service cluster assigned a Domain Name Service DNS domain each S MSE is assigned locally to the domain. Master MSE synchronizes the central configuration database with all of the S MSEs . Synchronization can be event driven for example when it is configured on the Master MSE by WCS and periodically checked for changes by the Master MSE reading each S MSE s change count on the configuration database. Cluster status monitoring is provided by Master MSE to WCS. This can include Up down status of S MSEs and or Load monitoring on each S MSE .

In an example embodiment the Master MSE maintains a directory service lookup for tracked devices to S MSE. The directory may suitably comprise multiple indexes. For example a Primary index comprising Media Access Control MAC Addresses a Secondary index comprising IP Addresses and a Tertiary index comprising Usernames. The actual tracked device information is stored on the S MSE. Each S MSE sends a notification to Master MSE as tracked devices appear on their network segment. The Master MSE updates the directory service if that device has roamed from another S MSE. When two S MSEs are tracking the same device the Master MSE updates the directory service when the secondary S MSE becomes the primary S MSE the primary S MSE then becomes the secondary S MSE . The Master MSE maintains a directory lookup for all network designs the network segments switches and controllers that each S MSE is currently tracking. All directory services information can be exposed for query by applications or S MSEs .

In an example embodiment the Master MSE performs historical data aggregation. As devices are tracked in the network by the S MSE history and data is collected over time on that device. This information is persistent on the S MSE until successfully archived on Master MSE then flushed from the S MSE. Periodically this information is posted to Master MSE for aggregation and archiving. Posting to Master MSE can be based on volume of data as well as time based triggers. Master MSE has the responsibility to correctly order all data sent from multiple S MSE for the same tracked device thus all S MSEs and Master MSE are time synchronized.

In an example embodiment the Master MSE provides load balancing. Static and Dynamic load balancing can be provided. For static load balancing part of the auto assignment algorithm assigns appropriate NSS across S MSE. For dynamic load balancing Master MSE is configured to detect the load on each S MSE and per NSS load on that S MSE. This enables Master MSE to determine how to re organize NSS assignments across S MSE based on tracking load.

In an example embodiment the Master MSE provides redundancy control. The Master MSE and each S MSE can employ a heart beat signal between them. After detection of an S MSE failure Master MSE will automatically reallocate all network segments assigned to the failed S MSE to one or more other S MSE in the cluster. Upon detecting recovery of the S MSE Master MSE will perform the automatic balancing of network segments again.

In an example embodiment Master MSE is provided by a High Availability HA . A HA Pair is a set of two servers that provide duplicate function. Master MSE and or an S MSE can belong to HA Pair. Each device in the HA Pair has a shared virtual IP address and individual IP address. A HA database option will synchronize all state and persistent data. In particular embodiments all necessary state data for hand off is stored in a database. Non persistent state e.g. Received Signal Strength Indication RSSI cache is rebuilt upon failover.

In an example embodiment Master MSE can be employed to implement slave MSE functions. For each network location segment assigned to the S MSE Master MSE provides tracking of the network topology and devices in that topology query and subscription processing on the network topology and devices and or RF Neighbor topology monitoring and forwarding changes to the Master MSE . Any event subscriptions from external applications configured on the S MSE by Master MSE will be handled directly from the S MSE to the application.

Referring now to there is illustrated an example of a network that is partitioned into network service segments NSS . As used herein a NSS is a cohesive grouping that provides one or more mobility services across a set of related infrastructure nodes such as APs. As will be illustrated in the example provided by by forming NSSs an area of the physical environment can be assigned to a Slave MSE S MSE . The physical environment within a NSS may suitably comprise a wired segment a wireless segment or both wired and wireless segments. A NSS may suitably comprise one or more floors of a building one or more buildings one or more switches controllers and zero or more APs. A NSS can ensure that all measurements for a tracked element are sent to a single service point the appropriate S MSE . The NSS can be different depending on service and or device types associated with the service. For example an NSS in an area with a high concentration of APs and or mobile devices can be smaller than a NSS with a lower concentration of APs and or mobile devices. As another example a NSS for tracking associated devices may be smaller than a NSS for tracking rogue devices.

In the example illustrated in network comprises a first building an outdoor area and a second building . First building and second building comprises five floors F F F F and F.

In first building the first floor F is serviced by APs . The second floor F is serviced by APs . The third floor F is serviced by APs . The fourth floor F is serviced by APs . The fifth floor F is serviced by APs .

As illustrated in outdoor area is located between first building and second building . Outdoor area is serviced by APs .

In second building the first floor F is serviced by As . The second floor F is serviced by APs . The third floor F is serviced by APs . The fourth floor F is serviced by APs . The fifth floor F is serviced by APs .

Network is partitioned into 3 NSSs. The first NSS NSS comprises the first two floors F F of first building outdoor area and the first two floors F F of second building . The second NSS NSS comprises all five floors F F F F F of first building . The third NSS NSS comprises all five floors F F F F F of second building .

NSS comprises APs in outside area APs in first building and APs in second building . NSS comprises APs and in first building . NSS comprises APs in second building . Thus APs and belong to both NSS and NSS and APs belong to both NSS and NSS .

The overlapping coverage areas can enable a device to be handed off without a loss of service. For example a device on the fifth floor F of first building is in NSS . As the device moves outside through the first floor of first building the device is covered by both NSS and NSS . As the device moves outdoors to outdoor area the device remains in NSS . If the device moves into second building while on the first F and second F floors of second building the device transitions from NSS to both NSS and NSS .

Controller is in data communication with the APs and in first building . Controller is in data communication with APs and in second building and will APs in the outdoor area between first building and second building .

In the illustrated configuration S MSE services NSS S MSE services NSS and S MSE services NSS . The APs in communication with controller are either a member of NSS and or NSS . Thus controller is in data communication with S MSE for servicing NSS and S MSE for servicing NSS . The APs in communication with controller are either a member of NSS and or NSS . Thus controller is in data communication with S MSE for servicing NSS and S MSE for servicing NSS .

For example if a device is located on the fifth floor F of first building the AP measurements for device are communicated to controller . Controller looks up the S MSE mapping for NSS and determines that S MSE is the S MSE for NSS . Controller then forwards the AP measurements to S MSE . S MSE can update M MSE with the current service data for device . In particular embodiments if device was previously unknown to S MSE S MSE notifies M MSE of device .

In operation when device is in the fifth floor F of first building device is in data communication with APs and which is in the domain of NSS . AP measurements made by APs are communicated to controller and respectively. Controller determines the S MSE mapping for NSS S MSE . Controller forwards the measurements to S MSE . Controller also determines the S MSE mapping for NSS S MSE . Controller likewise sends the measurements to S MSE . S MSE can update M MSE with the current service data for device .

S MSE notifies M MSE of device . Likewise S MSE notifies M MSE of device . M MSE is configured to evaluate which S MSE provides the best location determination based on time measurements and a confidence factor. If for example M MSE determines S MSE provides the best location determination M MSE notifies S MSE to forward device traffic to S MSE .

In an example embodiment having Multiple MSEs when a tracked element appears in multiple MSEs all S MSEs process the service for that element for example calculate location or determine voice handoff events etc. . Each S MSE periodically passes confidence factor time number of measurements etc. to the M MSE. The M MSE decides which S MSE provides primary service for the tracked element. The M MSE notifies all secondary service providers to forward data to the primary service provider for the tracked element. The forwarding rules can be aged out on each S MSE automatically if no data is received after a configurable time period.

In the illustrated example a roaming device starts in NSS roams across NSS to NSS . Initially the device is located on the fifth floor F of the first building at location . Location belongs to NSS which is serviced by S MSE . Controllers and route traffic for the device to S MSE .

The roaming device travels along path to location of the first floor F of first building . The first F and second F floors of first building belong to both NSS and NSS . So as the device travels along path it is transitioned from NSS to both NSS and NSS by M MSE . M MSE communicates the transition to S MSE S MSE and controllers . While at location or anywhere on floors F F of first building controllers route traffic for the roaming device to both S MSE and S MSE which service NSS and NSS respectively.

The roaming device then travels along path to location which is in the outdoor area between first building and second building . As the roaming device exits the first building M MSE transitions the roaming device to NSS serviced by S MSE . M MSE communicates the transition to S MSE S MSE and controllers . In this example NSS is configured to overlap with NBSS and NSS so there is no interruption of service to the roaming device as it enters exits first building and second building .

The roaming device then travels along path to location . As the roaming device enters second building the roaming device is in an area serviced by both NSS and NSS . Thus as the roaming device enters the second building S MSE transitions the roaming device to NSS and NSS serviced by S MSE and S MSE . M MSE communicates the transition to S MSE S MSE and controllers .

The roaming device then travels along path to location . As the roaming device moves above the second floor F of second building the roaming device is transitioned to NSS serviced by S MSE . M MSE communicates the transition to S MSE S MSE and controllers .

MSE comprises processing logic for implementing the functionality described herein. The processing logic is in data communication with a communication interface that enables communication between MSEs and also between an MSE and other infrastructures nodes such as APs controllers and or servers running applications. Communication interface provides a two way data communication via a communication link that is connected to a local network not shown . For example communication interface may be a local area network LAN card to provide a data communication connection to a compatible LAN. As another example communication interface may be an integrated services digital network ISDN card or a modem to provide a data communication connection to a corresponding type of telephone line. Wireless links may also be implemented. In any such implementation communication interface sends and receives electrical electromagnetic or optical signals that carry digital data streams representing various types of information. In an example embodiment communication interface is coupled to a user interface such as a display and keypad allowing data to be manually entered.

In an example embodiment MSE is implemented as a standalone device. In another example embodiment MSE is co located with another infrastructure component such as a server controller wireless domain controller and or a blade within a router.

In an example embodiment MSE is employed as an M MSE. Processing logic of MSE employs an algorithm to form NSS. Processing logic acquires RF neighbor maps from controllers in the mobility server cluster. Processing logic is configured to combine the RF neighbor maps with the physical layout e.g. building of the network. Where possible processing logic keeps adjacent floors of a building within the same NSS. Processing logic determines the active service s for the MSE Cluster NSS.

Processing logic employs an algorithm to evenly divide the NSS across a set of S MSEs. Where possible processing logic assigns NSS within the same proximity to the same S MSE.

For example processing logic may form one or more NSS from all APs and switch ports. For example for a simple indoor one building network processing logic may form one NSS. This provides the simplest NSS environment wherein all switches and or APs belong to the same NSS. For a complex indoor one building network processing logic may form multiple NSS. Typically multiple NSS are formed for large buildings or buildings with large AP Switch port counts. In addition outdoor areas are considered. A NSS may overlap where indoor and outdoor areas are physically close see e.g. . In an example embodiment a NSS is service specific. For example one NSS may be employed for location services one for voice handoff and another for passive handoff etc.

In an example embodiment each NSS is assigned to a single S MSE. Multiple NSS may be assigned to the same S MSE. For each mobility server cluster all switches controllers network designs and APs are configured on the M MSE. The configurations are communicated to the appropriate S MSE. Each S MSE pushes its NSS list to each controller that is currently managing APs belonging to the NSS. Each AP will be configured with NSS assignments by the controller.

In an example embodiment whenever a measurement or relevant information is retrieved on a NSS the controllers forward the data to the appropriate S MSE registered for the NSS. If a single AP is in multiple NSS the measurement data is sent to all S MSEs managing the set of NSSs. Each controller may be communicating with multiple S MSEs at the same time but for different NSSs.

In operation when a tracked element appears on multiple MSE all MSEs process service for the tracked element e.g. calculated location or determine voice handoff events . S MSEs periodically pass data such as confidence factor data time and number of measurements to M MSE . Processing logic of M MSE decides which S MSE provides primary service to the tracked element. M MSE notifies all secondary service providers to forward data to the primary service provider for the tacked element. Forwarding rules can be aged out on each S MSE automatically if no data is received after a configurable time period.

In an example embodiment the mapping of NSS is periodically refreshed based on network topology changes to the RF neighbor and AP to controller mappings by processing logic . All controllers in a mobility domain have NSS mappings. APs get NSS mapping and provide to controller when connecting to controller. Controller then contacts S MSE. An S MSE detects topology changes and pushes changes to controllers. The M MSE should receive either directly or indirectly topology change updates. In particular embodiments a NSS does not cross mobility domain boundaries.

In an example embodiment processing logic provides Master MSE functions described herein. For example all configurations for the cluster are configured on the M MSE. The M MSE synchronizes the configuration as necessary with the set of S MSE. The M MSE can provide directory services. For example the M MSE can provide a directory lookup for all tracked devices and which S MSE the tracked device is currently located. The M MSE can provides a directory lookup for all network designs and parts of controllers that each S MSE is currently tracking. The M MSE can also provide auto assignment. For example the M MSE can automatically determine which S MSE manages which parts of the physical and network topology. The M MSE provides for Load Balancing. For example the M MSE load balances across the set of S MSE in the cluster based on network and physical environment active monitoring and feeds this data into the auto assignment algorithms. The M MSE can also provide for High Availability HA for M MSE functions. The M MSE can also provide redundancy control. Upon detection of S MSE failure the M MSE can perform standby coordination with another S MSE in the cluster. The M MSE can be suitably configured to maintain history data. The history data including tracked device information location roaming . . . etc is aggregated by the M MSE. The M MSE can also provide Time Synchronization. For example the M MSE provides a central time synchronization function so that all S MSE are in sync when reporting time for live or historical data.

In an example embodiment the M MSE provides an Application Programming Interface API . External applications communicate with the M MSE to manage the cluster query cluster information or subscribe to events. Queries and subscriptions are pushed to the appropriate set of S MSE based on the scope of query or subscription. If a query or subscription is for an area or floor then the M MSE uses the directory services to map the query to the correct S MSE that is tracking that floor. For queries that may span multiple S MSE the M MSE provides aggregation query capability.

In an example embodiment the M MSE is managed by a WCS for example Cisco s Wireless Control System . The M MSE comprises a central configuration database that includes all network designs controllers switches APs. The M MSE has a central directory of S MSE IP address authentication credentials etc. This data could be configured by WCS and pushed to the M MSE. Alternatively this data could be auto discovered by using DNS and having each location cluster assigned a DNS domain each S MSE being assigned locally to the domain. Then the M MSE could discover all S MSE in a particular location cluster by using SAF Service Access Facilities between an S MSE and the M MSE. The M MSE synchronizes the central configuration database with all of the S MSEs. Synchronization can be event driven for example when it is configured on the M MSE by WCS and periodically checked for changes by the M MSE reading each S MSE change count on the configuration database. Cluster status monitoring is provided by M MSE to WCS. This can include Up down status of S MSEs and or Load monitoring on each S MSE.

In an example embodiment the M MSE maintains a directory service lookup for tracked devices to S MSE. The directory may suitably comprise multiple indexes. For example a Primary index comprising MAC Addresses a Secondary index comprising IP Addresses and a Tertiary index comprising Usernames. The actual tracked device information is stored on the S MSE. Each S MSE sends a notification to the M MSE as tracked devices appear on their network segment. The M MSE updates the directory service if that device has roamed from another S MSE. The M MSE maintains a directory lookup for all network designs the network segments switches and controllers that each S MSE is currently tracking. All directory services information can be exposed for query by applications or S MSEs.

In an example embodiment the M MSE performs historical data aggregation. As devices are tracked in the network by the S MSE history and data is collected over time on that device. This information is persistent on the S MSE until successfully archived on the M MSE then flushed from the S MSE. Periodically this information is posted to the M MSE for aggregation and archiving. Posting to the M MSE can be based on volume of data as well as time based triggers. The M MSE has the responsibility to correctly order all data sent from multiple S MSE for the same tracked device thus all S MSEs and the M MSE are time synchronized.

In an example embodiment the M MSE provides load balancing. Static and Dynamic load balancing can be provided. For static load balancing part of the auto assignment algorithm assigns appropriate NSS across S MSE. For dynamic load balancing the M MSE is configured to detect the load on each S MSE and per NSS load on that S MSE. This enables the M MSE to determine how to re organize NSS assignments across S MSE based on tracking load.

In an example embodiment the M MSE provides redundancy control. The M MSE and each S MSE can employ a heart beat signal between them. After detection of an S MSE failure the M MSE will automatically reallocate all network segments assigned to the failed S MSE to one or more other S MSE in the cluster. Upon detecting recovery of the S MSE the M MSE will perform the automatic balancing of network segments again.

In an example embodiment the M MSE provides High Availability HA . A HA Pair is a set of two servers that provide duplicate function. An M MSE and or an S MSE can belong to HA Pair. Each device in the HA Pair has a shared virtual IP address and individual IP address. A solid HA database option will synchronize all state and persistent data. In particular embodiments all necessary state data for hand off is stored in a database. Non persistent state e.g. a Received Signal Strength Indication RSSI cache is rebuilt upon failover.

In an example embodiment processing logic of MSE can be employed to implement slave MSE functions. For each network location segment assigned to the S MSE processing logic provides tracking of the network topology and devices in that topology query and subscription processing on the network topology and devices and or RF Neighbor topology monitoring and forwarding changes to the M MSE. Any event subscriptions from external applications configured on the S MSE by the M MSE will be handled directly from the S MSE to the application.

Computer system may be coupled via bus to a display such as a cathode ray tube CRT or liquid crystal display LCD for displaying information to a computer user. An input device such as a keyboard including alphanumeric and other keys is coupled to bus for communicating information and command selections to processor . Another type of user input device is cursor control such as a mouse a trackball or cursor direction keys for communicating direction information and command selections to processor and for controlling cursor movement on display . This input device typically has two degrees of freedom in two axes a first axis e.g. x and a second axis e.g. y that allows the device to specify positions in a plane.

An aspect of the example embodiment is related to the use of computer system for mobility service clustering. According to an example embodiment mobility service clustering is provided by computer system in response to processor executing one or more sequences of one or more instructions contained in main memory . Such instructions may be read into main memory from another computer readable medium such as storage device . Execution of the sequence of instructions contained in main memory causes processor to perform the process steps described herein. One or more processors in a multi processing arrangement may also be employed to execute the sequences of instructions contained in main memory . In alternative embodiments hard wired circuitry may be used in place of or in combination with software instructions to implement an example embodiment. Thus embodiments described herein are not limited to any specific combination of hardware circuitry and software.

The term computer readable medium as used herein refers to any medium that participates in providing instructions to processor for execution. Such a medium may take many forms including but not limited to non volatile media volatile media and transmission media. Non volatile media include for example optical or magnetic disks such as storage device . Volatile media include dynamic memory such as main memory . Transmission media include coaxial cables copper wire and fiber optics including the wires that comprise bus . Transmission media can also take the form of acoustic or light waves such as those generated during radio frequency RF and infrared IR data communications. Common forms of computer readable media include for example floppy disk a flexible disk hard disk magnetic cards paper tape any other physical medium with patterns of holes a RAM a PROM an EPROM a FLASHPROM CD DVD or any other memory chip or cartridge or any other medium from which a computer can read.

Various forms of computer readable media may be involved in carrying one or more sequences of one or more instructions to processor for execution. For example the instructions may initially be borne on a magnetic disk of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system can receive the data on the telephone line and use an infrared transmitter to convert the data to an infrared signal. An infrared detector coupled to bus can receive the data carried in the infrared signal and place the data on bus . Bus carries the data to main memory from which processor retrieves and executes the instructions. The instructions received by main memory may optionally be stored on storage device either before or after execution by processor .

Computer system also includes a communication interface coupled to bus . Communication interface provides a two way data communication coupling computer system to a network link that is connected to a local network .

For example communication interface may be a local area network LAN card to provide a data communication connection to a compatible LAN. As another example communication interface may be an integrated services digital network ISDN card or a modem to provide a data communication connection to a corresponding type of telephone line. Wireless links may also be implemented. In any such implementation communication interface sends and receives electrical electromagnetic or optical signals that carry digital data streams representing various types of information.

Network link typically provides data communication through one or more networks to other data devices. For example network link may provide a connection through local network . Local network may use electrical electromagnetic or optical signals that carry the digital data to and from computer system .

Computer system can send messages and receive data including program codes through the network s network link and communication interface . In the Internet example a server might transmit a requested code for an application program through local network and communication interface . In accordance with an example embodiment one such downloaded application provides for mobility service clustering as described herein.

The received code may be executed by processor as it is received and or stored in storage device or other non volatile storage for later execution. In this manner computer system may obtain application code in the form of a carrier wave.

In view of the foregoing structural and functional features described above a methodology in accordance with an example embodiment will be better appreciated with reference to . While for purposes of simplicity of explanation the methodology of is shown and described as executing serially it is to be understood and appreciated that the example embodiment is not limited by the illustrated order as some aspects could occur in different orders and or concurrently with other aspects from that shown and described herein. Moreover not all illustrated features may be required to implement a methodology in accordance with an aspect the example embodiment. The methodology described herein is suitably adapted to be implemented in hardware software or a combination thereof.

At the MSE Cluster Master runs an auto assignment algorithm to form Network Service Segments NSS for each service type running in the cluster. The auto assignment algorithm defines the boundaries of the NSS in physical environment. At the MSE Cluster Master distributes NSS across MSE Cluster Slaves. At the MSE Cluster Slaves configure controllers that are part of their NSS. The controllers can be configured to forward data for their NSS to the appropriate MSE Cluster Slave. A controller may belong to one or more NSS. The controllers are configured to maintain a mapping of AP Data to NSS Slave.

At the Controllers forward appropriate service data e.g. location RSSI measurements to the MSE Cluster Slave processing the NSS. At MSE Cluster Slaves then receive the data calculate or perform the service for the NSS measured data. At the MSE Cluster Master monitors the load of NSS processing on each MSE Cluster Slave and determines dynamically if one or more NSS need to be redistributed across cluster slaves so that load is evenly distributed. If a MSE Cluster Slave goes down the MSE Cluster Master will automatically re distribute NSS assigned to the down slave to one or more active MSE Cluster Slaves. A controller for a re distributed NSS can be reconfigured to forward data to the new MSE Cluster Slave.

Described above are example embodiments. It is of course not possible to describe every conceivable combination of components or methodologies but one of ordinary skill in the art will recognize that many further combinations and permutations of the example embodiments are possible. Accordingly this application is intended to embrace all such alterations modifications and variations that fall within the spirit and scope of the appended claims interpreted in accordance with the breadth to which they are fairly legally and equitably entitled.

