---

title: Verification of portable consumer devices
abstract: Embodiments of the invention are directed to methods, systems, and computer program products pertaining to obtaining, providing, and using dynamic card verification values for portable consumer devices, such as credit cards and debit cards. An exemplary method comprises receiving, at a server, a request for a device verification value for a portable consumer device associated with a user; obtaining, at the server, a datum indicative of a device verification value for a portable consumer device; and sending, from the server, the datum to at least one of a phone number or network address of a personal communication device associated with the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08020766&OS=08020766&RS=08020766
owner: Visa International Service Association
number: 08020766
owner_city: San Francisco
owner_country: US
publication_date: 20100511
---
This application claims priority from U.S. Provisional Patent Application No. 61 178 636 entitled Dynamic Data Authentication filed May 15 2009 the contents of which are hereby incorporated in their entirety by reference for all purposes.

As methods and devices for engaging in financial transactions have increased old problems such as fraud and counterfeiting persist.

One of the primary sources of fraud which is prevalent in the credit card industry is skimming. Skimming refers to the electronic copying of a card s magnetic stripe data to create counterfeit cards.

Skimming is predominantly a phenomenon afflicting static magnetic stripe based transactions. This is because the magnetic stripe which is placed on the back of a transaction card and stores a variety of data on three separate tracks is a passive medium. In other words the digital content of the magnetic stripe can be perfectly copied without any difference between the copy and the original.

One of the primary means by which skimming can be prevented is for the consumer to closely monitor the whereabouts of his transaction card. This may allow the consumer to prevent the card from being swiped through inappropriate devices. However as contactless cards evolve the classic skimming problem comes along with it when using static data. In fact in a wireless environment the opportunity to skim magnetic stripe data is more prevalent. In a wireless environment a potential skimmer need not physically possess the card to be skimmed nor have access to any of the physical equipment e.g. POS terminal communication lines etc. which is required for skimming in a wire based environment. A skimmer can without the knowledge of the consumer or merchant intercept the wireless transaction and copy the data being transmitted from the card to POS terminal.

To address the above problems a dCVV or a dynamic card verification value can be used. For example various systems and methods for generating dCVVs are discussed in U.S. patent application Ser. No. 10 642 878 entitled Method and System for Generating a Dynamic Verification Value filed on Aug. 18 2003 and in U.S. patent application Ser. No. 11 764 376 entitled On Line Payment Transactions filed on Jan. 29 2008. Both of these applications are hereby incorporated in their entirety for all purposes.

In addition to generating a dCVV a dCVV can be more effective for preventing fraud when it is securely received by a consumer. However securely receiving and using a dCVV cannot overly interfere with a consumer s experience conducting a transaction. A consumer might not use the dCVV or a consumer might conduct fewer transactions if the inconvenience of receiving and using a dCVV is too great.

Embodiments of the invention address the above problems and other problems individually and collectively.

Embodiments of the invention are directed to methods systems and computer program products pertaining to obtaining providing and using dynamic card verification values for portable consumer devices.

One exemplary embodiment of the invention is directed to a method of providing a device verification value for a portable consumer device. The exemplary method comprises receiving at a server a request for a device verification value for a portable consumer device associated with a user obtaining at the server a datum indicative of a device verification value for a portable consumer device and sending from the server the datum to at least one of a phone number or network address of a personal communication device associated with the user.

Another exemplary embodiment of the invention is directed to a server for providing device verification values for portable consumer devices. The server comprises a data processor a networking facility coupled to the processor a computer readable medium coupled to the processor and a plurality of codes embodied on e.g. stored in the computer readable medium. A first exemplary code directs the data processor to receive a request for a device verification value for a portable consumer device associated with a user. A second exemplary code directs the data processor to obtain a datum indicative of a device verification value for a portable consumer device. A third code directs the data processor to send the datum to at least one of a phone number or network address of a personal communication device associated with the user.

Another exemplary embodiment of the invention is directed to a computer program product embodied on a tangible computer readable medium that directs a data processor to provide device verification values for portable consumer devices. The exemplary computer program product comprises a first code that directs the data processor to receive a request for a device verification value for a portable consumer device associated with a user a second code that directs the data processor to obtain a datum indicative of a device verification value for a portable consumer device and a third code that directs the data processor to send the datum to at least one of a phone number or network address of a personal communication device associated with the user.

Other exemplary embodiments of the invention are directed to computer program products embodied on tangible computer readable medium that direct a personal communications device to send a request for a device verification value for a portable consumer device to a server that provides device verification values.

Further details regarding embodiments of the invention are provided below in the Detailed Description with reference to the Figures.

Embodiments of the present invention are able to maintain or improve existing user experiences minimize the impact on merchant processes systems leverage existing network data transport mechanisms utilize existing issuer validation infrastructure support multiple forms of implementation and maintain consistency with broader authentication strategy.

Generally embodiments of the present invention pertain to methods systems and computer program products of generating dynamic card verification values referred to herein as the dCVV values for portable consumer devices. The dCVV value can be provided along with the payment information of the portable consumer device to increase the confidence that the use of the portable consumer device is authentic and not fraudulent e.g. not skimmed . The embodiments described below can be applied for both card present and card not present CNP transactions.

A portable consumer device comprises a device that holds identification information pertaining to an account held by a user with another entity which is typically an entity that holds extends or credits items of value to the user e.g. monetary funds credits debts etc. . Portable consumer devices encompass credit cards charge cards debit cards bank cards prepaid cards access cards security cards and other cards that identify an account held by a user with another entity. The cards are capable of existing in both passive forms e.g. cards with a magnetic stripe and active forms e.g. integrated circuit cards smartcards and further encompass portable electronic devices that in whole or in part function as such cards. Such portable electronic devices can include memory cards account tokens fobs stickers cellular telephones including near field communications phone keychain devices such as the Speedpass commercially available from Exxon Mobil Corp. personal digital assistants other mobile electronic devices transponders smart media and pagers.

A typical credit card transaction flow using a portable consumer device at a point of sales location is described next. The user s portable consumer device is provided to the user by or on behalf of an issuing bank. The issuing bank extends credit to the user represents the user in credit card transactions and pays merchants for the purchases made by the user. A user presents his or her portable consumer device to a merchant at a point of sales location to pay for an item or service. The merchant uses a reader to read the user s portable consumer device and sends the payment information read from the device along with merchant s information and the transaction amount to an acquiring bank. The merchant may also read the portable consumer device for the printed card verification value e.g. the CVV value printed on the backs of many credit cards and may send this along as part of the transaction information sent to the acquiring bank. The acquiring bank represents and vouches for the merchant in credit card transactions. The acquiring bank forwards the transaction information to a payment processing network such as VisaNet for authorization. A payment processing network generally encompasses a collection of one or more data processing server computers subsystems networks and operations used to support and deliver one or more of the following authorization services exception file services and clearing and settlement services. Payment processing networks encompass bank processing networks credit card payment processing networks etc. An exemplary payment processing network may include VisaNet . Exemplary payment processing networks are able to process one or more of the following credit card transactions debit card transactions and other types of commercial transactions. A payment processing network may use any suitable wired or wireless network including the Internet to communicate with acquiring banks and issuing banks.

Prior to the occurrence of a credit card transaction the payment processing network has established a protocol with each issuing bank on how the bank s transactions are to be authorized. In some cases such as when the transaction amount is below the threshold value the payment processing network will authorize the transaction based on information that it has about the user s account without consulting the issuing bank and will accept the liability if the transaction turns out to be fraudulent. In other cases such as when the transaction amount is above a threshold value the payment processing network will forward the transaction information on to the issuing bank for verification and authorization. As part of the authorization process the payment network or the issuing bank may verify the printed CVV value which is stored at the issuing bank and may be securely provided by the issuing bank to the payment processing network for storage and subsequent use. The degree to which the payment processing network is involved in the verification of the consumer portable device and the authorization of the transaction is typically configured according to the wishes of the issuing bank. Once the transaction is authorized the payment processing network sends an authorization indication to the acquiring bank which sends the authorization indication on to the merchant. In order to reduce fraud merchants are not allowed to store printed card verification values CVVs for more than 24 hours.

When a user wishes to make an online purchase with a merchant over the Internet the user types in the credit card account number cardholder name expiration date and the printed CVV value of the portable consumer device into respective fields on the merchant s checkout page. This is the payment information associated with the portable consumer device. When the user confirms the purchase on the merchant s website the merchant sends payment information along with merchant s information and the transaction amount to the acquiring bank for the merchant. The acquiring bank forwards the transaction information to a payment processing network such as VisaNet for authorization just as in the point of sales example.

In both purchasing environments there is risk of fraudulent activity through skimming of the payment information. For example a store clerk can copy down the payment information during a transaction at a point of sales location and can later use the copied information to make an online purchase. As another example a hacker can install spyware on the user s computer to intercept the payment information and use it to make fraudulent purchases at other online merchants. Other avenues of potential fraud exist. Embodiments of the invention are directed to mitigating these types of fraudulent activity by replacing the use of the printed CVV value with a dynamically changing value which may change for each transaction or group of transactions or may change according to a time schedule that may be regular or irregular.

Also shown in is a provision entity and an SMS gateway . SMS gateway provides an interface between personal communications devices and entities that are coupled to communications network so that text messages can be conveyed between communication devices and the entities coupled to network . The entities coupled to network include web sites and provision entity . Provision entity provides device verification values to user by way of the user s personal communication device under various conditions and or circumstances according to various embodiments of the invention as described below. For the sake of clarity and without loss of generality we can refer to the device verification value provided by provision entity as a dCVV2 value so as to distinguish it from the dynamic CVC3 and dCVV values generated by smartcards from the printed CVV values on the backs of many credit cards and from the CVV field found on a checkout page of a typical merchant website. The dCVV2 values may be conveyed to the user s personal communications device by way of SMS gateway or by way of communications network . In the former case provision entity may send dVCC2 values to SMS gateway directly or via communications network . In the latter case personal communications device may be network capable and may have a network address that is accessible via communications network . A network address for personal communications device may comprise any one of a uniform resource locator URL an Internet protocol address IP address an e mail address or any other type of identifier that can identify an entity on a communications network.

The dCVV2 values provided by provision entity for a particular portable consumer device vary with time in some manner. They therefore are dynamic as opposed to the static nature of a printed CVV value on the back of a credit card. When conducting an in store purchase user can provide a received dCVV2 value to the store clerk to be entered in at POS terminal . When conducting an on line purchase user can enter a received dCVV2 value into the CVV field of the checkout page of merchant website . According to various embodiments the dCVV2 values provided to user by provision entity can be obtained from issuing bank or payment processing network or can be generated by entity and provided to issuing bank and or payment processing network . In each of the configurations user merchant and the entity that will authorize the transaction which may be payment processing network and or issuing bank know the particular dCVV2 value that is to be used for the transaction. Since the dCVV2 values vary with time a fraudster who intercepts and tries to use a prior dCVV2 value can be thwarted. In this manner the provision of varying dCVV2 values increases the confidence that the use of the portable consumer device is authentic and not fraudulent e.g. not skimmed . The provision of varying dCVV2 values also maintains or improves existing user experiences minimizes the impact on merchant processes and systems leverages existing network data transport mechanisms utilizes existing issuer validation infrastructure and maintains consistency with broader authentication strategies.

Provision entity can process requests from a plurality of different personal communication devices e.g. millions of cell phones and can process any number of requests by a particular personal communication device . Provision entity may apply one or more validation tests to the request to obtain a level of confidence that the request is not fraudulent before sending a datum indicative of a dCVV2 value to a requesting device . Provision entity comprises a system having one or more servers coupled to a communications network that can receive requests for device verification values. One of the servers of entity is shown in the server comprises one or more processors electrically coupled to each of a tangible computer readable medium a user interface one or more databases and a networking facility the latter of which is coupled to first and second communications networks and . User interface comprises one or more video output devices e.g. displays screens and one or more input devices e.g. keyboard mouse trackball etc. which enable an administrator of entity to receive information from the server and to provide input to the server. Computer readable medium may comprise a combination of semiconductor memory and non volatile storage such as one or more disk drives and or non volatile memory.

Computer readable medium stores an operating system for the server which enables processes and applications to be run by processor s and enables codes for directing the operation of processor s to be run. Computer readable medium also stores a plurality of codes that direct processor s to perform various tasks to process requests for dCVV2 values and to provide datum indicative of dCVV2 values. The codes and tasks can vary among the various sets of embodiments described herein and are described in greater detail below with the description of each set of embodiments. The operating system provides services to these processes applications and codes and enables them to access components of user interface portions of computer readable medium networking facility databases and other components of entity . Specifically the operating system provides one or more I O communications modules that enable processor s to communicate with user interface and databases . Each I O communications module has an application programming interface API with a collection of functions that a processor can call in order to access the components. The operating system of entity also comprises one or more network services modules that can access networking facility and set up communication sessions to entities on communications networks and and with SMS gateway . Such network services modules include Microsoft s Windows Communications Foundation e.g. .NET 3.0 .NET 4.0 etc. Apple s CFNetwork Framework the networking section of the Unix and Linux operating system kernels and the OS Services Layer and the Base Services Layer of the Symbian operating system and the like. Each of these network services modules is non exclusive e.g. capable of serving more than one processor and more than one process application and provides an application programming interface API which has a collection of functions that a processor can call in order to manage communications with another entity. With these API facilities a collection of function calls can be readily constructed for a processor to execute that enables the processor to establish a communications channel with an entity on a communications network coupled to networking facility and to exchange messages and data with the entity. The above operating system modules and APIs all include instructions that direct the operation of processor s .

One or more databases may be configured as database servers which processor s can access via networking facility over a private communications network which is illustrated by the dashed line in . Provision entity conventionally has a clock for tracking time and dates for various applications. Clock may be a simple counter of seconds or fractions thereof that can be read by processor by an I O operation or may comprise a more complex arrangement of hardware or firmware that can provide the various components of the current date and time year month day hour minute and second in various registers that can be read by processor through the execution of one or more I O operations.

In a first set of embodiments user creates a management account with provision entity or an associate thereof such as issuing bank or payment network . In some configurations provision entity may be part of issuing bank or part of payment processing network . With the management account the user can associate the consumer accounts e.g. account numbers and related information of one or more corresponding portable consumer devices with a mobile phone number and or network address of personal communications device . The associations specified in the management account are stored as an account record in a database of entity . If the management account is set up with issuing bank or payment processing network the association of the consumer accounts of one or more portable consumer devices with a mobile phone number and or network address provided in the management account is securely transmitted to provision entity over communications network and is stored as an account record in a database of entity . This database of account records enables provision entity to find the consumer accounts e.g. account numbers and related information of the user s portable consumer devices based on the mobile phone number or network address of the user s personal communication device .

An exemplary embodiment of an account record in the aforementioned database is shown in . The exemplary account record is embodied on a computer readable medium and comprises three data fields shown as the top row of the record to store a mobile phone number a network address and a unique identification code for user . All three of these data fields are indexed and searchable. The data fields for the mobile phone number and network address are to store the mobile phone number if available and network address if available of the user s personal communications device . At least one of these fields is filled. If device does not have both a mobile phone number and a network address then one of the fields is filled with a NULL indicator. The third data field holds a unique identification code that is uniquely assigned to the user by provision entity or an affiliated entity upon enrollment such as during the creation of the user s management account. The next three rows in the account record shown in hold data fields for three example consumer accounts for user which the user has associated with the mobile phone number and or network address provided in the data fields of the first row. The first data field e.g. Consumer Account A holds information about the consumer account such as the identity and contact information of the issuing bank and such as the conditions of use of the account e.g. expiration date . The second data field e.g. Account Number for Account A holds the account number for the consumer account such as a 16 digit number of a credit card consumer account. The third data field e.g. Code phrase for Account A holds a code phrase e.g. a text string of alphanumeric characters that user provides to identify the consumer account without referring to the account number for the consumer account the code phrase is different from the account number . The fourth data field stores an indication of which route the dCVV2 value is to be conveyed back to user Reply Route data field . This indication may be set to any of the following values 1 the dCVV2 value is to be sent to the mobile phone number given in the account record 2 the dCVV2 value is to be sent to the network address given in the account record 3 the dCVV2 value is to be sent to both the mobile phone number and the network address given in the account record 4 the dCVV2 value is to be sent back to the source of the request message 5 the dCVV2 value is to be sent back to the opposite of the request message e.g. sent to mobile phone number if the request was sent from the network address . The fifth data field indicates the method to be used to obtain the dCVV2 value and may include one or more actual dCVV2 values to use or an algorithm and any associated parameters to use to generate dCVV2 values. The sixth data field holds various parameters for the consumer account such as a status designation that indicates whether the account is the primary account and which validation tests if any are to be applied to dCVV2 requests for the consumer account.

To enable user to set up a management account provision entity or an affiliated entity e.g. issuing bank or payment processing network may comprise a website accessible to the user that enables the user 1 to create a password protected management account 2 to associate an e mail address with the management account to receive messages and alerts 3 to associate a mobile number and or URID e.g. network address of the user s personal communications device to be used to receive dCVV2 values 4 to associate one or more consumer accounts and corresponding account numbers of the user s one or more corresponding portable consumer devices and 5 to associate a code phrase and reply route with each consumer account. One of databases may be assigned to hold the management accounts of the users. Code associated with the website can direct the processor of the entity to create an account record shown in for the user by copying the data from the management account into the corresponding data fields of the account record by assigning a unique identification code to the user and copying it to the corresponding data field of the account record and by contacting the issuing bank for each consumer account to get the method for obtaining dCVV2 values for the consumer account and copying the method to the corresponding data field of the account record. Thereafter when provision entity receives a request for a dCVV2 value it can query the database of account records for the user s account record using the mobile phone number or network address of the user s personal communications device and determine the consumer accounts of the portable consumer devices that are associated with the user s personal communication device . The above codes and actions can be implemented with HTML page codes XML page codes and the like e.g. web pages conventional I O instructions memory access instructions database function calls CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the codes may be implemented by one of ordinary skill in the software art without undue experimentation.

As one approach for requesting a dCCV2 value when user wishes to complete an on line or in store purchase user can send a request in the form of a text message from personal communication device to a short mobile code e.g. 5 digit number or long mobile code e.g. 10 digit number associated with provision entity . The body of the text message may be blank or may contain a code phrase for portable consumer device or a selected number of digits of the account number for portable consumer device e.g. incomplete account number . The protocol of the text message which is separate from the body of the text message and which typically includes the header of the text message includes the mobile phone number of personal communications device . The text message is received by an SMS gateway which may be operated by the service provider for communications device . Looking at the received mobile code SMS gateway determines that the text message is to be forwarded to provision entity and forwards the text message to entity via communications network using a uniform resource identifier URID for entity . A URID may comprise a uniform resource locator URL an Internet protocol address IP address an e mail address or any other type of identifier or network address that can identify an entity on a communications network. Prior to this the short code long code and URID for entity may be provided to SMS gateway . SMS gateway performs any needed conversion of the message format for the text message and includes the mobile phone number in the body and or protocol e.g. header of the message going to entity . SMS gateway may encrypt the message with a key provided by provision entity . The Short Message Peer to Peer protocol SMPP may be used to route the message from gateway to provision entity over communications network and methods of converting to and from the SMP and SMPP message formats are well known to the art. In addition SMS gateway and its routing operations are known to the art and are commercially available. In some implementations SMS gateway may be coupled to networking facility of provision entity with a direct connection and may communicate with provision entity without the need to use first communications network .

As another communication approach personal communications device may be network enabled having its own network address and may send the request message directly to provision entity by way of communications network . The message may be sent by any number of well known Internet protocols such as User Datagram Protocol UDP Datagram Congestion Control Protocol DCCP Stream Control Transmission Protocol SCTP and Transmission Control Protocol TCP each of which includes the network address of device in the message protocol e.g. the message header or packet header .

The various actions occurring at provision entity are illustrated in the method flow diagram shown in . Once provision entity receives the request message from SMS gateway or from communication device via network action shown in it obtains the mobile phone number or network address of communications device from the protocol of the message e.g. message header or the body of the message and obtains a code phrase if present or any digits of the account number associated with portable consumer device from the body of the message if present as illustrated in action shown in . It then accesses as illustrated by action in the database of account records to locate and obtain an account record that contains the obtained mobile phone number network address or unique user identification code the account record having one or more consumer accounts of portable consumer devices that have been associated with the obtained mobile phone number network address or user identification code as described above. In one embodiment this database may store the account records of all the users that can request dCVV2 values from provision entity . As indicated above each account record is indexed by mobile phone numbers network addresses and user identification codes and can be located by phone number network address and user identification code e.g. the database is searchable based on these datum . Each account record also contains information pertaining to the method of how the dCVV2 values for each consumer account are to be obtained e.g. generated . In this manner provision entity can obtain all of the consumer accounts and account numbers of the portable consumer devices that are associated with the mobile phone number or network address of personal communications device that sent the request for the dCVV2 value and information on how the dCVV2 values are to be obtained.

If a code phrase or an account number or portion thereof is present in the request message provision entity may be configured to find a match of this code phrase or account number or portion thereof to a code phrase or account number or portion thereof stored in the accessed and obtained account record. If no match is found provision entity may be configured to take no further action or to send an error message in the form of a text message back to communications device via SMS gateway or communications network . If a match is found provision entity can select the consumer account for which the match was found and can then access the data field that stores the dCCV2 method for the selected consumer account action shown in . If an account number incomplete account number and code phrase were not obtained from the request message then provision entity can examine the parameter data fields of the account record shown in to see if one of the consumer accounts is indicated as being the primary consumer account for the user. If so provision entity can select the primary consumer account and access its data field that stores the dCCV2 method for the account action shown in . As another option for the case when the dCVV2 request message does not contain an account number incomplete account number or code phrase provision entity may be configured to take no action or to send an error message in the form of a text message back to communications device .

Provision entity may then obtain a datum indicative of a dCVV2 value for the selected consumer account using information from the above mentioned data field that stores the dCCV2 method for the selected consumer account action shown in . The obtained datum may be the dCVV2 value itself an encoded form of the dCVV2 value or an indication of a methodology to use to generate the dCVV2 value at the user s personal communication device . Exemplary methods of obtaining datum of dCVV2 values are described below in greater detail.

To enhance security of the service the full account number of the user s portable consumer device is not transmitted to entity in the request message. Instead only the code phrase or a small portion of the account number e.g. an incomplete account number of the user s portable consumer device is transmitted. This prevents an eavesdropping fraudster from intercepting the complete account number and using the information in another financial channel. In this regard the transmission of the mobile phone number or network address of device and the action of locating the consumer account in a secure database of provision entity as described above is significantly more secure than the case of transmitting the complete account number.

The above described finding of a match by provision entity between the code phrase or account number or portion thereof obtained from the request message and a code phrase or account number stored in the obtained account record serves as a first validation test that helps to ensure that the request for the dCVV2 value has not been spoofed by a fraudster. As a second validation test provision entity may check the mobile phone number or network address obtained from the received request message against one of its databases that tracks mobile phone numbers and network addresses that have been used in fraudulent activities. If the obtained mobile phone number or network address is found in the database provision entity does not send the dCVV2 value. As a third validation test provision entity may check the matched consumer account against one of its databases that tracks consumer accounts that have been used in fraudulent activities. If the matched consumer account is found in this database provision entity does not send the dCVV2 value.

As another security measure the dCVV2 request message may include the user s unique identification code which may comprise a number or alphanumeric name . The unique identification code is different from each of the account numbers of the user s portable consumer devices . As a fourth validation test provision entity may compare the identification code received in the request message against the unique identification code stored in the account record that entity has for the user which has been located by the mobile phone number or network address obtained from the request message . This validation test is passed if the received code matches the stored code and failed if the two codes do not match. It may be appreciated that the account records in database may be indexed by the unique identification codes so that provision entity can find the consumer accounts of the user s devices according to the identification code provided in the dVCC2 request message sent by the user. In this case as a corresponding validation test provision entity may compare the mobile phone number or network address obtained from the request message to the mobile phone number or network address stored in the account record that entity has for the user. This validation test is passed if the obtained phone number or network address code matches a phone number or network address stored in the account record.

As a fifth validation test for request messages sent via SMS messaging provision entity may obtain the network address e.g. IP address of the SMS gateway that sent the dCVV2 request message and compare the obtained network address to a list of trusted SMS gateways for a match. If a match is found the validation test is passed otherwise the test is failed. The network address of SMS gateway is provided in the protocol information such as header information in the request message sent from the SMS gateway.

Typically one or more of the validation tests are preformed in accordance with the desired level of security but it is not necessary to perform any or all of the tests. The optional performance of the validation tests is indicated at action in which can occur before or after the action of obtaining the dCVV2 datum. If a selected set of validation tests are passed provision entity may send the datum of the dCVV2 value in a response text message to the network address of personal communications device and or to the mobile phone number of device via SMS gateway which may be determined by the data in the Reply Route data field of the account record shown in for the selected consumer account. This action is shown at in . To thwart snooping by fraudsters the datum of the response message may send the dCVV2 value in encoded form such as with a selected number of dummy digits being added before and or after the dCVV2 value with user being advised beforehand on which digits to select for the dCVV2 value and which digits are the dummy digits . The datum may also comprise an indication of a methodology for user to use to generate the dCVV2 value at the user s personal communication device such as indications of a row and column of a table of dCVV2 values for the user to look up. The dCVV2 request message from device and the response message from entity may be sent in the same communications route e.g. both routed as SMS messages through SMS gateway or both directly routed as network messages through communications network using network addresses or may be sent by different communication routes e.g. one message send via SMS gateway the other sent directly through communications network .

To implement the above embodiments computer readable medium may store an application having the following codes embodied thereon. A first code directs processor s to receive a request message from personal communication device via network and or from SMS gateway for a device verification value for a portable consumer device associated with a user the request originating from personal communication device associated with user as described above. A second code directs processor s to obtain and place in temporary memory storage the following data from the request message the network address or phone number of the personal communication device that originated the request message the network address of the SMS gateway that sent the request message if the request was sent via the SMS route digits of an account number if present in the body or header of the message a code phrase if present in the body or header of the message and a user identification code if present in the body or header of the message. The first and second codes may comprise function calls to the network services module of the operating system and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions. A third code directs processor s to obtain an account record of user that contains the mobile phone number or network address obtained from the request message the account record having one or more consumer accounts of portable consumer devices that have been associated with the obtained network address or mobile phone number as described above. The third code may comprise conventional I O instructions or function calls to one of databases that holds the account records e.g. a function call directly to the database or via networking facility memory access instructions and CPU control instructions.

A fourth code of application directs processor s to select a consumer account from the obtained account record. This code may direct the data processor s to compare the account number incomplete account number or code phrase obtained from the request message to the account number s and or code phrase s stored in the account record to find a matching item. The data processor selects the consumer account with the matched item as the selected consumer account. If an account number incomplete account number and code phrase were not obtained from the request message then the fourth code may direct data processor s to examine the parameter data fields of the account record to see if one of the consumer accounts is indicated as being the primary consumer account for the user. If so the code directs data processor s to select the primary consumer account as the selected consumer account. The fourth code may comprise conventional memory access instructions CPU logic instructions and CPU control instructions.

A fifth code directs processor s to obtain a datum indicative of a device verification value for the selected consumer account e.g. for the portable consumer device . In some implementations the fifth code may include directing the processor s to identify from information in the obtained account record the method to be used to obtain the datum of the dCVV2 value for the selected consumer account and to execute the identified method. As indicated above this information may be stored in the dCVV2 method data field for the selected consumer account as shown in . This data field may contain parameters to be used in the method and the fifth code may direct processor s to read and use the parameters in the execution of the method. In other implementations an application different from application may pre store one or more dCVV2 values in the dCVV2 method data fields of the consumer accounts and the fifth code of application may read the dCVV2 method data field for a dCVV2 value to use. This other application may update the dCVV2 values in these data fields according to a selected time schedule and optionally in consultation with the issuing banks to keep the values dynamic. In yet other implementations the fifth code may direct processor s to execute a common method to generate the dCVV2 value where the common method is applied to all account records handled by provision entity or to all of the account records for devices issued by a given issuing bank. The common method may include as inputs parameters specific to the user or the selected consumer account as read from the obtained account record. The fifth code may further instruct data processor s to send the obtained dCVV2 value to payment processing network and or issuing bank e.g. an entity different from personal communications device along with an indication of the selected consumer account e.g. the account number . In view of this disclosure the fifth code can be implemented with conventional I O instructions function calls to databases memory access instructions CPU arithmetic instructions CPU logic instructions and CPU control instructions. Aspects of various implementations of the fifth code are described below in greater detail.

A sixth code directs processor s to send a fulfillment message having the datum of the dCVV2 value back to the network address or mobile phone number of device the latter being routed through SMS gateway . For these actions the processor can be directed to use the network address or mobile phone and URID e.g. the network address of SMS gateway that processor s had previously stored under the direction of the first and second codes. In other implementations the sixth code may direct processor s to read the Reply Route data field for the selected consumer account shown in to determine which route s to use and to then use network address and or mobile phone number stored in the obtained account record. The sixth code may further direct processor s to include in the fulfillment message a representation of the consumer account for which the dCVV2 value is being provided. The representation may comprise the incomplete account number or code phrase that was sent in the request message or may include a different representation. The sixth code may comprise function calls to the network services module of the operating system and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions.

An optional seventh code directs processor s to perform the above described second validation test prior to the execution of one or both of the above described fifth and sixth codes. The seventh code directs the processor s to access one of databases that tracks mobile phone numbers and network addresses that have been used in fraudulent activities to determine if the mobile phone number or network address provided in the request message is found in the accessed database. If it is found the seventh code directs the processors s to not execute the sixth code and optionally to not execute either or both of the fourth and fifth codes. The seventh code may comprise conventional I O instructions or function calls to one of databases direct or via networking facility memory access instructions CPU logic instructions and CPU control instructions. An optional eighth code directs processor s to perform the above described third validation test prior to the execution of one or both of the above described fifth and sixth codes. The eighth code directs the processor s to access one of databases that tracks consumer accounts or account numbers that have been used in fraudulent activities to determine if the selected consumer account or its corresponding account number is found in the accessed database. If it is found the eighth code directs the processors s to not execute the sixth code and optionally to not execute the fifth code. An optional ninth code directs processor s to perform the above described fourth validation test prior to the execution of one or more of the above described fourth fifth and sixth codes. The ninth code directs processor s to compare the identification code received in the request message as obtained and stored by the processor s under the direction of the first and second codes against the unique identification code stored in the obtained account record. If the two codes are not equal the ninth code directs processors s to not execute the sixth code and optionally to not execute the fourth code and or fourth code. An optional tenth code directs processor s to perform the above described fifth validation test prior to the execution of one or more of the above described fourth fifth and sixth codes. The tenth code directs processor s to obtain from the received request message the network address of the SMS gate that routed the request message to entity to access one of databases that stores the network addresses of trusted SMS gateways to determine if the network address of the SMS gate that routed the request message to entity is found in the accessed database. If it is not found the tenth code directs the processors s to not execute the sixth code and optionally to not execute the fourth code and or fifth code.

In view of this disclosure the above codes of provision entity may be implemented by one of ordinary skill in the software art without undue experimentation.

Various exemplary methods of obtaining datum of dCVV2 values that can be executed by provision entity with the above described fifth code are now described. In a first implementation the issuing bank for the portable consumer device may provide provision entity with a list of datums indicative of dCVV2 values that are to be used and one or more conditions under which the listed datums are to be given out. For example a condition may specify that the listed datums are to be given out as follows 1 one listed datum per request per transaction 2 one listed datum per group of N requests N transactions or 3 one listed datum for all requests transactions occurring within a selected time period such as 12 hours 1 day two days three days etc . Provision entity may store the listed datums and condition s in the dCVV2 method data field of the user s account record shown in or may store the listed datums and condition s in an auxiliary record located in another one of databases along with an indication of the consumer account. The auxiliary record and the user s account record shown in may be linked to one another. Provision entity may be configured to request additional listed datums when needed or the issuing bank may periodically send listed datums. The listed datums may comprise the actual dCVV2 values or information that can be used to generate dCVV2 values at the communication device . When provision entity receives a request for a dCVV2 value it obtains a user account record and selects a consumer account of a portable consumer device as described above and thereafter locates the listed datum and condition s from the user account record e.g. dCVV2 method data field or the auxiliary record. In this manner provision entity may obtain the datum of the dCVV2 value to be sent. In further implementations the issuing bank may provide provision entity with the actual dCVV2 values and provision may generate the datum as an encoding of the actual dCVV2 value which may be done by an algorithm determined by the issuing bank or provisioning entity . For these tasks related to obtaining datum of dCVV2 values provision entity may comprise code embodied on computer readable medium that directs data processor to communicate with the issuing bank to receive the listed datum and condition s to store the listed datum and condition s in the user account record or the auxiliary record both of which includes a computer readable medium and to look up the listed datum and condition s in response to receiving a request for a dCVV2 value including identifying and selecting the consumer account from the request . The above codes can be implemented with conventional I O instructions memory access instructions database function calls networking function calls CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the codes may be implemented by one of ordinary skill in the software art without undue experimentation.

In a second implementation of obtaining the datum of dCVV2 values that can be executed by provision entity the issuing bank for the portable consumer device may provide provision entity with an algorithm or indication thereof for generating the datums indicative of dCVV2 values that are to be used. The algorithm provides a new datum for each request transaction a new datum for each group of N requests N transactions or a new datum for all requests transactions occurring within a selected time period such as 12 hours 1 day two days three days etc . Provision entity may store the algorithm or indication thereof and any associated parameters in the dCVV2 method data field of the user s account record shown in or may store the algorithm or indication thereof and associated parameters in an auxiliary record located in another one of databases along with an indication of the consumer account. The auxiliary record and the user s account record shown in may be linked to one another. Since many issuing banks will use the same algorithm for its card holders but use different parameters it is more memory efficient to store the algorithm once in one of databases and to store indications of the algorithm such as in the form of a record pointer in the user s account record shown in or auxiliary record along with individualized parameters. However the algorithm can be stored as a script or a method data object in the dCVV2 method data field of the user s account record. When provision entity receives a request for a dCVV2 value it obtains a user account record and selects a consumer account of a portable consumer device as described above and thereafter locates the stored algorithm or algorithm indication and any associated parameters from the user account record e.g. dCVV2 method data field or the auxiliary record and executes the located algorithm. In this manner provision entity may obtain the datum of the dCVV2 value to be sent. The algorithm may include generating the actual dCVV2 value and or encoding the dCVV2 value. For these tasks related to obtaining datum of dCVV2 values provision entity may comprise code embodied on computer readable medium that directs data processor to communicate with the issuing bank to receive the algorithm or indication thereof and any associated parameters to store the algorithm or indication thereof and any associated parameters in an account record or auxiliary record of database which includes a computer readable medium and to look up the algorithm in response to receiving a request for a dCVV2 value including identifying the consumer account number from the request . The above codes can be implemented with conventional I O instructions memory access instructions database function calls networking function calls CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the codes may be implemented by one of ordinary skill in the software art without undue experimentation.

In a third implementation of obtaining datum of dCVV2 values that can be executed by provision entity provision entity may generate the datum values by determining the identity of the issuing bank from the selected consumer account sending an electronic message to the issuing bank through a secure channel to request a dCVV2 datum for use receiving a dCVV2 datum from the issuing bank through a secure channel and sending the received dCVV2 datum to personal communications device and optionally sending the received dCVV2 datum to payment processing network . For this implementation provision entity may comprise code embodied on computer readable medium that directs data processor to determine the identity of the issuing bank from the selected consumer account to send an electronic message to the issuing bank preferably through a secure channel to request a dCVV2 datum for use to receive a dCVV2 datum from the issuing bank preferably through a secure channel and to send the received dCVV2 datum to personal communications device and optionally to payment processing network . The above codes can be implemented with conventional I O instructions memory access instructions database function calls networking function calls CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the codes may be implemented by one of ordinary skill in the art without undue experimentation.

In a fourth implementation of obtaining datum of dCVV2 values that can be executed by provision entity provision entity may generate the datum values by any process and send the generated datum to both personal communications device and the authorizing entities for the transaction which may be one or both of payment processing network and issuing bank . The process may be specific to a particular portable consumer device specific to a particular user e.g. all of the user s devices specific to a group of users specific to a group of devices such as devices issued by a particular bank or general to all devices . An exemplary process may include the user of a pseudorandom number generator. For this implementation provision entity may comprise code embodied on computer readable medium that directs data processor to generate the datum for the dCVV2 value in response to a request according to the selected process and to communicate the datum to personal communication device and payment processing network and or issuing bank . The code may include code that directs data processor to determine the identity of the issuing bank from the selected consumer account as determined from the obtained account record and to send an electronic message to the issuing bank preferably through a secure channel with an indication of the device verification value and the selected consumer account. The above codes can be implemented with conventional I O instructions memory access instructions database function calls networking function calls CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the codes may be implemented by one of ordinary skill in the art without undue experimentation.

A second set of embodiments is similar to the above described first set of embodiments except that a code application is provided on personal communications device to send requests for dCVV2 values to provision entity . As an example device may comprise an Apple iPhone and the code application may comprise a third party iPhone application offered or provided to user by the operator of provision entity or issuing bank . illustrates a generic personal communications device that may be used for these embodiments with an exemplary code application . Device comprises a processor a computer readable medium that stores data an operating system which may be relatively minimal and instructions that direct the operation of processor a telecommunication facility that communicates with a telecommunication network such as through a cell tower an antenna coupled to telecommunications facility and a user interface that has a touch screen display speaker SPK and microphone MIC. As an option personal communications device may also comprise a networking facility capable of communicating with a wireless router or gateway that is coupled to the Internet e.g. WiFi station and an antenna coupled to networking facility . Processor is electrically coupled to computer readable medium user interface telecommunications facility and networking facility . Finally personal communications device conventionally has a clock for tracking time and dates for various applications. Clock may be a simple counter of seconds or fractions thereof that can be read by processor by an I O operation or may comprise a more complex arrangement of hardware or firmware that can provide the various components of the current date and time year month day hour minute and second in various registers that can be read by processor using one or more I O operations.

Application can be stored on computer readable medium . Application directs processor to present a graphical user interface GUI button with a suitable image or text that the user can associate with requesting dCVV2 values. In response to GUI button being activated application directs processor to send a text message to provision entity to request a dCVV2 value. The short or long message code for provision entity may be stored in the code of application and in turn may be stored in medium . As indicated above the text message need not provide an account number or code phrase of a portable consumer device . However application may be further configured to provide a configuration screen to user to receive one or more account numbers or portions thereof such as the last 3 5 digits of the user s portable consumer devices and or a code phrase that the user has created and entered into his or her management account and to thereafter store the account numbers or portions thereof and or code phrases in computer readable medium of personal communications device . The configuration screen may also prompt user to enter the unique identification code that was assigned to the user during the creation of the user s management account as described above to read the entered code and to store the entered code in computer readable medium . The configuration screen may be activated upon first use of application as well as upon a double activation of GUI button e.g. two taps of the button in rapid succession similar to a double click on a computer mouse . When multiple account numbers or portions thereof and or code phrases are stored by application application may present a selection screen to the user in response to a single tap of the button where the selection screen presents selection buttons next to representations of the stored account numbers or portions thereof and or code phrases. In response to the user tapping one of these selection buttons application directs processor of device to send a text message to provision entity that contains the selected account number or portion thereof i.e. an incomplete account number or the selected code phrase and optionally the user s unique identification code. Application may then leave it to user to wait for a text message from provision entity providing the datum of the dCVV2 value and to determine e.g. read decode etc. the dCVV2 value from the text message. As an option application may further direct processor to scan the SMS inbox of communications device for SMS messages from provision entity and delete such messages that have been in the SMS inbox for more than a selected period of time. The SMS inbox may be stored as a data structure in computer readable medium .

Computer readable medium also stores an operating system for the server which enables processes and applications such as application to be executed by processor . The operating system provides services to these processes and applications and enables them to access components of telecommunications facility networking facility user interface clock and portions of computer readable medium . Specifically the operating system provides an I O communications module that enables processor to communicate with user interface and portions of computer readable medium such as those used by application programs . The I O communications module has an application programming interface API with a collection of functions that processor can call in order to access the components. The operating system also comprises a telecommunications service module that enables processor to access telecommunications facility to send and receive SMS messages to store messages in an organized manner e.g. inbox and send box to search stored messages to access stored messages and to delete stored messages. The telecommunications service module has an application programming interface API with a collection of functions that a processor can call in order to perform the above tasks. With the above API facilities a collection of API function calls and other instructions can be readily constructed for processor to execute to carry out the above actions of application . The operating system also comprises one or more network services modules that can access networking facility and set up communication sessions to entities on communications networks . Such network services modules include Microsoft s Windows Communications Foundation e.g. .NET 3.0 .NET 4.0 etc. Apple s CFNetwork Framework and the OS Services Layer and the Base Services Layer of the Symbian operating system and the like. Each of these network services modules is non exclusive e.g. capable of serving more than one process application and provides an application programming interface API which has a collection of functions that a processor can call in order to manage communications with another entity. The above operating system modules and APIs all include instructions that direct the operation of processor .

An exemplary embodiment of application may comprise the following codes stored in computer readable medium . A first code directs processor to present GUI button on touch screen display of user interface . This code may comprise a graphical icon and identifier therefor that are provided to operating system when application is installed on the operating system with a direction that the icon be loaded onto the desktop or equivalent thereof of the user interface and as shown on touch screen . When user taps or clicks on the icon the operating system starts and executes application . A second code of application may be executed immediately upon the operating system starting application or a short duration thereafter to allow the execution of a third code as explained below . The second code may direct data processor to send an SMS text message to provision entity to request a dCVV2 value. The mobile code for entity may be embedded in the second code or may be stored in a segment of computer readable medium and accessed by processor under the direction of the second code. The second code may comprise one or more function calls to the API of the telecommunications services module to send an SMS text message wherein the telecommunication services module may include the mobile phone number of communications device in the protocol e.g. header of the SMS text message. The mobile phone number of device may be stored in computer readable memory which may have both volatile and non volatile memory components with the mobile phone number being stored in the non volatile component. The second code may further direct data processor to access a segment of computer readable medium for stored code phrases and or account numbers or portions thereof and for the user s unique identification code if stored before sending the SMS text message. If only one stored code phrase or account number is found the second code may further direct data processor to include the code phrase or account number or portion thereof in the SMS text message that is sent to provision entity . The second code may also direct processor to include the user s unique identification code in the SMS text message. If two or more stored code phrases and or account numbers are found the second code may include instructions that direct data processor to present a selection screen to the user on touch screen that displays representations of the stored code phrases and or account numbers or portions thereof along with corresponding selection buttons and to obtain a selection of an consumer account from user . The representations may be the actual code phrases and or account numbers or portions thereof or text or graphical icons for the corresponding consumer accounts provided by the user or an issuing bank that provided application to the user. The representations may be stored in computer readable medium along with the code phrases and or account numbers in a linked manner. In some embodiments application may be downloaded from an issuing bank for user and may be personalized by the issuing bank before or during downloading to include the code phrases and or account numbers of the consumer accounts of user and representations of the consumer account so that the user does not need to provide this information to application . The representations may also serve as the selection buttons or may be displayed within the selection buttons. After processor receives a selection of a consumer account from user the second code directs processor to include the code phrase or account number or portion thereof of the selected consumer account in the SMS text message that is sent to provision entity . The second code may also direct processor to include the user s unique identification code in the SMS text message. For these tasks the second code may comprise API function calls to the I O communications module and telecommunication services module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

The exemplary embodiment of application may further comprise as an option a third code that is executed before the second code is executed. The third code directs data processor to monitor touch screen to detect a second tap within a selected time of the start of the application. If such a second tap is detected the third code directs data process to present a configuration screen that receives input from user to provide one or more code phrases and or account numbers or portions thereof and optionally the user s unique identification code. The configuration screen may include a numeric key pad of the Arabic numbers 0 9 and optionally alphabetic letter keys A Z for the user to tap in the input areas to display the inputted codes and or numbers a back key to delete the last entered number or letter an enter key to enter the code and or account number or portion thereof into storage and a cancel key to allow the user to exit the configuration screen. For these tasks the third code may comprise API function calls to the I O communications module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

As another possible option provision entity may be configured to send an SMS text message to personal communications device when the management account of user is created or updated to include or change the account numbers code phrases and unique user identification code that are associated with the mobile phone number of device . The exemplary embodiment of application may further comprise a fourth code that directs processor to check the SMS text inbox of device for such messages to update the consumer account information stored in computer readable medium when such a message is found and to delete the message after updating the consumer account information. Such messages can be located by examining the protocol information of the message for the mobile number of entity and or further by a particular sequence of text characters placed in a selected location of the message or message header. Processor may be directed to check the SMS text inbox upon the starting of application before the second code is executed or periodically. For these tasks the fourth code may comprise API function calls to the telecommunication services module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

The exemplary embodiment of application may further comprise as an option a fifth code that directs processor to scan the SMS text inbox of device for dCVV2 fulfillment messages from provision entity and to delete each such message from the inbox except when it is the most recently received SMS text message in the inbox received from provision entity . Such messages can be located by examining the protocol information of the message for the mobile number of entity and or further by a particular sequence of text characters placed in a selected location of the message or message header. Processor may be directed to check the SMS text inbox upon the starting of application before the second code is executed or periodically. For these tasks the fourth code may comprise API function calls to the telecommunication services module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

The above second through fifth codes may be executed upon application being executed by the operating system at which point application may terminate. User may then check the SMS text message inbox for a message from entity that provides a datum indicative of the dCVV2 value. As another option the exemplary embodiment of application may further comprise a sixth code that directs processor to scan the SMS text inbox of device for the most recent dCVV2 fulfillment message from provision entity received after the execution of the second code to obtain the dCVV2 value from the message and to display dCVV2 value on touch screen of user interface for the user. As an option provision entity may include a representation of the consumer account for which the dCVV2 value is being provided and the sixth code may direct processor to obtain this representation from the SMS text message and to display it on touch screen along with the dCVV2 value. The representation may comprise an incomplete account number or a code phrase. The sixth code can include instructions that perform simple to very complex decoding of the dCVV2 datum to obtain the dCVV2 value thereby enabling entity to send dCVV2 values with a higher degree of security. These instructions can include decrypting instructions using a decryption key stored in computer readable medium . For the above tasks the sixth code may comprise API function calls to the I O communication module and telecommunication services module of the operating system memory access instructions CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

In the above second set of embodiments communications between provision entity and personal communication devices and are performed with SMS messaging. In a third set of embodiments some or all of this communication may be performed by simple packet messaging between entity and devices routed via communications network e.g. using the Internet . For example a modified version of application may send a dCVV2 request to provision entity in a network message sent from networking facility that is addressed to a universal resource identifier URID for entity . A uniform resource identifier URID may comprise a uniform resource locator URL an Internet protocol address IP address an e mail address or any other type of identifier or network address that can identify an entity on a communications network. The network message may be sent by any number of well known messaging protocols such as User Datagram Protocol UDP Datagram Congestion Control Protocol DCCP Stream Control Transmission Protocol SCTP Transmission Control Protocol TCP . The network message can include one or more of the following the mobile phone number of device an account number or incomplete account number for a consumer account of a portable consumer device a code phrase for a consumer account of a portable consumer device the user s unique identification code each of which may be encoded or encrypted. The protocol used to send the network message includes a URID e.g. a network address of device which may be used by provision entity to access and obtain an account record for the user as described above. Provision entity may send back a dCVV2 datum to device by way of an SMS message as described above. Instead of or in addition to provision entity may send back a dCVV2 datum by way of a network message addressed to a URID e.g. a network address of device with the message being routed via communications network and received by networking facility of device .

To implement the third set of embodiments device may comprise a modified version of application . Application may comprise the above described first code of application that directs processor to present GUI button on touch screen display of user interface . Application may comprise a modified version of the above described second code of application . The modified second code may direct data processor to send a network message to provision entity to request a dCVV2 value. The URID for entity may be embedded in the modified second code or may be stored in a segment of computer readable medium and accessed by processor under the direction of the modified second code. The modified second code may comprise one or more function calls to the API of the network services module to send a network message wherein the network services module may include a URID e.g. the network address of communications device in the protocol of the network message. The modified second code may further direct data processor to access one or more segments of computer readable medium for the mobile phone number and or the unique identification code for user before sending the network message. The modified second code may further direct data processor to access a segment of computer readable medium for stored code phrases and or account numbers or portions thereof before sending the network message. If only one stored code phrase or account number is found the modified second code may further direct data processor to include the code phrase or account number or portion thereof in the network message that is sent to provision entity . If two or more stored code phrases and or account numbers are found the modified second code may include instructions that direct data processor to present the above described selection screen to the user on touch screen that displays representations of the stored consumer accounts along with corresponding selection buttons and to obtain a selection of an consumer account from user as described above. For these tasks the modified second code may comprise API function calls to the I O communications module and network services module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the art without undue experimentation.

The modified version of application may comprise the third forth fifth and sixth codes of application and may accordingly receive update messages and dCVV2 fulfillment messages in the form of SMS messages. In some implementations the fifth code may be omitted in the modified version and a modified version of the sixth code may be used. The modified sixth code directs processor to receive a network message e.g. dCVV2 fulfillment message from provision entity after the execution of the modified second code to obtain the dCVV2 value from the so received message and to display the dCVV2 value on touch screen of user interface for the user. The modified sixth code can include instructions that perform simple to very complex decoding of the dCVV2 datum to obtain the dCVV2 value thereby enabling entity to send dCVV2 values with a higher degree of security. These instructions can include decrypting instructions using a decryption key stored in computer readable medium . For the above tasks the modified sixth code may comprise API function calls to the I O communication module and network services module of the operating system memory access instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above codes may be implemented by one of ordinary skill in the software art without undue experimentation.

In the above set of embodiments provision entity may be further configured to send a time datum with the dCVV2 datum where the time datum provides an indication of how long a period of time the dCVV2 datum is valid. The time datum may provide this indication in the form of an absolute point in time that is to be detected using a clock of device with the presumption that the clocks of entity and device are sufficiently synchronized or in the form of a relative period of time measured against the time that the fulfillment message is received in device . The above described fourth code of provision entity may be modified to include instructions to generate the time datum based on information in the account record for the user and the value of its clock . The modifications to the code can be implemented with conventional I O instructions memory access instructions CPU arithmetic instructions CPU logic instructions and CPU control instructions. In view of this disclosure the above modified codes may be implemented by one of ordinary skill in the software art without undue experimentation.

Each of applications and may have their second codes modified to include instructions that first check computer readable medium for an indication of the last received dCVV2 value and the associated time datum to determine if a request to provision entity needs to be sent. The indication may comprise the last received text message from provision entity in the user s text inbox. If the time datum indicates that the last received dCVV2 datum is still good as compared to the time indicated by clock applications and may simply display the dCVV2 value indicated by the last received dCVV2 datum. For this the additional instructions of the modified second code of each application may include 1 memory access instructions that direct the data processor to retrieve from computer readable memory the indication of the last received dCVV2 datum associated time datum and optionally the receipt time 2 I O instructions that direct the data processor to obtain the current time and date from clock 3 CPU arithmetic and logic instructions that direct the data processor to determine if the last received dCVV2 datum is still good valid from the current time and date the time datum and optionally the receipt time of the last dCVV2 datum by device the receipt time may be used in some cases where the time period is measured from the receipt time and 4 CPU control instructions that direct the data processor to proceed normally with the remainder of the second code which sends the request to entity if the last dCVV2 datum is no longer valid or to bypass the remainder of the second code and to jump to the above described fifth or sixth codes which display the dCVV2 value from the last received dCVV2 datum if the last dCVV2 datum is valid. If the second code is executed to obtain a new dCVV2 datum and associated time datum indications of these newly obtained datum and optionally time of receipt are stored in computer readable memory for use the next time application or is called. In view of this disclosure the above instructions and modifications may be implemented by one of ordinary skill in the software art without undue experimentation.

As further variations of the above embodiments that use time datum it may be appreciated that the time of receipt of a message from entity having a dCVV2 datum can effectively serve as the time datum and that entity does not need to send the time datum. In these embodiments applications and and entity may have a shared understanding of how long a dCVV2 value is valid from the time of its receipt. The validity period for the dCVV2 value may be a given amount of time as measured from the receipt time e.g. relative time period such as three days from the receipt time. The validity period may also be for certain days of the week as determined by the receipt time e.g. absolute time period . As an example of the latter the days of the month may be divided into groups of five consecutive days such as days 1 5 6 10 11 15 etc. A dCVV2 datum received during a particular group of days would be valid for the days of that group for example a dCVV2 value received on day 12 of a month would be valid for days 11 15 . Provision entity may send a message with a dCVV2 datum as described above but without a time datum. The shared understanding may be embodied in a time period algorithm that can be embodied in each of codes and as one or more instructions embodied on a computer readable medium that direct a processor to determine if the validity period has expired from the current time and the receipt time.

For this embodiment each of applications and may have their second codes modified to include instructions that first check computer readable medium for an indication of the last received dCVV2 datum and the associated receipt time to determine if a request to provision entity needs to be sent. The indication may comprise the last received text message from provision entity in the user s text inbox which includes a receipt time. If the receipt time indicates that the last received dCVV2 datum is still good as determined by the time indicated by clock and the time period algorithm applications and may simply display the dCVV2 value indicated by the last received dCVV2 datum. For this the additional instructions of the modified second code of each application may include 1 memory access instructions that direct the data processor to retrieve from computer readable memory the indication of the last received dCVV2 datum and associated receipt time 2 I O instructions that direct the data processor to obtain the current time and date from clock 3 CPU arithmetic and logic instructions that implement the time period algorithm and that direct the data processor to determine if the last received dCVV2 datum is still good valid from the following the current time and date the receipt time and the time period algorithm and 4 CPU control instructions that direct the data processor to proceed normally with the remainder of the second code which sends the request to entity if the last dCVV2 datum is no longer valid or to bypass the remainder of the second code and to jump to the above described fifth or sixth codes which display the dCVV2 value from the last received dCVV2 datum if the last dCVV2 datum is valid. If the second code is executed to obtain a new dCVV2 datum indications of newly obtained dCVV2 datum and associated receipt time are stored in computer readable memory for use the next time application or is called. In view of this disclosure the above instructions and modifications may be implemented by one of ordinary skill in the software art without undue experimentation.

Each of the above described embodiments for provision entity may be modified so that it unilaterally sends a dCVV2 datum and optionally a time datum without receiving a request from device . For example provision entity may periodically or intermittently send a dCVV2 datum and optionally a time datum to device . The above modified versions of Applications and may be used in this implementation of entity without further modification or the applications may be further modified to omit the instructions pertaining to sending requests for dVCC2 datums. In this modified embodiment provision entity may comprise a first code that scans through the account records and generates dCVV2 datums and optionally associated time datums using instructions described above according to one or more selected time intervals and a second code that sends the dCVV2 datums and optionally time datums to the personal communication devices of the users using instructions described above . As a further modification provision entity may send the dCVV2 datum and optionally the time datum along with a normal transaction notification message.

In each of the above embodiments one or more portable consumer devices may be combined and electronically integrated with personal communication device and provided as a single physical unit.

Alerts including data for use in completing transactions. While the above embodiments have focused on device verification values for purchase transactions the inventors have recognized that a verification value is one of several pieces of information that may be associated with a transaction and that the above embodiments may be configured to process e.g. to obtain receive and send other pieces of transaction related information. For example in some exemplary embodiments a message may be sent from provision entity to user during a transaction in order to assist with the transaction. For example user may need to provide to the merchant or other appropriate party certain information in order to complete the transaction such as a billing zip code a PIN personal identification number an expiration date a card security code e.g. CVV CVVC etc or other required information. During the transaction user may inadvertently omit or incorrectly enter some of the required information. In some exemplary embodiments user may receive a message such as an SMS message or network message with the omitted or corrected information to allow for completion of the transaction. For example during a transaction using a credit card such as at a gas station on a business trip user may be asked to provide the billing address of the credit card. The credit card may be associated with an employer of user such that user may not know the correct billing address. Upon a certain trigger e.g. inputting the wrong information during the transaction user requesting the information etc. a message may be sent to the personal communications device of user e.g. a wireless phone registered as belonging to user . This message can contain the billing address for the credit card. User can then supply the correct information allowing the transaction to finish.

In certain embodiments the message may only include a portion of the omitted or corrected information or a hint regarding the omitted or corrected information to prevent unauthorized transactions. For example if user provides the wrong information during a transaction user may receive a message such as an SMS message with a hint such as use your work address for the billing address. Another example of the hint may be please enter your work zip code not your current zip code. In certain embodiments the message may include information for a future transaction. For example once a first transaction has been completed user may receive a message containing a PIN code a card security code or other information that will be needed to complete a later second transaction such as the next transaction. This can prevent unauthorized transactions as even if the portable consumer device is compromised the message containing the information can still be secure.

Referring to omitted or incorrect information may be detected by payment processing network when merchant sends the transaction information to network for authorization. Network may determine which piece of information is omitted or incorrect and may send a message to provision entity instructing entity to send a message to user providing an indication of which piece of information was omitted or incorrect and optionally providing the omitted or corrected piece of information or a hint thereto. The message sent from payment processing network to provision entity includes the account number of the portable consumer device so that entity may find the mobile phone number or URID e.g. the network address of personal communication device from one of its databases . The message sent from network to entity may also include the text that is to be displayed to user so that entity may simply forward this text to user . When the mobile phone number or URID e.g. the network address is located from one of databases by provision entity the entity can simply forward the text in a message to user . At substantially the same time network may send a message to merchant instructing the merchant to reacquire the payment information from user and to retry the transaction with the reentered payment information. User may then receive a message from entity with text of what information was omitted or incorrect which may contain an indication of how to correct the entry of the payment information. User may then proceed with a complete and correct entry of the payment information with merchant . Merchant may then resend the authorization request to payment processing network .

To implement the above computer readable medium of provision entity may store an application having the following codes. A first code directs processor s to receive a request message from payment processing network and to place in temporary memory storage the following a message datum from the request message indicating a piece of information for a portable consumer device and an account number of the portable consumer device associated with user . The request message from payment processing network may implicitly serve as a request to provision entity to provide the message datum to user or the request message may contain an explicit direction to do so. The first code may comprise function calls to the network services module of the operating system of entity and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions. A second code of application directs processor s to access a record of user based upon the account number provided in the request message the record having at least one of a mobile phone number or a URID e.g. the network address of the user s portable consumer device that has been associated with the account number. The second code may comprise conventional I O instructions or function calls to one of databases direct or via networking facility memory access instructions and CPU control instructions. A third code of application directs processor s to send an alert message to the mobile phone number or URID e.g. the network address of personal communication device in the form of a text message routed through SMS gateway or a network message routed through first communications network with the alert message having the message datum indicative of the piece of information. The third code may comprise function calls to the network services module of the operating system and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions. The codes of this application for provision entity may be implemented by one of ordinary skill in the software art without undue experimentation.

As another implementation approach payment processing network may be combined with provision entity in which case a formal message from network to entity does not need to be sent. Computer readable medium of provision entity may store an application having the following codes for the merged operation of network and entity . A first code directs processor s to receive an authorization request message from a merchant which includes payment information and to store the payment information in temporary memory storage. The first code may comprise function calls to the network services module of the operating system of entity and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions. A second code directs processor s to access a record of payment information for the account number provided in the authorization request message the record having at least one of a mobile phone number or the URID e.g. the network address of the user s portable consumer device that has been associated with the account number. The second code may comprise conventional I O instructions or function calls to one of databases direct or via networking facility memory access instructions and CPU control instructions. A third code directs processor s to compare the received payment information with the payment information from the accessed record to identify omitted or incorrect payment information and to generate a message datum indicative of the omitted or incorrect payment information. A portion of the message datum or the entire message datum may be copied and or derived from a message field in the accessed record the message field being associated with the record s data field that is related to the omitted or incorrect payment information. The third code may comprise memory access instructions the accessed record may be stored in temporary memory CPU logic instructions and CPU control instructions. A fourth code directs processor s to send an alert message to the mobile phone number or the URID e.g. the network address of personal communication device in the form of a text message routed through SMS gateway or a network message routed through first communications network with the alert message having the message datum indicative of the omitted or incorrect piece of information. The code may comprise function calls to the network services module of the operating system and conventional I O instructions to networking facility memory access instructions CPU logic instructions and CPU control instructions. The codes of application for provision entity may be implemented by one of ordinary skill in the software art without undue experimentation.

Embodiments of the invention are not limited to systems involving purchase transactions. The same approach could be applied for other financial systems. For example embodiments could be used to authenticate a user using an online banking application. A cardholder may enter his user ID into a banking website. The cardholder can then use his or her personal communication device to obtain and use a dCVV2 value as a verification value. The banking website can validate the User ID and the verification value provided by the user by communicating with the provision entity.

Embodiments of the invention are not limited to the above described embodiments. For example although separate functional blocks are shown for an issuer payment processing system and acquirer some entities perform all of these functions and may be included in embodiments of invention.

It should be understood that various embodiments of the present invention as described above can be implemented in the form of control logic using computer software in a modular or integrated manner. Based on the disclosure and teachings provided herein a person of ordinary skill in the art will know and appreciate other ways and or methods to implement embodiments of the present invention using hardware and a combination of hardware and software.

Any of the software components or functions described in this application may be implemented as software code to be executed by a processor using any suitable computer language such as for example C C Java C or Perl using for example conventional or object oriented techniques. The software code may be stored as a series of instructions or commands on a computer readable medium such as a random access memory RAM a read only memory ROM a magnetic medium such as a hard drive or a floppy disk or an optical medium such as a CD ROM. Any such computer readable medium may reside on or within a single computational apparatus and may be present on or within different computational apparatuses within a system or network.

The above description is illustrative and is not restrictive. Many variations of the invention and embodiments thereof will become apparent to those skilled in the art upon review of the disclosure. The scope of the invention should therefore be determined not with reference to the above description but instead should be determined with reference to the pending claims along with their full scope or equivalents.

One or more features from any embodiment may be combined with one or more features of any other embodiment without departing from the scope of the invention.

A recitation of a an or the is intended to mean one or more unless specifically indicated to the contrary.

All patents patent applications publications and descriptions mentioned above are herein incorporated by reference in their entirety for all purposes. None is admitted to be prior art.

