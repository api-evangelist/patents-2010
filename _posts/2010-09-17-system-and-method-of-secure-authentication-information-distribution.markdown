---

title: System and method of secure authentication information distribution
abstract: A system and method of distributing authentication information for remotely accessing a computer resource. A request for authentication information, including identity information, is received from a user of a remote device. When the user is authenticated based on the identity information, requested authentication information is retrieved and returned to the remote device. The authentication information, or information generated from the authentication information, is then used for remotely accessing the computer resource.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08677138&OS=08677138&RS=08677138
owner: BlackBerry Limited
number: 08677138
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20100917
---
This application is a continuation of U.S. patent application Ser. No. 10 730 183 filed Dec. 8 2003 by Herbert A. Little et al. entitled System and Method of Secure Authentication Information Distribution which claims benefit of and priority to U.S. provisional application Ser. No. 60 431 737 entitled System and Method of Secure Seed Distribution filed Dec. 9 2002 and to U.S. provisional application Ser. No. 60 440 359 entitled System and Method of Secure Distribution of Authentication Information filed Jan. 16 2003 all of which are incorporated by reference herein as if reproduced in their entirety.

This invention relates generally to remote computer system access control and in particular to secure distribution of authentication information used in user authentication.

In a computer network network resources are accessible to computer systems or devices which are connected in the network. Many computer networks also support remote access to network resources from computer systems or devices external to the network. For remote access two factor authentication is often used to control network access. Two factor authentication is based on something a user knows such as a password and something the user has such as an access code generator or token. In order to remotely access a network a user provides authentication information including the password and the access code.

In a known two factor authentication scheme the code generator is a hardware component which stores a secret key or seed which is shared between the code generator and an authentication system at the computer network and a code generation algorithm. The code generation algorithm generates an access code valid for a relatively short period of time using the seed and a current time and the access code is displayed on a user interface. The user enters the access code and transmits the access code and other required authentication information to the authentication system at the computer network. The authentication system then retrieves the user s seed from a store at the computer network and uses the same algorithm and a current time to calculate an access code that should have been generated at the code generator. When the received access code and the calculated access code match or the received code is within a predefined range or window of past or future access code values then remote access to the computer network is granted.

Hardware code generators tend to be physically small and are thus prone to being misplaced or damaged. When a user travels with a laptop computer but forgets the hardware token for example the user cannot remotely access a computer network without intervention by a network owner or administrator. Although software based code generators installed on a computer system or device from which a user remotely accesses the computer network alleviate the problem of lost or forgotten hardware code generators seeds used in access code generation must be shared only between the network authentication system and the code generator. Known seed distribution techniques involve email requiring network administrator intervention to retrieve and insert each user s seed into an email message or use of a particular seed transfer mechanism such as a serial connection to a networked computer system. As well email is generally not desirable because a copy of the seed is stored for example in an email system and data backups. Encrypting messages containing seeds could address these concerns but creates an encryption key distribution problem. More automated and convenient systems and methods of securely distributing seeds to such computer systems and devices are therefore desirable.

In accordance with the teachings disclosed herein systems and methods are provided for use in distributing authentication information in order to remotely access a computer network. For example a request for the authentication information may be received from a user of a remote device wherein the request comprises identity information. The user is authenticated based on the identity information in the request and the authentication information is returned to the remote device if the user is authenticated.

In an alternate embodiment systems and methods are provided for distributing seeds for use in generating access codes for user authentication including receiving a seed request from a remote device the seed request comprising authentication information that includes an access code generated using a seed retrieving the seed from a seed store calculating an access code using the retrieved seed determining whether the calculated access code matches the received access code in the authentication information and returning the retrieved seed to the remote device where the calculated access code matches the received access code.

Other embodiments may be included without limitation such as computer software and computer readable media that have instructions for performing the authentication information distribution methods as well as data signals which are used to convey information among the systems and devices involved in distribution of authentication information.

Further features of seed distribution systems and methods will be described or will become apparent in the course of the following detailed description.

The computer system is a desktop or laptop personal computer PC which is configured to communicate to the WAN the Internet for example. PCs such as the computer system normally access the Internet through an Internet Service Provider ISP Application Service Provider ASP or the like.

The corporate LAN is a typical working environment in which multiple computers are connected in a network which also supports access by remote devices such as the computer system and the mobile device . Such a network is often located behind a security firewall . Within the corporate LAN a data server operating on a computer behind the firewall acts as the primary interface for the corporation to exchange data both within the LAN and with other external systems and devices via the WAN . Although a data server is shown in the LAN those skilled in the art will appreciate that a LAN may include more than one data server and other types of servers supporting network resources.

The wireless gateway provides an interface to a wireless network through which data may be exchanged with a mobile device . The mobile device may for example be a data communication device a dual mode communication device such as a mobile telephone having both data and voice communications functionality a multiple mode device capable of voice data and other types of communications a personal digital assistant PDA enabled for wireless communications or a laptop or desktop computer system with a wireless modem for example. An exemplary mobile device is described in further detail below.

Such functions as addressing the mobile device encoding or otherwise transforming messages for wireless transmission or other necessary interface functions are performed by the wireless network gateway . The wireless network gateway may be configured to operate with more than one wireless network in which case the wireless network gateway also determines a most likely network for locating the mobile device and possibly tracks mobile devices as users roam between countries or networks. Although only a single wireless network gateway is shown in mobile devices are often configured to communicate with more than one gateway such as a corporate network gateway and a Wireless Application Protocol WAP gateway for example. Alternatively private wireless network gateways such as wireless Virtual Private Network VPN routers could be implemented to provide a private interface to a wireless network. A wireless VPN implemented in the LAN provides a private interface from the LAN to one or more mobile devices such as through the wireless network without requiring the wireless network gateway .

A wireless network normally delivers data to and from communication devices such as the mobile device via RF transmissions between base stations and devices. The wireless network may for example be a data centric wireless network a voice centric wireless network or a dual mode network that can support both voice and data communications over the same infrastructure. Recently developed voice and data networks include Code Division Multiple Access CDMA networks Groupe Special Mobile or the Global System for Mobile Communications GSM and General Packet Radio Service GPRS networks and third generation 3G networks like Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS which are currently under development. Older data centric networks include but are not limited to the Mobitex Radio Network Mobitex and the DataTAC Radio Network DataTAC and known voice centric data networks include Personal Communication Systems PCS networks like GSM and Time Division Multiple Access TDMA systems that have been available in North America and world wide for several years.

In the system a company which owns the corporate LAN may provide employees with remote access to the corporate LAN via any of a variety of remote devices including mobile devices such as or external laptop and desktop computers such as . Network resources on the LAN are then accessible whether the user is at an office computer system in the LAN or at a remote location using the mobile device or the computer system . As described above two factor authentication is used in the LAN to authenticate a user requesting remote access to the LAN . A remote user inputs authentication information such as a network user name a network password and an access code generated by a code generator at a remote device in order to access the LAN .

The authentication system authenticates users requesting remote access to the LAN . In the system remote access control uses two factor authentication based on authentication information such as a user password and an access code generated using a shared secret seed for example. At the LAN authentication information for each user authorized for remote access is stored in the authentication information store e.g. a seed store . It should be appreciated that other information from which authentication information is generated such as a seed from which an access code is generated by a remote access code generator and the authentication system may also or instead be stored in the authentication information store .

The authentication information store may be indexed e.g. is searched by user name or another identifier associated with each user authorized for remote access to the LAN . Where the authentication information store stores seed values used to generate access codes for example code generator serial numbers associated with each authorized user could instead be used to index the authentication information store so that the authentication system is able to identify and access the correct seed when a user is to be authenticated. Since stored authentication information is secret and user specific the authentication information store is a secure store which is preferably accessible only to authorized parties or systems such as network administrators and the authentication system . Although shown as a separate block in the authentication system may be incorporated into the data server or another server in the LAN in alternative embodiments. Client and server types of implementations are also contemplated in which each protected network resource is configured to operate in conjunction with an authentication client which interacts with an authentication server. For example the authentication server authenticates users attempting to access protected network resources and the authentication clients grant access to protected network resources to authenticated users.

The mobile device comprises a memory a processor a user interface UI a clock a transceiver and an interface or connector . The memory includes a storage area for software applications an authentication information store and a plurality of data stores and . In some embodiments the mobile device may also include a code generation system .

The memory is or at least includes a writeable store such as a random access memory RAM into which other device components write data. Software applications that have been installed on the remote device are stored in the software applications store . These software applications include one or more software applications through which a computer network such as the LAN in is remotely accessible and possibly software applications that communicate with other entities or manage on device functions. Software applications may also perform more than one type of function and remotely access more than one computer network.

The application data store stores information associated with the software applications on the remote device including for example cached web pages for a browser application files used by software applications and possibly configuration data for software applications. Electronic messages such as received and or sent email messages are stored in the message store . Data such as schedule information appointments and reminders are stored in the calendar store . The task store is used to store tasks that a user wishes to track. Notes and memos entered by a user are stored in the memo store . The text entry store stores a word list or dictionary which supports for example predictive text entry and automatic error correction when text is entered on the remote device .

The authentication information store stores authentication information. For example a secret seed used to generate an access code for remotely accessing a computer network using the remote device may be stored in the authentication information store . Such a seed is specific to a particular user of the remote device and is also stored at the computer network to be remotely accessed. The authentication information store is preferably located in a secure memory location protected by a user password for example. Authentication information may also or instead be stored to the authentication information store in encrypted form such that a password is required to decrypt the authentication information when it is needed. In alternative embodiments the authentication information store is implemented in a smart card or other device such as a Universal Serial Bus USB token or Secure Digital SD card for example that can be attached to the remote device . In this manner the authentication store is provided in a separate secure memory component.

Although shown as separate data stores those skilled in the art will appreciate that some or all of the stores could be consolidated into a single data store in the memory . It should also be apparent that a remote device may include further fewer or different data stores than those shown in .

The processor is connected e.g. has a data pathway to the transceiver and thus enables the remote device for communication via a communication network. In a device such as the mobile device the transceiver is a wireless transceiver or wireless modem configured for communications in a wireless network. Alternatively the transceiver is a wired modem or network card where the remote device is a computer system which communicates via a WAN or the Internet. Incorporating more than one type of transceiver in the remote device enables the remote device for communication in different types of communication network.

The interface connector provides an alternate communication path to a PC or other device having a co operating interface or connector. The interface connector could be any of a plurality of data transfer components including for example an optical data transfer interface such as an Infrared Data Association IrDA port some other short range wireless communications interface or a wired interfaces such as serial or Universal Serial Bus USB port. Known short range wireless communications interfaces include for example BLUETOOTH modules and 802.11 modules. It will be apparent to those skilled in the art that BLUETOOTH and 802.11 denote sets of specifications available from the Institute of Electrical and Electronics Engineers IEEE relating to wireless LANs and wireless personal area networks respectively. Therefore a communication link established via the interface connector may be a wireless connection or a physical wired connection.

The UI includes such components as a keyboard or keypad a display or other components which accept inputs from or provide outputs to a user of the remote device . Although shown as a single block in a remote device typically includes more than one UI and the UI is therefore intended to represent one or more user interfaces.

In the remote device the code generation system is either a hardware or software based access code generator although a software based access code generator is preferred. The code generation system embodies a generator algorithm which generates access codes for use in two factor authentication for remote computer network access based on the seed in the authentication store and the current time from the clock . The clock provides either a current time or a timing signal from a local oscillator or frequency synthesizer for example from which a current time is calculated by the code generation system .

The identity information in the request preferably enables two factor authentication at the computer network and includes for example a password entered by a user of the remote device and a digital signature generated based on a transformation of at least a portion of the information in the request a signature key and a signature algorithm. In this example the two authentication factors are the network password something that a user knows and the signature key something the user has . Depending upon the particular type of remote access implementation other identity information may also or instead be used to authenticate a user requesting authentication information from a computer network. The data server or some other component in the LAN maintains a record of associations between users and remote devices. It is noted that a remote device serial number or other identifier of the remote device from which a request originated is another possible authentication factor. The user s particular remote device itself is then an authentication factor representing something that the user has.

The request for authentication information is preferably transmitted to the computer network via a secure communication link such as a Secure Hyptertext Transfer Protocol S HTTP connection a Secure Sockets Layer SSL connection or a Transport Layer Security TLS connection. Thus the authentication information request may be an SSL connection request for example. Secure email schemes such as Secure Multipurpose Internet Mail Extensions S MIME and Pretty Good Privacy PGP and other secure messaging techniques are other possible transports for authentication information requests.

At the computer network user authentication operations based on the identity information in the request are performed to determine whether the request was sent by the user whose authentication information is being requested. Since the authentication information is associated with a particular user it may be provided to that user only in response to a request unless the situation dictates otherwise . Where the request includes a network password and a digital signature for example then the password and digital signature are verified before the authentication information is returned. This authenticates the user to the computer network component or system which manages authentication information distribution. The authentication information stored at the computer system is retrieved and returned to the remote device where the user is authenticated.

User authentication during distribution of stored authentication information ensures that a user can retrieve his or her own corresponding authentication information and not authentication information associated with any other users. This user authentication allows authentication information distribution to be completed without intervention by an administrator at the computer network or restriction of authentication information distribution to a particular communication interface. Where stored authentication information is accessible through an automatic entity such as a web server to which access is controlled based on user authentication stored authentication information is automatically returned in response to a request from an authenticated user thereby further simplifying distribution of stored authentication information.

In the system of a request from the mobile device for example is received by the data server . In a preferred embodiment the data server performs user authentication for a received request based on the identity information in the request. Where the request includes a password and a digital signature for example the data server checks the password in the request to determine whether the password included in the request is correct. Password checking operations are well known to those skilled in the art to which the present application pertains.

The data server also checks the digital signature using a signature key and algorithm corresponding to the signature key and algorithm used to generate the digital signature. For example many known signature algorithms use a signature public private key pair. The signature private key is used by a signer to generate a digital signature and is known only to the signer whereas the signature public key is available from a key source such as a public key server PKS accessible through the Internet for example and is used to verify a digital signature generated using the corresponding signature private key. Thus where the digital signature in the request was generated using a user s signature private key the data server obtains the user s signature public key from a PKS not shown connected to the WAN or possibly the LAN and checks the digital signature using the signature public key. If the digital signature is verified then any signed information in the request has not been changed since it was signed and the request was signed by the user s signature private key.

Where both the password and the digital signature are verified the user is authenticated. The user submitting the request knows the correct password and has the signature private key. Provided the user is requesting his or her own authentication information the authentication information is retrieved from the authentication information store and returned to the mobile device . In the data server requests the authentication information from the authentication system although in an alternative embodiment the data server retrieves the requested authentication information from the authentication information store . In a still further embodiment the authentication system performs user authentication for authentication information distribution as well as for remote access.

With reference to once a user s authentication information has been returned to the remote device and stored to the authentication information store the authentication information stored at the computer network and required for accessing the computer network is available at the remote device .

A request mechanism as disclosed herein allows authentication information such as a seed value or an access code required for remote access to the computer network to be requested from the computer network even though a user has misplaced access codes. The user is able to remotely access the computer network using the requested stored authentication information even though the code generator is not available. In this example a code generator simplifies remote access operations in that authentication information stored at the computer network need not be requested when the code generator is available but is not essential for remote access.

Using the identity information in the request an authentication system or server at the computer network determines whether the requested authentication information should be returned to the remote device. If the user is authenticated based on the identity information in the request as determined at step then the requested authentication information is retrieved and returned to the remote device at step .

The returned authentication information is received at the remote device at step and stored in an authentication information store at step . Depending on the nature of the returned authentication information a protected authentication information store may be preferred. For example where the returned authentication information is an expiring password or access code which is valid for a relatively short period of time typically on the order of minutes the authentication information store need not necessarily be a protected store since it is unlikely that such a password or code would be compromised and used to access the computer network while it remains valid. However if the returned authentication information has a longer validity period such as a non expiring password or a seed from which access codes are generated as required then the authentication information store is preferably a protected store. In one embodiment the authentication information store is protected by encrypting the received authentication information using a password or passphrase before storing the authentication information to memory on the remote device. The same password or passphrase is then required to decrypt and use the stored authentication information for remote access to a computer network as described in further detail below. For example a user is prompted to enter an authentication information password or passphrase when the authentication information is received from the remote computer network. Depending upon the desired level of security further information could be used to encrypt the received authentication information along with the password or passphrase to help keep the authentication information more secure. Encrypting the received authentication information using device specific information such as a serial number in conjunction with a password for example ensures that the authentication information from one remote device cannot be used on any other device. In this case both a password entered by a user and a remote device serial number are either checked before authentication information is decrypted or required for correct decryption of the authentication information.

Where the user is not authenticated at step then the authentication information request is denied at step and the connection is preferably dropped. An error message may also be returned to inform the entity that submitted the request that the request was denied and possibly the reason for denial of the request.

With reference back to authentication information distribution operations on the remote device are preferably handled by a software application or utility that is executed by the processor when a user invokes an authentication information request operation. For example when authentication information distribution is handled via S HTTP SSL or TLS connection a browser application on the remote device likely supports authentication information requests and responses. At the LAN in user authentication for authentication information distribution at step is performed by the data server or the authentication system as described above. When the user has been authenticated either the authentication system or possibly the data server retrieves the requested authentication information from the authentication information store and the authentication information is returned to the remote device by the data server .

In one embodiment of the invention the authentication information is a password an access code or the like that is used in user authentication for remote access to the computer network. When remote access to the computer network is required this authentication information is retrieved from the authentication information store on the remote device in accordance with any security measures implemented to protect the authentication information store and sent to the computer network along with other authentication information such as a network account password and some form of identifier such as a user name or user account name or number when remote access to the computer network is required. For example where remote access to the computer network is Hypertext Transfer Protocol HTTP based then required authentication information and identifiers are formatted in an HTTP connection request. The authentication information retrieved from the authentication information store is either displayed on the remote device and manually entered or copied and pasted by a user for insertion into the connection request or automatically inserted into the connection request when it is retrieved.

At the computer network this authentication information is checked against corresponding authentication information stored for the user or user account to determine whether remote access to the computer network should be granted. Where the returned authentication information expires or becomes invalid after a certain period of time remote access is typically granted when the authentication information is received at the computer network from the remote device before it expires. In some systems a further time window is provided within which expired authentication information is accepted. This further time window allows for clock differences between the remote device and the computer network and communication network latency for example.

In order to access or decrypt stored authentication information e.g. a seed which has been stored with password protection a password must be correctly entered by the user. This provides a further level of security over known code generators which continuously generate access codes. At step it is determined whether access to the authentication information should be granted. Where a password has not been correctly entered the access code request is denied at step . Denial of the code request at step may also involve such typical error processing operations as returning an error message or indication and prompting the user to re enter the password for example. The particular operations at step are dependent upon how the authentication information store is protected. Password protection is one possible type of protection although the present invention is in no way limited thereto.

If access to the authentication information is granted where the password has been entered correctly for example then the method proceeds to step . The stored authentication information is accessed and decrypted if necessary. In one embodiment a current time is determined from a local clock in the remote device and an access code is generated using the authentication information the current time and an access code generation algorithm. The generated access code is then provided to the user on a display screen for example. Those familiar with remote access code generation will appreciate that access codes are typically valid for only a short period of time. As such a user has a limited time after an access code has been generated to correctly enter the generated access code using a keyboard or keypad and then complete and send a remote access request. Particularly on remote devices such as mobile telephones and other mobile communication devices on which data entry tends to be somewhat more difficult and time consuming relative to PCs with full alphanumeric keyboards entry of a generated access code in time to complete and send a remote access request while the generated access code is valid is difficult.

In accordance with another aspect of the invention the code generation system passes the generated access code to a software application being used for remotely accessing a computer network. The generated access code is then inserted into authentication information to be transmitted to the computer network for user authentication in a remote access operation. For example in one implementation the user invokes the code generation system when authentication information such as network user name and network password has been entered and the generated access code is inserted into the authentication information typically by appending the access code to the network password. Alternatively the access code is displayed to the user on a display screen and can be copied and pasted into the authentication information. Automatic insertion or copy and pasting of generated access codes simplifies user entry of access codes and reduces the likelihood of errors in entering the access codes.

As described above an authentication system at the computer network fetches the remote device user s authentication information e.g. seed and calculates the access code that should have been generated at the remote device to determine whether remote access to the computer network should be granted.

The authorization system may involve different types of access information. For example is a flow diagram illustrating a method of secure seed distribution. At step a seed request is received at a computer network from a remote device via a secure connection such as an SSL connection. As described above the seed request a connection request where the secure connection is an SSL connection includes authentication information such as a user name network password and an access code generated by an existing code generator. Depending upon how the seed is stored at the computer network further authentication information such as a serial number or other identifier of the existing code generator or seed may also be provided in the seed request. For example a particular seed may be identified in the seed request by a serial number of the existing code generator.

Using the authentication information in the seed request an authentication system or secure server associated with the seed store at the computer system determines whether the requested seed should be returned to the remote device. The seed corresponding to the user name and code generator or seed identifier if required is retrieved from the seed store at the computer network and used to calculate an access code that should have been generated by the existing code generator. If the user name and password are correct and the calculated access code matches the access code in the seed request then the user is authenticated at step and the seed is returned to the remote device at step . As those skilled in the art appreciate a user may be authenticated even though the calculated and received access codes do not match exactly. For example a user may be authenticated where less than a predetermined amount of time has elapsed since the received access code expired to allow for latency within communication networks. Many authentication schemes also provide for requesting a further access code from the user in this situation.

The returned seed is received at the remote device at step and stored in a protected seed store at step . The seed store on the remote device is preferably protected by encrypting the received seed using a password or passphrase before storing the seed to memory. The same password or passphrase is then required to decrypt and use the stored seed for access code generation as described in further detail below. In a preferred embodiment the user is prompted to enter a seed password or passphrase when the seed is retrieved. Depending upon the desired level of security further information could be used to encrypt the received seed along with the password or passphrase to help keep the seed more secure.

Where the user in not authenticated at step then the seed request is denied at step and the connection is preferably dropped. An error message may also be returned to inform the entity requesting the seed that the request was denied and possibly the reason for denial of the request.

With reference back to authentication information distribution operations on the remote device are preferably handled by a software application or utility that is executed by the processor when a user invokes an authentication information request operation. For example when authentication information distribution is handled via S HTTP SSL or TLS connection a browser application on the remote device likely supports authentication information requests and responses. At the LAN in user authentication for authentication information distribution at step is performed by the data server or the authentication system as described above. When the user has been authenticated either the authentication system or possibly the data server retrieves the requested authentication information from the authentication information store and the authentication information is returned to the remote device by the data server .

In a request to generate an access code using a seed is received at step . Although many known access code generators continuously generate and display access codes in a preferred embodiment the code generation system optionally generates a code only when needed. For example a software application such as a browser could be configured to automatically invoke or call the code generation system to generate an access code when a user attempts to remotely access a computer network. Alternatively the user starts the code generation system before or during preparation of a remote access request using a function call within a software application for example or a more generalized function call or menu item not specifically associated with a particular software application. Such as needed access code generation supports a higher level of security for the stored seed and also conserves power on the mobile device since the code generation system does not operate continuously.

In order to access or decrypt a stored seed depending upon how the seed store is protected a password must be correctly entered by the user. This provides a further level of security over known code generators which continuously generate access codes. At step it is determined whether access to the seed should be granted. Where a password has not been correctly entered the access code request is denied at step . Denial of the code request at step may also involve such typical error processing operations as returning an error message or indication and prompting the user to re enter the password for example.

If the password has been entered correctly as determined at step then the method proceeds to step . The stored seed is accessed and decrypted if necessary. In one embodiment a current time is also determined from the clock in and an access code is generated using the seed the current time and an access code generation algorithm. The generated access code is then provided to the user on a display screen for example.

As described above an authentication system at the computer network fetches the remote device user s seed and calculates the access code that should have been generated at the remote device to determine whether remote access to the computer network should be granted.

Having described in detail several preferred embodiments of the present invention including the preferred methods of operation it is to be understood that this operation could be carried out with different elements and steps. The above preferred embodiments are presented only by way of example and are not meant to limit the scope of the invention described herein. An example of the wide scope of the invention is illustrated with . With reference to a remote device requires authentication information in order to access computer resources. . The remote device obtains the desired authentication information from an authentication system which in this example uses a two factor authentication technique when determining whether to grant access to the computer resources .

The remote device provides a request to the authentication system over a wireless connector system e.g. a wireless network gateway and or a wireless network which is then sent over a network to the two factor authentication system . The request includes identity information for use by the authentication system to authenticate the remote device based on the identity information provided in the request.

The authentication system checks whether there is authorization to provide authentication information to the remote device . The authentication system uses the supplied identity information to make the authorization check. If the authorization check succeeds then the authentication system provides the authentication information to the remote device . When the remote device is to access the computer resources the remote device s two factor code generator generates based upon the authentication information the access data that is needed to gain access to the computer resources .

Multiple remote devices and computer systems e.g. desktop computers laptops etc. may also use this approach to access the computer resources through the two factor authentication technique. Such an approach offers an alternative to known access code generators. For example where authentication information. must be requested and then used for remotely accessing a computer network an audit trail may be provided for remote access operations. Also if the authentication information is dynamic and thus valid only for a certain period of time then a user does not have required authentication information until it is needed reducing the likelihood that valid authentication information can be lost or given away by a user. Using authentication information distribution provides that static passwords can be rotated between users and provided to users when requested. Generation of access codes based on a current time synchronization between a local and remote clocks and checking received access codes against past and future access codes at an authentication system are thereby avoided.

Distribution of authentication information according to aspects of the present invention may be implemented in conjunction with or instead of access code generator based two factor authentication for remote access to a computer network. Where access code generators are used the user has possession of a specific code generator and provide the access code currently displayed on the code generator when remote access to the LAN is requested. Otherwise remote access to the LAN requires intervention by a network administrator or owner who manually authenticates the user before granting remote access to the LAN without the normal two factor authentication. A software based code generator installed on a remote device from which remote access is enabled alleviates misplaced hardware based code generators and allows secure seed distribution. Systems and methods of secure authentication information distribution disclosed herein reduce network administrator involvement and user inconvenience associated with known authentication schemes. For example distribution of authentication information alleviates remote network access problems when a required code generator is not available.

As yet another example of the wide applicability of the methods and systems disclosed herein where different computer systems or components at a computer network handle user authentication for authentication information distribution and remote access operations each such system or component may have an associated authentication information store. With reference to where the data server authenticates a user when a request for stored authentication information is received the data server may consult a further authentication information store not shown to check the authentication information in the request.

In addition authentication information distribution as described herein is also applicable to different types of communication systems than the system of . Although the LAN is remotely accessed via the WAN in a computer network could also or instead be accessible through one or more other types of networks including other LANs Wireless LANs WLANs Metropolitan Area Networks MANs and Neighbourhood Area Networks NANs for example.

Authentication information used for user authentication during remote access to a computer network differs from the identity information submitted in a request for authentication information. It should be appreciated that identity information and authentication information could include some common information. For example a password included in identity information in a request could be the same as a network password used as one factor for user authentication in a subsequent remote access operation. In this case a second authentication factor in the request might be a digital signature or a remote device serial number whereas a second authentication factor for remote access includes authentication information returned in response to the request or information generated from the returned authentication information. Thus the identity information and authentication information include different information but may also include some common authentication information.

Where an authentication information store is protected a scheme such as shown in is generally preferred in that communication traffic is avoided when access to the authentication information is denied. Alternatively when the authentication information is protected via password based encryption for example the authentication information is properly decrypted only when the password is entered correctly. Thus the password need not be explicitly checked as shown in . The authentication information could be retrieved and decrypted using the password as entered and sent to the computer network. If the password had not been entered correctly then the authentication information is not properly decrypted user authentication at the computer network fails and remote access to the computer network is denied.

As described above identity information in a request for authentication information preferably includes something that a user knows such as a password and something a user has indicated by a verified digital signature for example. Where user and remote device associations are available to computer network then an identifier of the remote device may be used as an authentication factor. Other implementations may similarly enable user or remote device information stored at the computer network to be exploited during an authentication information distribution operation. For example in one known implementation which provides for communications between a computer network such as the LAN and the mobile device the data server incorporates or operates in conjunction with a wireless connector system not shown which communicates with the mobile device through the wireless network gateway . A mobile device and user are enabled for communication with the LAN by establishing a user information record including a user or user account identifier and a mobile device identifier at the wireless connector system and storing a symmetric cryptographic key at both the wireless connector system and the mobile device . The symmetric key supports secure communications between the LAN and the mobile device . Information to be sent to the mobile device is encrypted by the wireless connector system and decrypted when received at the mobile device and vice versa. In this system where a request for authentication information is encrypted at a remote device and then sent to the LAN proper decryption of the encrypted request at the LAN indicates that the user submitting the request has the symmetric key. As such encryption of the request can serve as an authentication factor during authentication information distribution. Public private encryption key pairs could similarly be used.

The disclosed systems and methods are not dependent upon any particular type of authentication information to be distributed. Authentication information could be static or dynamic specific to a particular user or shared between multiple users and might be sent back to the computer network when remote access is required or used to generate further authentication information that is sent to the computer network to remotely access the network as in the case of a seed. The extent of remote access that is granted based on the authentication information may also be different than described above. The authentication information might grant access to all network resources or one or more particular network resources. Remote access could be further limited to a predetermined maximum period of time. In this case a remote access session established on the basis of authentication information returned in response to a request can be maintained only for the maximum period of time after which new authentication information must be requested to establish a new remote access session. Time and resource limited remote access provide for enhanced security in that an unauthorized user that obtains authentication information cannot obtain full unlimited access to a computer system.

Another optional security enhancement applicable to the systems and methods described above involves insertion of a time reference or sequence number in each request for authentication information. Even though authentication information is returned to a requestor over a secure channel to prevent an attacker from obtaining the authentication information it may be desirable to provide for detection of a replay attack in which a previous request is replayed to the computer network by an attacker. Where each request includes a sequence number or time reference the computer network can determine whether a request is a replay of an old request and take appropriate action to ignore the request and to identify the attacker for example.

The systems and methods disclosed herein may be used with many different devices such as the device shown in . depicts a wireless mobile communication device. The mobile device is preferably a two way communication device having at least voice and data communication capabilities. The mobile device preferably has the capability to communicate with other computer systems on the Internet. Depending on the functionality provided by the mobile device it may be referred to as a data messaging device a two way pager a mobile telephone with data messaging capabilities a wireless Internet appliance or a data communication device with or without telephony capabilities but is referred to herein primarily as a mobile device.

The mobile device includes a transceiver a microprocessor a display non volatile memory random access memory RAM auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and other device sub systems . The transceiver preferably includes transmit and receive antennas a receiver Rx a transmitter Tx one or more local oscillators LOs and a digital signal processor DSP . Within the non volatile memory the mobile device includes a plurality of software modules AN that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions.

The mobile device is preferably a two way communication device having voice and data communication capabilities. Thus for example the mobile device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network. References to the network should therefore be interpreted as encompassing both a single voice and data network and separate networks.

The communication subsystem is used to communicate with the network . The DSP is used to send and receive communication signals to and from the transmitter and receiver and also exchange control information with the transmitter and receiver . If the voice and data communications occur at a single frequency or closely spaced set of frequencies then a single LO may be used in conjunction with the transmitter and receiver . Alternatively if different frequencies are utilized for voice communications versus data communications or the mobile device is enabled for communications on more than one network then a plurality of LOs can be used to generate frequencies corresponding to those used in the network . Although two antennas are depicted in the mobile device could be used with a single antenna structure. Information which includes both voice and data information is communicated to and from the communication module via a link between the DSP and the microprocessor .

The detailed design of the communication subsystem such as frequency band component selection power level etc. is dependent upon the communication network in which the mobile device is intended to operate. For example a mobile device intended to operate in a North American market may include a communication subsystem designed to operate with the Mobitex or DataTAC mobile data communication networks and also designed to operate with any of a variety of voice communication networks such as Advanced Mobile Phone System AMPS TDMA CDMA PCS etc. whereas a mobile device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Communication network access requirements for the mobile device also vary depending upon the type of network . For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each device. In GPRS data networks however network access is associated with a subscriber or user of the mobile device . A GPRS device typically requires a subscriber identity module SIM which is required in order to operate the mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM but the mobile device is unable to carry out functions involving communications over the network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the mobile device is able to send and receive communication signals preferably including both voice and data signals over the network . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna . Although a single transceiver is shown for both voice and data communications in alternative embodiments the mobile device may include multiple distinct transceivers such as a first transceiver for transmitting and receiving voice signals and a second transceiver for transmitting and receiving data signals or a first transceiver configured to operate within a first frequency band and a second transceiver configured to operate within a second frequency band.

In addition to processing the communication signals the DSP also provides for receiver and transmitter control. For example the gain levels applied to communication signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . High level communication applications including the voice communication application A and the data communication application B are stored in the non volatile memory for execution by the microprocessor . For example the voice communication module A provides a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice devices via the network . Similarly the data communication module B provides a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the mobile device and a plurality of other data devices via the network .

The microprocessor also interacts with other device subsystems such as the display the RAM the auxiliary I O devices the serial port the keyboard the speaker the microphone the short range communications subsystem and any other device subsystems generally designated as . For example the modules A N are executed by the microprocessor and may provide a high level interface between a user of the mobile device and the mobile device. This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary 1. 0 devices keyboard speaker or microphone .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as keyboard and display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a persistent store such as the non volatile memory . In addition to the operating system and communication modules A N the non volatile memory may include a file system for storing data. The non volatile memory also includes at least an authentication information store for storing authentication information. The operating system specific device applications or modules or parts thereof are typically temporarily loaded into a volatile store such as the RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in the non volatile memory . The nonvolatile memory may be implemented for example with Flash memory non volatile RAM or battery backed up RAM.

An exemplary application module N that may be loaded onto the mobile device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module B for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The non volatile memory preferably provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless network . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless network with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

The mobile device is manually synchronized with a host system by placing the mobile device in an interface cradle which couples the serial port of the mobile device to a serial port of the host system. The serial port may also be used to download other application modules N for installation on the mobile device . This wired download path may further be used to load encryption keys onto the mobile device for use in secure communications which is a more secure method than exchanging encryption information via the wireless network .

Software application modules N may be loaded onto the mobile device through the network through an auxiliary I O subsystem through the short range communications subsystem or through any other suitable subsystem and installed by a user in the non volatile memory or RAM . Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device . The code generation system if the authentication information distributed as described above includes a seed is preferably implemented as a software module N in the nonvolatile memory . Such software applications as a browser or a messaging application in the non volatile memory support remote access to a computer network using distributed authentication information and two factor authentication at the computer network. The code generation software module or utility could be incorporated into or at least accessible from each remote access software application to provide for the access code insertion or copy and paste features described above.

When the mobile device is operating in a data communication mode a received signal such as a text message or a web page download is processed by the transceiver and provided to the microprocessor which preferably further processes the received signal for output to the display or alternatively to an auxiliary I O device . When data protection is enabled received data may be encrypted as described above before being stored on the mobile device . A user of mobile device may also compose data items such as email messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the mobile device is further enhanced with the plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user are then transmitted over the communication network via the transceiver and may also be stored in encrypted form on the mobile device .

When the mobile device is operating in a voice communication mode the overall operation of the mobile device is substantially similar to the data mode except that received signals are output to the speaker and voice signals for transmission are generated by a microphone . Alternative voice or audio I O devices such as a voice message recording subsystem may also be implemented on the mobile device . The display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module A and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

A short range communications subsystem is also included in the mobile device . For example the subsystem may include an infrared device and associated circuits and components or a BLUETOOTH or 802.11 short range wireless communication module to provide for communication with similarly enabled systems and devices.

It will be appreciated that the above description relates to preferred embodiments by way of example only. Many variations on the systems and methods described above will be obvious to those knowledgeable in the field and such obvious variations are within the scope of the invention as described whether or not expressly described.

For example a device in which systems and methods described above is implemented may include fewer further or different components than those shown in the drawings.

In addition seed distribution as described herein is also applicable to different types of communication systems than the system of . Although the LAN is remotely accessed via the WAN in a computer network could also or instead be accessed remotely through one or more other types of networks including other LANs Wireless LANs WLANs Metropolitan Area Networks MANs and National Area Networks NANs for example.

Still further examples of the wide scope of the systems and methods disclosed herein are illustrated in . describe additional uses of the systems and methods within different exemplary communication systems. is a block diagram showing an example communication system. In there is shown a computer system a WAN corporate LAN behind a security firewall wireless infrastructure wireless networks and and mobile devices and . The corporate LAN includes a message server a wireless connector system a data store including at least a plurality of mailboxes a desktop computer system having a communication link directly to a mobile device such as through physical connection to an interface or connector and a wireless VPN router . Operation of the system in will be described below with reference to the messages and .

The computer system may for example be a laptop desktop or palmtop computer system configured for connection to the WAN . Such a computer system may connect to the WAN via an ISP or ASP. Alternatively the computer system may be a network connected computer system that like the computer system accesses the WAN through a LAN or other network. Many modern mobile devices are enabled for connection to a WAN through various infrastructure and gateway arrangements so that the computer system may also be a mobile device.

The corporate LAN is an illustrative example of a central server based messaging system that has been enabled for wireless communications. The corporate LAN may be referred to as a host system in that it hosts both a data store with mailboxes for messages as well as possibly further data stores not shown for other data items that may be sent to or received from mobile devices and and the wireless connector system the wireless VPN router or possibly other components enabling communications between the corporate LAN and one or more mobile devices and . In more general terms a host system may be one or more computers at with or in association with which a wireless connector system is operating. The corporate LAN is one preferred embodiment of a host system in which the host system is a server computer running within a corporate network environment operating behind and protected by at least one security firewall . Other possible central host systems include ISP ASP and other service provider or mail systems. Although the desktop computer system and interface connector may be located outside such host systems wireless communication operations may be similar to those described below.

The corporate LAN implements the wireless connector system as an associated wireless communications enabling component which is normally a software program a software application or a software component built to work with at least one or more message server. The wireless connector system is used to send user selected information to and to receive information from one or more mobile devices and via one or more wireless networks and . The wireless connector system may be a separate component of a messaging system as shown in or may instead be partially or entirely incorporated into other communication system components. For example the message server may incorporate a software program application or component implementing the wireless connector system portions thereof or some or all of its functionality.

The message server running on a computer behind the firewall acts as the main interface for the corporation to exchange messages including for example electronic mail calendaring data voice mail electronic documents and other PIM data with the WAN which will typically be the Internet. The particular intermediate operations and computers are dependent upon the specific type of message delivery mechanisms and networks via which messages are exchanged and therefore have not been shown in . The functionality of the message server may extend beyond message sending and receiving providing such features as dynamic database storage for data like calendars todo lists task lists e mail and documentation as described above.

Message servers such as normally maintain a plurality of mailboxes in one or more data stores such as for each user having an account on the server. The data store includes mailboxes for a number of n user accounts. Messages received by the message server that identify a user a user account a mailbox or possibly another address associated with a user account or mailbox as a message recipient are stored in the corresponding mailbox . If a message is addressed to multiple recipients or a distribution list then copies of the same message are typically stored to more than one mailbox . Alternatively the message server may store a single copy of such a message in a data store accessible to all of the users having an account on the message server and store a pointer or other identifier in each recipient s mailbox . In typical messaging systems each user accesses his or her mailbox and its contents using a messaging client such as MICROSOFT OUTLOOK software or LOTUS NOTES software which normally operates on a PC such as the desktop computer system connected in the LAN . Although only one desktop computer system is shown in those skilled in the art will appreciate that a LAN will typically contain many desktop notebook and laptop computer systems. Each messaging client normally accesses a mailbox through the message server although in some systems a messaging client may enable direct access to the data store and a mailbox stored thereon by the desktop computer system . Messages may also be downloaded from the data store to a local data store not shown on the desktop computer system .

Within the corporate LAN the wireless connector system operates in conjunction with the message server . The wireless connector system may reside on the same computer system as the message server or may instead be implemented on a different computer system. Software implementing the wireless connector system may also be partially or entirely integrated with the message server . The wireless connector system and the message server are preferably designed to co operate and interact to allow the pushing of information to mobile devices . In such an installation the wireless connector system is preferably configured to send information that is stored in one or more data stores associated with the corporate LAN to one or more mobile devices through the corporate firewall and via the WAN and one of the wireless networks . For example a user that has an account and associated mailbox in the data store may also have a mobile device such as . As described above messages received by the message server that identify a user account or mailbox are stored to a corresponding mailbox by the message server . If a user has a mobile device such as messages received by the message server and stored to the user s mailbox are preferably detected by the wireless connector system and sent to the user s mobile device . This type of functionality represents a push message sending technique. The wireless connector system may instead employ a pull technique in which items stored in a mailbox are sent to a mobile device responsive to a request or access operation made using the mobile device or some combination of both techniques.

The use of a wireless connector thereby enables a messaging system including a message server to be extended so that each user s mobile device has access to stored messages of the message server . Although the systems and methods described herein are not restricted solely to a push based technique a more detailed description of push based messaging may be found in the United States patent and applications incorporated by reference above. This push technique uses a wireless friendly encoding compression and encryption technique to deliver all information to a mobile device thus effectively extending the company firewall to include the mobile devices .

As shown in there are several paths for exchanging information with a mobile device from the corporate LAN . One possible information transfer path is through the physical connection such as a serial port using an interface or connector . This path may be useful for example for bulk information updates often performed at initialization of a mobile device or periodically when a user of a mobile device is working at a computer system in the LAN such as the computer system . For example as described above PIM data is commonly exchanged over such a connection for example a serial port connected to an appropriate interface or connector such as a cradle in or upon which a mobile device may be placed. The physical connection may also be used to transfer other information from a desktop computer system to a mobile device including private security keys private keys such as private encryption or signature keys associated with the desktop computer system or other relatively bulky information such as Certs and CRLs used in some secure messaging schemes such as S MIME and PGP.

Private key exchange using a physical connection and connector or interface allows a user s desktop computer system and mobile device or to share at least one identity for accessing all encrypted and or signed mail. The user s desktop computer system and mobile device or can also thereby share private keys so that either the host system or mobile device or can process secure messages addressed to the user s mailbox or account on the message server . The transfer of Certs and CRLs over such a physical connection may be desirable in that they represent a large amount of the data that is required for S MIME PGP and other public key security methods. A user s own Cert a chain of Cert s used to verify the user s Cert and CRL as well as Certs Cert chains and CRLs for other users may be loaded onto a mobile device from the user s desktop computer system . This loading of other user s Certs and CRLs onto a mobile device allows a mobile device user to select other entities or users with whom they might be exchanging secure messages and to pre load the bulky information onto the mobile device through a physical connection instead of over the air thus saving time and wireless bandwidth when a secure message is received from or to be sent to such other users or when the status of a Cert is to be determined.

In known synchronization type wireless messaging systems a physical path has also been used to transfer messages from mailboxes associated with a message server to mobile devices and .

Another method for data exchange with a mobile device is over the air through the wireless connector system and using wireless networks . As shown in this could involve a Wireless VPN router if available in the network or alternatively a traditional WAN connection to wireless infrastructure that provides an interface to one or more wireless networks . The Wireless VPN router provides for creation of a VPN connection directly through a specific wireless network to a wireless device . Such a Wireless VPN router may be used in conjunction with a static addressing scheme such as IPV6.

If a wireless VPN router is not available then a link to a WAN normally the Internet is a commonly used connection mechanism that may be employed by the wireless connector system . To handle the addressing of the mobile device and any other required interface functions wireless infrastructure is preferably used. The wireless infrastructure may also determine a most likely wireless network for locating a given user and track users as they roam between countries or networks. In wireless networks such as and messages are normally delivered to and from mobile devices via RF transmissions between base stations not shown and the mobile devices .

A plurality of connections to wireless networks and may be provided including for example ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. The wireless networks and could represent distinct unique and unrelated networks or they could represent the same network in different countries and may be any of different types of networks including but not limited to data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same or similar infrastructure such as any of those described above.

In some implementations more than one over the air information exchange mechanism may be provided in the corporate LAN . In the exemplary communication system of for example mobile devices associated with users having mailboxes associated with user accounts on the message server are configured to operate on different wireless networks and . If the wireless network supports IPv6 addressing then the wireless VPN router may be used by the wireless connector system to exchange data with any mobile device operating within the wireless network . The wireless network may be a different type of wireless network however such as the Mobitex network in which case information may instead be exchanged with a mobile device operating within the wireless network by the wireless connector system via a connection to the WAN and the wireless infrastructure .

Operation of the system in will now be described using an example of an email message sent from the computer system and addressed to at least one recipient having both an account and mailbox or like data store associated with the message server and a mobile device or . However the e mail message is intended for illustrative purposes only. The exchange of other types of information between the corporate LAN is preferably also enabled by the wireless connector system .

The e mail message sent from the computer system via the WAN may be fully in the clear or signed with a digital signature and or encrypted depending upon the particular messaging scheme used. For example if the computer system is enabled for secure messaging using S MIME then the e mail message may be signed encrypted or both.

E mail messages such as normally use traditional SMTP RFC822 headers and MIME body parts to define the format of the e mail message. These techniques are all well known to one in the art. The e mail message arrives at the message server which determines into which mailboxes the e mail message should be stored. As described above a message such as the e mail message may include a user name a user account a mailbox identifier or other type of identifier that may be mapped to a particular account or associated mailbox by the message server . For an e mail message recipients are typically identified using e mail addresses corresponding to a user account and thus a mailbox .

The wireless connector system sends or mirrors via a wireless network or certain user selected data items or parts of data items from the corporate LAN to the user s mobile device or preferably upon detecting that one or more triggering events has occurred. A triggering event includes but is not limited to one or more of the following screen saver activation at a user s networked computer system disconnection of the user s mobile device or from the interface or receipt of a command sent from a mobile device or to the host system to start sending one or more messages stored at the host system. Thus the wireless connector system may detect triggering events associated with the message server such as receipt of a command or with one or more networked computer systems including the screen saver and disconnection events described above. When wireless access to corporate data for a mobile device or has been activated at the LAN when the wireless connector system detects the occurrence of a triggering event for a mobile device user for example data items selected by the user are preferably sent to the user s mobile device. In the example of the e mail message once a triggering event has been detected the arrival of the message at the message server is detected by the wireless connector system . This may be accomplished for example by monitoring or querying mailboxes associated with the message server or if the message server is a Microsoft Exchange server then the wireless connector system may register for advise syncs provided by the Microsoft Messaging Application Programming Interface MAPI to thereby receive notifications when a new message is stored to a mailbox .

When a data item such as the e mail message is to be sent to a mobile device or the wireless connector system preferably repackages the data item in a manner that is transparent to the mobile device so that information sent to and received by the mobile device appears similar to the information as stored on and accessible at the host system LAN in . One preferred repackaging method includes wrapping received messages to be sent via a wireless network in an electronic envelope that corresponds to the wireless network address of the mobile device to which the message is to be sent. Alternatively other repackaging methods could be used such as special purpose TCP IP wrapping techniques. Such repackaging preferably also results in e mail messages sent from a mobile device or appearing to come from a corresponding host system account or mailbox even though they are composed and sent from a mobile device. A user of a mobile device or may thereby effectively share a single e mail address between a host system account or mailbox and the mobile device.

Repackaging of the e mail message is indicated at and . Repackaging techniques may be similar for any available transfer paths or may be dependent upon the particular transfer path either the wireless infrastructure or the wireless VPN router . For example the e mail message is preferably compressed and encrypted either before or after being repackaged at to thereby effectively provide for secure transfer to the mobile device . Compression reduces the bandwidth required to send the message whereas encryption ensures confidentiality of any messages or other information sent to mobile devices and . In contrast messages transferred via a VPN router might only be compressed and not encrypted since a VPN connection established by the VPN router is inherently secure. Messages are thereby securely sent via either encryption at the wireless connector system which may be considered a non standard VPN tunnel or a VPN like connection for example or the VPN router to mobile devices and . Accessing messages using a mobile device or is thus no less secure than accessing mailboxes at the LAN using the desktop computer system .

When a repackaged message or arrives at a mobile device or via the wireless infrastructure or via the wireless VPN router the mobile device or removes the outer electronic envelope from the repackaged message or and performs any required decompression and decryption operations. Messages sent from a mobile device or and addressed to one or more recipients are preferably similarly repackaged and possibly compressed and encrypted and sent to a host system such as the LAN . The host system then removes the electronic envelope from the repackaged message decrypts and decompresses the message if desired and routes the message to the addressed recipients.

Another goal of using an outer envelope is to maintain at least some of the addressing information in the original e mail message . Although the outer envelope used to route information to mobile devices is addressed using a network address of one or more mobile devices the outer envelope preferably encapsulates the entire original e mail message including at least one address field possibly in compressed and or encrypted form. This allows original To From and CC addresses of the e mail message to be displayed when the outer envelope is removed and the message is displayed on a mobile device or . The repackaging also allows reply messages to be delivered to addressed recipients with the From field reflecting an address of the mobile device user s account or mailbox on the host system when the outer envelope of a repackaged outgoing message sent from a mobile device is removed by the wireless connector system . Using the user s account or mailbox address from the mobile device or allows a message sent from a mobile device to appear as though the message originated from the user s mailbox or account at the host system rather than the mobile device.

The wireless connector systems are similar to the wireless connector system described above in that it enables data items such as e mail messages and other items that are stored in mailboxes and possibly data items stored in a local or network data store to be sent from the LAN to one or more mobile devices . In however the network operator infrastructure provides an interface between the mobile devices and the LAN . As above operation of the system shown in will be described below in the context of an e mail message as an illustrative example of a data item that may be sent to a mobile device .

When an e mail message addressed to one or more recipients having an account on the message server is received by the message server the message or possibly a pointer to a single copy of the message stored in a central mailbox or data store is stored into the mailbox of each such recipient. Once the e mail message or pointer has been stored to a mailbox it may be accessed using a mobile device or . In the example shown in the email message has been addressed to the mailboxes associated with both desktop computer systems and and thus both mobile devices and .

As those skilled in the art will appreciate communication network protocols commonly used in wired networks such as the LAN and or the WAN are not suitable or compatible with wireless network communication protocols used within wireless networks such as . For example communication bandwidth protocol overhead and network latency which are primary concerns in wireless network communications are less significant in wired networks which typically have much higher capacity and speed than wireless networks. Therefore mobile devices and cannot normally access the data store directly. The network operator infrastructure provides a bridge between the wireless network and the LAN .

The network operator infrastructure enables a mobile device to establish a connection to the LAN through the WAN and may for example be operated by an operator of the wireless network or a service provider that provides wireless communication service for mobile devices and . In a pull based system a mobile device may establish a communication session with the network operator infrastructure using a wireless network compatible communication scheme preferably a secure scheme such as Wireless Transport Layer Security WTLS when information should remain confidential and a wireless web browser such as a Wireless Application Protocol WAP browser. A user may then request through manual selection or pre selected defaults in the software residing in the mobile device any or all information or just new information stored in a mailbox in the data store at the LAN . The network operator infrastructure then establishes a connection or session with a wireless connector system using Secure Hypertext Transfer Protocol HTTPS for example if no session has already been established. As above a session between the network operator infrastructure and a wireless connector system may be made via a typical WAN connection or through the VPN router if available. When time delays between receiving a request from a mobile device and delivering requested information back to the device are to be minimized the network operator infrastructure and the wireless connector systems may be configured so that a communication connection remains open once established.

In the system of requests originating from mobile device A and B would be sent to the wireless connector systems and respectively. Upon receiving a request for information from the network operator infrastructure a wireless connector system retrieves requested information from a data store. For the e mail message the wireless connector system retrieves the e mail message from the appropriate mailbox typically through a messaging client operating in conjunction with the computer system which may access a mailbox either via the message server or directly. Alternatively a wireless connector system may be configured to access mailboxes itself directly or through the message server . Also other data stores both network data stores similar to the data store and local data stores associated with each computer system may be accessible to a wireless connector system and thus to a mobile device .

If the e mail message is addressed to the message server accounts or mailboxes associated with both computer systems and and devices and then the e mail message may be sent to the network operator infrastructure as shown at and which then sends a copy of the e mail message to each mobile device and as indicated at and . Information may be transferred between the wireless connector systems and the network operator infrastructure via either a connection to the WAN or the VPN router . When the network operator infrastructure communicates with the wireless connector systems and the mobile devices via different protocols translation operations may be performed by the network operator infrastructure . Repackaging techniques may also be used between the wireless connector systems and the network operator infrastructure and between each mobile device and the network operator infrastructure .

Messages or other information to be sent from a mobile device may be processed in a similar manner with such information first being transferred from a mobile device to the network operator infrastructure . The network operator infrastructure may then send the information to a wireless connector system for storage in a mailbox and delivery to any addressed recipients by the message server for example or may alternatively deliver the information to the addressed recipients.

The above description of the system in relates to pull based operations. The wireless connector systems and the network operator infrastructure may instead be configured to push data items to mobile devices and . A combined push pull system is also possible. For example a notification of a new message or a list of data items currently stored in a data store at the LAN could be pushed to a mobile device and then be used to request messages or data items from the LAN via the network operator infrastructure .

If mobile devices associated with user accounts on the LAN are configured to operate within different wireless networks then each wireless network may have an associated wireless network infrastructure component similar to .

Although separate dedicated wireless connector systems are shown for each computer system in the system of one or more of the wireless connector systems may preferably be configured to operate in conjunction with more than one computer system or to access a data store or mailbox associated with more than one computer system. For example the wireless connector system may be granted access to the mailboxes associated with both the computer system and the computer system . Requests for data items from either mobile device A or B may then be processed by the wireless connector system . This configuration may be useful to enable wireless communications between the LAN and the mobile devices and without requiring a desktop computer system to be running for each mobile device user. A wireless connector system may instead be implemented in conjunction with the message server to enable wireless communications.

The wireless connector system provides for transfer of data items stored at the LAN to one or more mobile devices . These data items preferably include e mail messages stored in mailboxes in the data store as well as possibly other items stored in the data store or another network data store or a local data store of a computer system such as .

As described above an e mail message addressed to one or more recipients having an account on the message server and received by the message server is stored into the mailbox of each such recipient. In the system of the external data store preferably has a similar structure to and remains synchronized with the data store . PIM information or data stored at data store is preferably independently modifiable to the PIM information or data stored at the host system. In this particular configuration the independently modifiable information at the external data store may maintain synchronization of a plurality of data stores associated with a user i.e. data on a mobile device data on a personal computer at home data at the corporate LAN etc. . This synchronization may be accomplished for example through updates sent to the data store by the wireless connector system at certain time intervals each time an entry in the data store is added or changed at certain times of day or when initiated at the LAN by the message server or a computer system at the data store or possibly by a mobile device through the access gateway . In the case of the e mail message an update sent to the data store some time after the e mail message is received may indicate that the message has been stored in a certain mailbox in the store and a copy of the email message will be stored to a corresponding storage area in the data store . When the e mail message has been stored in the mailboxes corresponding to the mobile devices and for example one or more copies of the e mail message indicated at and in are sent to and stored in corresponding storage areas or mailboxes in the data store . As shown updates or copies of stored information in the data store may be sent to the data store via a connection to the WAN or the VPN router . For example the wireless connector system may post updates or stored information to a resource in the data store via an HTTP post request. Alternatively a secure protocol such as HTTPS or Secure Sockets Layer SSL may be used. Those skilled in the art will appreciate that a single copy of a data item stored in more than one location in a data store at the LAN may instead be sent to the data store . This copy of the data item could then be stored either in more than one corresponding location in the data store or a single copy may be stored in the data store with a pointer or other identifier of the stored data item being stored in each corresponding location in the data store .

The access gateway is effectively an access platform in that it provides mobile devices and with access to the data store . The data store may be configured as a resource accessible on the WAN and the access gateway may be an ISP system or WAP gateway through which mobile devices and may connect to the WAN . A WAP browser or other browser compatible with the wireless networks and may then be used to access the data store which is synchronized with the data store and download stored data items either automatically or responsive to a request from a mobile device . As shown at and copies of the e mail message which was stored in the data store may be sent to the mobile devices and . A data store not shown on each mobile device may thereby be synchronized with a portion such as a mailbox of a data store on a corporate LAN . Changes to a mobile device data store may similarly be reflected in the data stores and .

