---

title: Intergrated service management system
abstract: The present invention provides techniques for creation, operation, management, and access control of network-based storage services. Specific embodiments provide improved efficiency of the service management tasks used for designing, operating and accounting the robust and profitable network services, for example. In representative embodiments, techniques for constructing integrated network and storage services are provided. In a specific embodiment, the service comprises of three major service components: virtual private networks (VPN), application servers and storage area networks (SAN). Each of these service components has its own customer identification information, such as VPN identifier for VPN services, process identifier for application servers and logical unit number (LUN) for storage devices.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07962601&OS=07962601&RS=07962601
owner: Hitachi, Ltd.
number: 07962601
owner_city: Tokyo
owner_country: JP
publication_date: 20100212
---
This application is a continuation of U.S. application Ser. No. 11 923 587 filed Oct. 24 2007 now U.S. Pat. No. 7 693 980 which is a continuation of U.S. application Ser. No. 09 964 129 filed Sep. 25 2001 now U.S. Pat. No. 7 379 987 which is a continuation in part of U.S. application Ser. No. 09 841 710 by common inventors TAKESHI ISHIZAKI and SHIGERU MIYAKE filed Apr. 24 2001 now U.S. Pat. No. 7 099 912 and entitled INTEGRATED SERVICE MANAGEMENT SYSTEM . Application Ser. Nos. 11 923 587 09 964 129 and 09 841 710 are fully incorporated herein by reference for all purposes.

The present invention relates generally to techniques for managing storage and in particular to techniques for creation operation management and access control of network based storage services.

Conventional network based value added services comprises of more than one service components. For example outsourcing service of enterprise application over Internet involves network access services via the Internet hosting service of Web servers and database servers and storage management services. Each service component may be provided by different service providers or may be served by one consolidated service provider. While certain advantages to such conventional approaches are perceived opportunities for further improvement exist. For example according to conventional network management technology managing such complicated service systems to keep the service up and running can be a challenging task to the service operators.

What is needed are improved techniques for creation operation management and access control of network based storage services.

The present invention provides techniques for creation operation management and access control of network based storage services. Specific embodiments provide improved efficiency of the service management tasks used for designing operating and accounting the robust and profitable network services for example. In representative embodiments techniques for constructing integrated network and storage services are provided. In a specific embodiment the service comprises of three major service components virtual private networks VPN application servers and storage area networks SAN . Each of these service components has its own customer identification information such as VPN identifier for VPN services process identifier for application servers and logical unit number LUN for storage devices.

In some specific embodiments service customers are connected to the service provider through VPN. The VPN path that connects customer sites and the data center of the service provider are terminated on a VPN termination device or a VPN router. Within the VPN router multiple routing processing programs or virtual routers VR run independently. The VPN router is connected to the application servers via virtual LAN VLAN switch. These application servers are then connected to the service provider s SAN.

The integrated service management system collects management information from individual management systems corresponding to each service components VPN servers and SAN and holds mappings or relationship information between resources in each service component and the customer who is allowed to use those resources. For example VPN management system is responsible for mapping between VPN customer and VPN path used by that customer. Similarly server management systems assign a number of servers to a certain customer. Integrated service management systems collect this kind of mapping information between customers and resources within service components. An application programming interface API enables software developers to implement management applications using the functionality of the integrated service management systems.

In a representative embodiment according to the present invention a system is provided. The system comprises a connection to a virtual private network and a router which is connected to the virtual private network. The router maintains at least one virtual router for a client. The system further comprises at least one server and a virtual LAN switch which is connected to the router. The server can be apportioned into one or more logical partitions. The virtual LAN switch provides selectable forwarding for information from the router to at least one logical partition of the server. The system also includes at least one volume and an FC switch. The FC switch provides selectable interconnection between the at least one logical partitions of the server and the at least one volume so that information received from a plurality of sources via the virtual private network is directed to a particular virtual router for each of the sources by the router. In some specific embodiments a virtual private network management system controls operation of the router. The information is then directed to a particular one of the logical partitions of the server for each of the sources by the virtual LAN switch. In some specific embodiments a server management system controls operation of the virtual LAN switch. The information is then directed to a particular volume for each of the sources by the FC switch. In some specific embodiments a storage management system controls operation of the FC switch.

In a representative specific embodiment in which a virtual private network management system is used to control the router the virtual private network management system comprises a network interface module that receives commands from an integrated service management system a service order processing module that analyzes and executes the commands updates a table of virtual private network information and sends new configuration information to the router through a control module. In some specific embodiments the virtual service management system further comprises a virtual private network table. The virtual private network table has a VPN ID that identifies a specific VPN an Address 1 and an Address 2 that hold IP addresses of two end points of the specific VPN a Protocol that specifies a VPN protocol that is used on the specific VPN an Internet that indicates whether access to public Internet is permitted and a VLAN ID that is assigned to packets received over the specific VPN.

In another representative embodiment an integrated service management system is used to control operation of other management systems. In a specific embodiment the integrated service management system comprises a network interface module that receives requests to change configuration a service order processing module that analyzes and executes requests to change configuration received by the network interface module updates related table cache in a service management database and sends new configuration information using the network interface module. In some specific embodiments the integrated service management system further comprises a service configuration table that stores destination information. In select embodiments the integrated service management system further comprises a server table that stores a server table said server table having a server identification an address a physical server identifier a virtual LAN identification a logical partition LPAR identification a host bus adaptor HBA identification an application identification an operating system identifier and a CPU information for example. In some specific embodiments the integrated service management system further comprises a storage table that stores storage table having a volume identifier a port identifier an allowed host bus adapter s HBAs identifier a capacity identifier and an access information. The integrated service management system further comprises a service mapping table that stores a customer identifier a virtual private network identifier a server identifier and a volume identifier in some specific embodiments. In some embodiments the integrated service management system further comprises a service status table that stores a customer identifier a virtual private network status a server status and a volume status.

In some specific embodiments an operator console application sends a request command to change service configuration to the integrated management system. In select specific embodiments a customer portal application sends a request command to change service configuration to the integrated management system.

In another representative embodiment a method for managing storage is provided. The method comprises receiving a request to change a configuration of an integrated storage and networking system analyzing the request to determine a new configuration updating configuration tables to reflect the new configuration and sending new configuration information to at least one of a plurality of subsystem managers. The configuration tables may comprise a mapping between a logical partition and at least one of a plurality of HBAs attached thereto for example.

In another representative embodiment a method for managing a configuration for a virtual private network is provided. The method comprises receiving at a subsystem manager a request to change to a new configuration for a virtual private network of an integrated storage and networking system analyzing the request to determine a new configuration for the virtual private network of the integrated storage and networking system updating configuration tables to reflect the new configuration and sending commands to a virtual private network router to implement the new configuration. The configuration tables may comprise a mapping between a logical partition and at least one of a plurality of HBAs attached thereto for example.

In another representative embodiment a method for managing a configuration for at least one of a plurality of servers is provided. The method comprises receiving at a subsystem manager a request to change to a new configuration for at least one of a plurality of servers in an integrated storage and networking system analyzing the request to determine a new configuration for the at least one of a plurality of servers in the integrated storage and networking system updating configuration tables to reflect the new configuration and sending commands to a virtual LAN switch to implement the new configuration. The configuration tables may comprise a mapping between a logical partition and at least one of a plurality of HBAs attached thereto for example.

In another representative embodiment a method for managing a configuration for at least one of a plurality of storage devices is provided. The method comprises receiving at a subsystem manager a request to change to a new configuration for at least one of a plurality of storage devices of an integrated storage and networking system analyzing the request to determine a new configuration for the at least one of a plurality of storage devices of the integrated storage and networking system updating configuration tables to reflect the new configuration and sending commands to a fibre channel switch to implement the new configuration. The configuration tables may comprise a mapping between a logical partition and at least one of a plurality of HBAs attached thereto for example.

In another representative embodiment an apparatus is provided. The apparatus comprises a connection to a virtual private network a router that is connected to the virtual private network. The router maintains at least one virtual router for a client and at least one server. The server can be apportioned into one or more logical partitions. The apparatus further includes a virtual LAN switch connected to the router. The virtual LAN switch provides selectable forwarding for information from the router to at least one logical partition of the server. The apparatus also includes at least one volume and an FC switch. The FC switch provides selectable interconnection between the at least one logical partitions of the server and the at least one volume so that information received from a plurality of sources via the virtual private network is directed to a particular virtual router for each of the sources by the router. In some specific embodiments a virtual private network management system controls operation of the router. The information is then directed to a particular one of the logical partitions of the server for each of the sources by the virtual LAN switch. In some specific embodiments a server management system controls operation of the virtual LAN switch. The information is then directed to a particular volume for each of the sources by the FC switch. In some specific embodiments a storage management system controls operation of the FC switch.

Numerous benefits are achieved by way of the present invention over conventional techniques. Specific embodiments according to the present invention provide the capability to integrate and manage customer identification information for each of the service components as a whole by the integrated service management systems. This enables the service operator to configure monitor and manage the service on per customer or per service basis. By selecting a certain customer the operator can focus on the end to end service from the customer site to access network to application servers and storage devices pertaining to the selected customer.

As customer identification information for each of the service components is automatically mapped by the integrated service management systems in specific embodiments it is not necessary for the operator of the service provider to manually configure each service component.

These and other benefits are described throughout the present specification. A further understanding of the nature and advantages of the invention herein may be realized by reference to the remaining portions of the specification and the attached drawings.

The present invention provides techniques for creation operation and management of network based storage services. Specific embodiments provide improved efficiency of the service management tasks used for designing operating and accounting the robust and profitable network services for example. In representative embodiments techniques for constructing integrated network and storage services are provided. In a specific embodiment the service comprises of three major service components virtual private networks VPN application servers and storage area networks SAN . Each of these service components has its own customer identification information such as VPN identifier for VPN services process identifier for application servers and logical unit number LUN for storage devices.

In a U.S. Pat. Ser. No. 6 205 488 entitled Internet protocol virtual private network realization using multi protocol label switching tunnels which is incorporated by reference herein in it entirety for all purposes one method for constructing VPN over a packet based network using multi protocol label switching MPLS technology is described. There are also several techniques to build a virtual private network over public IP networks. For example IPsec point to point tunneling protocol PPTP and layer 2 tunneling protocol L2TP may be used to set up a tunneling path between customer owned network equipment such as VPN routers and firewalls. Other forms of VPN are a network based VPN. An example of this type of VPN is described in RFC2547 BGP MPLS VPNs which is incorporated by reference herein in its entirety for all purposes.

However a need still exists to support integration and mapping between VPN and application services. Further other service components have their own service management systems. For example storage area network SAN can be managed using SAN management software.

According to the present invention a plurality of services is used to combine virtual private network VPN services application services and storage access services. This service is referred to as Secure storage access service SSAS in this document.

Virtual private network VPN service provides secure network path between the customer site and the data center of the service provider over the shared public network such as the Internet. Traffic that goes through VPN path may or may not be encrypted to prevent eavesdropping in various specific embodiments. Each of the VPN service customers has one or more sites to be connected to the VPN. For example in Customer A has two sites Aa and Ab . Each VPN site is an end point of a VPN path. The other end point of the VPN path is on the VPN router which resides in the data center of the service provider.

The VPN router in the data center aggregate multiple VPN paths identify the customer by VPN ID and direct the traffic received from the customer to the virtual LAN VLAN switch . Within the VPN router there are multiple virtual router VR programs each serving the different VPN customers. For example in the VPN paths from service customer A are terminated at the virtual router A in the VPN router . Similarly the VPN paths from customer B are connected to the VR B. Because each VR has its own routing table and other network resources dedicated to the customer it serves packets from each VPN customer are clearly separated from the network point of view. This enables for example two different customers to use the same overlapping IP address spaces within a private address range.

When a VR A receives packets from one of VPN path of customer A it then adds to them the VLAN tag for customer A and sends them to the VLAN switch. The VLAN tag is the information added to the LAN frame so that more than two logically independent networks can be overlaid on the same LAN segment. The more detailed specification of VLAN tag is defined in the IEEE 803.1q standard. The VPN service is one of the service components or subsystems that comprise SSAS and is managed by the VPN management system which will be described herein below.

Application service comprises of one or more application servers Servers . Each service customer is assigned to one or more Servers. For a larger service customer who requires a lot of server processing capacity such as CPU time more than one server can be assigned for load balancing. On the other hand for a smaller customer who doesn t use much CPU and wants to reduce the service cost one application server can be shared among more than one service customers. In the latter case more than one application processes may be run on the shared application server.

In customer A uses two servers S Aa and S Ab while customers C and D share one server S CD . Each application server belongs to a certain VLAN. As VLAN switch on the VLAN segment is configured to transfer VLAN tagged packets from VPN router to an appropriate server connected to the VLAN segment it is not necessary for servers to know to which VLAN they belong.

Each application server has one or more host bus adapters HBA that connect the server to a storage area network SAN . From the SAN point of vie each server is identified by its HBA address or port. In the configuration illustrated by each server is connected to a fibre channel FC switch which performs the switching functions of the SAN. Application service is one of the service components or subsystems that comprise SSAS and is managed by the server management system which will be described herein below.

Storage service comprises of multiple storage devices or volumes. Each storage volume is configured to accept accesses from a specific application server. Application servers and storage volumes are connected via the storage area network SAN . In FC switch of the SAN is used to connect servers and volumes. In order to segregate servers and volumes for different service customers the FC switch and or storage volumes are configured so that access to a specific storage volume is restricted to one or more specific servers. When incorporated into FC switches this functionality is called port zoning. When incorporated into storage devices this functionality is often called LUN security where LUN stands for logical unit number.

In server S Aa and S Ab can access volume V Aa and V Ab. Server S B uses volume V B. Server S CD gains access to volumes V CDa and V CDb. The FC switch is configured to manage the storage access as described above. Storage service is one of the service components or subsystems that comprise SSAS and is managed by the storage management system which will be described herein below.

Integrated service management system ISMS is the management server and programs running on it. Integrated service management system ISMS communicates with the subsystem management system SMS that controls and manages each service component comprising the SSAS. The ISMS includes application programming interfaces that can be used to develop application programs such as an operator console program. Service provider operators can communicate with ISMS by using operator console application . Service customers can communicate with ISMS by using customer portal applications . The ISMS communicates with other management components such as SMS and applications through management network .

The information for mapping between VPN path and VLAN tags associated with the VPN path is stored in a VPN table in a VPN database . The contents of the VPN table will be described later with reference to . System operation module controls the starting up and shutting down of the VPN SMS and executes common tasks including operating system tasks. Input output module processes the input output events of the VPN SMS .

Service order processing module is responsible for processing service orders received by network interface module . When ISMS sends a request command or a service order to VPN SMS in order to change VPN configuration the command packet is received by the network interface module of VPN SMS . Then the service order processing module analyzes and executes the command request updates the VPN table and sends the new configuration information to the VPN router through the VPN control module . A database access module is used to read data from or write data into VPN database as requested by other modules of VPN SMS .

A service order processing module is responsible for processing service orders received by network interface module . When operator console application or customer portal application sends a request command or a service order to ISMS in order to change service configuration the command packet is received by the network interface module of ISMS . Then the service order processing module analyzes and executes the command request updates related table caches in service management database and sends the new configuration information to the related SMSs through the network interface module .

A database access module is used to read data from or write data into the service management database as requested by other modules of the ISMS . Stored within the service management database are a number of tables which ISMS uses to control and manage the SSAS. Service configuration table service mapping table and service status table are described below.

The ISMS comprises a VPN table cache server table cache and storage table cache which are copies of the corresponding tables managed by SMSs respectively. For example VPN table cache is a copy of a VPN table that is stored in VPN SMS and collected by ISMS . The contents of VPN table server table and storage table are described below.

In this way ISMS can accept the configuration command on a per customer basis and translate it into the command request to the subsystems with subsystem specific identification information.

In specific embodiments of the present invention logical partitioning techniques may be applied to high end application servers to provide enhanced security and access control. Some servers especially those created for high end market have a capability called logical partitioning. A logical partition is a logical entity implemented on a single physical computer. It is possible to have more than one logical partition on a single physical computer. If multiple logical partitions reside on a computer each one of the partitions is independent from the other. Each partition can contain a different operating system within it. In addition application programs that run on a certain logical partition would not see any other applications that run on other logical partitions. Therefore from an application s point of view a logical partition acts as if it is a single independent computer system even though the logical partitions reside in the same physical computer.

By using logical partitioning service providers can serve more customers with the same number of servers. This means that the service providers can save the floor space of data centers which is becoming an increasingly scarce resource due to fast growing server needs. As each logical partition is logically separate and there is no interaction between them even if multiple customers share one physical server these customers can preserve information confidentiality and avoid system crashes caused by other customers actions.

In the example shown in a physical server P contains three logical partitions L L and L while P has a single logical partition L . Physical server P is equipped with four HBAs H through H . Among these four HBAs H and H are associated with L and H and H are associated with L and L respectively. In physical server P there is only one logical partition L and one HBA H . Though it is not shown in this example it is also possible for more than one logical partition to share the same HBA.

As access security in the storage area network is controlled on a per HBA basis the storage management subsystem manages which HBA is allowed to access which storage volumes.

Within server table Server identifies one of application servers within the server subsystem. Address holds the IP address of that server. Physical Server holds the id of the physical server in which the application server is contained. VLAN ID is the VLAN tag value assigned to that server. LPAR ID is the unique id that identifies the logical partition on which the application server runs. HBA ID specifies which HBA is attached to the logical partition. The actual value of HBA ID depends on the protocol used in the storage area network. For example in the Fibre Channel based network the world wide name of the HBA is used as an HBA ID.

 Application OS and CPU indicate the application running on the server operating systems of the server and CPU processing capability such as CPU speed respectively.

Note that servers such as S Aa S Ab and S B are logical notions of the application server. They are identified by a combination of a physical server and a logical partition in it. Thus according to the configuration shown in servers S Aa S Ab and S B are on the same physical computer P and their LPAR IDs are L L and L respectively. Server S CD on the other hand is on the physical computer P which holds a single logical partition L .

The ISMS collects mapping information from server SMS and storage SMS and combines the mapping information into the service mapping table of and the service status table of . The remaining operation is substantially similar to the processing of the specific embodiments discussed herein above with respect to .

The preceding has been a description of the preferred embodiment of the invention. It will be appreciated that deviations and modifications can be made without departing from the scope of the invention which is defined by the appended claims.

