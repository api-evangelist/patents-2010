---

title: System and method for protecting files stored on an electronic device
abstract: An electronic device includes a security system which provides for protection of designated files stored on an electronic device. For example, an electronic device may receive user input selecting a file for protection processing. The user input may select the file for encryption and automatic decryption under certain predetermined conditions and/or for automatic saving to a remote storage device after the device has been reported stolen, for instance. After receiving the user input selecting the file for protection processing, the electronic device may automatically receive theft information from a remote server, wherein the theft information indicates whether the electronic device has been reported stolen. After determining whether the electronic device has been reported stolen, the electronic device may automatically process the selected file according to the selected protection processing, wherein the processing is contingent on whether the electronic device has been reported stolen. Other embodiments are described and claimed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09336393&OS=09336393&RS=09336393
owner: Softex Incorporated
number: 09336393
owner_city: Austin
owner_country: US
publication_date: 20101012
---
This application is a continuation in part of U.S. application Ser. No. 11 484 098 filed on Jul. 11 2006 incorporated herein by reference which in turn claims priority to U.S. application Ser. No. 10 925 161 filed on Aug. 23 2004 now U.S. Pat. No. 7 590 837 incorporated herein by reference which in turn claims priority under 35 USC 119 e 1 to Provisional Application No. 60 497 182 filed Aug. 23 2003 incorporated herein by reference.

Theft of electronic devices containing costly hardware and software has become increasingly common. Such thefts may occur because of the value of the electronic device hardware or for access to information contained on the electronic device s storage accessories such as credit card information confidential and proprietary business information and so on. Another use of the stolen device may be to gain access to servers containing confidential information through the electronic device.

Physical attachment of the electronic device to the user or an immovable object is one way of preventing theft. Password protection schemes may also be used to discourage theft or at least stop the thief from accessing the information stored on the electronic device. Motion sensors or alarms placed on the electronic device may be another impediment to the would be thief. However such techniques do not always prevent theft are costly and once the electronic device is stolen do not allow tracking or recovery.

The problems noted above are solved in large part by the electronic device security and tracking system and method ESTSM that includes a plurality of hardware software and firmware components that cooperate to allow tracking disabling and other interaction with the stolen electronic device. The ESTSM electronic device hereinafter electronic device and the ESTSM server computer system communicate over a communication channel to determine if the user has registered for ESTSM services. The user may be an individual consumer user or a corporate government user. The corporate government user s electronic device may be part of a corporation s or government organization s customized ESTSM system. If the electronic device is not registered for ESTSM services then upon first time power on and connection to the ESTSM server of the electronic device that includes ESTSM software and firmware the user is prompted to register for different ESTSM services. Alternatively ESTSM may remain disabled and the user may register using techniques that include but are not limited to selecting a menu option for registration or selecting an icon on the electronic device s desktop or via World Wide Web pages from a remote system other than the ESTSM device itself. The electronic device may be a laptop computer desktop computer wearable computer server computer system personal digital assistant PDA cellular telephone WLAN capable computer Smart Phone tablet personal computer palm top device and so forth. Each of the services may consist of different monthly yearly or multi year service fees or a one time fee for the life of the electronic device. After registration is complete the ESTSM server computer system communicates over the Internet or another communication protocol such as Short Messaging Service SMS with the user to determine if an electronic device has been reported stolen. In accordance with some embodiments of the invention if the device is reported stolen the ESTSM server may inform the ESTSM device via a secure communications channel to take the appropriate action based on the service options selected by the user e.g. disabling the electronic device destroying the storage device e.g. hard disk drive HDD data recovering data encrypting data and more . In some other embodiments of the invention an automated voice prompting system at a call center or live call center operator after authentication of the user may communicate with the user to perform ESTSM activities. All ESTSM activities performed through the Internet may also be performed by the call center including registration reporting a system stolen reporting system has been recovered and so forth.

The ESTSM system may include an electronic device with three components and a server computer system. The three components may be an application component a non viewable component and a Basic Input Output System BIOS component. In some embodiments of the invention the application component includes ESTSM application software that executes under any Windows operating system OS . In other embodiments of the invention the application component software may execute under the Disk Operating System DOS Linux operating system Windows CE and its derivatives such as Windows Mobile Smart Phone Pocket PC and so on Symbian and Palm operating system and others. In some embodiments of the invention the application component is responsible for communicating over the Internet with the ESTSM server computer system to determine if the electronic device has been reported stolen. If the device has been reported stolen the application component along with the ESTSM server computer system will determine what services the user has registered for and will take the appropriate action e.g. disable the device communicate identifying information to the server erase the storage device recover data encrypt data etc .

In some embodiments of the invention the communication medium may be a messaging protocol such as Short Messaging Service SMS used in mobile devices such as cell phones and computers using Wireless Local Area Networks WLAN services from wireless service providers such as Verizon Wireless . In such systems the server computer system would inform the application component that the device had been reported stolen without the application component querying the server system to determine if the electronic device has been reported stolen.

In some embodiments of the invention the non viewable component may reside in a hidden partition on the hard disk drive HDD. Alternatively in some other embodiments of the invention the non viewable component may reside in the Host Protected Area HPA of the HDD that is not accessible by the operating system of the electronic device. The non viewable component may include a VALIDATOR program that inspects an ESTSM Communications Area ECA to determine if the ESTSM application components have run correctly during the last system boot. The non viewable component may also contain a copy of the original application component software fileset if the files need to be re installed to the HDD.

ESTSM also consists of a BIOS component that maintains the secured environment of the ESTSM application component. The BIOS component includes a secure nonvolatile area that stores critical information present after electronic device power off and accessible during electronic device power on and boot. If only the application component was provided a simple low level format of the hard disk drive would remove the application and bypass all the security features. ESTSM implements an application BIOS and non viewable component based solution to electronic device security. The ESTSM BIOS components ensure that a thief cannot bypass or circumvent the ESTSM application from running.

On every boot the BIOS component will check and ensure that the ESTSM application components have not been deleted or tampered with. If the BIOS component detects a problem with any of the application components it will restore the components from a special hidden partition on the hard disk drive or from system recovery media. In some embodiments of the invention the recovery media may be a floppy diskette but in other embodiments the recovery media may be a Compact Disc Read Only Memory CD ROM Universal Serial Bus USB key storage device or other storage device accessible during device boot.

In other embodiments of the invention as mentioned above the electronic device in the ESTSM may include a HDD that contains a HPA. The HPA is not accessible by the operating system of the electronic device or by the user of the electronic device. An ESTSM application component including ESTSM application software may be present on the HDD. The HPA may include an ESTSM non viewable component. The ESTSM electronic device may also include an ESTSM BIOS component that is capable of communicating with the non viewable component and application component. An ESTSM server computer system communicates with the other components through an ESTSM Communications Area ECA located on the HDD.

In some embodiments of the invention the ESTSM system may include an electronic device with a BIOS component an application component and a server computer system. On every boot the BIOS component will check and ensure that the ESTSM application components have not been deleted or tampered with. If the BIOS component detects a problem with any of the application components it will assume that the ESTSM application components will be installed by the user of the electronic device. If the application component is not installed after a number of unsuccessful attempts the BIOS component will prevent the user from accessing the electronic device. The application component may be installed by downloading from the ESTSM website or from recovery media that came with the device.

In some other embodiments of the invention the electronic device in the ESTSM includes a Flash memory and may be a PDA mobile cellular telephone or WLAN capable computer. The Flash memory may contain a changeable area and a system area. The system area is not changeable by the user of the electronic device. The ESTSM application software may reside in the changeable area or the system area depending on the security requirements of the device implementation. An ESTSM server computer system communicates to the ESTSM application software on the electronic device through communication channels that may be the Internet a wireless medium such as SMS a combination of the two and so on. The PDA mobile cellular telephone or WLAN capable computer may be continuously connected to the ESTSM server computer system through an always on Internet connection or other mobile device communication protocols such as Short Messaging Service SMS .

In some embodiments of the invention a machine readable medium provides instructions which when executed by an electronic device enable the electronic device to perform operations such as accepting a designation of a file stored in the electronic device and subsequently processing the file according to the designation wherein the processing is contingent on whether the electronic device has been reported stolen. Such a machine readable medium may be transitory or non transitory.

In addition to the foregoing other method system and machine readable medium aspects of the invention are described in the claims drawings and text forming a part of the present disclosure.

The ESTSM consumer user i.e. non corporate user experience consists of two phases 1 the registration phase and 2 administration phase via the ESTSM website. In the registration phase the user creates an account with ESTSM specifies what ESTSM services he wishes to purchase and provides user and billing information to complete the registration.

Once registration is complete the typical user will not interact with ESTSM until the electronic device is stolen. At that time the user can log into the ESTSM website. Once logged in the user can report the device as stolen disable the device or perform other device administration tasks. The user may also initiate all ESTSM device administration tasks through a call center that can validate the identity of the user and perform administrative tasks on the user s behalf.

After registration is complete the ESTSM server computer system communicates over the Internet with the user to determine if the electronic device has been reported stolen. In accordance with some embodiments of the invention if the device is reported stolen the ESTSM server will instruct the electronic device to take the appropriate action based on the service options selected by the user e.g. disabling the electronic device destroying the hard disk drive HDD data recovering data encrypting data and more .

When the user purchases the electronic device the ESTSM components may be pre installed by the manufacturer of the electronic device. In some embodiments of the invention the ESTSM registration screen shown in will come up when the user starts using his electronic device and the ESTSM system determines that the electronic device is not registered. The ESTSM system determines if the electronic device is registered or not by communicating with the ESTSM server computer system.

In some embodiments of the invention the user may request the manufacturer of the device to preregister the user for ESTSM services after the manufacturer builds the electronic device. In some alternative embodiments of the invention the device may be preregistered for ESTSM services at the location e.g. retail store where the device is purchased. In some embodiments of the invention the initial fees for the ESTSM services as described below may be included by the manufacturer in the price of the electronic device or may be discounted as a sales promotion for the device.

In some other embodiments of the invention the ESTSM system may be provided to the manufacturer of the electronic device without charge or for a very small fee. The user of the device may select the ESTSM services they want and the revenue generated may be shared by the manufacturer and ESTSM administrator. Thus the user may opt in to purchase the ESTSM services. In some embodiments of the invention the ESTSM services may be offered to the user of the electronic device on a trial basis for a limited time.

The user can proceed with the registration process at this point or choose to register at a later time or never. If the user chooses to register at a later time the ESTSM will remain disabled and the user may register using techniques that include but are not limited to selecting a menu option for registration or selecting an icon on the electronic device s desktop. If the user proceeds with the registration process the user will be asked to specify if they are a new user or an existing user that has other electronic devices running ESTSM. The next stage as shown in is to choose the ESTSM services for the electronic device.

In some embodiments of the invention due to the extendible design of ESTSM new services can be added. Such services may be made available through the ESTSM registration process for example. For instance as illustrated in the ESTSM system may allow users to register for data encryption services as well as data recovery services.

With this service the ESTSM system allows the user to select files and or folders to be protected by encryption. For instance the user could create a file folder called My Encrypted Files on the desktop of the electronic device and then select that folder to be protected by encryption by the ESTSM system. Consequently the ESTSM system will cause all files that are saved into this folder to be encrypted. For example the ESTSM system may use encryption techniques built into the operating system. Furthermore the ESTSM system may deny access to the folder unless the system is connected to the Internet and the electronic device has not been reported stolen. However if the system is not connected to the Internet the user can optionally enter the ESTSM username and password to get access to the folder. In other words the ESTSM system does not decrypt any protected file unless a the electronic device is connected to the Internet and the electronic device has not been reported stolen or b the user has entered the proper ESTSM username and password. For purposes of this document files and folders that are protected in this manner may be referred to as ESTSM protected or ESTSM encrypted. The ESTSM system may also allow the user to designate individual files for ESTSM encryption. depicts a desktop showing a folder named My Encrypted Files and a file named Encrypted File 1. The user may use any other suitable names as desired but once the user has selected an individual file or an entire folder for ESTSM encryption the ESTSM system will protect those selected objects as indicated above.

This service will allow a user to specify critical files and folders and in the case of theft of the electronic device the ESTSM software will first save these files and folders from the electronic device to the ESTSM server computer system before performing other service option actions such as disabling the electronic device . Consequently the user can recover those files from the ESTSM server computer system. For purposes of this document files and folders that are protected in this manner may be referred to as ESTSM protected or ESTSM critical. In one example the user could create a file folder called My Critical Files on the desktop of the electronic device and the user could then select that folder as a critical folder for the ESTSM system. Consequently if the electronic device is reported stolen the ESTSM system will cause all files that have been saved into this folder to be copied or saved from the electronic device to the ESTSM server computer system before performing other service option actions. As with ESTSM encrypted files the ESTSM system may also allow the user to designate or flag individual files as ESTSM critical. depicts a desktop showing a folder named My Critical Files and files named Critical File 1 and Critical File 2. The user may use any other suitable names as desired but once the user has selected an individual file or an entire folder as ESTSM critical the ESTSM system will protect those selected objects as indicated above.

Any suitable technique may be used to select files and folders for ESTSM protection. For instance the user may select an option provided on a right click menu the user may move a file or folder into another folder that has already been selected for ESTSM protection the user may move or copy a shortcut pointer for a file or folder into an ESTSM protected folder etc.

In some embodiments once a file or folder has been selected for ESTSM protection the icon of that file or folder is modified accordingly. For instance if a file has been selected as ESTSM critical the icon may indicate that the file will be saved or recovered if the electronic device is stolen. Similarly the icon for a file selected for ESTSM encryption may indicate that the file is so protected. In one embodiment ESTSM protected files may reside anywhere on the HDD of the electronic device.

Referring to the illustrated process begins with a determination of whether the ESTSM system has received or detected user input selecting a file or folder for ESTSM protection as shown at block . As shown at block if such user input has been received the ESTSM system applies the selected security option. For instance if the file has been selected for ESTSM encryption the ESTSM system encrypts it and adds it to the list of ESTSM encrypted file or if the file has been selected as critical the ESTSM system adds it to the list of ESTSM critical file.

As indicated at block the ESTSM system may then determine whether the electronic device is attempting to process a protected file. For instance the ESTSM system may detect whenever the user is trying to open a file that has been protected by ESTSM encryption. If processing of a protected file has been requested the ESTSM system determines whether the electronic device is connected to the Internet and whether the electronic device has been reported stolen as indicated at block and . If the electronic device is not connected to the Internet or if the electronic device has been reported stolen the ESTSM system prevents the requested processing as shown at block . For instance if a user is trying to open a protected file for editing with a word processing application the ESTSM system may refrain from decrypting that file thereby preventing the user from viewing or changing the corresponding unencrypted content. On the other hand if the device is connected and it has not been reported stolen the ESTSM system may automatically decrypt the ESTSM encrypted file to allow the user to access that file as indicated at block .

In one embodiment to implement some or all of the functionality described herein for ESTSM protected files and folders the ESTSM system uses hooks provided by the OS to intercept file operations. For instance for platforms using a Microsoft Windows OS the ESTSM system may use Windows Shell Extension application programming interfaces APIs . Other types of platforms may use other types of hooks. These hooks may allow the ESTSM system to add functionality such as a displaying customized icons on the screen to representing certain types of files e.g. files with an extension of opef and b intercepting user input and take appropriate action when the user clicks such an icon or performs other operations on it. For example the ESTSM system may first check the server to see if the device has been reported stolen and if the device is stolen instead of decrypting the file and opening it the ESTSM system may display an error or warning to the user. If the system is not stolen the ESTSM system may then proceed to decrypt the file and open it in the corresponding application e.g. opening a .doc file in Microsoft WORD etc .

However as described above and illustrated at block in one embodiment if the electronic device is not connected to the Internet or if the electronic device has been reported stolen the ESTSM system may yet allow the user to access the file provided that the user first enters the proper credentials such as a valid ESTSM user id and or password a valid OS userid and or password a smartcard a biocredential such as a fingerprint scan etc.

In addition as shown at blocks and in response to a determination that the electronic device has been reported stolen the ESTSM system may automatically save a copy of each ESTSM critical file and folder from the electronic device to the ESTSM server. As indicated at block the electronic device may determine which files to save based on a list of files received from the remote server in conjunction with the message indicating that the electronic device has been reported stolen.

In one embodiment before the electronic device has been reported stolen when the ESTSM system receives user input selecting a file for protection processing the ESTSM system transmits identification information for the selected file from the electronic device to the remote server. Then after the electronic device has been reported stolen the ESTSM system automatically receives identification information for the selected file from the remote server. In response the ESTSM system automatically processes the file according to the selected protection processing based on the identification information for the selected file received from the remote server. For instance if the remote server sends the electronic device a theft information indicating that the electronic device has been reported stolen and b file information indicating that the user has selected a particular file for automatic backup recovery the electronic device may respond by automatically copying that particular file to the remote server.

After the ESTSM system has determined whether the electronic device has been reported stolen and responded accordingly the process of may then end. The process may then return to block or to other blocks such as block of or block of with the ESTSM system disabling the electronic device or taking other action as appropriate.

In some embodiments of the invention most of ESTSM services are based on a yearly fee model. Some services such as data recovery may be billed on a per megabyte basis that is the user indicates the number of megabytes to be recovered during registration and is billed accordingly. However if the electronic device is stolen and during data recovery more megabytes are recovered then a one time fee is charged to the user. The user will automatically be billed at the end of the year to renew the service for one more year. The user will be sent an email before billing to give the user a chance to cancel the service if they wish.

The next stage in the registration phase is to create the username and password as shown in that can be used to log onto the ESTSM website to report a stolen electronic device etc. Once that is completed the user must provide his user information name address phone number and so forth as shown in so that the monitoring station can identify the user if the user calls the monitoring station to report a theft.

The final part of the registration phase is to provide the billing information for the ESTSM services. This requires the input of a credit card number debit card number or checking account number. The information is then validated the credit card or other billing means is charged and a confirmation email as shown in is sent to the end user corporation or insurance company that just completed the registration. The user will have to click a link at the end of the email to activate the ESTSM on that electronic device. In some embodiments of the invention periodic ESTSM service charges may be billed by adding these charges to the existing electronic device bill. For example ESTSM monthly service charges may be added to the users existing mobile phone bill for ESTSM registered mobile phones.

As mentioned above ESTSM provides a website from which the user may administer the ESTSM services on the electronic device. In some embodiments of the invention corporate users may have limited administrative capabilities because of their access permissions described in more detail below . As shown in the user must first log into the website using the username and password that was created during the registration phase. A user without access to the Internet i.e. his electronic device was stolen can call the ESTSM monitoring station to perform the administrative functions described below for the electronic device.

Once the user has logged into the ESTSM website the main ESTSM menu in accordance with some embodiments of the invention is presented as shown in the left hand portion of . In some embodiments of the invention corporate and noncorporate users may have different ESTSM menus.

The Device Registry portion of the page in shows all the electronic devices the user currently has registered with ESTSM. By clicking on a device image from the Device Registry page of the ESTSM website the user is taken to the Device Status page shown in . On the Device Status web page for each device the user can perform the following tasks 1 View the status of the user s electronic devices running ESTSM 2 Report an electronic device stolen 3 Recover and re enable a stolen system that has been found 4 Upgrade or change the ESTSM service options 5 Show the Billing and Electronic Device Location Status Logs 6 Perform User Management functions such as changing the user information password and billing information and 7 Perform Data Management functions such as viewing recovered data and transferring recovered data to another device.

As shown in the Device Status page shows for each electronic device the Model Name System Description Current State ESTSM Services Active on the Device and Last Connection to ESTSM Server. Depending on the Current State and the services selected by the user certain task buttons will appear below the electronic device information. These task buttons let you perform different operations on the device e.g. report the electronic device stolen and so forth . As shown in the user may click on the button labeled Report Stolen to start the process of reporting an electronic device stolen. The user will be taken to the Report a Stolen Device web pages shown in . The user fills out the information on the web page to generate a theft incident report and the ESTSM site will log this report so that it may be given later to the appropriate authorities as proof of filing the theft incident report. This documentation may be provided to the user upon request.

Once the report is completed the electronic device will be put in the REPORTED STOLEN state states of ESTSM are described in detail below . At this point if the electronic device is connected to the Internet the electronic device state will change to either BEING TRACKED or DISABLED state.

In some other embodiments of the invention mobile devices such as cell phones Smart Phones and Wireless Local Area Network WLAN capable computers that may be always connected to the ESTSM server and contacted at anytime by the server can communicate through a message passing scheme. Message passing schemes may be SMS WWW message passing protocol based on Transmission Control Protocol Internet Protocol TCP IP or Multimedia Messaging Service MMS . The state diagram for mobile devices is shown in .

If the electronic device is in the BEING TRACKED state the user will receive an email an example of which is shown in documenting the location of the stolen electronic device. This location information may contain the following information 1 IP address of the stolen electronic device 2 domain name on the Internet of the stolen electronic device 3 owner of the domain name 4 contact information for the domain name owner 5 name and contact information of the Internet Service Provider ISP and 6 date and time of IP address connection.

With this information the user may pursue recovery with the appropriate authorities. The information provided may be used to track the exact location of the electronic device. For example ISPs may identify the network port cable modem or phone number from which the electronic device was connected when provided with the IP address date and time of the connection. A location tracking report email will be sent to the user each time the electronic device is connected to the Internet. If the Track and Disable service option is selected by the user then only one tracking location will be recorded since the electronic device will be automatically disabled once the location is recorded.

In some embodiments of the invention ESTSM registration as shown in for a PDA mobile cellular telephone or Smart Phone device may be performed using another computer system that can display ESTSM registration web pages. In some embodiments of the invention a different set of ESTSM services as shown in may be offered for the PDA. Thus the manufacturer may offer but not be limited to a Basic service and a Data backup service for the device as shown in .

After the user has selected the ESTSM services for their PDA in some embodiments of the invention the ESTSM system as shown in may request that the user interact with the ESTSM application on the PDA and enter the registration key into the device as shown in . Entering the registration key into the device may be the first step to start a multi step registration process that ensures that the correct electronic device is being registered. The PDA will then display a confirmation key as shown in . The user through the computer system capable of displaying ESTSM web pages may then enter into the PDA verification screen shown in the confirmation key and a system description. The registration process for the PDA is successfully completed as shown in and the device is secured as shown in . In some other embodiments of the invention ESTSM registration may not require any user intervention with the ESTSM electronic device except an acknowledgement from the user at the end of the successful registration.

In some embodiments of the invention an automated voice prompting system at a call center or live call center operator after authentication of the user as shown in may communicate with the user to perform ESTSM activities. All ESTSM activities performed through the Internet may also be performed by the call center including registration reporting a system stolen reporting system has been recovered and so forth.

In most business or government organizations a central IT staff is responsible for configuring maintaining and purchasing licenses for electronic devices. ESTSM is designed to work easily in controlled corporate or government environments. Electronic devices registered to corporations or government entities using corporate government registration may contain a different set of administration pages and user pages as compared to non corporate users. In some embodiments of the invention the corporate web pages may be as shown in . Web pages for government entities would be similar to the corporate web pages shown in . Corporate ESTSM systems may be designed to be centrally maintained and administered as required by corporate customers. When a corporate account is created a central administrator or manager is specified. The central manager can then create other managers and users and purchase and assign licenses to these managers and users as shown in . As shown in the central manager can assign user permissions to other managers. Thus the corporation can control which users are allowed to report stolen electronic devices as shown in remove users as shown in purchase more licenses upgrade services etc.

For electronic devices registered to corporations or government entities the ESTSM may contain the user s position within the company and associate user permissions with that position as shown in . Thus if a user leaves the company the electronic device may be assigned to another employee transparently and without any change in service fees. The ex employees account information on ESTSM may be disabled and removed as shown in so that the ex employee may not falsely report an electronic device stolen to disable access to the device.

Some embodiments of the registration and administration technique for electronic devices in ESTSM for corporations is shown in . A corporate administrator may access the ESTSM server computer system located in the monitoring station by calling the monitoring station or through the Internet. In some embodiments of the invention the corporation or government entity may have the ESTSM server computer system located within their own premises for greater security and control. In this embodiment of the invention the administrator can access the server system through a terminal connected to the server or from a computer system at a remote site connected to the server system through the Internet.

The corporate or government entity can setup a corporate account to use ESTSM. The corporation or government entity can purchase services licenses in bulk i.e. 100 Data Destroy Services 50 Tracking Services etc . The licenses can be paid for via standard purchasing methods such as Purchase Orders as shown in net 30 day terms etc. The corporation or government entity receives a license number for each purchase. This license number is given to the end users in the corporate or government entity who will consume the license. Alternatively the corporation or government entity may pay a non recurring one time fee for individual services.

The corporate or government end user will register in a similar fashion as described above. However in some embodiments of the invention when creating the username and password the user can enter the license number for the License Number field as shown in . In this embodiment of the invention the end user will not be required to select the services as they will be determined by the services paid for in the license number. Also the end user will not have to provide a credit card or other form of payment.

The administrator of the corporate or governmental ESTSM account can manage and configure the electronic devices in the corporation or government entity that have the ESTSM application installed. Thus for example the administrator may re send an activation email to a user of an ESTSM enabled electronic device as shown in or send a login and password reminder to the user as shown in . The administrator may override an individual user s access to an electronic device as shown in deregister an electronic device from the ESTSM system or remove user access to ESTSM enabled electronic devices as shown in . The current state of the electronic device ACTIVE REPORTED STOLEN BEING TRACKED DISABLED HALF RECOVERED and so on as described in detail below registered with ESTSM may be viewed by the corporate or government administrator by entering the machine id the login id of the user mobile phone number or any other ESTSM device specific identification as shown in . The administrator can also perform other administrative tasks such as recover an ESTSM enabled system as shown in change server settings as shown in or change the administrator login password or administrator master password as shown in 

The administrator may add new users to the ESTSM system and designate the rights and permissions of users so that these users have administrator capabilities. Users on a corporate or governmental ESTSM account may heave permission to report their ESTSM device stolen perform user management functions and so forth.

As mentioned above and shown in the Device Status page displays task buttons below the electronic device information. The task buttons displayed depend on the current state of ESTSM and the services selected by the user. The task buttons let the user perform different operations on the device e.g. report the electronic device stolen and so forth .

Each electronic device can have one of the following current states ACTIVE REPORTED STOLEN BEING TRACKED DISABLED and HALF RECOVERED. The definition of each of the states is given below 

Turning now to and state diagrams including the states described above and the conditions to enter and exit the states are shown. shows the states and transitions of an electronic device in ESTSM from a not registered state to registered and active state. After the user goes through the registration process an electronic device in the not registered state transitions into the registered and not activated state . Once the user clicks on an activation email on the electronic device or calls an activation telephone number the device becomes registered and activated .

Referring to the states and transitions of an electronic device in ESTSM from a not registered state to registered and active state with the device passing through a never remind state are shown. If the user clicks the never remind option shown in the electronic device transitions to the never remind state . Next if the user at a later time decides to manually register i.e. in some embodiments of the invention by clicking on an ESTSM application icon on the graphical interface of the device and going through registration process the electronic device is placed into a registered and not activated state . Once the user clicks on an activation email on the electronic device or calls an activation telephone number the device becomes registered and activated .

Referring to the states and transitions of an electronic device in ESTSM from a registered and active state to deregistered state are shown. The user may decide they no longer want ESTSM services and select the Stop ESTSM option shown in . The electronic device that was previously in the registered and active state will transition to the deregistered state after selection of Stop ESTSM. 

Referring to the states and transitions of an electronic device in ESTSM that is reported stolen and then tracked disabled and recovered are shown. During registration and activation with ESTSM the user must select the Track and Disable service option to activate the states and transitions shown in . Once the electronic device is registered and active with ESTSM and the user reports the system stolen ESTSM will place the device into the reported stolen state . When the electronic device is next connected to the Internet ESTSM will begin tracking the device in the being tracked state . The user is sent a location identification email shown in and because the user had selected the track and disable service is again given the option to disable . If the user selects disable then the electronic device is placed into the going to disable state . The Application component on the electronic device disables the device and informs the ESTSM server computer system that the electronic device is in a disabled state . If the user recovers the device and performs the recovery procedure the electronic device is placed into the half recovered state . Next the Application component on the electronic device informs the ESTSM server computer system that it is operating normally and the electronic device transitions back into the registered and active state .

Referring to the states and transitions of an electronic device in ESTSM from a registered and active state to override state are shown. As described above to continue using the electronic device if the Application component on the electronic device is unable to communicate with the ESTSM server computer system the user must enter an activation password . ESTSM on the electronic device is then bypassed in the override state . If the electronic device is not reported stolen and the ESTSM Application component re establishes communication with the ESTSM server computer system the electronic device returns back to the registered and active state .

Referring to the states and transitions of an electronic device in ESTSM for the Data Destroy Service is shown. As shown in the user may select the Data Destroy Service that erases the electronic device hard disk drive. If the Data Destroy Service is selected the electronic device registered and active with ESTSM may be reported stolen by the user. A stolen electronic device is placed into the reported stolen state and once the stolen device connects to the Internet it is placed into the being tracked state . The user is sent a location identification email shown in and because the user had selected the data destroy service is again given the option to select or bypass data destroy. If the user selects data destroy then the Application component on the electronic device erases the hard disk drive and the electronic device is in the erase hard disk state .

Referring to the states and transitions of an electronic device in which the corporate user of the device is removed from ESTSM is shown. As described above a corporate user may have an electronic device which is registered and active with ESTSM. If ESTSM were not installed on the electronic device but rather the device was protected by a password known only to the user the electronic device would be rendered unusable if the user left the organization. With ESTSM if the corporate user leaves the organization the corporate administrator may remove the user s access rights to the ESTSM system. The electronic device used by the user is placed into the user removed state .

If an electronic device is in the REPORTED STOLEN BEING TRACKED or DISABLED state the user can use a System Recovered interface that may be a button to bring the electronic device back to the ACTIVE state. The procedure after the electronic device is recovered may be different depending on the ESTSM services selected for the recovered electronic device and the current state of the electronic device. In some embodiments of the invention the user may be required to fill out a recovery incident report which documents the circumstances under which the electronic device was recovered.

The electronic device may be in the HALF RECOVERED state when recovered indicating that the electronic device is currently locked from boot access. The electronic device screen will show system information such as the manufacturer model number and serial number of the electronic device and an unlock key. The electronic device screen will prompt the user to enter an activation password to re enable boot access to the device. On the ESTSM website after completing the recovery incident report the user will be asked to enter the system information and unlock key indicated on the screen of the electronic device. The ESTSM server computer system will generate the activation password that the user can enter on the recovered electronic device to re enable boot access.

From the ESTSM website a user may also view the ESTSM services that are currently active on any of their electronic devices. The user may also add other ESTSM services and be billed accordingly. The user may also switch the options of certain services. For example as shown in the user may switch from Track and Disable option to Continuous Track option under the Tracking Service. 

A user may be informed by the Application component of new services that are available for ESTSM. In some embodiments the Application component may display a pop up information message box that explains the new services along with pricing information. The Application component may optionally allow the user to purchase the new service using an interface in the message box.

The user may also view billing information about their account. The billing information will show all charges to the user s credit card and the services which were purchased along with the date of purchase.

The ESTSM server computer system includes electronic device status logs that show all the ESTSM activity for an electronic device. The user may view the electronic device status logs. These logs may be used to see when an electronic device was reported stolen a summary of the tracking location information collected for an electronic device date and times of recovery or device disabling events and any other device status information.

The ESTSM website may also be used to update user information such as address telephone number email address and so forth. Also the user s billing information such as the credit card number and expiration date may also be updated.

The user may want to upgrade the operating system or hardware specifically the hard disk drive on the electronic device. As described above the ESTSM BIOS ensures that the ESTSM application components may not be removed from the hard disk drive. Thus if the user upgrades to a new hard disk drive the user will be asked to insert the electronic device s recovery media. In some embodiments of the invention the recovery media may be a floppy diskette but in other embodiments the recovery media may be a Compact Disc Read Only Memory CD ROM or Universal Serial Bus USB key storage device. The ESTSM BIOS will prevent the system from booting until it detects the presence of the recovery media. The ESTSM BIOS component will automatically run a special program from the recovery media and this program will re install all the ESTSM application components and special hidden partition on the hard disk drive described in greater detail below . In some other embodiments of the invention where a special hidden partition is not present the user may load the ESTSM application components into the hard disk drive directly.

The user has to take no special action to upgrade the operating system on an electronic device that already has the ESTSM components properly installed and running. When the user upgrades the OS the ESTSM application components will also be maintained as part of the OS upgrade. If the ESTSM components are removed inadvertently the ESTSM BIOS component will automatically re install the ESTSM application components from a special hidden partition that exists on the hard disk. This operation will be transparent to the user.

Turning now to in some embodiments of the invention the ESTSM architecture consists of application components non viewable component and a BIOS component that work together to provide a secure environment for electronic device operation. The application components may be files stored on a hard disk drive HDD of the electronic device and may include startup files ESTSM application and ESTSM Dynamic Link Libraries DLL . A web browser application connected to and capable of communicating with the ESTSM DLL may be present on the HDD. The application component runs within the operating system environment and is responsible for communicating with the ESTSM server computer system through the Internet . Server computer system includes a number of servers . . . that may be web servers containing the web pages and data for ESTSM described above. The application component determines from the ESTSM server computer system if the electronic device has been reported stolen and if so the application component takes the appropriate action based on the services the user registered for i.e. disable electronic device track location erase hard disk drive etc .

The BIOS component ensures that the application component cannot be removed from the system or bypassed in any way. The BIOS component consists of a small piece of code that resides in the system BIOS ROM image located in a secure non volatile area . In some embodiments of the invention a non viewable component program VALIDATOR resides on a special hidden partition of the hard disk drive and is executed during Power On Self Test POST of the electronic device. Every time the electronic device boots up the BIOS component will check the integrity of the ESTSM non viewable component and application component programs and files and restore the original programs and files if they have been tampered with. Furthermore the BIOS component will ensure that the application component has run properly on the previous device boot and will take action if it is determined that an attempt to bypass the application component has occurred.

In some embodiments of the invention the BIOS component consists of a BIOS ROM image that is integrated into the system BIOS. The non viewable component consists of a VALIDATOR program which resides in a special hidden partition created by ESTSM. Together the ROM image and VALIDATOR cooperate to make sure that someone cannot bypass or circumvent the ESTSM application component from running. This is done by the ESTSM BIOS in the three ways shown below. In this document reference made to ESTSM BIOS may refer to the code in the BIOS ROM image or VALIDATOR or combination of both.

In some embodiments of the invention as shown in the architecture for an ESTSM enabled PDA WLAN capable computer mobile phone that in some embodiments may be a cell phone or Smart Phone may include a Flash memory containing a changeable area and a system area . The system area may include application components containing ESTSM application programs and a secure non volatile area coupled to the application components . In some embodiments of the invention the system area may be non viewable and implemented in non volatile memory. The ESTSM enabled PDA WLAN capable computer mobile phone or Smart Phone may continuously communicate to an ESTSM Server Computer System through an always on Internet connection or other mobile device communication protocols such as Short Messaging Service SMS . Server computer system includes a number of servers . . . that may be web servers containing the web pages and data for ESTSM described above.

In some embodiments of the invention as shown in an ESTSM enabled electronic device may contain a HDD including an application component and an ESTSM Communications Area ECA . Through an Internet connection the ECA allows the electronic device to communicate with the ESTSM Server Computer System . Server computer system includes a number of servers . . . that may be web servers containing the web pages and data for ESTSM described above. The HDD may include a Host Protected Area HPA containing ESTSM non viewable components . The non viewable components may include a VALIDATOR program that inspects an ECA to determine if the ESTSM application components have run correctly during the last system boot. The non viewable component may also contain a copy of the original application component software fileset if the files need to be re installed to the HDD. As described above every time the electronic device boots up the BIOS component will check the integrity of the ESTSM non viewable components and application component programs and files and restore the original programs and files from the backup fileset or from recovery media if they have been tampered with. Furthermore the BIOS component will ensure that the application component has run properly on the previous device boot and will take action if it is determined that an attempt to bypass the application component has occurred.

In some embodiments of the invention as shown in the ESTSM enabled electronic device may include a HDD containing an application component that receives and transmits information to a remote component that may be an ESTSM WWW component through the Internet . In some embodiments of the invention the application component may reside in the ESTSM WWW component on the ESTSM website and may be installed by the user from the ESTSM website. The application component may be coupled to an ECA . The ECA may couple to a BIOS component that is connected to a secure non volatile area as described above. The ESTSM application component may communicate through the ECA to the BIOS component . The ECA also allows the application and BIOS components to communicate with an ESTSM server computer system through an Internet connection . Server computer system includes a number of servers . . . that may be web servers containing the web pages and data for ESTSM described above.

Turning now to in accordance with some other embodiments of the invention the architecture for an ESTSM enabled electronic device with Short Messaging Service SMS capability is shown. The ESTSM enabled electronic device with SMS capability may be a PDA WLAN capable computer mobile phone that in some embodiments may be a cell phone or Smart Phone. The electronic device may include a Flash memory containing a changeable area that functions like non volatile storage and may include a file system. A system area in the Flash memory that is non changeable to a user of the electronic device may include an ESTSM SMS component ESTSM application component and a secure non volatile area coupled to the application component . The application component communicates with web servers . . . in the ESTSM server computer system through an Internet connection . The ESTSM server computer system also includes a SMS server coupled to the SMS component through a wireless communication connection such as Code Division Multiple Access CDMA or Global Mobile System GSM . In some embodiments the SMS component communicates with the ESTSM server using SMS services on the electronic device when an Internet connection is not available.

Turning now to a computer system that includes a BIOS component application component and non viewable component in accordance with some embodiments of the invention is shown. Computer system may be configured in any number of ways including as a laptop unit a desktop unit a network server or any other configuration. Computer system generally includes a central processing unit CPU coupled to a main memory array and to a variety of other peripheral computer system components through an integrated bridge logic device . The bridge logic device is sometimes referred to as a North bridge for no other reason than it often is depicted at the upper end of a computer system drawing. The CPU couples to North bridge logic device via a CPU bus or the bridge logic device may be integrated into the CPU . The CPU may comprise for example a Pentium IV microprocessor. It should be understood however that computer system could include other alternative types of microprocessors. Further an embodiment of computer system may include a multiple CPU architecture with each processor coupled to the bridge logic device . An external cache memory unit further may couple to the CPU bus or directly to the CPU .

The main memory array couples to the bridge logic unit through a memory bus . The main memory functions as the working memory for the CPU and generally includes a conventional memory device or array of memory devices in which program instructions and data are stored. The main memory array may comprise any suitable type of memory such as dynamic random access memory DRAM or any of the various types of DRAM devices such as synchronous DRAM SDRAM extended data output DRAM EDO DRAM or Rambus DRAM RDRAM .

The North bridge logic device couples the CPU and memory to the peripheral devices in the system through a Peripheral Component Interconnect PCI bus or other expansion bus such as an Extended Industry Standard Architecture EISA bus. The present invention however is not limited to any particular type of expansion bus and thus various buses may be used including a high speed 66 MHz or faster PCI bus. Various peripheral devices that implement the PCI protocol may reside on the PCI bus as well.

The computer system includes a graphics controller that couples to the bridge logic device via an expansion bus . As shown in the expansion bus comprises an Advanced Graphics Port AGP bus. Alternatively the graphics controller may couple to bridge logic device through the PCI bus . The graphics controller may embody a typical graphics accelerator generally known in the art to render three dimensional data structures on display .

Bridge logic device includes a PCI interface to permit master cycles to be transmitted and received by bridge logic device . The bridge logic device also includes an interface for initiating and receiving cycles to and from components on the AGP bus . The display comprises any suitable electronic display device upon which an image or text can be represented. A suitable display device may include for example a cathode ray tube CRT a liquid crystal display LCD a thin film transistor TFT a virtual retinal display VRD or any other type of suitable display device for a computer system.

The computer system optionally may include a Personal Computer Memory Card International Association PCMCIA drive coupled to the PCI bus . The PCMCIA drive is accessible from the outside of the computer and accepts one or more expansion cards that are housed in special PCMCIA cards enclosures which are approximately the size of credit cards but slightly thicker. Accordingly PCMCIA ports are particularly useful in laptop computer systems in which space is at a premium. A PCMCIA card typically includes one connector that attaches to the PCMCIA port and additional connectors may be included for attaching cables or other devices to the card outside of the computer . Accordingly various types of PCMCIA cards are available including modem cards network interface cards bus controller cards and memory expansion cards.

If other secondary expansion buses are provided in the computer system another bridge logic device typically couples the PCI bus to that expansion bus. This bridge logic device is sometimes referred to as a South bridge reflecting its location vis vis the North bridge in a typical computer system drawing. In the South bridge logic device couples the PCI bus to an Industry Standard Architecture ISA bus and to an Integrated Drive Electronics IDE bus . The IDE bus typically interfaces input and output devices such as a CD ROM drive a Digital Video Disc DVD drive a hard disk drive and one or more floppy disk drives. In accordance with the embodiment of the invention shown in the IDE bus shown in couples to HDD . ESTSM application component and ECA may be executable software files stored in a file system of HDD . Hidden partition in HDD may include ESTSM non viewable components as described in detail above with reference to .

Various ISA compatible devices are shown coupled to the ISA bus including a BIOS ROM . The BIOS ROM is a memory device that stores commands which instruct the computer how to perform basic functions such as sending video data to the display or accessing data on hard floppy disk drives. In addition the BIOS ROM may be used to store power management instructions for hardware based or legacy power management systems or to store register definitions for software based power management systems. The BIOS instructions also enable the computer to load the operating system software program into main memory during system initialization and transfer control to the operating system so the operating system can start executing also known as the INT19 boot sequence. BIOS ROM in includes the ESTSM BIOS component in accordance with the embodiment of the invention shown in . The ESTSM BIOS component in BIOS ROM couples through a bus that may be a serial bus a serial bus generally is a bus with only one data signal to secure non volatile area containing firmware code. The BIOS ROM typically is a nonvolatile memory device which means that the memory contents remain intact even when the computer powers down. By contrast the contents of the main memory typically are volatile and thus are lost when the computer shuts down.

The South bridge logic device supports an input output I O controller that operatively couples to basic input output devices such as a keyboard a mouse a floppy disk drive general purpose parallel and serial ports and various input switches such as a power switch and a sleep switch not shown . The I O controller typically couples to the South bridge logic device via a standard bus shown as the ISA bus in . A serial bus may provide an additional connection between the I O controller and South bridge logic device . The I O controller typically includes an ISA bus interface not specifically shown and transmit and receive registers not specifically shown for exchanging data with the South bridge logic device over the serial bus .

Turning now to a wireless communication device that may be a PDA WLAN capable computer mobile phone that in some embodiments is a cell phone or Smart Phone includes a changeable area and an application component in a system area in accordance with the embodiment of the invention of . The wireless communication device may transmit and receive information with a plurality of base transceiver stations BTS not shown in . Each BTS may transmit in a forward or downlink direction both physical and logical channels to the mobile station in accordance with a predetermined air interface standard. A reverse or uplink communication path also exists from the mobile station to the BTS which conveys mobile originated access requests and traffic.

The air interface standard can conform to any suitable standard or protocol and may enable both voice and data traffic such as data traffic enabling Internet access and web page downloads. One suitable type of air interface is based on Time Division Multiple Access TDMA and may support a GSM or an advanced GSM protocol although these teachings are not intended to be limited to TDMA or to GSM or GSM related wireless systems. Another wireless system and air interface such as a Wideband Code Division Multiple Access WCDMA system may serve at least a part of the geographical area served by the wireless communication system shown in and the mobile station maybe a multi band terminal that is capable of operating with either the GSM or the WCDMA network.

The mobile station typically includes a microcontrol unit MCU having an output coupled to an input of a display and an input coupled to an output of a keyboard or keypad . The mobile station may be contained within a card or module that is connected during use to another device. For example the mobile station could be contained within a PCMCIA or similar type of card or module that is installed during use within a portable data processor such as a laptop or notebook computer or even a computer that is wearable by the user.

The MCU includes or is coupled to a memory including a system area for storing ESTSM application components as well as a changeable area for temporarily storing required data scratchpad memory received packet data packet data to be transmitted and the like. A separate removable Subscriber Identity Module SIM that is not shown can be provided as well the SIM storing for example a preferred Public Land Mobile Network PLMN list and other subscriber related information. The system area may also store a program enabling the MCU to execute the software routines layers and protocols required to operate in the wireless communications system as well as to provide a suitable user interface UI via display and keypad with a user. Although not shown a microphone and speaker are typically provided for enabling the user to conduct voice calls in a conventional manner.

The mobile station also contains a wireless section that includes a digital signal processor DSP or equivalent high speed processor or logic or control unit as well as a wireless transceiver that includes a transmitter Tx and a receiver Rx both of which are coupled to an antenna for communication with the BTS. At least one local oscillator LO such as a frequency synthesizer is provided for tuning the transceiver. Data such as digitized voice and packet data is transmitted and received through the antenna .

As mentioned above with reference to the ESTSM enabled PDA mobile phone WLAN capable computer or Smart Phone may continuously communicate to the ESTSM Server Computer System through an always on Internet connection. Information such as telephone numbers email addresses calendar appointments sales meetings and other daily reminders on a PDA mobile phone WLAN capable computer or Smart Phone with ESTSM can be retrieved from a stolen device in some embodiments of the invention by the user calling an ESTSM service center to report the device as stolen. Because the PDA mobile phone WLAN capable computer or Smart Phone has an always on Internet connection data on the device can be recovered and stored on the ESTSM server computer system as soon as the device is reported stolen. After recovery the data may be erased off the stolen PDA mobile phone WLAN capable computer or Smart Phone and the device disabled making it worthless for the thief. Upon the ESTSM user purchasing a replacement PDA mobile phone WLAN capable computer or Smart Phone the data recovered and stored on the ESTSM server computer system from the user s stolen device can be placed on the user s new replacement device.

Turning now to some embodiments of the ESTSM server computer system of are shown in more detail. Clients are ESTSM enabled electronic devices that transmit and receive information through firewall to web servers . The firewall may be software executing on each of the web servers or a stand alone firewall device with dedicated hardware and software that may be a computer system. Web servers as described above include web pages for administration and use of ESTSM as well as software to transmit the web pages and receive responses from clients . Web servers connect through firewall to one or more database servers . Firewall may be software executing on each of the database servers or a stand alone firewall device with dedicated hardware and software that may be a computer system. Database servers may contain among other information user configuration information and access rights for clients . Configuration information may include the ESTSM services selected by a user the electronic devices associated with a particular user electronic device identification information billing information such as credit card number and expiration date electronic device location and status logs and so forth. Web servers may also couple to File Transfer Protocol FTP server that allows clients to download large files directly without having to go through web servers . Web servers also have access to files on FTP server allowing clients to access and view the contents of these files through the web servers.

Turning now to web servers of are depicted in greater detail and show connections between the primary and secondary servers in accordance with some embodiments of the invention. Clients may each connect to primary server and each of secondary server . . . and . The primary server and secondary servers . . . are coupled to each other and can communicate and transfer information. In some embodiments of the invention as described in greater detail below each of clients includes an application component that works with web browser software such as Microsoft Internet Explorer to ensure that if Explorer can access the ESTSM website the ESTSM application components will also be able to access the website. If Explorer on the client cannot get to the ESTSM website on the primary server it will then try to access the ESTSM secondary servers . . . for status of the primary. If the secondary servers are also unavailable but ESTSM application component on the client can access other popular websites then it is assumed that some firewall or other software has been loaded to attempt to block ESTSM operation.

The web pages for registration on the ESTSM server can be customized for each type of electronic device and manufacturer. This way manufacturers can offer different services to the user during the registration phase based on the model and target customers for that model. Thus for example a manufacturer may want to set a higher price for Data Destroy Services on corporate laptop models than on consumer laptop models.

If the ESTSM server computer system receives a message from an electronic device that has been reported stolen and the Tracking Service is registered for that electronic device the ESTSM server will log the IP address of the stolen electronic device. The ESTSM server computer system will get the IP address from the header of the message packet part of Internet Protocol IP and will not have to execute a tracing program such as TraceRoute on the electronic device that may be a client personal computer. The ESTSM server will use the Internet to lookup the information for that IP address and will send the tracking location email as described above to the user.

The ESTSM server computer system hosts all the web pages that provide the user experience once logged into the ESTSM website. The ESTSM server environment can be duplicated at a corporate customer facility and the specific serial numbers of the electronic devices at that corporation can be re directed to work directly with the ESTSM server located at that corporation. Thus corporate customers for security purposes can control the flow of messages to servers located at their own facility.

If the ESTSM server needs repairs to hardware new software functional changes to web pages etc. electronic device clients may be requested by the server to stop making new queries to the server for a random amount of time. Thus needed updates and repairs to the ESTSM sever may be performed during this time.

Turning now to a flow diagram in accordance with some embodiments of the invention of the BIOS component of ESTSM of is shown. The Power on Self Test POST firmware may call the ESTSM BIOS component towards end of POST. The BIOS component will first check to see if the electronic device has already been disabled by ESTSM i.e. the electronic device was reported stolen or some other ESTSM failure occurred . If the electronic device is already disabled the BIOS component will display the system information and a boot specific unlock key and will prompt the user to enter the activation password to re enable system boot . This activation password can be obtained by the original user through the ESTSM website or by calling the monitoring station.

If the system was not already disabled the BIOS component checks to see if the special ESTSM hidden partition exists . If it does exist the BIOS component will transfer control to ESTSM non viewable component VALIDATOR program . If the hidden partition does not exist the BIOS component will create the ESTSM hidden partition . If there is a bootable operating system partition on the hard disk the BIOS component will force the user to insert the recovery media into the appropriate device . The BIOS component will re build the ESTSM hidden partition using the files from the recovery media . As mentioned above if the hidden partition does not exist a check is also made to see if a bootable operating system partition is present before forcing the recovery media to be inserted. If a bootable operating system partition is not present then the electronic device will proceed with the INT19 boot process until it stops because no bootable OS is present. This may occur if the thief deletes the OS in which case he must install the OS and the recovery media to allow the system to reboot. Alternatively a bootable OS partition may not be present as during initial HDD installation at the factory and a master hard disk image may be used for seamless factory installation during boot process without requiring the recovery media to be inserted in each electronic device during manufacture.

Turning now to a flow diagram of the VALIDATOR program in the non viewable component of the ESTSM in accordance with some embodiments of the invention is shown. If the hidden partition on the hard disk is valid the BIOS component will load and transfer control to the VALIDATOR program on the hidden partition as shown in and described above. The VALIDATOR program inspects the ESTSM Communications Area ECA to determine if the ESTSM application components have run correctly during the last system boot . If the ECA information is correct i.e. ESTSM application was run correctly then the VALIDATOR program will return control to POST to proceed with INT19 OS boot process . If the VALIDATOR program determines that the application components failed to run correctly the user is warned to correct the problem otherwise the electronic device will be disabled within a number of system boots that in some embodiments of the invention is 5 system boots. The VALIDATOR program will then restore the ESTSM application components from ESTSM backup fileset to try to correct the problem . If the number of system boots has been reached and ECA information is still not correct then ESTSM will disable the system . The procedure described above may then be used to re enable the system. An application component failure will be generated if the thief deletes or tampers with ESTSM files loads an application or service to try to bypass ESTSM operation or in any other way tries to prevent ESTSM from running. After the VALIDATOR program has completed operation it returns control back to the electronic device BIOS so that system POST may be completed and the normal OS boot can occur via the INT19 interface.

In some other embodiments of the invention the check of the ECA to determine if the ESTSM application components have run correctly is performed by the BIOS component thus the VALIDATOR program may be located in the BIOS component. If the VALIDATOR program determines that the application components failed to run correctly the user is asked to install the application components onto the electronic device.

As shown in the ESTSM application component consists of two sets of programs 1 ESTSM application program and 2 startup program files. The application component programs work together to provide the ESTSM environment described above and periodically check with the ESTSM server computer system to see if the electronic device is reported stolen and take the appropriate action.

A flow diagram of the application component of the ESTSM is shown in in accordance with some embodiments of the invention. The startup program creates the appropriate system processes and loads and executes the ESTSM application program on the electronic device that performs most of the ESTSM operations. The ESTSM application program works with the operating system driver files to communicate with the ECA. The ESTSM application program will check the integrity of all the ESTSM application components and will ensure ESTSM is working correctly. The ESTSM application program will communicate this information to the BIOS component through the ECA. Checking the integrity of ESTSM application components may include interfacing with specialized security hardware on the electronic device that in some embodiments of the invention may be Trusted Platform Module TPM integrated circuitry. If there is a problem with the ESTSM application components no information will be communicated to the ECA and on the next electronic device boot the BIOS component will not allow the electronic device to boot. Otherwise the ESTSM application program will then try to detect an Internet connection on the electronic device. Once an Internet connection is established by the user the ESTSM application program will attempt to contact the primary ESTSM server . If the ESTSM application program is successful in contacting the primary ESTSM server the application program will then send an encrypted query to the primary ESTSM server . Encryption of the query may involve interfacing with specialized security hardware on the electronic device such as TPM integrated circuitry described in more detail below. This query will identify the electronic device by the device system information such as serial number and model number no other user data is sent to the server . The ESTSM application program receives the electronic device status from the server to determine if the device is registered with ESTSM . If the electronic device is not registered with the ESTSM server the user is given the option to complete the registration phase as described above and shown in at and .

If the system is registered with ESTSM server the electronic device executing the ESTSM application program will receive a response from the ESTSM server computer system indicating whether or not the electronic device is reported stolen. If the electronic device is in an active state i.e. not stolen the application program will wait an interval and again contact the ESTSM server . If the electronic device is reported stolen the ESTSM application program will cooperate with the other application components to take the appropriate action i.e. disable the system erase the hard disk drive etc and . If the user has selected the disable electronic device service then the ESTSM application program will inform the ECA of electronic device disabled state and freeze the electronic device . The electronic device executing the ESTSM application program will send an encrypted message to the ESTSM server periodically while the system is connected to the Internet.

The application component of ESTSM is designed so that firewall software cannot block the ESTSM application components from accessing the ESTSM website. If firewall software could block the ESTSM application components a thief could merely install the firewall software to bypass ESTSM. The ESTSM application program works with web browser software such as Microsoft Internet Explorer to ensure that if Explorer can access the ESTSM website the ESTSM application components will also be able to access the website. If Explorer cannot get to the ESTSM website on the primary server it will then try to access the ESTSM secondary servers for status of the primary as shown in in . If the secondary servers are also unavailable but ESTSM can access other popular websites then it is assumed that some firewall or other software has been loaded to attempt to block ESTSM operation. In this case in some embodiments of the invention the user is warned that they must correct the problem within five boots and or enter an override code to continue operation with ESTSM temporarily disabled. The override code can be obtained from the ESTSM website call center or an automated response system. If the override code is not entered the system will be disabled after five boots and and the user must get the activation password as described above.

The ESTSM server is located at a particular address on the WWW accessible to the user. The application components of ESTSM communicate with this web server during the registration phase and periodically once the system is registered to determine if the electronic device has been reported stolen.

Turning now to encryption and encoding of information by the client electronic device and decoding and decryption of information by the server computer system in accordance with some embodiments of the invention is shown. A client that is an ESTSM enabled electronic device includes an ESTSM application component as described above. The ESTSM application component may be coupled to an encryption decryption module that transmits and receives encrypted and encoded data. The encrypted and encoded data may be transmitted and received from an ESTSM server computer system through a communication medium such as HyperText Transfer Protocol HTTP . The server computer system includes an ESTSM server application that may include web pages and information displayable on ESTSM enabled devices as described above and ESTSM server application software. The ESTSM server application may be coupled to an encryption decryption module that transmits and receives encrypted and encoded data to and from client .

Turning now to encryption and encoding of information by the client electronic device and decoding and decryption of information by the server computer system of is shown. Client electronic device may frequently and at randomly selected times send a query to server computer system asking if the electronic device has been reported stolen. The query is encrypted by encryption decryption module using an encryption technique as described below into a binary format sequence of ones and zeroes. The sequence of ones and zeros is encoded by encryption decryption module using an encoding technique as described below into an American Standard Code of Information Interchange ASCII text format . ASCII text format is a standard 7 bit ASCII character code embedded in an 8 bit byte whose high order bit is always zero as described in ANSI standard X3.64 herein incorporated by reference.

Simultaneously with the encryption and encoding performed by encryption decryption module the server computer system receives ASCII text formatted data via communication medium . The ASCII text formatted data is decoded by encryption decryption module using a decoding technique as described below into a binary format sequence of ones and zeroes. The sequence of ones and zeroes is decrypted by encryption decryption module into query information that may be as mentioned above asking if the electronic device has been reported stolen.

Referring now to a flow diagram implemented in the client and server for encoding binary format sequence data into ASCII text format data in accordance with some embodiments of the invention is shown. If the end of the binary format sequence data source has been reached as determined by the value of the source length variable then encoding ends . If the end has not been reached then the next byte to encode is stored 5820 in a variable. Thus n bits from the variable are extracted into another variable that in some embodiments may be C1. ASCII text format may have n 6 bits with the highest order 7and 8bit being zero. Variable C1 is passed to ENC function that performs binary mapping operations on the binary sequence data to generate an encoded byte . In some embodiments of the invention the binary mapping operations on C1 include mapping C1 to a base 64 number. The encoded byte is placed into a Destination data structure that may be an array of bytes for transmission over communication medium . The encoded byte is re initialized to a zero value in some embodiments of the invention and the source length variable is decremented.

Referring now to a flow diagram implemented in the client and server for decoding ASCII text format data into binary data in accordance with some embodiments of the invention is shown. Encryption decryption modules located in the client electronic device or server computer system receive encoded bytes of ASCII text format data that are placed into a source byte stream data structure that may be an array of bytes. The source byte stream data structure is described by a source length variable that indicates the number of ASCII text format data bytes present in the array. Every time a new byte of data is received by the encryption decryption module and placed in the array the source length variable is incremented and when a byte of data is removed and decoded the source length variable is decremented. If the end of source has been reached the array will become empty and decoding will end . If the end of the source has not been reached then a current ASCII text format byte of data is placed into variable E . The ASCII text format byte of data in variable E is passed to DECODE function that performs mapping operations on the data to generate a decoded byte ED . The lower six bits of the decoded byte ED are placed into a final byte stream data structure and the upper two bits are discarded. Finally the source length variable is decremented as described above. If the end of the source byte stream is reached every eight bits in the final byte stream corresponds to the original unencoded data.

Turning now to a flow diagram showing encryption and encoding of SMS messages from SMS server to SMS enabled ESTSM electronic device for the system of is depicted. Each SMS capable device that in some embodiments of the invention may be a Smart Phone includes unique device information that is used in the encoding and encryption process. The encryption decryption module in the Smart Phone stores the device information into a variable DI as shown in block . The encryption decryption module passes the device information in variable DI to a function Jumble as shown in block and stores the result into a variable JDI. In some embodiments of the invention the function Jumble rearranges and reorders the individual bytes in variable DI. Next the encryption decryption module as shown in block generates an encrypted command by passing the jumbled device information in variable JDI and an ESTSM Secret Cmd to function FN. The ESTSM Secret Cmd is a command sent from the ESTSM server to the electronic device for a function supported by the electronic device. The function FN returns an encrypted command that is stored in variable ECMD and may be an array of bytes. Next in block the encryption decryption module calls the Encode function that may be the flowchart shown in . The Encode function is passed the variable ECMD containing the encrypted command and encodes the array of bytes as shown in . The encoded array of bytes is stored in a variable EncECMD that is transmitted as a message to the ESTSM server computer system over the communication medium .

Turning now to a flow diagram showing decoding and decryption of SMS messages is depicted. A MESSAGE variable that in some embodiments of the invention is variable EncECMD containing the encoded array of bytes is decoded by a Decode function that may be the flow chart shown in . The decoded array of bytes is stored in a variable DecFCMD that is then passed to a Decrypt function . The Decrypt function returns a decrypted command that is stored in variable FCMD and may be an array of bytes. The jumbled device information is extracted from FCMD and stored in variable JDI . Similarly the ESTSM Secret Cmd Data message is extracted from FCMD . The encryption decryption module passes the jumbled device information in variable JDI to a function UnJumble as shown in block . The device information after being unjumbled is stored in a variable DEVICE INFO that is verified with the unique device information of the electronic device.

Implementing ESTSM on an electronic device may necessitate the manufacturer integrating the ESTSM BIOS components including the BIOS ROM images into the system BIOS of the electronic device. In some embodiments this is the only task that may have to be performed during the system s development phase. The integration of the ESTSM BIOS component needs very little effort. The ESTSM BIOS component is designed to minimize the effort needed to integrate with the existing electronic device BIOS. Factors such as size of code complexity of integration and so forth have been addressed in the design of the ESTSM BIOS component. In some embodiments of the invention as shown in the ESTSM BIOS component is integrated with the existing electronic device BIOS using the technique described below.

As discussed above the ESTSM BIOS component is provided to the manufacturer of the electronic device in an encapsulated Option ROM image format that may be ESTSM.ROM as shown in . In some embodiments of the invention as shown in the manufacturer may utilize tools provided by BIOS vendors such as BIOS editors to merge the encapsulated ROM ESTSM image into the manufacturer s base BIOS image using the Option ROM format . In some other embodiments of the invention as shown in the manufacturer may use a BIOS Configuration Utility to insert the encapsulated ROM ESTSM image into the manufacturer s base BIOS ROM image . In this embodiment the BIOS calls the ESTSM Option ROM in the same way as it would any other Option ROM image. The ESTSM ROM proceeds in the same manner as it would if it had been integrated into the BIOS using known BIOS integration techniques by checking the system security during INT 19 boot strap call.

Returning now to maintaining and updating of the electronic device system BIOS is minimized because of the design of the ESTSM BIOS component. When the manufacturer needs to do a system BIOS update for the electronic device no changes need to be made to the ESTSM BIOS component in the system BIOS. The manufacturer can simply fix the bugs in the BIOS and do a new system BIOS build as shown in which will include the ESTSM BIOS components and the new system BIOS will work correctly. The new system BIOS can then be Flash upgraded by the user without any impact to ESTSM operation.

If an update is released for the ESTSM components the updated versions of the BIOS component image files may be copied into the BIOS build file and a new build performed. Once the new build is complete the updated system BIOS can be released to the user. No additional coding or maintenance tasks need to be performed to update the ESTSM BIOS components in the system BIOS.

Integration of the ESTSM application component requires no action by the manufacturer of the electronic device. This is because the ESTSM BIOS component restores the application components onto the hard disk drive of the electronic device once the OS is installed on the electronic device. In some other embodiments of the invention the application component may be installed by the user of the electronic device as described above.

For some embodiments of the invention creation of the ESTSM hidden partition may be performed immediately after installation of the electronic device s hard disk drive. Various utilities can be used to create the hidden partition. In some embodiments a scripted installation program including the utility to create the hidden partition may be run at the beginning of the manufacturing process. Typically this utility should be run just before the FDISK.EXE or some other utility is used to create the OS partition on the hard disk drive.

If the manufacturing process copies a prepared hard disk image directly to a blank hard disk then the prepared image should be created with the ESTSM hidden partition installed. Thus when the prepared image is copied to the blank hard disk drive during manufacture the ESTSM hidden partition will also be copied automatically from the prepared image.

Engineering and electronic device quality assurance test processes may be performed by the manufacturer providing the ESTSM monitoring station with a block of electronic device serial numbers to be used as part of the testing process. The monitoring station will mark these serial numbers as test in the ESTSM server computer system and the user will not be billed on the credit card for these systems. This will facilitate the test process at the manufacturer s facilities.

In some embodiments of the invention due to the extendible design of ESTSM new services can be added for a mobile device such as third party insurance data destroy service tracking service and data encryption service.

In some embodiments of the invention most of ESTSM services are based on a yearly fee model. Some services such as data recovery may be billed on a per kilobyte basis that is the user indicates the number of kilobytes to be recovered during registration and is billed accordingly. However if the mobile device is stolen and during data recovery more kilobytes are recovered then a one time fee is charged to the user. The user may be billed at the end of the year to renew the service for one more year. The user may be sent an email before billing to give the user a chance to cancel the service if they wish.

After the user has selected the ESTSM services for their mobile device in some embodiments of the invention the ESTSM system as shown in may request that the user turn on the cell phone or open the flip cover. In accordance with some embodiments the user through the computer system capable of displaying ESTSM web pages may then enter the mobile phone number service provider International Mobile Equipment Identifier IMEI number and a phone description. The registration process for the mobile device is successfully completed as shown in . In some other embodiments of the invention ESTSM registration may not require any user intervention with the mobile device except an acknowledgement from the user at the end of the successful registration.

In some embodiments of the invention an automated voice prompting system at a call center or live call center operator after authentication of the user may communicate with the user to perform ESTSM activities. All ESTSM activities performed through the Internet may also be performed by the call center including registration reporting a system stolen reporting system has been recovered and so forth.

As shown in the Device Status page shows for each mobile device the Model Name System Description Phone Number Current State and ESTSM Services Active on the device. Depending on the Current State and the services selected by the user certain task buttons will appear below the mobile device information. These task buttons let you perform different operations on the device e.g. report the mobile device stolen and so forth . As shown in the user may click on the button labeled Report Stolen to start the process of reporting a mobile device stolen. The user will be taken to the Report a Stolen Device web pages. The user fills out the information on the web page to generate a theft incident report and the ESTSM site will log this report so that it may be given later to the appropriate authorities as proof of filing the theft incident report. This documentation may be provided to the user upon request.

In some embodiments of the invention once the report is completed the electronic device will be placed into the REPORTED STOLEN state. At this point because of the always on connection of the mobile device to the Internet in some embodiments the mobile device files are backed up and the device state will change to RECOVERED state as shown in . The user may then manage these files to move them into a new cell phone Smart Phone or PDA device that they purchase. After the data has been recovered the ESTSM system informs the user that the mobile device is disabled as shown in .

Turning now to a flow diagram showing implementation of ESTSM on mobile devices such as cellular telephones Smart Phones or WLAN capable computers as in and that have a messaging capability that may be Short Messaging Service SMS is depicted. In some embodiments of the invention as described above the ESTSM server computer system may inform the mobile device that it has been reported stolen and backup the data on the device. In some other embodiments of the invention the ESTSM server may periodically backup the data on the device even if the mobile device has not been reported stolen. The ESTSM server may disable the mobile device i.e. lock the user out but device can still communicate with ESTSM server if the Subscriber Identity Module SIM card has been changed and the mobile device is reported stolen. The ESTSM server may also disable the mobile device if the IMEI number has been changed and the device is reported stolen.

As shown in the ESTSM application component located in the system area of the mobile device gets the device identifier of the mobile device in block . In some embodiments of the invention the device identifier is a concatenated string of numbers that may include the IMEI number manufacturer s model number of the mobile device and the phone number associated with the mobile device. If the application component is not able to get the device identifier in block then the application component disables the mobile device . If the application component is able to successfully get the device identifier then the application component determines if the user information module has been changed in block . In some embodiments of the invention the user information module may be a SIM card located in the mobile device. In some other embodiments of the invention the user information module may be stored on a Read Only Memory ROM that is a FLASH ROM or Electronically Erasable Programmable ROM EEPROM of the mobile device. The user information module identifies user information with the mobile device. The user information may be the phone number associated with the mobile device user details security information and memory for a personal directory of numbers. If the user information module has been changed in the mobile device the ESTSM application component gets the new phone number from the mobile device . The application component in block notifies the ESTSM server of the new phone number. Next in block the ESTSM application component determines the current state of the mobile device and begins the status loop waiting for a message from the ESTSM server. An encrypted and encoded message as described above may be communicated from the ESTSM server to the application component of the mobile device as shown in block .

In if the application component detects that a new message has arrived message data is processed in block . A command is extracted from the message data in block as described above and is stored into the variable Cmd. If the Cmd is REGISTER as shown in block then the user has registered the mobile device for ESTSM services. The ESTSM server is notified to change the mobile device state to ACTIVE in block and the application component sets the current state to ACTIVE in block . If the Cmd is DISABLE as shown in block the mobile device is disabled and the application component sets the current state to DISABLE in block . The ESTSM server may send a DISABLE command if the mobile device is reported stolen or the user information module that may be a SIM card has been changed and the device identifier has not changed in the mobile device. If the Cmd is BACKUP as shown in block the ESTSM server requests that the data on the mobile device be copied to the ESTSM server. As shown in block the ESTSM server begins to backup the data stored on the mobile device. The ESTSM server will recover the data requested by the user during registration for the mobile device. Thus if during ESTSM registration the user had selected recovery of contacts and calendar data these items will be backed up. In some embodiments of the invention the user may specify other data for recovery such as Mobile Commerce M commerce monetary information stored on the mobile device. The ESTSM server in some embodiments of the invention may request that the mobile device be placed into a disabled state and thus the application component in the mobile device sets the current state to DISABLE in block . If the Cmd is RESTORE as shown in block the ESTSM server starts to restore the data backed up from the mobile device back to the original mobile device that may have been recovered or a new mobile device. After restoring the data to the mobile device the ESTSM server places the mobile device into an active state. The application component in the mobile device sets the current state to ACTIVE in block and waits for some time before starting the status loop .

Turning now to the states and transitions of a mobile device with SMS messages for activation and operation of ESTSM services is shown. A mobile device as shown in including the ESTSM application component is initially in an UNREGISTERED state . After completion of the registration process the ESTSM server sends a SMS message to the mobile device indicating that the device is registered with ESTSM and placing the mobile device into an ACTIVATION PENDING state . The mobile device sends a SMS confirmation message to the ESTSM server and transitions into an ACTIVE state . In some embodiments of the invention as shown in the ESTSM server performs periodic backups of the data on the mobile device while in the ACTIVE state . While in the active state the ESTSM server computer system communicates over the Internet with the user to determine if the mobile device has been reported stolen. If the device is reported stolen using the ESTSM website the mobile device is placed into a REPORTED STOLEN state . The ESTSM server informs the mobile device via a secure communications channel to take the appropriate action based on the service options selected by the user e.g. disabling the electronic device destroying the storage device e.g. hard disk drive HDD data recovering data encrypting data and more . In some embodiments of the invention as shown in if the user during registration had selected the basic service the mobile device is disabled and placed into a DISABLE state . If the mobile device has been recovered or the user has purchased a new mobile device and the user re enables the device using the ESTSM website an SMS message is sent from the server to the mobile device placing the device into an ENABLE PENDING state . The mobile device sends an SMS confirmation message to the ESTSM server indicating that it has received the re enablement SMS message from the ESTSM server. The mobile device is placed into the ACTIVE state .

If the user during registration had selected the data recovery service the mobile device is placed into BACKUP IN PROGRESS state and data on the mobile device is backed up to the ESTSM server. If the data is backed up successfully the mobile device is placed into DISABLED DATA BACKUP state data on the device is deleted and the mobile device is disabled. The mobile device may be transitioned to ENABLE AFTER RECOVERY state from either the BACKUP IN PROGRESS state or DISABLED DATA BACKUP state if the user re enables the mobile device while the data backup is in progress. Once the mobile device has been recovered or the user has purchased a new mobile device and the user re enables the device using the ESTSM website an SMS message is sent from the server to the mobile device placing the device into an ENABLE AFTER RECOVERY state . The mobile device sends an SMS confirmation message to the ESTSM server indicating that it has received the re enablement SMS message from the ESTSM server. The mobile device is activated and placed into the ACTIVE DATA BACKUP state . The data that has been backed up into the ESTSM server is restored into the new or re enabled mobile device in the RESTORE IN PROGRESS state . After data has been restored into the mobile device the device is placed into the ACTIVE state .

While the invention has been disclosed with respect to a limited number of embodiments those skilled in the art will appreciate numerous modifications and variations therefrom. It is intended that the appended claims cover all such modifications and variations as fall within the true spirit and scope of the invention.

