---

title: Systems and methods of voice call setup involving mobile devices
abstract: A mobile device can send a notification to place a call using a PBX (e.g., using SIP signaling) or receive a notification of call availability for the mobile device at the PBX. An authentication token is provided over a data channel for use in authenticating the mobile device when calling the PBX on a voice channel. However, when the mobile device calls the PBX (e.g., on a DNIS number, where ANI information is made available to an application server), if ANI information is found to correspond to the mobile device, the PBX can send tone(s) indicating that the mobile device can respond with an abbreviated validation tone, rather than the entirety of the authentication token. If the ANI information is not obtained or not matched, then a different tone(s) is sent, indicating to provide the authentication token. If the authentication token provided does not match or if the mobile device does not respond, the voice channel is not set up.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08688079&OS=08688079&RS=08688079
owner: BlackBerry Limited
number: 08688079
owner_city: Waterloo
owner_country: CA
publication_date: 20101122
---
This application claims priority from U.S. Provisional Pat. App. Ser. No. 61 328 093 filed on Apr. 26 2010 and U.S. Provisional Pat. App. Ser. No. 61 328 555 filed on Apr. 27 2010 the contents of both applications are incorporated herein in their entirety for all purposes.

The present application relates to voice telephony and more particularly to transport setting up and authorizing of voice calls involving mobile devices.

Voice telephony remains a major application of interest for business and personal use. In an example corporate setting a telephony installation at a site can have a large number of users connected to a Private Branch Exchange PBX server which can interface those users to a smaller number of outside lines e.g. an E1 or T1 line a PBX can be implemented using a server with telephony cards for example . A PBX can interface with other servers and systems such as one or more application servers that can provide enhanced services to devices connected to the PBX such as mobile devices. For example a PBX can interface with an application server over an IP connection using SIP signaling. Services provided by an application server can include third party call control enterprise voice mail single number reachability call forwarding park and conferencing for example. PBX systems also can communicate with each other over trunk lines and packet networks depending on implementation.

A PBX can perform services for a voice call based on direction from an application server. For example a PBX can initiate an outgoing call to a number specified by an application server using SIP signaling to the PBX. A PBX also can provide information about incoming calls to an application server. For example a PBX can provide ANI information to an application server for a call incoming to the PBX which may be provided a service by the application server. Where data communication is unavailable with a mobile device the mobile device would not have an IP address or more generally where mobile device cannot acquire an IP address authentication mechanisms available in SIP cannot be used.

It is desirable to provide an experience to devices being serviced from such systems that is responsive while also maintaining a measure of authentication to be able to use the systems to reduce undesirable situations such as abuse or unauthorized access.

Briefly one concern in providing enhanced telephony services to mobile devices is providing a responsive experience to users of the mobile devices. For example in a situation where a call is to be anchored from a PBX a mobile device calling party can indicate that a call to a specified number a called party is to be made from the PBX on behalf of the calling party and that a voice channel between the PBX and each of the called and calling party should be bridged so that the called and calling party are in voice communication.

In one approach to such a service e.g. where SIP authentication measures cannot be applied a mobile device can indicate through a data channel e.g. a data service to a server in communication with the PBX that such a call is to be made. The server can return via the data channel an authentication token that can be presented over a voice channel to the PBX as a series of DTMF tones typically at least 5 tones . Upon reception of the tones at the PBX from the mobile device these tones or data representative of them can be sent from the PBX to the server which determines whether or not the DTMF tones represent the authentication token that was provided to the mobile device. If so then authorization for the call to proceed is granted. Such an approach may require several seconds around 4 or more seconds to complete at least because DTMF tones require a guardband of time between each tone and the tones require some time for processing. Thus using an authentication token long enough to provide reasonable security results in a delay longer than desirable.

In one aspect disclosed herein a mobile device indicates over a data channel that a call is to be made as described above . The server likewise responds with an authentication token. The mobile device can call a DNIS telephone number in order to reach the PBX. The PBX gathers ANI information for that call and or caller identification information . The ANI information is provided to the server. The server determines whether the ANI information matches to an authorized user of the system e.g. matches to identification information such as a phone number associated with a device issued to an employee of a company controlling the PBX.

If the ANI information or other identifying information matches then the server can generate a trigger code comprising one or more DTMF tones e.g. such tones can be pre determined to be associated with the trigger functionality described to be sent over the voice channel between the PBX and the mobile device. The mobile device receives these tone s and interprets these tone s to indicate that the authentication token need not be transmitted over the voice channel to the PBX. The mobile device can respond with one or more acknowledgement tones allowing the call to proceed. In this example the total number of DTMF tones exchanged over the voice channel to enable the mobile device to be authenticated and the call to proceed has been reduced. In some implementations such reduction in DTMF tones allows several seconds faster setup time for a call which enhances responsiveness of the system to mobile device service needs.

Traditionally a PBX e.g. PBX provides telephony services for a closed group of private telephones for example within an enterprise or a hotel. However in many cases the services to the private telephone desirably could also be extended out to a mobile device that communicate via third party networks such as wide area cellular networks or through wireless local area networks. In these situations SMP server may be added as an adjunct to the PBX and can take an active role in providing services to mobile devices.

SMP server can be connected to PBX through a packet switched connection that can use the Internet Protocol IP .

PSTN can communicate with Public Land Mobile Network PLMN and by particular example with a switching control within PLMN . Such communication is for accepting calls from PLMN to be carried on PSTN and vice versa as an example. SS7 signalling can be employed between PSTN and PLMN . PSTN is depicted to have telephones and coupled thereto. Other implementations can include multiple gateways that translate between or among different signaling protocols.

PLMN communicates with a mobile device . Communication between PLMN and mobile device can take place using a wide variety of technologies some of which are capable of supporting only voice traffic either voice traffic and data traffic or simultaneous voice and data traffic to from mobile device . PLMN also can use Internet to receive send traffic to and from corporate network as indicated by communication link . Communication between network and PLMN also may be carried via a relay . Relay may provide for example a leased line access to one or more PLMNs or to equipment hosted within such PLMNs . As such public packet networks e.g. Internet are not necessarily used in some examples.

Mobile device includes one or more radio transceivers and associated processing hardware and software to enable wireless communications with the PLMN and optionally a WLAN. In various embodiments the PLMN and mobile device may be configured to operate in compliance with any one or more of a number of wireless protocols including GSM GPRS CDMA EDGE UMTS EvDO HSPA 3GPP or a variety of others. It will be appreciated that the mobile device may roam within PLMN as well as into other PLMNs i.e. that the depicted PLMN represents one or more such wireless access networks that operate according to what a person of ordinary skill would understand as broadband cellular access technologies .

For example in some instances a dual mode mobile device and or the enterprise network can be configured to facilitate roaming between the PLMN and a WLAN and are thus capable of seamlessly transferring sessions such as voice calls from a connection with a cellular interface of a dual mode device to a WLAN interface of such a dual mode device and vice versa.

GSM signaling can be implemented using the Fast Associated Control Channel FACCH . FACCH is a logical channel on a digital traffic channel that can be used to send urgent signaling control messages. The FACCH channel sends messages by replacing speech data with signaling data for short periods of time. In GSM two special reserved bits are used to inform the receiving device if the data in the current time slot is digitally coded subscriber traffic or alternatively a FACCH message. Switching control manages the conversion between GSM signaling and SS7 signaling for clarity a network of base stations operating within PLMN is not separately depicted and usually there is a connection between switching control and one or more base station elements where device can be connected to such base station elements. GSM signaling can be relayed through the base station to a termination point in switching control . 

In some embodiments PBX may be connected to one or more conventional analog telephones . The PBX is also connected to or part of the enterprise network and through it to telephone terminal devices such as digital telephone sets softphones operating on computers and so on. Within the enterprise network each individual may have an associated extension number sometimes referred to as a PNP private numbering plan or direct dial phone number. Calls outgoing from PBX to PSTN or incoming from PSTN to PBX can be circuit switched calls typically in the absence of gateway . Gateway also can be considered part of enterprise network and a boundary of such enterprise network depicted in is primarily for convenience. Within the enterprise e.g. between the PBX and terminal devices voice calls are increasingly packet switched calls for example Voice over IP VoIP calls.

SMP server can perform some aspects of messaging or session control like call control and advanced call processing features. SMP server may in some cases also perform some media handling. Collectively SMP server and PBX may be referred to as the enterprise communications platform server generally designated . It will be appreciated that the enterprise communications platform and in particular SMP server can be implemented on one or more servers having suitable communications interfaces for connecting to and communicating with the PBX and other network connections. Although SMP server may be implemented on a stand alone server it will be appreciated that it may be implemented into an existing control agent server as a software component comprising instructions configuring a processor operating with other software components to implement the functionality attributed to it. As will be described below SMP server may be implemented as a multi layer platform.

The enterprise communications platform implements the switching to connect session legs and may provide the conversion between for example a circuit switched call and a VoIP call or to connect legs of other media sessions. In some embodiments in the context of voice calls the enterprise communications platform provides a number of additional functions including automated attendant interactive voice response call forwarding voice mail etc. It may also implement certain usage restrictions on enterprise users such as blocking international calls or 1 900 calls. In many embodiments Session Initiation Protocol SIP may be used to set up manage and terminate media sessions for voice calls. Other protocols may also be employed by the enterprise communications platform for example Web Services Computer Telephony Integration CTI protocol Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE and various custom Application Programming Interfaces APIs .

One of the functions of enterprise communications platform is to extend the features of enterprise telephony to the mobile devices . For example the enterprise communications platform can allow mobile device to perform functions akin to those normally available on a standard office telephone such as the digital telephone set or analog telephone set . Example features may include direct extension dialing enterprise voice mail conferencing call transfer call park etc.

The depicted system may include a number of enterprise associated mobile devices device is depicted . Device can be a device equipped for cellular communication through the PLMN or a dual mode device capable of both cellular and WLAN communications.

Enterprise network typically includes a number of networked servers computers and other devices. For example enterprise network may connect one or more desktop or laptop computers one shown . The connection may be wired or wireless in some embodiments. The enterprise network may also connect to one or more digital telephone sets one shown .

Now turning to methods of establishing calls involving mobile device will be explained in view of the logical communications depicted in the mobile device method of and the server oriented method of .

SMP responds with communication which includes an authentication token. Communication can be sent similarly to the approach of communication . The method of includes receiving the authentication token of communication and calling a DNIS number . The calling of the DNIS number is depicted in as communication to PBX which would typically occur over PLMN and PSTN and which also could occur over WiFi and Internet coupled to gateway or to PSTN . ANI information obtained for this case is compared with a database of authorized devices in order to determine whether the ANI information matches to an authorized device. If so then the authentication token can be determined to be unnecessary for the mobile device to provide on the voice channel. This decision can be communicated to device as explained below.

Upon establishing communication with PBX over the voice channel mobile device waits represented by no loop to receive one or more DTMF tones over the voice channel such tones are represented by communication in and which occurs over the established voice channel . Upon receiving tones mobile device determines whether the received tone s represent a trigger indicating that mobile device need not send the authentication token over the voice channel that was received by mobile device .

If the determination indicates that the sending of the authentication token can be dispensed then mobile device responds with one or more DTMF acknowledgement tones as indicated by communication in also over the voice channel. If determination indicates to send the authentication token then mobile device responds by providing DTMF tones representative of the authentication token also represented by communication of . Assuming that the authentication token is correctly received then the call can continue thereafter which will be explained further with respect to . The call continue is depicted with dashes to indicate that if the call is not completed on the server PBX side then device can wait to receive further tones or may ultimately time out and retry.

Thereafter the acknowledgement tone s can be received and SMP can wait subject to timeout to receive such tones . SMP can signal direct PBX to initiate a voice channel to the called party as represented by communication of FIG. which can be specified in the notice received at . The voice channel is represented by communication in . That call to the called party can be bridged with the established voice channel to mobile device . If the authentication token matched or if the acknowledgement approach was successful then the call can be conducted . If tones received after did not match the previously provided authentication token then the call can be rejected . As another example device may be directed to send the authentication token again.

Although not explicitly the focus of the method depicted in if the authentication token is provided even though it was not requested the call can also be authorized. Further other variations can be introduced such as PBX starting to initiate a call to the called party concurrently with the authentication acknowledgement of device .

Processing module communicates with mass storage which can be composed of a Random Access Memory and of non volatile memory . Non volatile memory can be implemented with one or more of Flash memory PROM EPROM and so on. Non volatile memory can be implemented as flash memory ferromagnetic phase change memory and other non volatile memory technologies. Non volatile memory also can store programs device state various user information one or more operating systems device configuration data and other data that may need to be accessed persistently.

User input interface can comprise a plurality of different sources of user input such as a camera a keyboard a touchscreen and a microphone which can provide input to speech recognition functionality .

Processing module also can use a variety of network communication protocols grouped for description purposes here into a communication module which can include a Bluetooth communication stack which comprises a L2CAP layer a baseband and a radio . Communications module also can comprise a Wireless Local Area Network interface which comprises a link layer with a MAC and a radio . Communications module also can comprise a cellular broadband data network interface which in turn comprises a link layer with MAC . Cellular interface also can comprise a radio for an appropriate frequency spectrum . Communications module also can comprise a USB interface to provide wired data communication capability. Other wireless and wired communication technologies also can be provided and this description is exemplary.

Referring to there is depicted an example of mobile device . Mobile device comprises a display and a cursor or view positioning device here depicted as a trackball which may serve as another input member and is both rotational to provide selection inputs and can also be pressed in a direction generally toward housing to provide another selection input. Trackball permits multi directional positioning of a selection cursor such that the selection cursor can be moved in an upward direction in a downward direction and if desired and or permitted in any diagonal direction. The trackball is in this example situated on a front face not separately numbered of a housing to enable a user to maneuver the trackball while holding mobile device in one hand. In other embodiments a trackpad or other navigational control device can be implemented as well.

The mobile device in also comprises a programmable convenience button to activate a selected application such as for example a calendar or calculator. Further mobile device can include an escape or cancel button a menu or option button and a keyboard . Menu or option button loads a menu or list of options on display when pressed. In this example the escape or cancel button menu option button and keyboard are disposed on the front face of the mobile device housing while the convenience button is disposed at the side of the housing. This button placement enables a user to operate these buttons while holding mobile device in one hand. The keyboard is in this example a standard QWERTY keyboard.

In the foregoing separate boxes or illustrated separation of functional elements of illustrated systems does not necessarily require physical separation of such functions as communications between such elements can occur by way of messaging function calls shared memory space and so on without any such physical separation. As such functions need not be implemented in physically or logically separated platforms although they are illustrated separately for ease of explanation herein. In particular a PBX and a server that can communicate with a device over a data channel can be implemented in separate devices or as different software based functions on a single device such as using separate processes running on a processor or group of processors more generally a processing resource or resources . These aspects can be implementation specific and a variety of implementations would occur to those of ordinary skill in view of these disclosures.

For example different embodiments of devices can provide some functions in an operating system installation that are provided at an application layer or in a middle layer in other devices. Different devices can have different designs such that while some devices implement some functions in fixed function hardware other devices can implement such functions in a programmable processor with computer code obtained from a computer readable medium.

Further some aspects may be disclosed with respect to only certain examples. However such disclosures are not to be implied as requiring that such aspects be used only in embodiments according to such examples.

The above description occasionally describes relative timing of events signals actions and the like as occurring when another event signal action or the like happens. Such description is not to be construed as requiring a concurrency or any absolute timing unless otherwise indicated.

Certain adaptations and modifications of the described embodiments can be made. Aspects that can be applied to various embodiments may have been described with respect to only a portion of those embodiments for sake of clarity. However it is to be understood that these aspects can be provided in or applied to other embodiments as well. Therefore the above discussed embodiments are considered to be illustrative and not restrictive.

