---

title: Architecture for an efficient media framework
abstract: A system comprises a first media framework component, a second media framework component, and a media framework. The media framework comprises a simplified media framework interface and a non-tunnel mode handler. The simplified media framework interface handles connectivity between a first port and a second port in a tunnel mode. The non-tunnel mode handler converts connectivity of a third port and a fourth port in a non-tunnel mode to appear to be the tunnel mode for the simplified media framework interface. The first port and the second port of the simplified media framework interface is coupled to a fifth port and a sixth port of the non-tunnel mode handler. And, the third port of the non-tunnel mode handler is coupled to the first media framework component and the fourth port of the non-tunnel mode handler is coupled to the second media framework component.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08539128&OS=08539128&RS=08539128
owner: VisualOn, Inc.
number: 08539128
owner_city: Santa Clara
owner_country: US
publication_date: 20101216
---
Processing and rendering media e.g. audio or video is a very popular application on computers cellular phones and embedded computing devices. Many different software applications exist to perform the media processing and rendering some specific to one type of computing device some which exist on multiple platforms. Underlying the software is typically a media framework application programming interface API which provides access to the media capabilities of the computing device. A media framework additionally has an associated set of functionality that may be used with the framework to build new media applications referred to variously as components or plug ins. These components may be authored by the framework authors and included along with the framework or they may be authored by a third party and distributed separately. There exist several media frameworks e.g. DirectShow OpenMAX GStreamer QuickTime Helix DNA Xine etc. Some of these media frameworks e.g. DirectShow QuickTime are authored by a software company and distributed as closed source software. Some of the media frameworks e.g. OpenMAX have functionality specified by a central organization but implementation of the functionality left to outside developers for distribution as either open or closed source software.

Many software components exist for the OpenMAX framework and many can be used together to form a single application. OpenMAX components forming an application communicate both with OpenMAX framework and with each other. Communication between OpenMAX components can be directly from one component to the next referred to as communication in tunnel mode or it can pass through and be controlled by the OpenMAX framework referred to as communication in non tunnel mode. Some OpenMAX components support communication in either tunnel mode or non tunnel mode and some OpenMAX components support communication only in non tunnel mode. Controlling and keeping track of non tunnel mode communications can be significant overhead for OpenMAX framework but is necessary to support communications involving components that do not implement tunnel mode communication. Building a non tunnel mode communication handler that is efficient even when there is a large complex network of components can be significant work for the software developer implementing OpenMAX framework.

The invention can be implemented in numerous ways including as a process an apparatus a system a composition of matter a computer program product embodied on a computer readable storage medium and or a processor such as a processor configured to execute instructions stored on and or provided by a memory coupled to the processor. In this specification these implementations or any other form that the invention may take may be referred to as techniques. In general the order of the steps of disclosed processes may be altered within the scope of the invention. Unless stated otherwise a component such as a processor or a memory described as being configured to perform a task may be implemented as a general component that is temporarily configured to perform the task at a given time or a specific component that is manufactured to perform the task. As used herein the term processor refers to one or more devices circuits and or processing cores configured to process data such as computer program instructions.

A detailed description of one or more embodiments of the invention is provided below along with accompanying figures that illustrate the principles of the invention. The invention is described in connection with such embodiments but the invention is not limited to any embodiment. The scope of the invention is limited only by the claims and the invention encompasses numerous alternatives modifications and equivalents. Numerous specific details are set forth in the following description in order to provide a thorough understanding of the invention. These details are provided for the purpose of example and the invention may be practiced according to the claims without some or all of these specific details. For the purpose of clarity technical material that is known in the technical fields related to the invention has not been described in detail so that the invention is not unnecessarily obscured.

A system is disclosed. The system comprises a first media framework component a second media framework component and a media framework. The media framework comprises a simplified media framework interface and a non tunnel mode handler. The simplified media framework interface handles connectivity between a first port and a second port in a tunnel mode. The non tunnel mode handler converts connectivity of a third port and a fourth port in a non tunnel mode to appear to be the tunnel mode for the simplified media framework interface. The first port and the second port of the simplified media framework interface are coupled to a fifth port and a sixth port of the non tunnel mode handler. The third port of the non tunnel mode handler is coupled to the first media framework component and the fourth port of the non tunnel mode handler is coupled to the second media framework component.

In some embodiments the OpenMAX media framework specifies both tunnel mode and non tunnel mode communication between components. The disclosed media framework comprises a simplified media framework that does not handle non tunnel mode communication between two components and a non tunnel mode handler that handles non tunnel mode communication between two components and makes it appear as if it is a tunnel mode communication for the simplified media framework. The simplified media framework comprises an OpenMax media framework except that it does not handle non tunnel mode communication between components. In various embodiments components comprise file handler s file container parser s audio renderer s video renderer s audio decoder s video decoder s or any other appropriate media framework component. In some embodiments the non tunnel mode handler makes the simplified media framework easier to implement. In some embodiments the simplified media framework is able to handle more complex graphs of components more easily and remain a fully OpenMAX compliant media framework.

Architecture for an efficient media framework is disclosed. Software for efficiently handling non tunnel mode communications among OpenMAX media framework components is developed and modularized separately from the OpenMAX media framework implementation. The non tunnel mode handling software interfaces with components and allows them to communicate in either tunnel mode or non tunnel mode as they desire handling non tunnel mode communication as though it were the media framework. The handling software also interfaces with the media framework and informs it that all components are communicating in tunnel mode regardless of their actual communication mode. Communications between the media framework and the components pass through the handling software. Communications not related to inter component communication are passed on from the handling software to the component at which they were directed. Communications related to inter component communication are intercepted by the handling software and translated to account for the discrepancy occurring because the media framework functions as though the component is in tunnel mode even though it may be in non tunnel mode.

In some embodiments computing system comprises a smart phone that includes a media framework coupled to one or more components where the media framework coupled to the one or more components is capable of loading a data file for example a video or audio file and processing the data file to present the data file to a user. In various embodiments the data file is presented to the user as a video stream displayed using a color or black and white display or an audio stream output using a speaker or headphones or broadcast to a wireless connected audio output device e.g. a Bluetooth connected head set . In some embodiments processing the data file includes decompressing or decrypting the data file for example processing the data file compatible with a format such as MPEG 1 MPEG2 MPEG4 e.g. formats specified by the Moving Picture Experts Group H.264 AAC MP3 Windows Media Audio Windows Media Video MIDI media containers such as AVI ASF WAV AAC or MP4. In various embodiments data storage device comprises a solid state memory e.g. a random access memory a magnetic memory an optical memory or any other appropriate data storage device.

When non tunnel mode communication is established between non tunneling media framework component and non tunneling media framework component media framework creates buffer and establishes links from non tunneling media framework component to buffer and from non tunneling media framework component to buffer . Media framework coordinates communications between non tunneling media framework component and non tunneling media framework component via buffer . In some embodiments when non tunneling media framework component is to send data to non tunneling media framework component media framework requests non tunneling media framework component to input data to buffer . When non tunneling media framework component has finished inputting data to buffer it communicates to media framework that it is finished. Media framework then requests non tunneling media framework component to retrieve data from buffer . When non tunneling media framework component has finished retrieving data from buffer it communicates to media framework that it has finished and the data transfer is complete. A complementary process occurs when non tunneling media framework component is to send data to non tunneling media framework component .

In various embodiments when non tunnel mode communication is established between non tunneling media framework component and non tunneling media framework component media framework decides the buffer utilization policy. The buffer utilization policy indicates buffers utilized for the communication between non tunneling media framework component and non tunneling media framework component . Buffers may be located in non tunneling media framework component in non tunneling media framework component or in any other appropriate location. In various embodiments a buffer is allocated using a create a buffer command or a buffer is not allocated or created. For instance if either non tunneling media framework component or non tunneling media framework component has its own buffer then media framework will use an available buffer. In some embodiments if both non tunneling media framework component and non tunneling media framework component insist on using their own buffer then copying data from one buffer to the other may be required. Media framework coordinates data flow between non tunneling media framework component and non tunneling media framework component regardless of whether the buffer used for communication is located within media framework or in another location.

When tunnel mode communication is established between tunneling media framework component and tunneling media framework component tunneling media framework component creates buffer and establishes a link between tunneling media framework component and buffer . In some embodiments when tunneling media framework component is to send data to tunneling media framework component it inputs the data to buffer and then communicates to tunneling media framework component to retrieve the data from buffer . When tunneling media framework component has finished retrieving the data from buffer it communicates to tunneling media framework component that it has finished and the data transfer is complete. In various embodiments when tunnel mode communication is established between tunneling media framework component and tunneling media framework component the communication buffer is established in tunneling media framework component in another media framework component or in any other appropriate location.

In the example shown communications between media framework and non tunneling media framework component and non tunneling media framework component pass through non tunnel mode handler . Communications not related to inter component communication are passed from non tunnel mode handler to the component at which they were directed. Communications related to inter component communication are intercepted by non tunnel mode handler and translated. The translation carried out by non tunnel mode handler ensures that media framework can interact with non tunneling media framework component and non tunneling media framework component as though they are communicating in tunnel mode despite their communicating in non tunnel mode coordinated by non tunnel mode handler without discrepancies or errors arising.

When non tunnel mode communication is established between non tunneling media framework component and non tunneling media framework component non tunnel mode handler creates buffer and establishes links from non tunneling media framework component to buffer and from non tunneling media framework component to buffer . Non tunnel mode handler coordinates communications between non tunneling media framework component and non tunneling media framework component via buffer . In some embodiments when non tunneling media framework component is to send data to non tunneling media framework component non tunnel mode handler requests non tunneling media framework component to input data to buffer . When non tunneling media framework component has finished inputting data to buffer it communicates to non tunnel mode handler that it is finished. Non tunnel mode handler then requests non tunneling media framework component to retrieve data from buffer . When non tunneling media framework component has finished retrieving data from buffer it communicates to non tunnel mode handler that it has finished and the data transfer is complete. A complementary process occurs when non tunneling media framework component is to send data to non tunneling media framework component .

In various embodiments when non tunnel mode communication is established between non tunneling media framework component and non tunneling media framework component non tunnel mode handler creates a buffer located in non tunneling media framework component located in non tunneling media framework component or in any other appropriate location. Non tunnel mode handler coordinates data flow between non tunneling media framework component and non tunneling media framework component regardless of whether the buffer used for communication is located within non tunnel mode handler or in another location.

When non tunnel mode communication is established between non tunneling media framework component and non tunneling media framework component non tunnel mode handler communicates to media framework that non tunneling media framework component and non tunneling media framework component are communicating in tunnel mode. Media framework has no responsibility for coordinating communication between non tunneling media framework component and non tunneling media framework component if they are communicating in tunnel mode. Responsibility for coordinating communication between non tunneling media framework component and non tunneling media framework component is then left to non tunnel mode handler . In the event that media framework component graph comprises a complex graph of media framework components including non tunnel mode communication e.g. media framework component graph of media framework is able to treat the graph as though all communications are made in tunnel mode reducing the complexity it has to coordinate.

In the example shown simplified media framework handles connectivity between port and port in a tunnel mode e.g. as though components connected to port and port are communicating in tunnel mode as described in the section regarding . Non tunnel mode handler converts connectivity between port and port in a non tunnel mode e.g. components connected to port and port are communicating in a non tunnel mode as described in the section regarding to appear as connectivity in a tunnel mode at port and port . Port of simplified media framework is coupled to port of non tunnel mode handler and port of simplified media framework is coupled to port of non tunnel mode handler . Non tunneling media framework is coupled to port of non tunnel mode handler and non tunneling media framework component is coupled to port of non tunnel mode handler . Communication between non tunneling media framework component and non tunneling media framework component is handled in non tunnel mode by non tunnel mode handler at port and port and is converted to appear as components communicating in tunnel mode at port and port which are controlled by simplified media framework at port and port .

When a media framework developer is developing simplified media framework for use with non tunnel mode handler the media framework developer is able to leave out the parts of the media framework regarding non tunnel mode communication. Development complexity and time is thereby reduced and a simplified media framework is created. Simplified media framework is combined with non tunnel mode handler to create media framework which conforms to media framework specifications.

Although the foregoing embodiments have been described in some detail for purposes of clarity of understanding the invention is not limited to the details provided. There are many alternative ways of implementing the inventio. The disclosed embodiments are illustrative and not restrictive.

