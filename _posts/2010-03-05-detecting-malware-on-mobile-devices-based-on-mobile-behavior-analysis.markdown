---

title: Detecting malware on mobile devices based on mobile behavior analysis
abstract: Applications running on a mobile device are monitored for suspicious actions utilizing mobile features of the mobile device. Once a suspicious action performed by an application is detected, that suspicious action is suspended. Information about the suspicious action and the application is collected and transmitted to a remote security system over a wireless network. The security system analyzes the suspicious action and the application to determine a security rating of the application, and transmit the security rating back to the mobile device. Whether the application is malware and whether the suspicious action should be allowed to continue are both determined based on the security rating.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09479357&OS=09479357&RS=09479357
owner: Symantec Corporation
number: 09479357
owner_city: Mountain View
owner_country: US
publication_date: 20100305
---
The disclosure generally relates to the field of computer security in particular to detecting malicious software applications on mobile devices.

A wide variety of malicious software malware can attack modern computers. Malware threats include computer viruses worms Trojan horse programs spyware adware crimeware and phishing websites. Malicious entities sometimes attack servers that store sensitive or confidential data that can be used to the malicious entity s own advantage. Similarly other computers including home computers must be constantly protected from malicious software that can be transmitted when a user communicates with others via electronic mail when a user downloads new programs or program updates and in many other situations. The different options and methods available to malicious entities for attack on a computer are numerous.

Conventional techniques for detecting malware on personal computers such as signature string scanning are proven to be ineffective for detecting malware on mobile devices such as mobile phones. Because the mobile devices typically have limited computing capacity resource demanding malware detection techniques such as virtual execution and sandboxing cannot be applied in the mobile devices. Similarly because of their resource limitations collecting virus samples is also difficult on mobile devices making fingerprint based malware detection techniques unreliable for detecting malware on mobile devices. In addition because fingerprint based malware detection techniques rely upon predefined fingerprints of known threads they cannot detect unknown threads. Accordingly there is a need for new techniques that can detect malware on mobile devices.

Embodiments of the present disclosure include methods and corresponding systems and non transitory computer readable storage media for detecting malware on mobile devices.

One aspect of the present disclosure is a computer implemented method for detecting a malicious application on a mobile device comprising detecting a suspicious action performed by an application running on the mobile device the suspicious action attempting to access a mobile feature of the mobile device suspending the suspicious action performed by the application collecting information about the suspicious action and the application transmitting the collected information to a remote computer through a wireless network receiving a security rating of the application through the wireless network the security rating comprising a measurement of a likelihood of the application for being malware and determining whether the application is malware based on the security rating.

Another aspect of the present disclosure is a mobile device for detecting a malicious application on the mobile device comprising a non transitory computer readable storage medium storing executable computer program code the computer program code comprising program code for detecting a suspicious action performed by an application running on the mobile device the suspicious action attempting to access a mobile feature of the mobile device suspending the suspicious action performed by the application collecting information about the suspicious action and the application transmitting the collected information to a remote computer through a wireless network receiving a security rating of the application through the wireless network the security rating comprising a measurement of a likelihood of the application for being malware and determining whether the application is malware based on the security rating.

Still another aspect of the present disclosure is a non transitory computer readable storage medium encoded with executable computer program code for detecting a malicious application on a mobile device the computer program code comprising program code for detecting a suspicious action performed by an application running on the mobile device the suspicious action attempting to access a mobile feature of the mobile device suspending the suspicious action performed by the application collecting information about the suspicious action and the application transmitting the collected information to a remote computer through a wireless network receiving a security rating of the application through the wireless network the security rating comprising a measurement of a likelihood of the application for being malware and determining whether the application is malware based on the security rating.

The features and advantages described in the specification are not all inclusive and in particular many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims. Moreover it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and may not have been selected to delineate or circumscribe the disclosed subject matter.

The Figures FIGS. and the following description describe certain embodiments by way of illustration only. One skilled in the art will readily recognize from the following description that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein. Reference will now be made in detail to several embodiments examples of which are illustrated in the accompanying figures. It is noted that wherever practicable similar or like reference numbers may be used in the figures and may indicate similar or like functionality.

A mobile device is an electronic device with mobile features e.g. telephonic functionality that can host malicious software. One example of a mobile device is a mobile telephone e.g. a smartphone executing for example a mobile operating system OS such as Microsoft Windows Mobile Apple iPhone OS Google Android and Palm WebOS. Another example of a mobile device is a device having networking and computing functionality such as a personal digital assistant PDA . A mobile device typically stores numerous computer files that can host malicious software.

Malicious software sometimes called malware is generally defined as software that executes on the mobile device surreptitiously or that has some surreptitious functionality. Malware can take many forms such as parasitic viruses that attach to legitimate files worms that exploit weaknesses in the mobile device s security in order to infect the mobile device and spread to other mobile devices Trojan horse programs that appear legitimate but actually contain hidden malicious code and spyware that monitors user inputs and or other actions on the mobile device in order to capture sensitive information or display advertisements.

The mobile device executes a security module for detecting malware running on the mobile device . The security module can be for example incorporated into the mobile OS of the mobile device or part of a separate comprehensive security package. In one embodiment the security module is provided by the entity that operates the security system . The security module can communicate with the security system via the network for information related to malware detection.

The security module monitors applications running on the mobile device to detect suspicious actions or sequence of actions in real time suspends or blocks the detected suspicious actions and transmits related information to the security system via the network . Examples of the transmitted information include information describing the suspicious actions e.g. timing frequency and fingerprints of the applications performing the suspicious actions also called the suspicious application . The security module receives security ratings of the suspicious applications from the security system . A security rating comprises an assessment of a likelihood of a corresponding suspicious application being malicious versus being legitimate . For example the security rating can have a set of values such as the following Low Middle High and Serious where Low indicates a low likelihood of the application being malicious and Serious indicates a very high likelihood of the application being malicious. Alternatively the security rating can be a continuous value ranging from 0 to 1 with a score of 0 indicating a very low likelihood of the application being malicious and a score of 1 indicates a very high likelihood of the application being malicious. The security module determines whether the suspicious application is malware and or whether to allow the suspicious action based on the received security rating.

In one embodiment in addition to or instead of monitoring suspicious actions the security module monitors web browsing activities on the mobile device . After detecting an action to visit a certain web page or website the security module suspends the action and transmits information about the web page e.g. its Uniform Resource Locator URL to the security system . The security module subsequently receives a security rating of the web page and allows the action to go through only if the security rating indicates that the web page is likely legitimate e.g. the security rating is below a threshold value . Otherwise if the security rating indicates that the web page is likely malicious the security module prompts the user with a warning about the malicious nature of the web page and only continues the action upon receiving an explicit authorization from the user.

The security system is a hardware device and or software program configured to receive information about applications performing suspicious actions on the mobile devices analyze the suspicious actions and or the suspicious applications to determine security ratings of the suspicious applications and send the security ratings back to the mobile devices . In one embodiment one or more of the functions of the security system is provided by a cloud computing environment. As used herein cloud computing refers to a style of computing in which dynamically scalable and often virtualized resources are provided as a service over the network .

The security system determines the security rating of a suspicious application by traversing a decision tree based on information related to the suspicious action and or the suspicious application. Alternatively or additionally the security system may apply one or more security rules and or conduct statistical analysis on data collected from multiple mobile devices to determine the security rating.

In one embodiment the security system also receives information about web browsing activities detected on the mobile device determines security scores for the web page or website to be visited and returns the security scores to the mobile device . For example the security system can access a central database that includes information about websites to determine the security score of a particular website i.e. likelihood of the website for being malicious versus being legitimate . As another example the security system can determine the security score of a website using techniques such as virtual execution and sandboxing e.g. executing a browser in a virtual execution system to visit the website and analyzing the consequences of the visit and or based on related feedback from other mobile devices e.g. statistical analysis behavior analysis .

The network enables communications between the mobile device and the security system and may include a voice and or data network. Examples of voice networks include Global System of Mobile GSM communication system a Code Division Multiple Access CDMA system and a Universal Mobile Telecommunications System UMTS . Examples of data networks include General Packet Radio Service GPRS third generation 3G mobile or greater High Speed Download Packet Access HSDPA High Speed Uplink Packet Access HSUPA and Worldwide Interoperability for Microwave Access WiMAX .

The entities shown in are implemented using one or more computers. is a high level block diagram illustrating an example computer . The computer includes at least one processor coupled to a chipset . The chipset includes a memory controller hub and an input output I O controller hub . A memory and a graphics adapter are coupled to the memory controller hub and a display is coupled to the graphics adapter . A storage device keyboard pointing device and network adapter are coupled to the I O controller hub . Other embodiments of the computer have different architectures.

The storage device is a non transitory computer readable storage medium such as a hard drive compact disk read only memory CD ROM DVD or a solid state memory device. The memory holds instructions and data used by the processor . The pointing device is a mouse track ball or other type of pointing device and is used in combination with the keyboard to input data into the computer . The graphics adapter displays images and other information on the display . The network adapter couples the computer to one or more computer networks.

The computer is adapted to execute computer program modules for providing functionality described herein. As used herein the term module refers to computer program logic used to provide the specified functionality. Thus a module can be implemented in hardware firmware and or software. In one embodiment program modules are stored on the storage device loaded into the memory and executed by the processor .

The types of computers used by the entities of can vary depending upon the embodiment and the processing power required by the entity. For example the security system might comprise multiple blade servers working together to provide the functionality described herein. As another example the mobile device might comprise a mobile telephone with limited processing power. The computers can lack some of the components described above such as keyboards graphics adapters and displays .

The application monitor module monitors applications running on the mobile device and detects suspicious actions or sequence of actions performed by the applications in real time. Suspicious actions are actions that legitimate applications normally would not perform. Malware often attempts to access certain mobile specific features of the mobile device to cause damage e.g. incur financial cost on the mobile device . Examples of such attempts are listed below 

An attempt to access a mobile feature by itself is not necessarily a suspicious action since legitimate applications also make such attempts for legitimate purposes. However the attempts made by malware often share some characteristics that are uncommon among the attempts made by legitimate applications. For example a legitimate application only sends out a SMS MMS message after explicit user authorization e.g. clicking the send button and does not send out messages automatically in the background. On the other hand because of it surreptitious nature malware typically sends out SMS MMS messages automatically in the background. Accordingly the suspicious actions can be defined using contextual characteristics such as whether the action is performed in the background versus with explicit user authorization . Below is a list of example definitions of suspicious actions related to sending SMS MMS messages 

In one embodiment in addition to or instead of detecting individual suspicious actions the application monitor module detects sequences or combinations of actions that collectively are suspicious i.e. uncommon among legitimate applications . Below are definitions of two sequences of actions that collectively are suspicious called suspicious sequences 

After the application monitor module detects a suspicious action or sequence performed by an application running on the mobile device the application monitor module suspends or blocks the operation of the application to prevent the suspicious action or sequence from negatively affecting the mobile device . In addition the application monitor module collects information related to the suspicious action and or the suspicious application. Examples of the information collected for a suspicious attempt by an application to send a SMS message are listed below 

The communication module communicates with the security system to provide information about the suspicious actions and or the suspicious applications and to receive security ratings of the suspicious applications from the security system . The communication module stores the received information in the data store together with other related information for the suspicious applications.

The security analysis engine determines whether a suspicious application is malware by analyzing the received security rating of the suspicious application. For example assuming the security rating is a value ranging from 0 to 1 if the security rating exceeds a predetermined threshold value e.g. 0.5 then the security analysis engine determines that the suspicious application is malware and otherwise legitimate.

In addition the security analysis engine determines whether to allow the suspicious action to continue based on the security rating. In one embodiment the security analysis engine treats the suspicious actions differently based on their corresponding security ratings. For example the table below lists the security ratings and their corresponding treatments the security analysis engine may apply to the associated suspicious actions.

The data store stores data used by the security module . Examples of such data include information collected for the applications running on the mobile device e.g. suspicious actions fingerprints received security ratings and information about the security system e.g. IP address . The data store may be a relational database or any other type of database that stores the data such as a flat file.

The communication module receives information about applications performing suspicious actions from the security modules running on the mobile devices stores the received information in a central database e.g. the data store and provides security ratings determined by the security analysis engine for the suspicious applications to the security modules .

The security analysis engine analyzes the received information about an application performing a suspicious action on the mobile device to determine a security rating for the suspicious application. In one embodiment the security analysis engine conducts statistical analysis on data collected from multiple mobile devices to determine the security rating. For example if the application that performed the suspicious action has been determined to have a high security rating the application is likely malicious on other mobile devices e.g. with identical fingerprints the security analysis engine may determine a high security rating for the suspicious application even if the suspicious action itself has not been observed before. As another example if the suspicious action or sequence has been performed by other applications and most of the applications have been assigned high security ratings the security analysis engine may determine a high security rating for the suspicious application even if the application itself has not been observed before. Thus the accuracy of the security ratings the security analysis engine determines for a suspicious action and or a suspicious application can improve as it collects more related information from mobile devices .

Alternatively or additionally the security analysis engine may traverse a decision tree based on information related to the suspicious action e.g. whether the action was performed automatically in the background the suspicious application e.g. whether the application is signed by a reputable software publisher and or the mobile device e.g. whether the mobile device has reported similar suspicious actions before . The decision tree itself may be induced from the data collected from the multiple mobile devices using a decision tree induction algorithm. The security analysis engine may apply other decision making systems such as the Bayesian decision making system to determine the security scores. Further the security analysis engine may apply one or more security rules derived from a set of security policies to determine the corresponding security rating. For example if a security policy prohibit sending SMS messages in the background or to a service provider number the security analysis engine automatically determines a high security rating e.g. High Serious in response to suspicious actions that fall into the prohibited category such that applications making such attempts either are terminated or continue only upon explicit user authorization. The table below lists a set of example security rules for determining the security ratings of suspicious attempts to send SMS messages 

In one embodiment the security analysis engine transmits some security rules to the security modules to enforce locally also called the local security rules . Examples of the local security rules include security rules that are well established e.g. security rules generated by human experts or derived from important security policies. The security modules store the local security rules on the mobile devices and apply the local security rules to determine security ratings when desirable e.g. when the security system is unavailable or nonresponsive .

The security analysis engine may also apply additional malware detection techniques such as virtual execution and sandboxing to further analyze the suspicious applications. For example assuming the security module uploads a suspicious application to the security system the security analysis engine executes or installs the suspicious application in a self enclosed environment e.g. an emulator a sand box detects suspicious actions or take snapshots of this application and analyzes these actions to determine a security rating for the suspicious application. If the suspicious application is indeed malware the application will exhibit suspicious actions over the course of its execution and the security analysis engine will determine a security rating based on these suspicious actions. In one embodiment the security analysis engine does not terminate the suspicious application after it exhibits a dangerous action e.g. attempting to delete the system registry and leaves the suspicious application running.

The data store stores data used by the security system . Examples of such data include the information received from the security modules and information about the mobile devices to name a few. The data store may be a relational database or any other type of database.

The security module monitors applications running on the mobile device to detect suspicious actions in real time. Once the security module detects a suspicious action the security module suspends or blocks the detected suspicious action collected relevant information and transmits the collected information to the security system . The security module subsequently receives security score of the application from the security system and determines whether the application is malware and whether to allow the suspicious action to continue based on the security score. Depending on the security score the security module may allow the application to continue with or without alerting the user of the suspicious action prompt the user for an explicit authorization of the suspicious action before allowing the application to continue or terminate the application and delete it from the mobile device . In one embodiment in addition to or instead of communicating with the security system for the security rating the security module also applies one or more local security rules to determine the security score itself e.g. when the security system cannot be reached or is nonresponsive .

Some portions of above description describe the embodiments in terms of algorithmic processes or operations. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs comprising instructions for execution by a processor or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of functional operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

As used herein any reference to one embodiment or an embodiment means that a particular element feature structure or characteristic described in connection with the embodiment is included in at least one embodiment. The appearances of the phrase in one embodiment in various places in the specification are not necessarily all referring to the same embodiment.

Some embodiments may be described using the expression coupled and connected along with their derivatives. It should be understood that these terms are not intended as synonyms for each other. For example some embodiments may be described using the term connected to indicate that two or more elements are in direct physical or electrical contact with each other. In another example some embodiments may be described using the term coupled to indicate that two or more elements are in direct physical or electrical contact. The term coupled however may also mean that two or more elements are not in direct contact with each other but yet still co operate or interact with each other. The embodiments are not limited in this context.

As used herein the terms comprises comprising includes including has having or any other variation thereof are intended to cover a non exclusive inclusion. For example a process method article or apparatus that comprises a list of elements is not necessarily limited to only those elements but may include other elements not expressly listed or inherent to such process method article or apparatus. Further unless expressly stated to the contrary or refers to an inclusive or and not to an exclusive or. For example a condition A or B is satisfied by any one of the following A is true or present and B is false or not present A is false or not present and B is true or present and both A and B are true or present .

In addition use of the a or an are employed to describe elements and components of the embodiments herein. This is done merely for convenience and to give a general sense of the disclosure. This description should be read to include one or at least one and the singular also includes the plural unless it is obvious that it is meant otherwise.

Upon reading this disclosure those of skill in the art will appreciate still additional alternative structural and functional designs for a system and a process for detecting malware on a mobile device. Thus while particular embodiments and applications have been illustrated and described it is to be understood that the present invention is not limited to the precise construction and components disclosed herein and that various modifications changes and variations which will be apparent to those skilled in the art may be made in the arrangement operation and details of the method and apparatus disclosed herein without departing from the spirit and scope as defined in the appended claims.

