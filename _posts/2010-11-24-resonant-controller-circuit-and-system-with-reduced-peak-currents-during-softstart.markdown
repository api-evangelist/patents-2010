---

title: Resonant controller circuit and system with reduced peak currents during soft-start
abstract: A circuit includes a first control output adapted to couple to a control terminal of a first transistor and a second control output adapted to couple to a control terminal of a second transistor. The circuit further includes a feedback input for receiving a signal and a control circuit. The control circuit is configured to independently control first and second on-times of control signals applied to the first and second control outputs, respectively, in response to receiving the signal to limit a current at an output node.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08804382&OS=08804382&RS=08804382
owner: Semiconductor Components Industries, LLC
number: 08804382
owner_city: Phoenix
owner_country: US
publication_date: 20101124
---
The present disclosure is generally related to switching power supplies and more particularly to switching power supplies with soft start functionality.

When first turned on many electronic devices consume a transient peak current which can cause voltage fluctuations and affect the performance of other circuits connected to a common power supply. The transient peak current is sometimes referred to as an inrush current. In switching power regulators including those with bridge type power stages charging of gate capacitances bridge capacitances and reactive loads can introduce these transient peak currents during startup stressing or damaging associated circuitry if such peak currents are not adequately controlled. Generally switching power regulators include soft start circuitry configured to suppress the transient peak currents by controlling the charging rates of any reactive elements.

One technique for controlling such peak currents includes biasing the switching field effect transistors FETs into their linear region. Controlling the FETS in this manner reduces the peak currents but applies undesirable stress to the FETs. Further in this technique the switching power supply does not operate properly at higher power levels without expensive high power FETs.

Another technique for controlling peak currents uses a frequency ramp soft start method where the frequency of drive pulses for controlling the FETs decreases over time from a high frequency down to an operating frequency level. Unfortunately this technique still introduces a large current spike on start up that is dependent on the size of the resonant capacitor and on the charge stored by the resonant capacitor on startup. If the resonant capacitor is large and or there is no stored charge the current spike will also be large as the resonant capacitor charges.

Still another technique for controlling such peak currents involves increasing the amplitudes of the gate drive signals of the switching FETs. In this method the gate voltages of the high side and low side FETs are slowly increased with each cycle. The low gate voltage for each turn on cycle makes the FETs more resistive and slowly ramps the inductor current. However cyclically increasing the gate amplitudes can cause overdissipation on the FETs and reliability issues and may not work in some applications.

In an embodiment a circuit includes a first control output adapted to couple to a control terminal of a first transistor and a second control output adapted to couple to a control terminal of a second transistor. The circuit further includes a feedback input for receiving a signal and a control circuit. The control circuit is configured to independently control first and second on times of control signals applied to the first and second control outputs respectively in response to receiving the signal to limit a current at an output node.

In another embodiment a system includes an output node and a first transistor having a first current electrode coupled to a first power supply terminal a control electrode and a second current electrode coupled to the output node. The circuit further includes a second transistor having a first current electrode coupled to the output node a control electrode and a second current electrode coupled to a second power supply terminal. The circuit also includes a controller having a feedback input coupled to the output node a first output coupled to the control electrode of the first transistor and a second output coupled to the control electrode of the second transistor. The controller detects a signal at the output node and independently controls at least one of the first transistor and the second transistor in response to the signal to limit a current at the output node.

In yet another embodiment a method includes selectively applying one of a first drive signal to a first connection coupled to a control electrode of a first transistor and a second drive signal to a second connection coupled to a control electrode of a second transistor. The first transistor includes a first current electrode coupled to a first power supply terminal and a second current electrode coupled to an output node. The second transistor includes a first current electrode coupled to the output node and a second current electrode coupled to a second power supply terminal. The method further includes measuring a signal related to a current at the output node and selectively controlling at least one of the first drive signal and the second drive signal to independently control on times of the first and second transistors in response to measuring the signal.

In the following description the use of the same reference numerals in different drawings indicates similar or identical items.

In resonant controllers a soft start circuit prevents the sudden application of relatively high or potentially destructive currents into a resonating circuit. Conventionally control circuitry charges a soft start capacitor and utilizes the capacitor voltage to produce a modulated oscillation frequency. In particular the charging current causes the controller to decrease the operating frequency to a pre determined frequency level. As the soft start capacitor charges the control circuit decreases the operating frequency. However the frequency method of soft start can produce large current spikes at the beginning of the startup process depending on the charge stored by the resonant capacitor on startup. If the capacitor happens to start at ground and the high and low side drive signals have the same on time then the current will increase faster in response to the high side drive signal than it can discharge in response to the low side drive signal. This produces a large successively increasing current until the voltage across the resonant capacitor reaches a mid rail voltage level.

Embodiments of systems and methods described below independently control the on times of the high and low side FETs during each cycle to prevent cycle by cycle current build up and to limit a peak current. Embodiments of a circuit are configured to control the on times of the high side FET and or the low side FET to ensure that the discharge of the low side FET and or the charge of the high side FET at least reaches a threshold current level such as a zero current level . In this way the current does not build up from one cycle to the next but rather returns at least to a pre determined threshold level when each FET is on before the next cycle begins. Further the on times are controlled to ensure that the discharge of the current during the low side FET on time does not fall below a negative current level and the charge of the current during the high side FET on time does not exceed a positive current level. By independently controlling the on times of the high and low side FETS i.e. by independently controlling the pulse widths of the high and low side drive signals the current peak into the load can be controlled.

To understand how independent control of the high and low side drive signals can impact the current into the load the following discussion introduces a half of an H bridge circuit coupled to an inductive capacitive load to explain how the high and low side drive signals control the current driven into the load. An example of such a circuit is described below in .

Circuit includes an inductor having a first terminal connected to the source of transistor and the drain of transistor and a second terminal. Circuit further includes a capacitor including a first electrode connected to the second terminal of inductor and a second electrode connected to ground. Capacitor charges based on the inductor current I and stores a capacitor voltage Vcap .

In operation a control circuit not shown applies a high side drive signal to the gate of transistor to control current to flow through transistor and applies a low side drive signal to the gate of transistor to control current flow through transistor . The current through transistor flows into inductor as inductor current I charging capacitor to a capacitor voltage Vcap . After a period of time the control circuit applies the high side drive signal to control current flow through transistor and applies the low side drive signal to control current flow through transistor decreasing the inductor current I .

In a frequency based soft start system the switching frequency of the high side drive signal and the low side drive signal decreases over time from the initial startup gradually increasing the capacitor voltage Vcap . However the inductor resists changes in the flow of inductor current I . If the on times of the high side drive signal and the low side drive signal are substantially equal the inductor current I can successively increase with each switching cycle. In particular if the inductor current I does not reach a zero current level while transistor is active when transistor is activated the current flowing through transistor will aggregate with the existing inductor current I causing the inductor current I to increase over time. This increasing current can stress associated circuitry potentially to damaging levels. In embodiments of the invention described below the on times are controlled such that the on time of the low side drive signal is different from that of the high side drive signal to ensure that the inductor current I reaches a zero current level or another pre determined level before switching transistors and .

As previously mentioned the conventional frequency method of soft start can cause the inductor current to increase rapidly over time. An example of a timing diagram depicting the increasing inductor current I is described below with respect to .

Capacitor voltage and inductor current I are shown to begin increasing with a first rising edge of the high side drive signal . With the falling edge of the high side drive signal the low side drive signal increases to a logic high level and both the rate of increase of the capacitor voltage Vcap and the level of the inductor current I start to decrease. However when the low side transistor is active the inductor current I decreases more slowly than it increases when transistor is active. Thus the inductor current I gradually increases over time with each cycle of the high and low side drive signals and . In the inductor current I and the capacitor voltage Vcap rates of change are exaggerated for illustration purposes. It should be understood that cycle to cycle changes actually occur gradually over many cycles. At some future point in time not shown the capacitor voltage reaches a mid rail voltage level or some other pre determined voltage level. Unfortunately the peak currents in the inductor due to the net increase in current each cycle can stress associated circuitry as noted. An example of the high peak currents due to such equal on times in a frequency method of soft start is described below with respect to .

Unfortunately the initial peak currents at and stress the associated circuitry and can damage such circuitry. Further such peak currents necessitate over sized over rated system components rated to withstand such peak currents without sustaining damage. Such over sized over rated system components increase the overall costs of the circuitry.

If the resonant capacitor voltage Vcap starts at ground and switching starts with both the high side drive signal and the low side drive signal with equal on times then the voltage on the inductor is much higher when the transistor is turned on than when the transistor is turned on. As a result the inductor current I increases with each switching cycle until Vcap is charged to the normal operating level resulting in a positive current peak of a magnitude similar to that at .

Thus when transistors and are controlled to have the same on times inductor current I can increase to a current level that can damage associated circuitry. To avoid such a current build up the pulse width of the low side drive signal can be controlled independently of the high side drive signal to increase or decrease the on time of transistor such that during a next pulse of the high side drive signal the peak of the inductor current I does not continue to increase. In one instance a control circuit controls the pulse width of the low side drive signal to extend the on time of transistor until a pre determined current level of inductor current I is reached. An example of a timing diagram for independent control of the on times of the high side and low side transistors is described below with respect to .

In the illustrated example when the high side drive signal is high the low side drive signal is low. In actuality there is a very short duration when both the low side drive signal and the high side drive signal are low between at least some of the pulses however such periods are omitted from the drawing for ease of discussion. During a first high signal time T high side drive signal is at a logic high level causing current flow through transistor and through inductor charging the capacitor . Capacitor voltage increases at a first rate and the inductor current increases at a second rate. During a first low signal time T low side drive signal is at a logic high level causing current to flow through transistor . During this period the rate of charging of the capacitor voltage decreases as the inductor current decreases to a zero current level. In this example when the inductor current reaches the zero current level the slope of the capacitor voltage rate of change is zero. If the inductor current were to fall below the zero current level the capacitor voltage would begin to decrease and the capacitor voltage graph would show a negative slope during such an interval. In the illustrated example the first low signal time T is greater than the first high signal time T allowing time for inductor current to decrease to zero before application of the next high signal time T i.e. before the beginning of the next cycle .

In this instance when inductor current reaches a zero current level the control circuit applies high and low side drive signals and to the gates of transistors and to allow current flow through transistor and to turn off current flow through transistor . During time T capacitor voltage increases and inductor current also increases. During time T the rate of charging of the capacitor voltage decreases once again as inductor current decreases to the zero current level. While the capacitor voltage is shown to increase substantially over three pulses it should be understood that the capacitor voltage and the inductor current are exaggerated in to illustrate the point that the capacitor continues to charge controllably even when the inductor current is returned to the zero current level between each cycle. Thus over a sequence of pulses capacitor voltage increases and the inductor current varies within a current range. In another embodiment the capacitor voltage may be initially charged and the system may operate using a high side detection scheme changing the high side and low side drive signals and such that they would be substantially interchanged. Further while the example of describes a zero crossing threshold it should be appreciated that other thresholds may be used that are offset from the zero current level. While the able example suggests a fixed current threshold in another embodiment a control circuit may adjust the threshold levels dynamically during the soft start process.

The pulse width of the high side drive signal does not have to remain constant. As the voltage on the resonant capacitor increases the high side drive signal can stay on longer to achieve the same peak current. The pulses of high side drive signal continue to get wider until the operating frequency is reached or until the maximum on time of the high side drive is reached often half of the normal operating period . In the illustrated example the portion of the high side drive signal that is shown appears to be constant but the on time of the high side pulses vary to allow time for the inductor current to reach a pre determined level before the next low side drive signal pulse. In another embodiment the pulse widths of the low side drive signal can be varied to reach the pre determined level. In another alternative embodiment the pulse widths of both the high and low side drive signals and can be varied independently.

In the illustrated example the capacitor voltage Vcap starts at a zero volt level. Low side drive signal is allowed to stay on longer than the high side drive signal allowing low side transistor to conduct current for longer than transistor providing more time for the inductor current I to discharge. In this case inductor current I is allowed to discharge to a zero current level however any low side on time that allows a net charging of the capacitor voltage Vcap of the capacitor without substantially increasing the inductor current I over switching cycles can be selected. The zero current detect threshold provides one possible convenient current level for achieving the net charging of the capacitor without increasing the inductor current I over multiple cycles. However it should be appreciated that other current levels may also work. In a particular example a non zero current level such as plus or minus 50 mA is used as the switching threshold. In some instances it may be desirable to use a threshold indicative of a switching transition occurring later in time than that indicated by inductor zero current crossing such that zero voltage switching occurs.

In the conventional equal on time implementation the frequency method of soft start can produce reasonably high peak current spikes. However even with an initially low resonant capacitor voltage Vcap the soft start method described in above controls and reduces the absolute value of the peak current level. An example of a resonant controller configured to independently control the high side and low side on times to control the inductor current Iind is described below in .

Circuit includes pads and . Pad connects circuit to the gate of transistor . Pad connects circuit to the gate of transistor . Pad is a bridge node feedback input that connects circuit to the source of transistor the drain of transistor and the first terminal of inductor . Pad connects circuit to ground and to the drain of transistor .

Circuit further includes a high side driver circuit having a first input connected to pad a second input connected to pad and an output connected to pad . Circuit also includes a level shift circuit including a first input connected to pad through diode a second input connected to pad a first output connected to high side driver circuit and a second output connected to an input of a logic timing circuit which has a second input connected to an output of a comparator and an output connected to an input of low side driver circuit . Low side driver circuit includes an output connected to pad . In an alternative embodiment diode may be moved off chip between voltage source V and pad . In such an alternative embodiment a bootstrap capacitor not shown could be coupled between pad and pad which capacitor could be used to provide an operating power to level shift circuit and high side driver circuit enabling transistor to conduct current when a voltage on pad is high.

Circuit further includes a transistor having a drain connected to pad a gate connected to pad and a source connected to a first input of comparator which has a second input connected to a reference voltage V and an output connected to the input of logic timing circuit . Circuit further includes a current source having a first terminal connected to pad and a second terminal connected to a first terminal of a switch which has a second terminal connected to the first input of comparator and a control terminal connected to pad .

Level shift circuit sends the high side control signal from logic timing circuit to high side drive circuit to control the on time of high side transistor . Transistor switch and current source cooperate to provide a level shift function and or to discharge the capacitor before performing a soft start operation. Further when low side driver circuit applies a positive low side drive signal to pad transistor turns on and switch is closed connecting the voltage on the drain of transistor to the first input of comparator and current source . Comparator compares the voltage to reference voltage V and produces an output state corresponding to the voltage on pad and reference voltage V .

In an example when the low side drive signal is at a logic high level high side drive signal is at a logic low level turning off current flow through transistor and allowing current flow through transistor . The logic high level of low side drive signal turns on transistor providing a pad voltage from pad to the first input of comparator . Comparator compares the pad voltage at the first input to reference voltage V and provides an output signal to logic timing circuit that corresponds to the difference between the pad voltage and the reference voltage V . Logic timing circuit provides a first on time signal to low side drive circuit which produces low side drive signal having a pulse duration determined by the first on time signal. Because the resistances of the transistors and when conducting current are known the current in inductor can be determined by the voltage at when the low side drive is on. Also the peak current for the high side transistor can be inferred from the voltage on the drain of the low side transistor at the time the low side transistor is first turned on assuming little or no delay in transition. Logic timing circuit can adjust the duration of the low side drive signal to control the on time of transistor allowing the voltage at pad representative of low side current to cross a threshold level such as a zero current threshold before turning off transistor and activating transistor . Similarly logic timing circuit can be configured to control the on time of high side transistor allowing the current I in inductor to increase from a first current level such as a negative peak current level to a second current level such as a zero current threshold .

In this embodiment the zero current level in the high side transistor can not be detected directly however it can be indirectly determined when the low side transistor begins to conduct current. When the low side transistor is turned on the last current in the high side transistor becomes available. If the current from the high side transistor has not crossed over the zero current level the next on time of the high side transistor needs to be longer to allow zero current to be reached. Thus on a cycle by cycle basis the high side on time can be extended to allow the current at pad to reach a threshold current level such as the zero crossing level. Also or alternatively the low side on time can be shortened on a cycle by cycle basis until the high side on time is sufficient for the current to reach the threshold current level.

It should be understood that the peak currents for the high side transistor and the low side transistor can be detected. With this information instead of slowly ramping the switching frequency of the high side and low side drive signals and circuit can directly and independently adjust the on times of the high side transistor and the low side transistor to produce a desired peak inductor current I . In this instance circuit can be used for soft start functionality and also for current mode control of the resonant controller or for an overload current limit circuit. An example of a timing diagram of high side drive signal low side drive signal and inductor current is depicted in for a resonant controller configured to use peak current thresholds and a zero crossing threshold to control on times of the high side and low side transistors and .

While the zero current zero crossing level is relatively easy to find it should be appreciated that different current thresholds may be used for high side detection and for low side detection. For example the zero current threshold may be below the zero crossing level at for the low side current detect function i.e. when the inductor current is decreasing from a positive peak current level to a negative peak current level and the zero current threshold may be above the zero crossing level for the high side current detect function i.e. when the inductor current I is increasing from a negative peak current level to a positive peak current level . In general using only low side detection the peaks and can only be measured when the low side is on. Circuit has no problem detecting the zero current threshold zero crossing for the low side on signal and the zero crossing from the high side can be inferred.

Depending on the resonant capacitor voltage it can take more time for the inductor current to increase and cross the zero current level than for the current to decrease from the peak positive current level at to reach or cross the zero current level at . In some instances circuit controls the high side driver circuit and the low side driver circuit to ensure that the inductor current crosses the zero current threshold before the high side driver circuit applies a high side drive signal having a logic high level. While the inductor current is depicted crossing a zero current level it should be appreciated that in some instances a threshold other than zero amperes could be used. In a particular example logic timing circuit controls the timing of high side driver circuit and low side driver circuit based on the level of the inductor current as compared to a non zero current threshold. In one instance circuit compares the absolute value of the voltage at in to a threshold voltage that represents a current in the inductor such as a 50 mA threshold and controls the timing of one or both of the high side drive signal and the low side drive signal to ensure that the inductor current reaches the threshold before applying the next logic high pulse of the high side drive signal .

System further includes transistor including a drain connected to an input source Vin and to a resonant circuit a gate connected to pad and a source connected to a node . System further includes transistor having a drain connected to node a gate connected to pad and a source connected to ground. System further includes a transistor including a drain connected to node a gate connected to pad and a source connected to pad . System also includes a sense resistor having a first terminal connected to the source of transistor and a second terminal connected to ground. In an alternative embodiment transistor and resistor may be incorporated within circuit .

Resonant circuit includes inductor having a first terminal connected to node and a second terminal. Resonant circuit further includes a capacitor having a first electrode connected to the drain of transistor and a second electrode connected to the second terminal of inductor . Resonant circuit also includes a capacitor including a first electrode connected to the second terminal of inductor and a second electrode connected to ground. Load circuit further includes a diode having an anode connected to the second terminal of inductor and a cathode connected to the drain of transistor . Load circuit also includes a diode having an anode connected to ground and a cathode connected to the second terminal of inductor . Diodes and perform a current limit function. In some embodiments inductor could be replaced by an inductor and a transformer.

In operation circuit activates transistor and transistor by applying the low side drive signal to their gates driving the inductor current and providing a low side current sense LCS signal in the form of a voltage representing the current in on resistor to pad . Circuit controls the timing of high side drive signal and low side drive signal based on the LCS signal to control inductor current such that the inductor current crosses a pre determined current threshold such as a zero current threshold or another current threshold and it also keeps the current in inductor between maximum and minimum current thresholds. In a particular example circuit provides current limit control for resonant circuit coupled to the output node .

Circuit includes logic circuitry configured to determine on times of high side and low side transistors and based on LCS signal . Examples of logic circuitry configured to produce signals used to determine the on times are described below with respect to .

Logic circuit further includes a comparator having a positive input for receiving a negative voltage signal proportional to a maximum negative current VNeg Max Curr level a negative input connected to pad in for receiving LCS signal and an output connected to a switch . Switch includes a first terminal connected to current source and a second terminal connected to current source . Logic circuit further includes a switch connected to pad in for receiving the low side drive signal LSDRV a terminal connected to current source and a second terminal for providing a maximum current time signal Max Curr. Time . Logic circuit further includes a capacitor having a first electrode connected to the second terminal of switch and a second electrode connected to ground. Further logic circuit includes a transistor having a first current electrode connected to the second terminal of switch a control electrode for receiving a reset signal and a second current electrode connected to ground.

In operation when a reset signal is applied to the gate of transistor any voltage stored by capacitor can be discharged to ground. When low side drive signal is a logic low level switch is open and current source is not connected to capacitor and transistor . When low side drive signal is at a logic high level switch connects current source to capacitor and the current electrode of transistor . Comparator compares LCS signal to positive voltage maximum current V signal and produces an output signal that controls switch . When LCS signal exceeds the positive voltage maximum current threshold switch is closed current from sources and sum to produce a net current of 4 I to charge capacitor altering the maximum current time signal . Similarly when the LCS signal falls below the negative voltage maximum current V signal comparator produces a signal to close switch to alter the maximum current time signal . Thus the time necessary for the high side transistor and the low side transistor to drive the inductor current to their respective maximum current peaks is represented by Vmaxcurrtime and are determined from the LCS signal and the positive and negative thresholds.

In a particular embodiment the maximum current time signal is a maximum peak current timer that is common to the high side transistor and the low side transistor . The system for example may include multiple timers and produce multiple timing signals such as the maximum current time signal a low side zero or minimum current timer corresponding to the time it takes for the low side transistor to reach the zero current level and a high side current timer corresponding to the time it takes for the high side transistor to reach the zero or minimum current level. For the low side transistor the on time will be the shortest of the normal on time timer and the maximum peak current timer unless the low side zero or minimum current timer is longer in which the case the low side zero or minimum current timer controls the low side transistor . For the high side transistor the on time is the shortest of the normal on time timer and the maximum peak current timer controlled by maximum current time signal unless the high side minimum or zero current timer is longer in which case the high side minimum or zero current timer controls the high side transistor . In this way system substantially reduces high peak currents during start up and reduces or eliminates high power dissipation in the transistors and because the transistors and are fully switched.

Logic circuit further includes a transistor including a drain connected to an on time current source a gate connected to the output of AND gate for receiving pull down signal and a source connected to ground. Logic circuit also includes a transistor including a first current electrode connected to on time current source a control electrode for receiving a reset signal and a source connected to ground. Logic circuit also includes a capacitor having a first electrode connected to on time current source and a second electrode connected to ground.

Logic circuit also includes a plurality of comparators. In particular logic circuit includes comparator having a positive input connected to on time current source a negative input for receiving a maximum current time signal and an output for providing a maximum current control signal . Logic circuit includes comparator having a positive input connected to on time current source a negative input for receiving a maximum time signal and an output for providing a maximum on time signal . Logic circuit includes comparator having a positive input connected to on time current source a negative input for receiving a minimum time signal and an output for providing a minimum on time signal .

In operation inverters and invert high side drive signal and low side drive signal respectively and provide the inverted outputs to AND gate . When both the high side drive signal and the low side drive signal are at a logic low level AND gate produces a logic high pull down signal that turns on transistor and discharges the voltage on capacitor . Comparator compares a voltage across capacitor to a maximum current time voltage to produce a maximum current control signal corresponding to a fixed maximum on time. Further comparator compares the voltage across capacitor to a maximum time signal voltage and produces a maximum on time signal corresponding to a time it takes for either the high side or the low side to reach an inductor current peak. Comparator compares voltage across capacitor to a minimum on time voltage to produce a minimum on time signal . Transistor provides a reset function by providing a current path to ground in response to reset signal .

In the illustrated embodiment of logic circuit produces output signals that can be used to control various logic elements to independently adjust the on times of the high side drive signal and the low side drive signal in order to control the on times of their respective transistors and to produce a desired output voltage while controlling the inductor current I .

Transistor includes a drain connected to a current source and a source connected to ground. Logic circuit also includes a capacitor having a first current electrode connected to current source and a second current electrode connected to ground. Logic circuit further includes a transistor including a drain connected to current source a source connected to ground and a gate for receiving reset signal . Logic circuit also includes a comparator implemented as a comparator including a first input connected to current source a second input for receiving a restart voltage signal V and an output for providing a restart signal .

In operation circuit creates a fixed dead time between drive pulses. Current source delivers a current that charges capacitor while transistors and are turned off. The charge on capacitor is compared to the restart voltage signal V using comparator which produces an output representing the restart signal that turns on the next drive pulse as shown in . When the reset signal is at a logic high level the charge on capacitor is discharged through transistor to ground resetting the voltage level on capacitor .

When the low side drive signal and the high side drive signal are at logic low levels AND gate produces a logic high signal that resets the gate of transistor to ground turning off current flow through transistor and allowing current source to charge capacitor . When the charge on capacitor exceeds the Vsignal comparator produces restart signal which is applied to the S input of latch . However as long as the reset signal at the R input of latch is at a logic high level the Q output provides a logic high output signal.

Latch provides a logic low output when the output of AND gate is at a logic high level and provides a logic high output when the output of AND gate is at a logic low level and after S has gone to a high state provided the reset signal at the R input of latch is at a logic low level. In the illustrated example the level of the current supplied by current source and the size of the capacitor determine the timing of the restart signal producing a fixed off time between the high side and low side drives. An example of a circuit configured to infer the high side signal from the LCS signal is described below with respect to .

In operation when the low side drive signal is at a logic high level switch provides the LCS signal to the input of peak detector . Peak detector generates an output signal equal to the peak voltage of LCS for that cycle. The output signal is provided to the negative input transconductance amplifier . Amplifier produces a current output signal proportional to the difference between the threshold in this instance a zero voltage threshold and the output of the peak detector Note this conversion can be non linear as shown in . A detect time signal controls switch to connect the output of amplifier to the negative input of comparator and to capacitor . The charge across capacitor is compared to the high side voltage on time signal and comparator produces a high side zero crossing detection signal . The HSZCD signal adjusts over a few cycles with transition to a high state approximately when zero current will be reached on the high side driver.

In general logic circuitry and depicted in and can be included within circuit depicted in to control the on time of high side transistor . Further circuit or circuit in can include logic circuits and depicted in to control the on time of low side transistor . While in the above embodiments circuitry has been connected to pad or to an external resistor in to find the zero current crossing it is possible to use an additional winding on the transformer to find zero current for both high side and low side zero crossing or threshold crossing conditions.

Logic circuit includes a buffer including an input for receiving reset signal and an output connected to an anode of a diode and to a first terminal of a resistor . Resistor includes a second terminal connected to a cathode of diode and to a first input of an OR gate . OR gate includes a second input connected to an output of an AND gate and an output connected to the R input of latch circuit . AND gate includes a first input connected to an output of an OR gate which has a first input for receiving maximum current control signal and a second input for receiving maximum on time signal . AND gate includes a second input for receiving minimum on time signal and a third input for receiving a high side zero crossing detect signal . It should be appreciated that the high side zero crossing detect signal can represent a non zero threshold signal.

Logic circuit further includes an inverter including an input for receiving the high side drive signal and an output connected to an input of an AND gate . AND gate includes a second input for receiving the last high signal and a third input for receiving restart control signal . AND gate also includes an output connected to an S input of a latch circuit which includes an R input and an output for providing the low side drive signal . When the last high signal and restart signal are at logic high levels and high side drive signal as at a logic low level zero for a period of time AND gate produces a logic high signal at the S input of latch . The signal at the R input of latch controls the output. When the reset signal is applied or LZCD signal and the minimum on time signal and one of the maximum current control signal and the maximum on time signal are at logic high levels OR gate applies a logic high signal to the R input resetting the latch and causing latch to provide a logic high signal on its Q output.

Logic circuit also includes an OR gate including a first input for receiving the maximum current control signal a second input for receiving the maximum on time signal and an output connected to an input of AND gate . AND gate includes a second input for receiving the minimum on time signal a third input for receiving a low side zero current detect LZCD signal and an output connected to a second input of OR gate . OR gate includes a second input for receiving reset signal and an output connected to the R input of latch .

In operation latch produces a last high output signal which is fed back to AND gate and . The last high output signal holds during the dead time between drive pulses the state of the last drive signal high side or low side that was high. Inverters and invert low side output signal and the last high signal respectively and provide the inverted signals to first and second inputs of AND gate . AND gate also receives restart control signal and provides a logic high output signal to the S input of latch circuit when the inverted signals and the restart control signal are all at a logic high level.

OR gate produces a logic high output when either of the maximum current control signal or the maximum on time signal are at a logic high level and provides the logic high output to AND gate . AND gate includes a second input for receiving the minimum on time signal and produces a logic high output signal when both the minimum on time signal and high side zero current detect signal and one of the maximum current control signal or the maximum on time signal are at logic high levels. AND gate provides the resulting signal to OR gate . Buffer receives reset signal and produces a delayed version of reset signal . The reset signal is provided to OR gate through resistor and diode and is used to charge filter capacitor . The filter capacitor delays the removal of the reset high signal as applied to the high side drive latch ensuring that the low side drive starts first. OR gate produces a logic high level to reset latch circuit whenever either the delayed version of reset signal or the output of AND gate are at a logic high level.

Latch circuit is set by the output of AND gate and reset by the output of OR gate which produces a logic high signal when the reset signal is high or when AND gate produces a logic high signal. As with the other latches described above the signal at the R input of latch circuit controls the output signal on the Q output. AND gate produces a logic high signal in response to HSZCD signal minimum on time signal and the output of OR gate which is responsive to the maximum current control signal and the maximum on time signal . The high side drive signal is provided to OR gate and to inverter . In an embodiment latch circuit produces an output that is high when the low side drive should come on next and low when the high side drive should come on next. OR gate provides either the high side drive signal or the reset signal to the S input of latch . Inverter inverts the high side drive signal and provides the inverted version to AND gate which takes an inverted version of the low side drive signal from inverter and produces a pull down signal that is at a logic high level whenever the high side drive signal and the low side drive signal are at logic low levels.

When the high side drive signal is on the signal at the S input of latch is at a logic low level. When the low side drive signal is on the low side zero current detection circuitry is active. When the low side zero current is detected LZCD is at a logic high level. If minimum on time signal and one of the maximum on time signal and the maximum current control signal are at logic high levels AND gate produces a logic high signal causing OR gate to produce a logic high signal to reset latch and causing latch to output a logic high signal.

In operation each drive signal high side drive signal or low side drive signal is turned off when the zero current detect high side zero current detect or low side zero current detect the minimum on time signal and the maximum on time signal or the maximum current control signal maximum current on time signal time have occurred. Thus the logic reduces the on time of the corresponding drive signal to limit the peak current at the output or increases the on time of the corresponding drive signal to ensure the inductor current reaches a pre determined current threshold such as a zero current threshold as an example .

If the voltage Vcap on the resonant capacitor starts low then the low side zero current detection signal for the low side driver is used. This low side zero current level can be measured directly when the low side driver transistor in is on. In this embodiment when the resonant capacitor voltage Vcap starts high the zero current for the high side has to be approximated from the information on the current sense i.e. transistor comparator and current source when the low side driver turns on. This means that the zero current information for the high side cannot be applied until the next high side drive pulse creating a cycle by cycle delay.

Referring to graph at inductor current I is at approximately a zero current level. Prior to the startup process is initiated. However because the resonant capacitor is discharged in this example the low side zero detect is used which has no delay and therefore there is no current spike. Instead the current increases quickly to approximately a current limit and then stabilizes within a current range of approximately plus or minus 2 Amperes. Thus controlling the high side drive signal and the low side drive signal to have different on times reduces the amplitude of the current spikes and thereby reducing stresses on associated circuitry.

In conjunction with the embodiments described above with respect to FIGS. and a resonant controller circuit provides soft start functionality through independent control of low side driver and high side driver on times. In one embodiment a circuit includes a resonant controller circuit configured to independently control the on times of the high side driver and the low side driver such that the inductor current crosses a current threshold before switching on off the transistors. In one particular example the circuit includes two timers a zero crossing detection timer for the low side and zero crossing estimator for the high side that control the on times to yield a net charging current to the resonant capacitor such as capacitor which net charging current does not build up over time. If the initial charge stored by the resonant capacitor voltage was guaranteed to start at either a high level or a low level then one of the timers could be omitted. In some instances the circuit further includes an over current timer or common on time ramp.

In a particular embodiment the circuit includes a current detection FET in the half bridge of the transistor driver circuitry to detect the bridge voltage when the low side FET is turned on. Further a level shifting circuit can be used to provide a current limit function and to discharge the initial voltage stored on the resonant capacitor before switching the FETs.

Although the present invention has been described with reference to preferred embodiments workers skilled in the art will recognize that changes may be made in form and detail without departing from the scope of the invention.

