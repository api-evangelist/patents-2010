---

title: UE antenna tuner control via node-B inner power control loop
abstract: A user equipment (UE) antenna tuner control system and method that utilize a base transceiver station (BTS) inner power control loop, and in particular utilize a Node-B inner power control loop, are provided. The UE antenna tuner control system and method of the present disclosure include an antenna impedance matching algorithm and a power amplifier (PA) input drive control that are digitally controlled by the BTS. Therefore, each UE having a digitally controllable antenna tuner unit (ATU) and operating within a network that is controllable by the BTS will have increased power efficiency.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09420395&OS=09420395&RS=09420395
owner: Qorvo US, Inc.
number: 09420395
owner_city: Greensboro
owner_country: US
publication_date: 20101122
---
This application claims the benefit of provisional patent application Ser. No. 61 263 129 filed Nov. 20 2009 the disclosure of which is hereby incorporated herein by reference in its entirety.

The present disclosure relates to controlling the power of wireless communication devices that include variable antenna impedance matching circuitry and communicate with base transceiver stations BTSs .

Antenna tuner units ATUs are employed in user equipment UE such as mobile terminals in order to maintain good link quality between base transceiver stations BTSs and the UE. In particular an ATU is usable to match antenna input impedance with the output impedance of a power amplifier PA . ATUs are especially useful when the UE is a mobile terminal communicating with a BTS since the antenna of the mobile terminal can experience voltage standing wave ratio VSWR changes that may range from near 1 1 to 3.5 1 as the position of the antenna relative to the user s body changes. For example antenna input impedance often experiences relatively large changes as portions of the user s body move within the near field of the antenna. These relatively large antenna input impedance changes typically result in a large reflected power which limits the total radiated power TRP to less than a desired maximum amount of TRP.

Unreliable power control due to antenna impedance fluctuations is problematic for third generation 3G and fourth generation 4G UEs such as mobile terminals because standards for 3G and 4G UE include relatively strict power control accuracy constraints. What is needed is a UE antenna tuner control system and methods that utilize a BTS inner power control loop and in particular utilize a Node B inner power control loop.

The present disclosure provides a user equipment UE antenna tuner control system and methods that utilize a base transceiver station BTS inner power control loop and in particular utilize a Node B inner power control loop. The UE antenna tuner control system and method of the present disclosure include an antenna impedance matching algorithm and a power amplifier PA input drive control that are digitally controlled by the BTS. Therefore each UE having a digitally controllable antenna tuner unit ATU and operating within a network that is controllable by the BTS will have increased power efficiency.

The PA input drive control is for adjusting the power delivered by the PA. The antenna impedance matching algorithm is for determining the amount and direction of impedance change needed to provide an optimal impedance match between the PA and antenna that comprise the UE. The antenna impedance matching algorithm combined with the PA input drive control enables a convergence over time such that the ATU of the UE is optimally set to provide an increased delivered power.

One advantage of the UE antenna tuner system of the present disclosure is that additional power control loops beyond the inner power control loop are unnecessary. Since only the inner power control loop is needed a possibility of loop instability due to interactivity between power control loops is eliminated. Moreover by providing the inner power control loop with an ability to synchronize control of both the ATU and the power delivered by the PA concerns about instability for continuous power transmission networks such as third generation 3G and fourth generation 4G networks are reduced.

Another advantage of the UE antenna tuner system of the present disclosure is that a directional coupler and a mismatch power detector are not needed as elements of the UE. As such manufacturing costs of other power control and sensing circuitry on board the UE are reduced due to simplifications brought about by the elimination of the directional coupler and the mismatch power detector.

The elimination of the directional coupler and the mismatch power detector is made possible by measuring power delivered by the UE to the BTS based upon the inner power control loop s uplink and by measuring power delivered to the UE from the BTS based upon the inner power control loop s downlink. Both measurements of delivered power are usable by the antenna impedance matching algorithm to digitally tune the ATU of the UE such that the power delivered by the BTS and the power delivered by the UE are both optimized for a full duplex communication session in which a transmit TX frequency and a receive RX frequency for the full duplex communication session are different.

Those skilled in the art will appreciate the scope of the present disclosure and realize additional aspects thereof after reading the following detailed description of the preferred embodiments in association with the accompanying drawing figures.

The embodiments set forth below represent the necessary information to enable those skilled in the art to practice the embodiments and illustrate the best mode of practicing the embodiments. Upon reading the following description in light of the accompanying drawing figures those skilled in the art will understand the concepts of the disclosure and will recognize applications of these concepts not particularly addressed herein. It should be understood that these concepts and applications fall within the scope of the disclosure and the accompanying claims.

Power control is implemented for code division multiple access CDMA and long term evolution LTE based cellular network systems. The primary goal of power control in such systems is to transmit signals in both an uplink direction and a downlink direction using the lowest possible power levels while maintaining a requested quality of service QoS for a user equipment UE in communication with a base transceiver station BTS . However determining appropriate transmitter levels for the uplink direction and the downlink direction is a sophisticated task due to a dynamic variation of the radio frequency RF environment between the UE and the BTS in communication. For example a signal quality between the UE and the BTS can be affected in both directions by system level interference reduced power available to the UE due to battery drain and or the mobility of the UE relative to the BTS.

The receiver front end receives information bearing RF signals from one or more remote transmitters provided by a BTS not shown . The ATU tunes the antenna to enhance the reception of an RF signal captured by the antenna . A low noise amplifier LNA amplifies the RF signal. A filter circuit minimizes broadband interference in the RF signal while a downconverter downconverts the filtered received RF signal to an intermediate or baseband frequency signal which is then digitized into one or more digital streams. The receiver front end typically uses one or more mixing frequencies generated by the frequency synthesizer .

The baseband processor processes the digitized received signal to extract the information or data bits conveyed in the received signal. This processing typically comprises demodulation decoding and error correction operations. As such the baseband processor is generally implemented in one or more digital signal processors DSPs .

On the transmit side the baseband processor receives digitized data which it encodes for transmission from the control system . The encoded data is output to the RF transmitter section where it is used by a modulator to modulate a carrier signal that is at a desired transmit frequency. PA circuitry amplifies the modulated carrier signal to a level appropriate for transmission from the antenna . The power amplifier PA circuitry provides gain for the signal to be transmitted under control of power control circuitry which is preferably controlled by the control system using an adjustable power control signal V . The ATU tunes the antenna to match the output impedance of the PA circuitry to the input impedance of the antenna . In this way the RF power of the modulated signal transmitted from the antenna will be efficiently transmitted. The ATU may be controlled by two digital general purpose input output GPIO signals. One signal GPIO T R SWITCH switches the ATU between tuning the antenna for transmission and reception. Another signal GPIO ANT. TUNER is usable to adjust tuning elements not shown in of the ATU .

The power control circuitry adjusts the bias for the PA circuitry to maintain a desired output power under varying conditions such as decreasing battery voltage and or fluctuating voltage standing wave ratio VSWR etc. The control system may also provide a transmit enable signal TX ENABLE to effectively enable the PA circuitry during periods of transmission.

A user may interact with the mobile terminal via the interface which may include interface circuitry associated with a microphone a speaker a keypad and a display . The interface circuitry typically includes analog to digital converters digital to analog converters amplifiers and the like. Additionally the interface circuitry may include a voice encoder decoder in which case it may communicate directly with the baseband processor .

The microphone will typically convert audio input such as the user s voice into an electrical signal which is then digitized and passed directly or indirectly to the baseband processor . Audio information encoded in the received signal is recovered by the baseband processor and converted into an analog signal suitable for driving the speaker and the interface circuitry . The keypad and the display enable the user to interact with the mobile terminal inputting numbers to be dialed address book information or the like as well as monitoring call progress information.

As illustrated in a cellular network experiences a near far effect due to a UE that is located far from a BTS a UE that is located at an intermediate distance from the BTS and a UE that is located near to the BTS . All signals transmitted from the UE the UE and the UE and received by the BTS would ideally have the same power level. However if the UE the UE and the UE each transmits at a power level that is appropriate for the nearby UE the BTS will potentially not be able to receive a usable signal level from the far away UE . Alternately if the nearby UE transmits a signal at a power level appropriate for the far away UE BTS reception of signals transmitted from the intermediately distant UE and the far away UE will potentially by interrupted by interference from the signal transmitted from the nearby UE . This problem is known as the near far effect. As a result of the near far effect users of the UE the UE the UE and other UEs not shown cannot transmit signals at fixed power levels and expect reliable communication with the BTS and other BTSs not shown that make up a modern cellular network such as the cellular network . Various factors such as fading variations and other signal power variations caused by radio wave propagation physics contribute to the near far effect.

Optimally efficient uplinks to the BTS occur when the RF signal power from each of the UEs and appears to be equal regardless of significant differences in range from the BTS that exist for the UEs and . This equality in received signal strength provides for an optimal signal to interference ratio SIR which theoretically allows the BTS to decode a maximum number of transmissions within the cellular network . However in reality a radio channel used for uplink to the BTS is unstable. Therefore RF signal power transmitted from the each of the UEs and must be accurately and dynamically controlled.

Mature investigations pertaining to efficient RF signal power control have resulted in many RF signal power control algorithms that achieve efficient RF signal power control for uplinks from UEs such as the UEs and . Most of these traditional RF signal power control algorithms distribute the responsibility of RF signal power control to BTSs such as the BTS . Traditionally each BTS such as the BTS tracks and updates RF signal power levels received from UEs such as the UEs and .

In contrast an optimally efficient downlink from the BTS to the UEs and must be handled differently. RF signals transmitted by the BTS are orthogonal. RF signals that are mutually orthogonal do not in theory interfere with one another. However it is difficult if not impossible to achieve complete orthogonality in typical communication environments for the cellular network . For example RF signal reflections off of structures not shown within the cellular network may cause non orthogonal interference even in the case of a single BTS such as the BTS . Moreover RF signals transmitted from other BTSs such as BTSs similar to the BTS are non orthogonal and thus increase interference levels with the cellular network . Interference caused by RF signals that are non orthogonal is particularly problematic for a CDMA system in which neighboring cells use an RF carrier signal of the same frequency. As a result of the interference caused by RF signals that are non orthogonal a power control for efficient downlink of RF signals is necessary.

Open loop power control and closed loop power are available for RF power control for downlink of RF signals. A UE such as the UE using open loop power control estimates an RF signal strength transmitted from the BTS by measuring a received power level of the pilot signal of the BTS in a downlink RF transmission from the BTS . The UE then adjusts its RF power level to be inversely proportional to the received power level of the pilot signal of the BTS . Consequently the UE will transmit a relatively lower power RF signal in response to a relatively higher received power level of the pilot signal of the BTS . The responsiveness of open loop power control is relatively responsive. However a problem exists in that the interference estimate made by the UE is based upon the received power level of the pilot signal of the BTS which can be of a different frequency than the frequency transmitted by the UE . This problem is particularly evident in the case of frequency division duplex FDD which uses uplink and downlink frequencies that are different by a duplex frequency offset. As a result uplink and downlink fast fading on different RF signal carriers do not correlate which results in less accurate power control based on averaging the received power level of the pilot signal of the BTS .

Nevertheless open loop control achieves good results for universal mobile telecommunications system UMTS terrestrial radio access time division duplex UTRA TDD that uses a common frequency for both uplink and downlink. The good results for open loop control using a TDD mode are due to a strong correlation between the processing of fading for both the uplink and downlink RF signal transmissions. However a wideband CDMA frequency division duplex WCDMA FDD system only uses open loop power control to provide an initial power setting of UEs such as the UEs and at the beginning of a communication session between the UEs and and the BTS . An open loop power control tolerance is 9 dB for normal environmental conditions for the cellular network and 12 dB for extreme environmental conditions for the cellular network .

Closed loop power control typically provides more accurate power control for UEs than open loop power control. In a typical closed loop power control technique the BTS makes use of uplink and downlink RF transmissions to measure the quality of the RF signals passed between the BTS and the UEs and . The results of the quality measurement of the RF signals are sent from the BTS to the UEs and so that the UEs and can adjust their respective RF signal power levels based upon the quality of the RF signals received by the BTS .

A UMTS terrestrial radio access frequency division duplex UTRA FDD mode of operation for the cellular network uses a fast closed loop power control technique for both uplink and downlink RF signal transmissions. In the UTRA FDD mode a received SIR is measured over one UTRA FDD time slot TS which has a duration of about 667 microseconds. For the uplink a digital process algorithm executed by the BTS determines whether or not to increase or decrease the power transmitted by any one of the UEs and .

A transmission power control TPC command having a TPC cmd value with a number of transmit control bits is transmitted within each TS during an uplink or a downlink to individual ones of the UEs and to convey commands for each of the UEs and to either increase or decrease the power of their respective RF signal transmissions. For example when the BTS receives an RF signal from one of the UEs and the BTS will compare a measured signal level of the received RF signal with a threshold value that is predefined. If the measured RF signal level for the received RF signal exceeds the threshold value the BTS will send a decrease power TPC cmd value to the UE . Alternately the BTS will send an increase power TPC cmd value to the UE if the measured RF signal level is lower than the threshold level.

During downlink transmissions the UEs and will report received RF signal levels for RF signals transmitted from the BTS . The digital process algorithm executed by the BTS uses received RF signal level reports from the UEs and to determine when the RF signal power of the BTS needs an increase or decrease to maintain high quality communication between the individual ones of the UEs and and the BTS .

The TPC commands multiplexed with the BTS DOWNLINK SIGNAL are transmitted over a DOWNLINK RADIO CHANNEL to be received by a demultiplexer DEMUX . The DEMUX separates the BTS DOWNLINK SIGNAL from the TPC commands sending the latter to control the PA and sending the former to a decoding function block that decodes the BTS DOWNLINK SIGNAL to output a UE DOWNLINK SIGNAL. An information exchange comprising SIREST and TPC commands between the UE and the BTS make up an INNER LOOP. The INNER LOOP allows control loop power adjustments that maintain transmitted RF power levels from the UE that will keep the received SIR estimates substantially equal to the SIR Target value. The power control frequency of the INNER LOOP is 1500 Hz in order to provide timely power adjustments.

If the SIR Target value results in a low quality bit stream carried by the UE UPLINK SIGNAL over the UPLINK RADIO CHANNEL then the SIR Target value should be increased. The SIR Target value is fixed based upon a block error ratio BLER or bit error ratio BER . The SIR Target value is set by the OUTER LOOP in order to match a required BLER. An optimal SIR Target depends on the speed of the UE towards or away from the BTS as the UE traverses a multipath profile. Thus the OUTER LOOP is usable to maintain the quality of communications at the level of a bearer service quality requirement while transmitting as low a level as possible from both the UE and the BTS . The OUTER LOOP is also responsible for setting the SIR Target at the BTS for each individual uplink under the power control of the INNER LOOP. The SIR Target is updated for each UE such as the UE according to an SIREST uplink quality that preferably include BLER and or BER measurements for each Radio Resource Control RRC connection. The RRC connection is responsible for controlling the configuration of UMTS radio interface Layers and . The OUTER LOOP also provides for a downlink power control that allows a receiver of the UE to converge to a required BLER that is set by a Radio Network Controller RNC .

As shown in the table of a transmitter of the UE is typically adapted to change the output power transmitted by the UE in step sizes of 1 dB 2 dB and 3 dB. Changes in the output power provided by the BTS occur during TSs that immediately follows a TPC command.

A first algorithm ALGORITHM for power control using the INNER LOOP requests a transmit power decrease if the SIREST is greater than the SIR Target. In contrast the first algorithm for power control using the INNER LOOP requests a transmit power increase if the SIREST is less than the SIR Target. It is to be understood that a change in the transmitter output power for a UE such as the UE is made in response to a single TPC command via a TPC cmd value.

A second algorithm ALGORITHM for power control only updates every fifth TS in order to simulate smaller power update steps relative to the update steps of the ALGORITHM. The transmit power of the UE is reduced by 1 dB if five TPC commands in a row have a TPC cmd value requesting a power decrease. In contrast the transmit power of the UE is increased by 1 dB if five TPC commands in a row have a TPC cmd value requesting a power increase. If no power increase or decrease is requested the transmit power of the UE will remain unchanged.

The transmit power of the DOWNLINK RADIO CHANNEL for the UE is determined by the cellular network . A power control step size can have four values which are typically 0.5 db 1 dB 1.5 dB and 2 dB. However regulations for a UMTS terrestrial radio access network UTRAN only mandate support for a 1 dB power control step size. Support for other power control step sizes is optional.

The UE generates TPC commands to control the transmit power of the BTS . The UE transmits the TPC commands to the BTS in a TPC field of an uplink dedicated physical control channel DPCCH . The BTS adjusts the downlink power of the DPCCH and the dedicated physical data channel DPDCH upon receiving the TPC commands from the UE .

In a soft handover state in which the UE is traveling between cells of a cellular network such as the cellular network the transmit power of the UE is adjusted by selecting the most suitable TPC command received from various BTSs such as the BTS . In a case in which the UE has simultaneous radio links with other BTSs besides the BTS the UE will receive more than one TPC command from the other BTSs independently. The received TPC commands may provide conflicting power control instructions to the UE . A basic approach to resolving the conflicting power control instructions is for the UE to comply with the TPC command that calls for the least amount of transmit power.

A site selection diversity technique SSDT is another approach to resolving TPC command conflicts. The basic principle of SSDT is that the BTS with the highest signal level is dynamically selected by the UE to be the only transmitting BTS. As a result any other BTSs that have simultaneous radio links to the UE will cease their DPDCH transmissions. As a result the transmit power of the UE will be adjusted based upon the TPC commands of the BTS with the highest signal level as determined by the UE .

During an inter frequency handover from the BTS to another BTS the UE must be given time to make the necessary measurements on the different WCDMA carrier frequency. In this compressed mode the transmissions of the BTS and the UE are ceased for a predefined period to provide enough time for inter frequency measurements. As a result the adjustments of transmit power for both the UE and the BTS are problematically halted. In order to resolve this problem during uplink the UE is allowed to increase or decrease transmit power using step sizes that are larger than typically called for in order to reach a desired SIR Target as swiftly as possible.

While power control of the UE and the BTS using the power control algorithms described above are relatively well developed problems remain in that factors other than power levels that affect signal quality are present during a typical communication session between the UE and the BTS . For example as illustrated in a VSWR variation seen for an antenna of a UE in a flip phone form typically ranges from about 1 1 to about 6 1. The Smith chart of shows the impedance of the antenna relative to a reference plane . An impedance mismatch for the antenna caused by a non 50 ohm impedance generates an impedance mismatch loss. The mismatch loss can be as high as 3 dB for a VSWR of 6 1. Due to such a high loss the power transmitted by the UE is degraded and the received signal level at a BTS such as the BTS is reduced. Other problems caused by the impedance mismatch loss include an increased noise figure and reduced battery life for the UE .

Relatively large VSWR changes can be seen at the antenna depending on how a user handles the UE . illustrate two examples of how the VSWR for the antenna is affected by user handling. is a graph of VSWR versus time for low band 900 MHz transmission from the antenna . In the example of the UE of and C was alternately lifted from and placed onto a table five times. Notice that the VSWR for the antenna changes from around 1 1.4 when the UE is off of the table to around 1 2.8 when the UE is on the table. In the example of the fingers of a user were rapidly moved about the antenna . Notice that the VSWR is seen to change rapidly at a rate that is around 200 milliseconds.

The problem of relatively large VSWR changes is becoming more challenging as advances in cellular networks are requiring the support of larger bandwidth ranges within a single UE such as the UE . For example the preferred bandwidth range to be supported will cover 700 MHz through 2600 MHz for a single UE such as the UE . Note that even with such a wide bandwidth range antenna efficiency and radiated gain must remain within ranges that provide reliable communication between BTSs and UEs.

In order to counter the problems caused by antenna impedance mismatches most antenna tuning techniques incorporate an ATU and a baseband BB power controller that both reside within a UE. is a block diagram of a UE according to the prior art. The UE is in communication with a BTS having a BTS antenna . The UE includes a BB power controller for controlling a transceiver output power adjusting function . The BB power controller sends a signal to the transceiver output power adjusting function based on downlink TPC commands received from the BTS . In turn the transceiver output power adjusting function controls the amount of output voltage and or bias current that is delivered to a PA from a switcher power supply . The PA includes power amplifier stages PASs PAS and PAS. An amplified RF signal output from the PA is directed through an RF front end module FEM to an automatic antenna tuning system that is coupled to a UE antenna .

The automatic antenna tuning system is made up of a directional coupler that passes the majority of an amplified RF signal into an ATU while directing a sample of the amplified RF signal into a mismatch detector . An ATU control unit receives a mismatch signal from the mismatch detector . The ATU control unit uses the mismatch signal to adjust a matching network of the ATU to generate a mismatch correction signal that automatically optimizes an impedance match between the UE antenna the FEM and the PA . In this way there will be a reduced negative impact on the transmission performance of the UE as a user inadvertently changes the VSWR of the UE antenna during operation of the UE . However it is important to note that the automatic antenna tuning system is independent of an inner loop power control such as used with the INNER LOOP between the UE and the BTS of . While a certain amount of independence is positive in some control systems the opposite is true in this case because the automatic antenna tuning system is relatively slow compared to an inner loop power control for 3G and 4G continuous transmission systems that have TS periods of around 0.667 milliseconds. Further still the automatic antenna tuning system relies on the directional coupler the mismatch detector and the ATU control unit all of which add to the design and production costs of the UE .

An example of potential network degradation due to the independence of the automatic antenna tuning system can be demonstrated with the following scenario. In reference to assume a VSWR changes at the UE antenna from 1 1 to 2.5 1. As a result the BTS will see a change of about 1 dB in the power delivered by the UE . Further assume that the VSWR change starts at a TS boundary of 0.667 ms. Also assume that the response of the automatic antenna tuning system is slower than 0.667 ms and assume that a convergence algorithm of the antenna tuning takes about 0.677 ms to measure the change of VSWR to find an optimum adjustment for the matching network. Meanwhile the inner loop power control will request that the UE increase its output power by 1 dB via a TPC equals up command. However the automatic antenna tuning system will independently apply its correction to the matching network of the ATU which results in a change of about 1 dB. The UE also will apply a power change of 1 dB thus resulting in a 2 dB change of delivered power increase versus the previous TS. Such action will result in a lack of accuracy necessary for reliable communication between the UE and the BTS . Worse there is a potential for creating instabilities of the inner power control loop.

Another potential problem pertains to a degradation of the detection of an impedance mismatch. Such a problem can be created by the presence of a near by transmitter that leaks an interference signal into the UE antenna . The interference signal may superimpose onto an internally reflected signal that needs to be measured due to a load mismatch at the UE antenna . The superimposing interference signal would likely lead to erroneous impedance mismatch correction attempts by the automatic antenna tuning system .

The present disclosure provides solutions for the above described problems associated with prior art antenna tuning techniques. In particular the present disclosure provides a novel antenna tuning control scheme that adds an antenna control algorithm ALGORITHM to an inner loop power control similar to that used with the INNER LOOP between the UE and the BTS of .

Turning now to a communication system and a UE that is in accordance with the present disclosure are illustrated. The UE is in communication with a BTS having a BTS antenna . The UE includes a first baseband BB power controller for controlling a transceiver output power adjusting function . The first BB power controller sends a signal to the transceiver output power adjusting function based on downlink TPC commands received from the BTS which applies the ALGORITHM or the ALGORITHM. In turn the transceiver output power adjusting function controls the amount of output voltage and or bias current that is delivered to a PA from a switcher power supply . An amplified RF signal output from the PA is directed through an RF FEM to an automatic antenna tuning system that is coupled to a UE antenna .

The automatic antenna tuning system includes a forward power coupler that passes the majority of an amplified RF signal into an ATU while directing a sample of the amplified RF signal into a forward power detector . A second BB power controller receives an output of the forward power detector along with an input from the ALGORITHM. The second BB power controller outputs a pair of ATU control signals CTRL and CTRL which are based on inputs from the ALGORITHM along with an output of the forward power detector . As shown in the ATU control signals CTRL and CTRL adjust variable capacitors VC and VC that make up the ATU . An inductor L is coupled to the variable capacitors VC and VC in a PI network configuration.

In operation the only power measurement made by the UE is a forward power measurement that is similar to the forward power measurements conducted by most 3G and 4G applications. The forward power measurement is used as a control input into the second BB power controller so that the second BB power controller can avoid exceeding a predetermined maximum power limit. The forward power measurement is reported to the BTS .

During operation the ALGORITHM and or the ALGORITHM are used by the INNER LOOP POWER CONTROL to adjust the output power of the UE via the transceiver output power adjusting function . The UE informs the BTS of a maximum forward power limit if the output power of the PA as detected via the forward power detector reaches a maximum output power. If the maximum forward power limit has been reached the BTS will command the UE to switch to the ALGORITHM INNER LOOP POWER CONTROL mode.

At this point in time the BTS remains in communication with the UE via the TPC commands. However while processing the ALGORITHM the UE will use the TPC commands to adjust the antenna tuning control while maintaining constant forward output power for the PA . The TPC commands received by the second BB power controller in the form of Up and Down power control messages and used for inner power loop control are preferably in accordance with high speed packet access HSPA standards and or long term evolution LTE standards. If a TPC command is Up the antenna tuning is adjusted in a random direction. The change in the antenna tuning will either increase the delivered output power by reducing the reflected power from an antenna mismatch or will decrease the delivered output power by inadvertently increasing the reflected power due to the antenna mismatch. If the BTS sees that the output power of the UE has decreased instead of increasing the BTS will command the UE to increase output power via the TPC command set as Up. However the BTS will also indicate that the direction of the antenna tuning control must be changed on the next TS. Thus on the next TS the antenna tuning control would be set on the right direction to result in an increased delivered power by reducing the reflected power due to the antenna mismatch. If the BTS determines that the delivered power is still below a predetermined target the BTS will continue sending the TPC command for Up until the measured power at the BTS meets the predetermined target.

Once the BTS verifies that the delivered power for the UE meets the predetermined target the BTS will command the UE to switch back to ALGORITHM or ALGORITHM and thus to stop operating in ALGORITHM INNER LOOP POWER CONTROL mode. In this way the antenna tuning setting commanded by the BTS may not have reach an optimum setting but at least the current setting increases the delivered power by the UE to an amount commanded by the BTS .

If the output of the UE decreases after a previous increase the BTS will command the UE to cease operating the ALGORITHM during a subsequent TS. This case is due to the limited range of the antenna tuning for the given VSWR at which the antenna is operating. A previous antenna control value will be maintained by the second BB power controller after the ALGORITHM ceases.

It is important to note that during the execution of the ALGORITHM the UE will provide power steps on each TS but will not meet the relative gain accuracy requirements since the antenna tuning control cannot precisely predict the gain changes. However no gain inaccuracy problem is created because the UE is usually far enough away from the BTS that a request by the BTS for more output power from the UE will not be impacted by the near far effect.

The power delivered Pdel by the UE is estimated by taking the difference between the forward power Pfwd and the reverse power Prev . Therefore the Pdel Pfwd Prev Pfwd 1 where is the reflection coefficient and is function of the antenna load and the antenna control settings for the variable capacitor VC and the variable capacitor VC .

The ALGORITHM controls the antenna tuning such that the ATU is adjusted to provide an increase of the power delivered by the UE . An unknown step value may be used to change the antenna control settings for the variable capacitor VC and the variable capacitor VC. However the PI filter configuration made up of VC VC and L is preferably implemented such that an unknown step does not exceed a predetermined limit such as will result in a 1 dB change. While this constraint might not necessarily provide the optimum matching settings that maximize the delivered power from the UE for an individual TS it is sufficient to increase the delivered power during a given TS.

As the ALGORITHM continues to issue TPC commands over subsequent TSs the antenna tuning is again slightly adjusted such that the delivered power from the UE is increased. In this way the antenna tuning provided by ALGORITHM will converge to optimum settings for the variable capacitor VC and the variable capacitor VC over several TSs. The latest variable capacitor VC and variable capacitor VC set are preferably maintained after the BTS commands the UE to operate in the ALGORITHM or ALGORITHM modes where the output power control is implemented by adjusting the drive input level of the PA using the transceiver output power adjusting function .

ALGORITHM and ALGORITHM are usable with the inner loop power control to adjust a forward power output of the PA with a relatively precise gain step. In comparison the ALGORITHM is usable with the inner loop power control to reduce reverse power by adjusting the ATU . Advantageously no precise gain step is required for the ALGORITHM in order to increase UE power delivered to the BTS . Moreover the ALGORITHM reduces a typical need to over design the PA to make up for reverse power losses.

The Node B also determines if the UE delivered power to Node B for the new TS TXUEDEL NODE n 1 is greater than or equal to a target power level TXUEDEL NODEBTARGET step . If the UE delivered power to Node B for the new TS is greater than or equal to the target power level the ALGORITHM will be exited step . However if the UE delivered power to Node B for the new TS is less than the target power level the Node B will request that the UE tune the ATU in an attempt to increase output power delivered to the Node B step .

The Node B will then measure the UE delivered power at TS SLOT n 2 step . The Node B then determines if the UE delivered power to the Node B for the new TS TXUEDEL NODEB n 2 is greater than or equal to a target power level TXUEDEL NODEBTARGET step . If the UE delivered power to Node B for the new TS is greater than or equal to the target power level the ALGORITHM will be exited step . However if the UE delivered power to Node B for the new TS is less than the target power level the Node B then determines if the UE delivered power at the new TS TXUEDEL NODEB n 2 is less than the UE delivered power for the previous TS TXUEDEL NODEB n 1 step . If the UE delivered power to the Node B for the new TS is not less than the UE delivered power for the previous TS the new TS is incremented to the next TS step .

Alternately if the UE delivered power to Node B for the new TS is less than the UE delivered power for the previous TS the Node B sends a request to the UE to tune the ATU back to a previous state i.e. the tuning settings at the n 1 state and to switch to another VC tuning mode VCMODE step . For example a variable capacitor VC is a tuning element for the tuning mode VCMODE VC while a variable capacitor VC is a tuning element for the tuning mode VCMODE VC.

Next the UE determines if both tuning modes have been exhausted step . If the UE determines that both tuning modes have not been exhausted the new TS is incremented to the next TS step . Alternately if the UE determines that both tuning modes have been exhausted the ALGORITHM is exited step .

System simulations of the ALGORITHM may be performed using a numerical computing environment and 4G programming language adapted to simulate antenna tuning with the PI filter of where the variable capacitor VC and the variable capacitor VC are controlled sequentially via the BTS . Each iteration of a plurality of iterations needed for a simulation of the ALGORITHM corresponds to one TS period.

Several system simulations of the ALGORITHM may be performed for various Smith chart locations of an antenna load. The normalized real part of the antenna load is 1. Similarly the normalized imaginary part is 1. Note that simulations of the ALGORITHM do not include a time domain modulated signal because the simulations are based only on impedance and power reflection calculations.

A path loss of 60 dB may be assumed between the UE and the BTS . Absolute values are not critical and do not alter the conclusions for other values that may be used. However simulation values are assumed to be constant during a TS. In practice the UE will often be moving relative to the BTS . Assuming that the UE is moving away from the BTS at 50 km h the distance between the UE and the BTS will change by 3 cm for a transmission time interval TTI of 2 milliseconds. The resulting average power change is low and does not represent an instantaneous power due to fast fading. A simulation may also be added to provide a random path loss change that would represent fast fading.

In a first simulation case an antenna complex load impedance of Zload 31.25 j 100 ohms is assumed. All antenna loads are normalized to a Z of 50 ohms. is a Smith chart that illustrates the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. The Smith chart of shows the converged settings near the center of the Smith chart i.e. 50 ohms after the completion of the ALGORITHM.

In a second simulation case the antenna impedance Zload is changed to Zload 20 j 50. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a third simulation case the antenna impedance Zload is changed to Zload 20 j 50. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a fourth simulation case the antenna impedance Zload is changed to Zload 70 j 50. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a fifth simulation case the antenna impedance Zload is changed to Zload 70 j 50. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a sixth simulation case the antenna impedance Zload is changed to Zload 70 j . is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

It is important to note that the changes of the variable capacitor VC and the variable capacitor VC are performed at relatively small phase jumps that are preferably less than 30 degrees. As a result the number of tuning elements making up the ATU may need to be increased if switchable capacitors and inductors are used in place of continuous tuning elements such as variable capacitance diodes. Using a relatively large number of switchable tuning elements for the ATU may be undesirable in some cases due to a relatively high cost of implementation. One method to reduce the number of tunable elements is to perform antenna tuning adjustments at every frame or at a frame multiple rather than at each TS. This method would allow a phase jump larger than 30 degrees but smaller than 60 degrees which would be acceptable in more and less cases.

Another complexity addressed by the present disclosure pertains to duplex communication systems that require optimization of antenna tuning for both the transmitter and receiver of the UE . In a duplex communication system the receive frequency is at a different frequency than the transmit frequency. For some bands like UTMS Band the duplex frequency offset is very large equal to 400 MHz. By comparison the duplex frequency offset for UTMS Band is only 190 MHz. Thus an optimization of the tunable element settings for the ATU for a given transmit frequency would likely not yield an optimization of the tunable elements settings for the ATU for an offset receive frequency. One solution would be to adapt the ATU for broadband tuning to create optimized tuning peaks for both the TX and RX frequencies. However in some cases broadband tuning would result in undesirably complex filter circuit topologies.

A different method for solving the duplex communications issue involves using the ALGORITHM to measure the power level delivered to the UE at the receive frequency. In this case the ALGORITHM averages measured received power levels at both the UE and the BTS to determine an average link power level. The average link power level can be determined by a logarithmic averaging of a linear averaging. Alternately some weighting can be introduced if the TX frequency is to be more favored than the RX frequency. This averaging method preferably has a sampling period that is applied every two TSs rather than each TS. In this way the UE reports received power levels to the BTS using the DOWNLINK RADIO CHANNEL. In this way the BTS can make determinations for TPC commands based upon both an uplink power level and a downlink power level for the same ATU settings.

The ALGORITHM including averaging for both an uplink power level and a downlink power level can be simulated for various loads noise levels and path losses. For example in a first case logarithmic averaging of the power received at the UE and the power received at the BTS may be simulated for an RX to TX frequency offset of 190 MHz with an antenna load of Zload 20 j 50 ohms. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a second case linear averaging of the power received at the UE and the power received at the BTS may be simulated for an RX to TX offset of 190 MHz with an antenna load of Zload 20 j 50 ohms. is a Smith chart that includes a plot of the impedance Zload at the UE antenna a node impedance ZVC for the variable capacitor VC a serial node impedance ZL at L which is assumed to have a fixed value and a node impedance ZVC for the variable capacitor VC before the start of the ALGORITHM. illustrates the impedance transformation at the end of the ALGORITHM through the INNER LOOP POWER CONTROL of the ATU .

In a third case logarithmic averaging of the power received at the UE and the power received at the BTS may be simulated for an RX to TX offset of 190 MHz with an antenna load of Zload 20 j 50 ohms. is a plot of return loss versus frequency prior to running the ALGORITHM.

In most instances it may be preferable for the ALGORITHM to be executed on processors of the BTS to control the ATU of the UE . However it is possible to have the UE execute the ALGORITHM via a processor such as the second BB power controller . In such a case the UE would measure a received delivered power level based on the downlink inner loop to control the antenna tuning at the RX frequency. Alternately the UE could use an averaged value of the delivered received power at the RX frequency while also receiving from the BTS via the DOWNLINK RADIO CHANNEL a measurement of delivered power level at the TX frequency of the BTS .

The BTS could then report to the UE a measured delivered power level at the TX frequency as seen at the BTS using the TPC fields. An average of the two power levels would indicate the delta of the measured power versus a reference target. Thus when the ALGORITHM is enabled to run on the UE by the BTS the BTS would send to the UE the measured delivered power level or delta at the TX frequency based on the Uplink Inner Loop and the UE would also use this reported value and the receive delivered power at the receive frequency based on the Downlink Inner Loop to calculate an averaging value used by the ALGORITHM running on the UE to adjust the ATU .

The ALGORITHM would then operate at 2 TTI time rate since the UE would need to wait to adjust the ATU . The UE would then update the BTS and wait for the BTS to report the measured power level at the BTS . The BTS would then receive the measured power level while measuring the RX power level at the UE for the same antenna settings.

The transceiver output power adjusting function controls the amount of output voltage and or bias current that is delivered to a PA from a switcher power supply . The PA includes PA stages PAS and PAS. The transceiver output power adjusting function also controls the level of an RF INPUT signal.

An amplifier RF signal output from the PA is directed through an RF FEM to an automatic antenna tuning system that is coupled to a UE antenna . The automatic antenna tuning system includes a directional coupler that passes a majority of an amplified RF signal into an ATU while directing a sample of the amplified RF signal into a mismatch detector .

An antenna tuning power controller receives an ESTIMATED TX DELIVERED POWER from the mismatch detector . The antenna tuning power controller receives an ESTIMATED RX DELIVERED POWER at the 3G or 4G receiver and an ANTENNA TUNING SIGNAL output from the BB power controller . The antenna tuning power controller averages the ESTIMATED TX DELIVERED POWER and the ESTIMATED RX DELIVERED POWER using a logarithmic averaging method. In response the antenna tuning power controller outputs a pair of ATU control signals CTRL and CTRL that are received as input by the ATU . In turn the ATU matches output impedance of the PA with the input impedance of the UE antenna such that UE power delivered to the BTS is maximized. Further still The ATU is adapted to adjust the tuning elements of the ATU to increase levels of signals being received once the AGC reaches a maximum gain level.

Similarly the tuning elements of the variable capacitor VC comprise a first capacitor array made up of a plurality of digitally switchable capacitors CB CB CBN and CBN where N is a positive integer. The control signal CTRL is usable to activate and deactivate the CB CB CBN and CBN via electronic switches SB SB SBN and SBN where N is a positive integer. Lastly the inductor L is coupled between the variable capacitor VC and the variable capacitor VC to form a PI network configuration.

Those skilled in the art will recognize improvements and modifications to the preferred embodiments of the present disclosure. All such improvements and modifications are considered within the scope of the concepts disclosed herein and the claims that follow.

