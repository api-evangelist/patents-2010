---

title: Method and system to identify geographical locations associated with queries received at a search engine
abstract: Techniques are provided for prediction locations of users that submit search queries. A query is received at a search engine. An inverted index is searched to identify one or more geographical locations associated with one or more terms of the received query. The inverted index lists a plurality of query terms and one or more geographical locations associated with each query term. Each geographic location that is associated with a listed query term in the inverted index is a determined location for at least one user previously having submitted the listed term in a search query. A geographical location is predicted for a user that submitted the received query based on the identified one or more geographical locations. In this manner, a location is predicted for the user based on similar queries previously submitted by users.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09384289&OS=09384289&RS=09384289
owner: EXCALIBUR IP, LLC
number: 09384289
owner_city: Sunnyvale
owner_country: US
publication_date: 20101223
---
A search engine is an information retrieval system used to locate documents and other information stored on a computer system. Search engines are useful at reducing an amount of time required to find information. One well known type of search engine is a Web search engine which searches for documents such as web pages on the World Wide Web also known as the Web . Examples of such search engines include Yahoo Search at http www.yahoo.com Microsoft Bing at http www.bing.com Ask.com at http www.ask.com and Google at http www.google.com . Online services such as LexisNexis and Westlaw also enable users to search for documents provided by their respective services including articles and court opinions. Further types of search engines include personal search engines mobile search engines and enterprise search engines that search on intranets among others.

To perform a search a user of a search engine typically enters a query into an entry box of the search engine. The query contains one or more words terms such as hazardous waste or country music. The terms of the query are typically selected by the user to as an attempt find particular information of interest to the user. The search engine returns a list of documents relevant to the query. In a Web based search the search engine typically returns a list of uniform resource locator URL addresses for the relevant documents which is displayed to the user in a search results page. If the scope of the search resulting from a query is large the returned list of documents may include thousands or even millions of documents.

Users perform searches using a variety of devices including mobile devices. Although it is often possible to determine a user s location based on information associated with the device used by the user in performing a search this determination is generally limited to such device specific information. For searches performed by mobile device users or other device users this information may be irrelevant or misleading.

Various approaches are described herein for among other things generating indexes that may be accessed to predict locations of users that submit search queries. An index which may be referred to as an inverted index stores query terms that were previously submitted by users and for each query term stores one or more geographical locations determined for the users that previously submitted the query term. The inverted index may be accessed to predict a location of a user submitting a search query. One or more locations may be obtained from the inverted index that correspond to the terms of the search query and a location of the user may be predicted from the obtained one or more locations. As such a location of the user may be determined using the inverted index based on the determined locations of users that submitted similar search queries previously.

In an embodiment a plurality of inverted indexes may be generated with each inverted index corresponding to a respective location group. Each location group may correspond to a different location and or a different level of location granularity e.g. a particular zip code city state region country etc. . Multiple inverted indexes may be accessed each time that a user submits a search query to predict multiple potential locations for the user corresponding to multiple location groups. The multiple potential locations may be analyzed and or compared to each other and a most likely location of the user that submitted the search query may be selected.

In one implementation a method for generating an inverted index is provided. Geographical locations are determined for a plurality of users that submitted search queries. Each submitted search query is annotated with a determined geographical location for a user that submitted the search query. The annotated search queries are grouped according to the determined geographical locations into a plurality of location groups. An inverted index is built for each location group that relates each term of the submitted search queries in the location group to one or more geographical locations determined for the users that submitted the search queries that include the terms.

In another implementation a method for predicting a geographical location of a user submitting a query to a search engine is provided. A query is received at the search engine. An inverted index is searched to identify one or more geographical locations associated with one or more terms of the received query. The inverted index lists a plurality of query terms and one or more geographical locations associated with each query term. Each geographic location that is associated with a listed query term in the inverted index is a determined location for at least one user previously having submitted the listed term in a search query. A geographical location is predicted for a user that submitted the received query based on the identified one or more geographical locations. In this manner a location is predicted for the user based on similar queries previously submitted by users.

In still another implementation a system is provided. The system includes a location determiner a query grouper and an index generator. The location determiner is configured to determine geographical locations for a plurality of users that submitted search queries and to annotate each submitted search query with a determined geographical location for a user that submitted the search query. The query grouper is configured to group the annotated search queries into a plurality of location groups according to the determined geographical locations. The index generator is configured to build an inverted index for each location group. The inverted index relates each term of the submitted search queries in the location group to one or more geographical locations determined for the users that submitted the search queries that include the terms.

Furthermore the system may include a query receiver and a location predictor. The query receiver is configured to receive a search query from a user. The location predictor is configured to search the inverted index to identify a geographical location associated with the received search query as a predicted location of the user that submitted the search query.

Still further the system may include an action performer. The action performer is configured to perform an action based at least in part on the predicted location of the user that submitted the search query such as selecting an advertisement generating a heat map and or other action.

Computer program products are also described herein. The computer program products include a computer readable medium having computer program logic recorded thereon for generating inverted indexes that enable locations of users that submit search queries to be predicted for using an inverted index to determine a location of a user that submitted a search query and for enabling further embodiments according to the implementations described herein.

Further features and advantages of the disclosed technologies as well as the structure and operation of various embodiments are described in detail below with reference to the accompanying drawings. It is noted that the invention is not limited to the specific embodiments described herein. Such embodiments are presented herein for illustrative purposes only. Additional embodiments will be apparent to persons skilled in the relevant art s based on the teachings contained herein.

The features and advantages of the disclosed technologies will become more apparent from the detailed description set forth below when taken in conjunction with the drawings in which like reference characters identify corresponding elements throughout. In the drawings like reference numbers generally indicate identical functionally similar and or structurally similar elements. The drawing in which an element first appears is indicated by the leftmost digit s in the corresponding reference number.

The following detailed description refers to the accompanying drawings that illustrate exemplary embodiments of the present invention. However the scope of the present invention is not limited to these embodiments but is instead defined by the appended claims. Thus embodiments beyond those shown in the accompanying drawings such as modified versions of the illustrated embodiments may nevertheless be encompassed by the present invention.

References in the specification to one embodiment an embodiment an example embodiment or the like indicate that the embodiment described may include a particular feature structure or characteristic but every embodiment may not necessarily include the particular feature structure or characteristic. Moreover such phrases are not necessarily referring to the same embodiment. Furthermore when a particular feature structure or characteristic is described in connection with an embodiment it is submitted that it is within the knowledge of one skilled in the art to implement such feature structure or characteristic in connection with other embodiments whether or not explicitly described.

Example embodiments are described in the following sections. It noted that the section subsection headings provided herein are not intended to be limiting. Embodiments are described throughout this document and any type of embodiment may be included under any section subsection.

Embodiments of the present invention enable the determination of geographical locations for users based on their queries and the queries of other users in search environments. Embodiments may be implemented in a variety of environments including search environments. For instance shows a search network which is an example environment in which user location determination may be implemented. As shown in network includes a search system . Search system is configured to provide search results for a received search query and to provide matching advertisements. As shown in search system includes a search engine and an advertisement selector . These and further elements of network are described as follows.

As shown in one or more computers such as first third computers are connected to a communication network . Network may be any type of communication network such as a local area network LAN a wide area network WAN or a combination of communication networks. In embodiments network may include the Internet and or an intranet. Computers can retrieve documents from entities over network . Computers may each be any type of suitable electronic device typically having a display and having web browsing capability such as a desktop computer e.g. a personal computer etc. a mobile computing device e.g. a personal digital assistant PDA a laptop computer a notebook computer a tablet computer e.g. an Apple iPad a netbook etc. a mobile phone e.g. a cell phone a smart phone etc. or a mobile email device. In embodiments where network includes the Internet numerous documents including a document that form a portion of World Wide Web are available for retrieval by computers through network . On the Internet documents may be identified located by a uniform resource locator URL such as http www.documents.com documentX and or by other mechanisms. Computers can access document through network by supplying a URL corresponding to document to a document server not shown in .

As shown in search engine is coupled to network . Search engine accesses a stored index that indexes documents such as documents of World Wide Web . A user of computer who desires to retrieve one or more documents relevant to a particular topic but does not know the identifier location of such a document may submit a query to search engine through network . For instance the user may enter query into a search engine entry box displayed by computer e.g. by a web browser . Search engine receives query and analyzes index to find documents relevant to query . For example search engine may determine a set of documents indexed by index that include terms of query . The set of documents may include any number of documents including tens hundreds thousands or even millions of documents. Search engine may use a ranking or relevance function to rank documents of the retrieved set of documents in an order of relevance to the user. Documents of the set determined to most likely be relevant may be provided at the top of a list of the returned documents in an attempt to avoid the user having to parse through the entire set of documents.

Search engine may be implemented in hardware software firmware or any combination thereof. For example search engine may include software firmware that executes in one or more processors of one or more computer systems such as one or more servers. Examples of search engine that may be accessible through network include but are not limited to Yahoo Search at http www.yahoo.com Microsoft Bing at www.bing.com Ask.com at http www.ask.com and Google at http www.google.com .

Furthermore in a sponsored search environment one or more advertisements may be selected for display to the user along with the documents displayed to the user in response to query . Sponsored search refers to a form of Internet advertising marketing that enables advertisers to increase their visibility in the results page of a search engine query. In sponsored search an advertiser may pay or provide other consideration for having information such as a link to a website of the advertiser appear in a sponsored section of the results webpage for one or more particular queries. The sponsored section is prominently displayed in the results page to enable the user to easily view and interact with the displayed information of the advertiser. In this manner an advertiser is enabled to provide advertisements to users that are directly related to their queries and a search engine owner operator is enabled to further monetize the search engine.

For example network may include advertisement selector that is configured to select advertisements related to received queries for display. Advertisement selector may receive query from search engine . Advertisement selector may include a mapping of queries to advertisers advertisements. Advertisement selector may determine from the mapping whether advertisements are present that correspond to query and if so to select one or more of the corresponding advertisements to be displayed as sponsored search results for query . Advertisement selector may provide an indication of the selected advertisements to search engine . Search engine may generate a search results page that is transmitted to first computer to be displayed e.g. by a browser and that includes any determined search results and selected advertisements for query .

In embodiments search system may be configured to determine geographical locations for users submitting queries such as query . For instance shows a block diagram of a search system according to an example embodiment. Similarly to search system of search system may include a search engine e.g. search engine an index e.g. index and an advertisement selector e.g. advertisement selector . Furthermore as shown in search system may include an index generation module and or a location prediction module . These features of search system are described as follows.

Index generation module is configured to generate an index that may be used to predict or determine locations from which users are submitting their queries. Index generation module receives context information which includes information about the locations of users that previously submitted queries and generates an inverted index . Inverted index relates the received location information to search terms within the received queries and may be used to predict locations of users that submit subsequent queries.

For instance as shown in location prediction module receives inverted index . Using inverted index location prediction module is capable of predicting geographical locations for users who submit queries. For instance as shown in location prediction module may receive query e.g. directly or from a search engine such as search engine and may return a predicted geographical location predicted for the user submitting query based on the location history for previously submitted queries in inverted index . In further embodiments location prediction module may perform one or more actions based on predicted geographical location .

Example embodiments for index generation module and location prediction module and for further techniques for generating inverted indexes and predicting locations of users that submit search queries are described in further detail in the following sections.

Index generation module may be configured in various ways to generate inverted index according to embodiments. For instance shows a block diagram of index generation module according to an example embodiment. As shown in index generation module includes a location determiner a query grouper and an index generator . These elements of index generation module are described as follows.

As shown in location determiner receives context information for previously submitted queries e.g. a plurality of search queries previously submitted to a search engine such as search engine of . Context information includes the terms of the previously received queries and includes further information associated with the queries such as information regarding the users submitting the previously received queries e.g. an IP Internet protocol address associated with the computing device where a query was submitted a user ID of a user account for a user that submitted a query etc. and or further metadata. Location determiner is configured to determine locations from which the previously submitted queries were submitted by users based on context information and to output determined geographic locations . Location determiner may identify or determine the locations of the users that submitted the previously submitted queries based on context information in a number of ways including determining location information based on the IP address associated with the computer that submitted a query determining location information provided in a profile of the user that submitted the query e.g. location information stored in a user account analyzing query logs at a search engine annotated with query locations and or other context information.

It is noted that the location determined by location determiner for a user when the user submits a first query may be different than the location determined for the same user when the user submits a different query. This is because a location of the user may change between query submissions. As such a variety of factors may be taken into account in determining a user location when submitting a query as would be known to persons skilled in the relevant art s .

Geographic locations output by location determiner includes each submitted search query and an annotation of each search query with a determined geographical location for a user that submitted the search query. As such determined geographic locations may include a plurality of pairs of determined user location and submitted query user location query pairs . It is noted that more than one location may be indicated for each user location query pair in determined geographic locations . For example based on a determined location for the user source of a query such as the location of Seattle location determiner may determine a hierarchy of locations that include the location such as zip code city county state region country continent etc. For instance with respect to Seattle as the determined location for a user issuing a query location determiner may include a further location indication for the zip code e.g. for the city of Seattle for the state of Washington for the country USA and so on for the user location query pair. In addition to known locations such as cities states regions e.g. Silicon Valley and so on location determiner may assign locations newly created or unique to the search system . For example location determiner may form unique groupings of known locations may split known locations and so on. Queries may be associated with any number of hierarchical tiers of locations in user location query pairs.

Query grouper receives determined geographic locations . Query grouper is configured to group the annotated search queries received in determined geographic locations according to their corresponding determined geographical locations. As shown in query grouper generates location groups which includes one or more location groups. Each location group includes one or more user location query pairs that have a determined location within a location represented by the location group. For instance location groups may be represented as a list of the locations included in determined geographic locations and for each location in the list a list of the one or more queries for which the location was determined by location determiner .

For example determined geographic locations may include the following search query and corresponding determined location information shown shown in Table 1 below 

Note that in an embodiment locations may be grouped by location type such as zip code city state etc. using corresponding location groups of location groups . When grouping locations by location type queries are listed in all of the location groups in which they belong. In other words a location group that is higher in the location hierarchy e.g. state includes all of the location groups lower in the hierarchy e.g. city or zip code that are within the location. For example a query determined to have issued from zip code 80203 is included in the location group for zip codes e.g. in a location group that represents 80203 . The query also is included in the location group for the city that includes the zip code e.g. in a location group representing Denver . The query also is included in the location group for the state that includes the city a location group representing Colorado . That query may also be included in the location group for the country that includes the state e.g. a location group representing the United States . As such multiple location groups may be generated that each correspond to a particular group type representing a particular location.

Index generator receives location groups and stores the information included in the location groups as an inverted index . For example index generator may invert the information of location groups to generate an inverted index or may store the information of location groups in a manner such that it may be accessed as inverted index e.g. by keying on query terms . If multiple location groups have been generated e.g. corresponding to different location types an inverted index may be generated for each location group of location groups . Inverted index is generated as a list of the queries included in a corresponding location group and for each query in the list a list of the one or more locations for which the query was listed in the corresponding location group. For instance further to the example above index generator may generate inverted index as shown in Table 3 as follows 

Note that in the above example of inverted index queries that include multiple terms are listed together for an entry. In another embodiment inverted index may list each query term separately as an entry. For instance index generator may generate inverted index as shown in Table 4 as follows where each query term is listed separately as an entry with one or more associated locations 

As described above if multiple location groups have been generated e.g. corresponding to different location types an inverted index may be generated for each location group. That is every location group is associated with an inverted index that includes entries also referred to as pseudo documents that each includes a query and one or more locations for each query the locations all being included in the location of the location group. For example index generator may generate an inverted index for one or more countries in the world for one or more of the zip codes in the USA one or more of the voting districts in the USA and so on. An inverted index generated for Washington state may include a list of queries and for each query a list of locations that are included in Washington state including Seattle . An inverted index generated for Seattle may include a list of queries and for each query a list of locations that are included in Seattle. For instance the above example of Table 3 may be an inverted index for a location group of the United States.

In some embodiments index generator may also add location relevance information to generated indexes. The location relevance information may provide a relevance score or metric that indicates the relevancy or importance of a location with respect to queries from the location included in the particular inverted index . Thus an entry for a specific location within an index may include a listing of tuples that associate queries or query terms to their assigned locations and the relevance of the locations to the queries.

As such index generation module may receive context information for previously submitted queries and return an inverted index that relates the received location information to search terms within the received queries. For instance index generation module may operate according to . shows a flowchart for building an inverted index according to an example embodiment. Flowchart is described as follows with respect to index generation module of for illustrative purposes. Further structural and operational embodiments will be apparent to persons skilled in the relevant art s based on the following description of flowchart .

Flowchart begins with step . In step geographical locations are determined for a plurality of users that submitted search queries. For example as described above based on context information location determiner determines locations for users that submitted queries.

In step each submitted search query is annotated with a determined geographical location for a user that submitted the search query. For example as described above and shown in location determiner annotates the submitted queries with the determined locations for users that submitted the queries to generate determined geographic locations .

In step the annotated search queries are grouped according to the determined geographical locations into a plurality of location groups. For example as described above and shown in index generator generates location groups that group the annotated search queries received in determined geographic locations according to their corresponding determined geographical locations.

In step an inverted index is built for each location group that relates each term of the submitted search queries in the location group to one or more geographical locations determined for the users that submitted the search queries that include the terms. For example index generator may invert location groups generated by index generator to generate one or more inverted indexes . Each inverted index includes a list of one or more determined user locations for each query term of the search queries submitted by the users. Multiple inverted indexes may be generated that are each associated with a particular location group or tier e.g. zip code city state country etc. .

In step the second index is associated with a search engine. For example inverted index or multiple inverted indexes is associated with a search engine e.g. search engine of . The search engine may use inverted index to determine locations for queries when the search engine receives queries.

Flowchart describes steps implemented by index generation module when generating one or more inverted indexes used to identify or determine locations for queries received at a search engine. shows a table that is an example of an inverted index such as inverted index according to an embodiment. Table is provided for purposes of illustration and is not intended to be limiting.

Table is an inverted index that enables locations to be assigned to queries received at a search engine. Table is an inverted index for a location group associated with the United States. Table includes a plurality of entries that each contains corresponding information . Information for each entry includes a search term and one or more corresponding locations . In some cases not shown entries may include tuples for search terms where the tuples include the location information and relevance scores and or other metrics with respect to the relevance or importance of the locations to the search queries. For instance an example of inverted index having such tuples is shown as follows in Table 5 based on the example of Table 4 shown above 

The relevance scores may be determined in any number of ways. For example index generation module may include a relevance metrics generator that generates relevance scores and or other metrics for locations with respect to queries. The relevance metric generator may base relevance scores on various criteria. For instance queries that are associated with identifying locations directions landmarks and so on e.g. bus route to central park may receive higher scores whereas queries associated with general new topics e.g. Oscar winners 2008 may receive lower scores. Of course further reasons or factors may be utilized to determine relevance scores.

Embodiments for the use of inverted indexes that relate search terms to user locations are described in the following section.

Location prediction module of may be configured in various ways to predict locations of users that submit queries in embodiments. For instance shows a block diagram of location prediction module according to an example embodiment. As shown in location prediction module includes a query receiver a location predictor and an action performer . These elements of location prediction module are described as follows.

Query receiver is configured to receive queries for location prediction module such as queries supplied to a search engine that a user submits to obtain search results. For instance as shown in query receiver may receive query . In an embodiment query receiver may be included in the front end of a search engine or may be located elsewhere. Query receiver may be an API application programming interface a front end of a web service provided by location prediction module or may be configured in other manner and may optionally include a communication interface for communicating over a network such as described elsewhere herein . As shown in query receiver transmits received query to location predictor . In some embodiments query receiver may not be present such as where index generation module and a search engine that receives query are located in a common computer system and thus location predictor can receive query without query being transmitted over a network.

As shown in location predictor receives query and inverted index . Location predictor predicts a location for a user that submitted query and outputs the location as predicted geographical location . Location predictor searches inverted index of to identify one or more locations associated with query . For instance for a received query of coffee shop location predictor may locate the query entry of coffee shop in inverted index and output each location associated with coffee shop in inverted index as predicted geographical location . In an embodiment location predictor may process each term of a multi term search query separately to determine a set of one or more locations for each term to determine a plurality of sets of locations for the multi term search query. Location predictor may determine an intersection of the determined sets of locations that is a subset of the determined locations. The one or more locations in the intersection of locations may be output by location predictor as predicted geographical location . Location predictor may optionally process relevance scores or metrics associated with the identified locations in inverted index . In an embodiment location predictor may determine a plurality of locations for a received query from inverted index and may select one of the locations to be a most likely source for the query such as by selecting the location having the highest relevance score. Location predictor may output the determined most likely source for the query as predicted geographical location .

For example for a received query of Chinese food location predictor may analyze Table in to identify the entries for the terms Chinese and food and to identify an intersection of the locations associated with those terms. In this example a single location of New York is included in the intersection. As such location predictor may determine that the query came from New York. Using various methods described herein such as the intersection of all matching search terms the use of relevance metrics and so on location predictor may determine one or more locations for received queries and transmit predicted geographical location to action performer .

Action performer is optionally present. When present action performer may perform an action in response to predicted geographical location . Action performer may be configured to perform one or more of a variety of different actions. For instance in one embodiment action performer may generate update and or display a heat map that displays geographical location information for received queries. For instance action performer may generate a map displayed by a display of a computing device that indicates the geographical locations identified in inverted index for the terms of query . The display may indicate one or more of the locations displayed in the map as hot or cold e.g. close or far by color such as red and blue with regard to their relative probability or likelihood as being the source of the corresponding query e.g. based on their corresponding relevance scores and or other metrics . Such a heat map enables a visualization of query trends at the time the query is received and may enable a user to select a predicted geographical location from the map based on the hot and or cold indications. In another embodiment action performer may generate or update a report that provides an analysis of query trends. In still another embodiment action performer may be configured to select and or display an advertisement associated with the determined query and the location of predicted geographical location . In still another embodiment action performer may update a list of search results based on the determined query. In further embodiments action performer may perform further and or alternative actions.

As such location prediction module may receive a query received at a search engine may generate a predicted geographical location for query and may perform an action based on predicted geographical location . For instance location prediction module may operate according to . shows a flowchart for determining the geographical location for a user according to an example embodiment. Flowchart is described as follows with respect to location prediction module for illustrative purposes. Further structural and operational embodiments will be apparent to persons skilled in the relevant art s based on the following description of flowchart . Note that flowchart may be repeated for a received query for each of a plurality of inverted indexes that correspond to different location groups.

Flowchart begins with step . In step a query is received from a search engine. For example as shown in query receiver receives a query . Query may include one or more query terms.

In step the inverted index is searched to identify one or more locations associated with terms with the search query. For example the location predictor and searches inverted index to identify one or more entries that contain terms from within the received search query and for each term identifies the geographic locations in inverted index that are associated with the term.

In step a geographical location for a user that submitted the received search query is predicted. As described above location predictor is configured to determine a location corresponding to the user that submitted received search query based on the one or more locations identified in inverted index associated with terms of the search query. For example in an embodiment location predictor may determine an intersection of the locations identified for each term to predict the location. In this and or other embodiments location predictor may consider relevance scores when predicting a location for a user that submitted a query. Location predictor outputs predicted geographical location which includes the determined location. When step is repeated for a plurality of inverted indexes corresponding to different location groups location predictor may determine an intersection of the locations identified for the different location groups to predict the location and or may predict the location of the user to be the location predicted for the most granular location group of the location groups e.g. choosing the location predicted for a location group corresponding to a relatively smaller region such as a zip code over the locations predicted for location groups corresponding to relatively larger regions such as a city a state a country etc. .

In step a plurality of sets of geographical locations associated with the received query is identified in the inverted index. For example as described above location predictor may identify a set of geographical locations in inverted index for each query term of query . Each set of geographical locations may include one or more locations. For instance referring to the example of for the query Chinese food location predictor may identify New York and California as a location set for the term Chinese and may identify New York and Boston as a location set for the term food. 

In step a subset of geographical locations that is an intersection of the sets of geographical locations is determined. As described above location predictor may perform an intersection of the sets of geographical locations determined for the terms of query . For instance continuing the example of Chinese food as a query an intersection of the location sets for Chinese and food is a subset of locations that includes New York. 

In step a geographical location is selected from the subset of geographical locations to be the predicted location for the user that submitted the received query. As described above location predictor may select a geographical location from the determined subset to be the predicted location for the user that submitted query . For instance continuing the example of Chinese food as a query the subset of locations includes a single location of New York. As such in this example the location of New York is predicted to be the location of the user that submitted the query Chinese food. If additional locations were included in the subset of locations the predicted location may be selected from the subset of location as the location having the highest relevance score and or based on other metric. Location predictor may output the location as predicted geographical location .

In another embodiment shows a flowchart for predicting a geographical location of a user based on relevance scores for geographical locations according to an example embodiment. In an embodiment flowchart can be performed by location predictor and is described as follows.

Flowchart begins with step . In step a plurality of geographical locations associated with the received query is identified in the inverted index. For example as described above location predictor may identify a plurality of geographical locations in inverted index for the one or more query terms of query .

In step a relevance score for each of the plurality of geographical locations is identified in the inverted index. For example as described above relevance scores may have been assigned to locations included in inverted index . Location predictor may use the assigned relevance scores as relevance scores for the identified geographical locations. Location predictor may consider one or more further factors to determine a relevance score for each candidate geographical location such as frequency of matching terms a weight of matching terms a combination of the relevance scores for the individual terms and or other factors.

In step a geographical location is selected from the plurality of geographical locations having the highest relevance score to be the predicted location for the user that submitted the received query. For example location predictor may select a location to be a predicted location for the user that submitted query based on a ranking of the relevance scores for the identified geographical locations. For instance location predictor may select the geographical location having the highest relevance score to be output as predicted geographical location .

As described above in some embodiments location prediction module may also perform actions in response to location predictions made by location predictor such as via action performer . For example shows a flowchart for performing an action based on a determined geographical location for a search query according to an example embodiment.

In step a geographical location for the received query is determined. For example location predictor may predict a location of the user that submitted query based on the processes shown in or B combinations thereof or according to other embodiment and the predicted location may be output as predicted geographical location .

In step an action is performed based on the determined location. For example action performer may perform an action based on predicted geographical location . As described above action performer may perform one or more actions such as generating a heat map that illustrates identified locations that illustrates trend information associated with the locations of received queries by updating a report that analyzes location trends in queries received by search engines by displaying an advertisement based on a determined location by updating a list of results of a search for information based on the determined location and so on.

In step an index is updated with the determined geographical location. For example the entries of inverted index corresponding to the received query may be updated with predicted geographical location . For instance entries for the full query and or for each query term the received query in inverted index may have the determined geographical location added to their corresponding lists of locations and or relevancy information in inverted index for the tuples of the determined location and query terms may be updated e.g. may be increased etc. Such updating provides the index with an ever growing and relevant index of information in which locations can be determined for received search queries.

Search engine advertisement selector search system search system index generation module location prediction module location determiner query grouper index generator query receiver location predictor and action performer may be implemented in hardware software firmware or any combination thereof. For example search engine advertisement selector search system search system index generation module location prediction module location determiner query grouper index generator query receiver location predictor and or action performer may be implemented as computer program code configured to be executed in one or more processors. Alternatively search engine advertisement selector search system search system index generation module location prediction module location determiner query grouper index generator query receiver location predictor and or action performer may be implemented as hardware logic electrical circuitry.

The embodiments described herein including systems methods processes and or apparatuses may be implemented using well known servers computers such as a computer shown in . For example computers search engine advertisement selector search system search system index generation module location prediction module and components or modules therein may be implemented using one or more computers .

Computer can be any commercially available and well known computer capable of performing the functions described herein such as computers available from International Business Machines Apple Sun HP Dell Cray etc. Computer may be any type of computer including a desktop computer a server etc.

Computer includes one or more processors also called central processing units or CPUs such as a processor . Processor is connected to a communication infrastructure such as a communication bus. In some embodiments processor can simultaneously operate multiple computing threads.

Computer also includes a primary or main memory such as random access memory RAM . Main memory has stored therein control logic A computer software and data.

Computer also includes one or more secondary storage devices . Secondary storage devices include for example a hard disk drive and or a removable storage device or drive as well as other types of storage devices such as memory cards and memory sticks. For instance computer may include an industry standard interface such a universal serial bus USB interface for interfacing with devices such as a memory stick. Removable storage drive represents a floppy disk drive a magnetic tape drive a compact disk drive an optical storage device tape backup etc.

Removable storage drive interacts with a removable storage unit . Removable storage unit includes a computer useable or readable storage medium having stored therein computer software B control logic and or data. Removable storage unit represents a floppy disk magnetic tape compact disk DVD optical storage disk or any other computer data storage device. Removable storage drive reads from and or writes to removable storage unit in a well known manner.

Computer further includes a communication or network interface . Communication interface enables the computer to communicate with remote devices. For example communication interface allows computer to communicate over communication networks or mediums representing a form of a computer useable or readable medium such as LANs WANs the Internet etc. Network interface may interface with remote sites or networks via wired or wireless connections.

Any apparatus or manufacture comprising a computer useable or readable medium having control logic software stored therein is referred to herein as a computer program product or program storage device. This includes but is not limited to computer main memory secondary storage devices and removable storage unit . Such computer program products having control logic stored therein that when executed by one or more data processing devices cause such data processing devices to operate as described herein represent embodiments of the invention.

Devices in which embodiments may be implemented may include storage such as storage drives memory devices and further types of computer readable media. Examples of such computer readable storage media include a hard disk a removable magnetic disk a removable optical disk flash memory cards digital video disks random access memories RAMs read only memories ROM and the like. As used herein the terms computer program medium and computer readable medium are used to generally refer to the hard disk associated with a hard disk drive a removable magnetic disk a removable optical disk e.g. CDROMs DVDs etc. zip disks tapes magnetic storage devices MEMS micro electromechanical systems storage nanotechnology based storage devices as well as other media such as flash memory cards digital video discs RAM devices ROM devices and the like. Such computer readable storage media may store program modules that include computer program logic for search engine advertisement selector search system search system index generation module location prediction module location determiner query grouper index generator query receiver location predictor action performer flowchart flowchart flowchart flowchart and or flowchart including any one or more steps of flowcharts and and or further embodiments of the present invention described herein. Embodiments of the invention are directed to computer program products comprising such logic e.g. in the form of program code or software stored on any computer useable medium. Such program code when executed in one or more processors causes a device to operate as described herein.

The invention can work with software hardware and or operating system implementations other than those described herein. Any software hardware and operating system implementations suitable for performing the functions described herein can be used.

While various embodiments have been described above it should be understood that they have been presented by way of example only and not limitation. It will be apparent to persons skilled in the relevant art s that various changes in form and details can be made therein without departing from the spirit and scope of the invention. Thus the breadth and scope of the present invention should not be limited by any of the above described exemplary embodiments but should be defined only in accordance with the following claims and their equivalents.

