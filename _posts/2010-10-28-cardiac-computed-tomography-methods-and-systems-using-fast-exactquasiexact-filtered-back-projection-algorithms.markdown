---

title: Cardiac computed tomography methods and systems using fast exact/quasi-exact filtered back projection algorithms
abstract: The present invention provides systems, methods, and devices for improved computed tomography (CT). More specifically, the present invention includes methods for improved cone-beam computed tomography (CBCT) resolution using improved filtered back projection (FBP) algorithms, which can be used for cardiac tomography and across other tomographic modalities. Embodiments provide methods, systems, and devices for reconstructing an image from projection data provided by a computed tomography scanner using the algorithms disclosed herein to generate an image with improved temporal resolution.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08483351&OS=08483351&RS=08483351
owner: Virginia Tech Intellectual Properties, Inc.
number: 08483351
owner_city: Blacksburg
owner_country: US
publication_date: 20101028
---
This application claims priority to and the benefit of the filing date of U.S. Provisional Application No. 61 225 708 filed Oct. 28 2009 which is incorporated by reference herein in its entirety.

This invention was made made with government support under contracts EB002667 EB004287 and EB007288 awarded by National Institutes of Health. The government has certain rights in the invention.

The present invention provides systems methods and devices for improved computed tomography CT . More specifically the present invention includes methods for improved cone beam computed tomography CBCT resolution using improved filtered back projection FBP algorithms which can be used for cardiac tomography and across other tomographic modalities.

Cardiovascular diseases CVDs are pervasive American Heart Association 2004 . CVD is the number one killer in the western world. The cost of the health care for CVD is skyrocketing. In 2004 the estimated direct and indirect cost of CVD was 368.4 billion.

Coronary artery disease is a leading cause of death as a result of a myocardial infarct heart attack without any symptom. Tomographic equipment with high temporal resolution is needed in order to successfully perform a cardiac scan and understand the etiology and pathogenesis of CVD such as high blood pressure coronary artery diseases congestive heart failure stroke and congenital cardiovascular defects as well as to develop effective prevention and treatment strategies. CT scanners are now considered instrumental for detecting early heart diseases and are a centerpiece of preventive cardiology programs.

Although there has been an explosive growth in the development of CT scanners for cardiac CT studies the efforts are generally limited to regular heartbeats. When applying traditional CT algorithms for cardiac CT reconstruction the cardiac images may be inaccurate or useless based on substantial motion blurring especially seen in patients who have high and irregular heartbeats due to the fact that each projection sector covers a projection angular range of a substantial length. Within such an angular range the heart moves appreciably especially when it is not in a relative stationary phase. As a benchmark a 0.3 mm spatial resolution is routinely achieved in spiral CT of the temporal bone where the motion magnitude is much less than that of the heart see M. Vannier and G. Wang Spiral C T refines imaging of temporal bone disorders vol. 15 p. 116 121 1993 and G. Wang et al. Design analysis and simulation for development of the first clinical micro CT scanner1 vol. 12 pp. 511 525 2005 which is incorporated by reference herein in its entirety . Spatial resolution with cardiac CT is at best in the millimeter domain.

Over the last thirty years computer tomography CT has gone from image reconstruction based on scanning in a slice by slice process to spiral scanning. From the mid 1980s to present day spiral type scanning has become the preferred process for data collection in CT. Under spiral scanning a table with the patient continuously moves through the gantry while the source in the gantry is continuously rotating about the table. At first spiral scanning used a one dimensional detector array which received data in one dimension a single row of detectors . Later two dimensional detectors where multiple rows two or more rows of detectors sit next to one another were introduced. In CT there have been significant problems for image reconstruction especially for two dimensional detectors.

For three four dimensional also known as volumetric dynamic image reconstruction from the data provided by a spiral scan with two dimensional detectors known groups of algorithms include exact algorithms quasi exact algorithms approximate algorithms and iterative algorithms. While the best approximate algorithms are of Feldkamp type the state of the art of the exact algorithms is the recently developed Katsevich algorithm.

Under ideal circumstances exact algorithms can provide a replication of a true object from data acquired from a spiral scan. However exact algorithms can require a larger detector array more memory are more sensitive to noise and run slower than approximate algorithms. Approximate algorithms can produce an image very efficiently using less computing power than exact algorithms. However even under typical circumstances they produce an approximate image that may be similar to but still different from the exact image. In particular approximate algorithms can create artifacts which are false features in an image. Under certain circumstances these artifacts can be quite severe.

To perform the long object reconstruction with longitudinally truncated data the spiral cone beam scanning mode and a generalized Feldkamp type algorithm were proposed by Wang and others in 1991. However the earlier image reconstruction algorithms for that purpose are either approximate or exact only using data from multiple spiral turns.

In 2002 an exact and efficient method was developed by Katsevich which is a significant breakthrough in the area of spiral cone beam CT. The Katsevich algorithm is in a filtered backprojection FBP format using data from a PI arc scanning arc corresponding to the PI line and less than one turn based on the so called PI line and the Tam Danielsson window. The principle is that any point inside the standard spiral or helical belongs to one and only one PI line. Any point on the PI line can be reconstructed from filtered data on the detector plane with the angular parameter from the PI arc. In 2003 a slow FBP and a backprojected filtration algorithm BPF were developed for helical cone beam CT based on the Katsevich algorithm by exchanging the order of integrals. For important biomedical applications including application with movement present such as cardiac CT generalization of the exact cone beam reconstruction algorithms from the case of standard spirals to the case of nonstandard spirals and other scanning loci is desirable and useful. Although the current Katsevich type algorithms are known for a standard spiral scan there are no known fast algorithms systems devices and methods that can reconstruct an image exactly or quasi exactly from data acquired in a CT scan with good temporal resolution.

Therefore despite the impressive advancement of the CT technology there are still unmet critical and immediate needs such as those mentioned above for better image quality in many cardiac and other CT investigations wherein the motion magnitude is increased.

The numerous limitations inherent in the scanning systems described above provide great incentive for new better systems and methods capable of accounting for one or more of these issues. If CTs are to be seen as an accurate reliable therapeutic answer then improved methods for reconstructing an image should be developed that can more accurately predict the image with improved temporal resolution and less artifacts.

The primary limitation to the above mentioned system is its need to provide good temporal resolution and image reconstruction when movement is involved. However as more complex applications for scanning are encountered reconstruction of key subject areas such as the heart lung head and neck is cumbersome at best and may be inadequate to develop reliable diagnosis and therapies. Therefore a more advanced system that allows for the production of better object reconstruction would be ideal. This allows for the adaptation of exact and quasi exact algorithms to provide better images.

Accordingly embodiments of the invention provide methods systems and devices for reconstructing an image from projection data provided by a computed tomography scanner comprising scanning an object in a cone beam imaging geometry following a general triple helix path wherein projection data is generated reconstructing the image wherein the reconstructing comprises performing a filtered backprojection using a fast exact or quasi exact filtered back projection algorithm to generate the backprojected data and using the backprojected data to generate an image with improved temporal resolution. Preferably embodiments of the invention provide images with less than about 500 ms e.g. about 100 ms temporal resolution or less such as about 80 ms or less or about 60 ms or less or about 50 ms or less or about 30 ms or less or even about 10 ms or less and so forth.

In the context of this disclosure exact or quasi exact means that the algorithm is theoretically exact for a good portion of voxels in the object or theoretically exact if a practically insignificant portion of data could be handled in a more complicated fashion. Said another way quasi exact means that the algorithm is derived from an exact three dimensional reconstruction approach in which deviations from exactness are introduced which are sufficiently small and lead to minor artifacts but result in a numerically efficient algorithm. By way of example these deviations may lead to inexact weighting of a small percentage of Radon planes at every voxel.

In preferred embodiments the temporal resolution may be in the range of about 100 ms to less than about 10 ms.

The present invention includes a computed tomography CT imaging method comprising scanning an object using multi source helical cone beam computed tomography CBCT to acquire projection data relating to the object and reconstructing the scanned portion of the object into an image by performing a computationally efficient filtered backprojection FBP and theoretically exact quasi exact algorithm to generate image data. Such methods for example are included within the scope of the invention which are capable of achieving a temporal resolution in the image in the range of 

In the context of this disclosure what is meant by computationally efficient we mean that the computational efficiency of a cone beam reconstruction algorithm is in the same order of magnitude of that developed by Katsevich as reported in A. Katsevich Theoretically exact filtered backprojection type inversion algorithm for spiral CT SIAM Journal on Applied Mathematics vol. 62 p. 2012 2002 which is herein incorporated by reference in its entirety. Further by theoretically exact we mean that the reconstructed image would be exact if both the sampling interval and the measurement error approach zero.

Embodiments of the invention further include a computed tomography CT imaging system comprising a multi source helical cone beam computed tomography CBCT scanner operably configured for scanning an object to acquire projection data relating to the object a processing module operably configured for reconstructing the scanned portion of the object into an image by performing a filtered backprojection FBP with a fast exact or quasi exact FBP algorithm to generate image data and a processor for executing the processing module. Such systems can include software and hardware operably configured for performing the functions of the processing module.

Embodiments of the present invention provide for reconstructing the image using a fast exact or quasi exact algorithm developed by defining the weight function determining filtering directions calculating the backprojection coefficients and reconstructing the object with for example 

Such methods systems and devices can further be characterized in having the fast exact or quasi exact algorithm implemented by differentiating each projection with respect to variable s for each y s i 1 2 3 performing the Hilbert transform of derivative data along the given filtering directions on the corresponding detector plane and backprojecting the filtered data on the inter PI segments to reconstruct the object.

The features and advantages of the present invention will be apparent to those skilled in the art. While numerous changes may be made by those skilled in the art such changes are within the spirit of the invention.

In accordance with embodiments of the present invention a method of the present invention may comprise introducing two fast FBP algorithms for use with conventional cardiac CT technologies in order to obtain better reconstruction images. One of the many potential advantages of the methods of the present invention only some of which are discussed herein is that images with less blurring and improved temporal resolution may be obtained even when there is movement in the object being scanned. The current invention may provide benefits to various types of interior tomography including but not limited to cardiac lung head and neck tomography. In the medical field and in biomedical science the methods disclosed herein may greatly reduce the production of unusable images and thereby potentially allow increased early detection of diseases reduced amount of radioactive contrast used on the patients and or reduced costs associated with CTs. Better temporal resolution in the images may provide a cost savings by reducing the number of images needed to conclude a finding. This type of scanning may likewise provide more flexibility in designing experiments in small animals in order to better study these diseases and develop effective treatments.

Another potential advantage is that the two fast FBP proposed algorithms utilize the inter PI line and inter PI arcs and have a shift invariant filtering structure. Unlike our slow FBP algorithm performing filtration spatial variantly line by line the proposed fast FBP algorithms filter projection data spatial invariantly view by view representing a significant computational benefit. Since triple source helical CBCT may triple temporal resolution it seems a promising mode for cardiac CT and other CT applications and our proposed algorithms may find applications in this context. The methods of the present invention allow for temporal resolution in the range of about 100 ms to less than about 10 ms.

In particular embodiments the geometry of the triple source helical. CBCT may be measured by allowing f x be an object function to be reconstructed. In embodiments where this function is smooth and vanishes outside the object cylinder EQUATION 1 may be applied as described below 0

where r is the radius of the object cylinder and R the radius of the scanning cylinder on which a scanning trajectory resides. In embodiments with the Cartesian coordinate system x x x the triple helix trajectories can be expressed as shown in EQUATION 2 below 

where h 0 is the pitch of each helix and s is the rotation angle. illustrates the triple source helical CBCT geometry.

Previously the inter helix PI lines were defined and extended the traditional Tam Danielsson window to the Zhao window in the case of triple helices. The terms inter helix PI lines and inter PI lines are the same and are used interchangeably throughout. Specifically for each source position y s j 1 2 3 the corresponding Zhao window is the region on the surface of the scanning cylinder bounded by the nearest helix turn of y s and the nearest helix turn of y s j 1 2 3. In and denote the boundaries of the Zhao window and the Tam Danielsson window on the detector plane respectively. In certain embodiments the algorithms described herein are designed for flat panel detectors. However in embodiments with detectors of other shapes the arbitrary shaped detector may be rebinned to a virtual flat panel detector in a preprocessing step so that the algorithms of the current disclosure may be used.

The properties of the inter PI lines and inter PI arcs may be determined by recalling that an inter PI line for y s and y s j 1 2 3 is the line that 1 intersects y s at one point and y s at another point and 2 the absolute difference between the angular parameter values at the two intersection points is less than 2 . The existence and uniqueness of the inter PI line is shown in Theorem 1 below.

Theorem 1 states that through any fixed x there exists one and only one inter PI line for any pair of the three helices defined by EQUATION 2. In the triple helix case there are three inter PI lines for a fixed x and corresponding inter helix PI arcs whose end points may be along the corresponding helices and share the intersection points of the inter PI lines. In some embodiments the three inter PI arcs represent the source trajectory arcs along which the sources illuminate the point x as shown in .

In 2003 Katsevich proposed a general scheme for constructing inversion algorithms for CBCT. It can be stated as follows in EQUATIONS 3 8 

where D y is the cone beam transform of f the polar angle in the plane perpendicular to s x s x a unit vector perpendicular to s x a point where s x is discontinuous n s x a weight function C a finite union of C curves in 

The aforementioned general inversion formula can be applied to any trajectory that satisfies Tuy s condition but only when the weight function n s x is well designed can the inversion formula have a shift invariant filtering structure. To derive fast exact FBP algorithms for triple source helical CBCT our general approach involves the following key concepts of and analyses on the inflection line A T L and Bs curves.

Inflection line. On the detector plane the boundaries of the Zhao window may be expressed as EQUATION 9 below 

where D is the distance between the detector and the source s is the angular parameter relative to the corresponding source position s 2 3 and s 4 3 are for the top and bottom boundaries respectively. Then EQUATIONS 10 14 can be used.

Because cos s cos s 0.8596 the slope is the same 0.1368 h R at both inflection points. For practical medical applications it is common that r 0.5 R and a boundary limitation x x r r 0.495 R may be included which is shown as the vertical lines and in . Now the inflection lines the tangent lines at and where and are the projection of y s and y s j 1 2 3 on the detector plane and the boundary lines split the Zhao window into the following three regions G Gand G. Only the points in Gand Gcan have tangent lines with .

To construct an appropriate weight function the understanding of how Radon planes intersect with the trajectories is important. The number of intersection points only changes when a Radon plane is tangent to the trajectory or contains one PI line inter PI line. Hence if we find all such Radon planes we can determine the distribution of the intersection points. Since each plane is uniquely determined by its normal vector in the following sections we use unit vectors instead of the Radon planes. An A curve consists of all unit vectors orthogonal to an inter PI line. A T curve consists of all unit vectors in EQUATION 16 as shown below 

where s belongs to an inter PI arc. Actually the A curve represents all Radon planes containing one inter PI line and the T curve represents all Radon planes tangent to the trajectory. Since there are three inter PI lines and three inter PI arcs for a fixed x there are accordingly three A curves and three T curves. The use of spherical coordinates to describe these curves on the unit sphere is shown in EQUATION 17 cos sin sin sin cos 0 . EQUATION 17 

As an example the A curves and T curves of point x 0.1 0 0 are illustrated in where R 1 h 2 . T Tand Tstand for the T curves corresponding to the inter PI arcs and respectively. Similarly A Aand Aare for the A curves corresponding to the inter PI lines and circumflex over ss respectively.

The A curves and T curves may divide the surface of the unit sphere into several connected domains in each of which all the planes through x have the same number of intersection points IPs with the inter PI arcs of x. Given an object point and one trajectory the number of IPs only changes when a Radon plane is tangent to the trajectory or contains the endpoints of the trajectory. The A curve represents all planes containing the endpoints of the trajectory and the T curve represents all planes tangent to the trajectory. If any Radon plane is chosen and rotated around one direction the normal vector of this plane forms a curve on the unit sphere. Clearly only when this curve intersects with the A curve or T curve does the number of IPs change. Thus the A curve and T curve define the boundaries of different domains in which the number of IPs is constant. The distribution of IPs over the inter PI arcs is listed in Table I. To determine the distribution of IPs we first pick a vector in each domain and then generate the plane through x and perpendicular to and compute numerically the number of IPs.

By construction a T curve always starts from an A curve and ends on another A curve. It can be seen from that a T curve is may not be smooth at some point a but the limits of unit tangent vectors at a and a are equal Such a point ais defined herein as a cusp . The term cusp indicates that the two vectors determine the same plane and ais the normal vector to that plane. It has been proved in that the cusp is equivalent to the osculating plane x which goes through y s x i 1 2 3 is parallel to dot over y s x s x and contains x see . On the detector plane this corresponds to a point where the projected boundary has a point of zero curvature i.e. the point of inflection.

The diagram plotted in spherical coordinates deforms smoothly as a function of x. The new diagram is equivalent to the old one in the embodiments where the distribution of IPs remain the same. An essential change could happen when three boundaries intersect each other at one point which is defined herein as a critical event . The term critical event may happen in the following seven cases 

6. When the order of tangency i.e. the zero derivatives of this order at the beginning of the T curve is increased the T curve re emerges on the other side of the A curve 

From Lemmas 2 3 described below in the Examples section it is shown that Cases 1 2 4 6 7 do not occur for r

The L curve may be used to split the domain Dinto sub domains making the weight function n continuous across all the A curves. This is the key requirement which may allow for the development of efficient reconstruction algorithms. Thus the L curve should not go across an A curve. In embodiments where x is fixed and s is run over the three inter PI arcs circumflex over x forms a trajectory on the detector plane. Because at the endpoint of the inter PI arc the line connecting y s and x happens to be an inter PI line circumflex over x always starts from one endpoint of the inter PI arc on the boundary of the Zhao window and ends at the other one. Hence whatever the trajectory of circumflex over x is part of the trajectory is in G. In other words circumflex over x will run across one inflection line then move in G and finally cross the other inflection line. Note that circumflex over x on the inflection line indicates a plane containing the inflection line i.e. a cusp in one T curve. From Lemma 3 described in the Example section below the cusps always belong to the boundary of domain D. Thus they can be used as the endpoints of the L curve. A family of L curves is formed as follows. Run s over the three inter PI arcs of x. If circumflex over x is in Gand above where intersects L find the plane through circumflex over x and . If circumflex over x is in Gand below where intersects L find the plane through circumflex over x and . If circumflex over x is in Gand between and find the plane through circumflex over x and parallel to the u axis. A plot of all the normal unit vectors of these planes in the spherical coordinates may then be constructed. This gives us three L curves. The corresponding lines on the detector plane are called L lines. shows the L curves on the diagram in spherical coordinates where L Land Ldenote the L curves corresponding to the inter PI arcs and respectively. As is seen from the above construction the L curve always starts and ends on the cusps and not defined for those parameter values when circumflex over x is not in G.

For r 0.265 R one or more cusps will disappear if critical event Case 5 occurs then the L curve may start from the intersection of T curve and A curve and end at one A curve. Also the L curve may start from one cusp and end at one A curve or start from the intersection of T curve and A curve and end at one A curve. For example see Lstarts from the intersection of Tand A and ends at the intersection of Tand A Lstarts from one point on A and ends at the cusp of T Lstarts from the cusp of T and ends at one point on A.

Whatever the endpoints of L curves are the L curves intersects at one point for example in some embodiments or 0 in the spherical coordinates which corresponds to the plane containing x and parallel to the x xplane . Then Dis split into several sub domains. If the endpoints of L curves are cusps by Lemma 5 each sub domain contains only one A curve. If not small line segments on A curves may appear and the sub domains may contain more than one A curve see .

B curve. A B curve may consist of all unit vectors perpendicular to x y s i 0 2 3. Each intersection of B and A curves corresponds to a plane containing an inter PI line and y s . Each intersection of B and T curves corresponds to a plane tangent to an inter PI arc and containing y s . For example in certain embodiments one may choose x with circumflex over x G circumflex over x is above L where Lis the projection of the helical tangent at the current position. If L DP s x s x is denoted where DP s is the detector plane corresponding to the source position s and L is the projection of the plane through x with the normal vector s x then as increases s x s x rotates clockwise on DP s and the following sequence of events takes place. First x s x intersects and a pair of IPs is born. On the unit sphere this is seen as an intersection of Band A after which Benters D . Second x s x intersects and another pair of IPs is born. On the unit sphere this is seen as an intersection of Band A after which Benters D. Third a swap of two IPs takes place. On DP s this happens when L is parallel to the helical tangent. On the unit sphere this means that Bis tangent to Tat s x . Fourth Bexits Dby intersecting T. On DP s this takes place when L is tangent to . Finally x s x intersects the L line. This will not change the number of IPs but it will be useful for construction of the weight function. On the unit sphere this is seen as an intersection of Band L.

The jumps across an A curve can only be of two types from a 1 IP domain to a 3 IP domain and from a 3 IP domain to a 5 IP domain. Note that the B curve is tangent from the inside to T which means a swap of two intersection points at where sgn dot over y s 0 see 15 . For a fixed s if x is allowed to change slightly inside the Zhao window the tangency point will move from Dto Dacross A or from Dto Dacross A . If x projects into Gor G the B curve will pass not only through D or D and Dbut also through Dand D . The similar results can be obtained if the source is on y s or y s .

Two filtered backprojection algorithms for triple source helical cone beam CT can be used to obtain images having higher temporal resolution. The first exemplary algorithm uses two families of filtering lines which are parallel to the tangent of the scanning trajectory and the so called L lines. The second algorithm uses two families of filtering lines tangent to the boundaries of the Zhao window and L lines respectively but it eliminates the filtering paths along the tangent of the scanning trajectory thus reducing the detector size greatly. Additional information concerning these algorithms can be found in Lu Yang et al. Fast Exact Quasi Exact FBP Algorithms for Triple Source Helical Cone Beam CT IEEE Transactions on Medical Imaging Vol. 29 No. 3 March 2010 which is incorporated by references herein in its entirety.

In order to design an algorithm for triple source helical CBCT useful in cardiac CTs and other CTs where movement exists the weight function n s x must be specified. The filtering directions by the discontinuities of s x sgn dot over y s n s x must also be determined. Following the determination of the filtering directions the backprojection coefficients can be calculated according to EQUATION 6. Once the filtering lines and the backprojection coefficients are determined EQUATION 3 may be used to reconstruct the object.

In order to construct the weight function n s x one should know the following. In certain embodiments in order to have an efficient FBP structure the weight function n s x should be continuous across all A curves. Thus the weight function can be defined as shown in Table II. The values in Table II are the weights assigned to IPs. For example in the Ddomain the Radon plane has only one IP on the inter PI segment . Accordingly a weight of 1 may be assigned to this IP and a dash used to indicate that there is no IP on the inter PI segments and . In the Ddomain the Radon plane has three IPs on one IP on and one IP on . Thus a weight of 1 may be assigned to two IPs on and a weight of 1 to all other IPs.

To find the backprojection coefficients a representative point in each area is selected in order to determine the discontinuities of s x sgn y s n s x and extend the results by continuity to the entire area. A discontinuity of sgn occurs only when a B curve is tangent to a T curve from the inside. In other words the B curve does not go across the T curve but stays on one side in a neighborhood of the point of tangency. On the detector plane L is parallel to the helical tangent for all circumflex over x G G G. Hence this gives a family of filtering lines parallel to L where Lis the projection of the helical tangent at y s . The swap of two IPs changes the weight from n 0 to n 1. The backprojection coefficient is computed as c 1 0 1 1 1 .

In certain embodiments by construction the weight function n is continuous across all inter PI lines. A discontinuity of n occurs only when a B curve intersects a T curve or an L curve. Without loss of generality or wishing to be limited by theory choosing y s on . For circumflex over x G after the swap mentioned in the above paragraph the weight at the current position is zero. Hence when the B curve passes through a T curve i.e. from Dto D n is continuous. Possible jumps of n may only occur when a B curve passes through an L curve i.e. from Dto Dor from Dto Din . On the detector plane this occurs when L overlaps the L line of circumflex over x . Then the backprojection coefficients may be computed as c 1 1 1 0 1 . . For circumflex over x G G the B curve will not enter D. Instead it passes through a second T curve twice i.e. from Dto Dand from Dto D. From Table II the jumps of n may only occur in the latter intersection. On the detector plane this happens when L overlaps the line tangent to . Then the backprojection coefficients may be computed as c 1 1 1 0 1 .

Again the design of the second fast FBP algorithm starts with specifying new weights Table III . By construction n s x is continuous across all inter PI lines. More importantly a swap of two IPs takes place when a B curve becomes tangent to a T curve and n s x changes from 1 to 1. The discontinuity of sgn s appears only when a B curve is tangent to a T curve from inside. Since both n s x and sgn dot over y s are discontinuous at that point the function s x sgn dot over y s n s x is continuous. Thus the filtering operation along the tangent of the scanning trajectory is eliminated.

A discontinuity of n can occur only when a B curve intersects a T curve or an L curve. Follow the discussion in Section IV jumps of n may occur when 1 a B curve passes through a T curve i.e. from Dto Dor from Dto Din and 2 a B curve passes through an L curve i.e. from Dto Dor from Dto Din . On the detector plane this gives two families of filtering lines the lines tangent to or and the L lines. Note that the filtering lines tangent to are different from those for our first fast FBP algorithm because the discontinuity of n s x occurs on the different side of the cusp. Then the backprojection coefficients can be calculated a c 1 0 1 1 1 and c 1 1 1 0 1.

The reconstruction formula for the second algorithm is the same as that for the first algorithm. The only difference lies in the selection of the filtering lines. For clarity our second fast FBP algorithm is illustrated in . Because the filtering paths along the tangent of the scanning trajectory are eliminated the required detector area is reduced by at least 30 .

By Lemma 3 described below in the Examples section there are two types of line segments according to different critical events. First let us consider the line segment related to a critical event in Case 3. Recall that before entering Dthe B curve will be tangent to a T curve. For the first algorithm at the tangency the weight n changes from 1 to 0 then it does not change whether the Bs curve enters Dacross an A curve or a T curve. For the second algorithm if the weight n changes from 1 to 1 at the tangency then it will jump from 1 to 0 when the B curve enters D. If the B curve enters Dacross an A curve i.e. the line segment see the FBP structure is ruined. Thus the critical event in Case 3 will only affect the second algorithm without damaging the FBP structure of the first algorithm. Then let us consider the line segment related to a critical event in Case 5 which only occurs when r 0.265 R. From the discussion in Section III.D such a line segment is the boundary of the one IP and three IP domains. Hence for both the algorithms the weight n will jump from 1 to 0 if the B curve enters Dacross the line segment and the FBP structure is ruined. Consequently the first algorithm is theoretically exact for r

Since the algorithms are not always exact it may be important to estimate what percentage of the Radon planes is incorrectly calculated. If the Radon planes with approximate weighting only have a small percentage the algorithms can be considered quasi exact and we can still reconstruct with high image quality.

First one must consider the incorrectly weighting planes caused by the critical event in Case 3. It appears in the area r

Then one must further consider the incorrectly weighting planes caused by the critical event in Case 5. Recall that the L curves are used to split the domain Dinto sub domains making the weight function n continuous across all the A curves and the cusps are the starting and ending points of the L curves. If the endpoints of the L curves are not the cusps there will be small fractions or line segments on the A curves making the weight function n discontinuous across them and ruining the FBP structure of our algorithms. It possibly occurs for r 0.265 R. As discussed above the Bs curve will first enter a 1 IP domain from a 3 IP domain across the line segment and then pass through an L curve. On the detector plane this corresponds to that L intersects the inter PI line before the L line while L is rotated clockwise. Recall that if the cusp is not in D is possibly to the left of or is to the right of . Thus the slope of is always more than 0.35 h R.

Because the slope of the L curve is never positive the percentage of the incorrectly weighted Radon planes is less than 2.57 for h R 0.2. On the other hand based on the discussion on Lemma 3 one or more cusps may possibly remain even when r 0.265 R which means that less line segments related to critical events will appear in Case 5 and in fact more Radon planes may be correctly weighted.

The implementation of these algorithms consists of one or more and preferably all of the following steps Step 1 Differentiate each projection with respect to variable s Step 2 For each y s i 1 2 3 perform the Hilbert transform of derivative data along the given filtering directions on the corresponding detector plane Step 3 Backproject the filtered data on the inter PI segments to reconstruct the object point. Differences between the algorithms described herein and some of the ones previously described include but are not limited to differences in triple helices geometry the filtered data are backprojected on inter PI segments and that there are two families of filtering lines for each algorithm so that each point on the detector plane will be filtered twice. Also since the algorithms described herein allow shift invariant filtration all results are in Cartesian coordinates directly and there is no coordinate transform necessary similar to what was used in the slow FBP algorithm or BPF algorithm.

Previously published BPF algorithms for triple source helical CBCT can indeed produce excellent image quality FBP algorithms either slow or fast are computationally desirable for several reasons such as being amendable for parallel processing. In particular while the computational structures of our BPF algorithm and FBP algorithms are quite similar the FBP algorithms avoid densely sampled intermediate reconstruction in the PI line based coordinate system and more importantly they can reconstruct a region of interest ROI or volume of interest VOI much more efficiently than the BPF counterpart. Note that ROI VOI reconstruction is very common in medical imaging. A related technology called interior tomography is being actively developed to target this type of problems. Then an interesting possibility would be to develop tripe source interior CBCT.

The inventive two fast exact quasi exact FBP algorithms for triple source helical CBCT have their advantages and disadvantages. From the perspective of exact reconstruction the first algorithm is more desirable than the second algorithm because it is not affected by critical events in Case 3. However in terms of efficient data acquisition it may require a larger detector area than the second algorithm. In the medical CT field the rectangular detector shape is most popular and the helical pitch may be varied case by case. Therefore it is practically possible to have projection data for reconstruction using either or both of the two fast FBP algorithms.

The methods disclosed herein can be practiced on any CT system. An example of a CT system and apparatus capable of implementing the methods is provided is an electron beam CT. In that framework a curvilinear tungsten material or target can be arranged along a non standard curve to be traced by an electro magnetically driven electron beam for formation of an X ray source and collection of cone beam data.

An exemplary electron beam CT comprises a vacuum chamber having an exterior surface an underlying interior surface and defines an enclosed space. At least a portion of the exterior surface can define or surround a subject cavity. The subject cavity is adapted to receive a subject. The subject cavity can be adapted to receive a human a mouse or a rat e.g.

The apparatus can further comprise a charged particle beam generator having a proximal and a spaced distal end. The electron beam generator can generate a flat or curved electron sheet. The electron beam generator can have a scanning speed from about 25 Hz to about 50 Hz. The apparatus can comprise a single electron beam generator or a plurality of electron beam generators.

The apparatus can include a focusing mechanism adapted to selectively focus charged particles generated by the charged particle beam generator and a target adapted to generate X rays upon receipt of charged particles from the charged particle beam generator. If a plurality of electron beam generators are used the apparatus may comprise a plurality of focusing mechanisms.

The apparatus further comprises a detector or a series of detectors surrounding the target. There are a large variety of detectors that can be used in the disclosed apparatuses systems and methods. Two representative types are a thin film transistors TFT .alpha. Si H and b mono crystalline silicone CCD CMOS detectors. Although their quantum efficiency is high the readout speed of TFT detectors is generally less than 30 frames per second rarely reaching 100 frames per second. On the other hand the readout speed of CCD CMOS detectors can be extremely high such as 10 000 30 000 frames per second and are coupled with fiber optical tapers resulting in low quantum efficiency. For example the 1000 Series camera from Spectral Instruments Tucson Ariz. can be used. This camera is compact measuring 92 by 92 by 168 mm. Two three and four phase architecture CCDs from Fairchild Imaging Milpitas Calif. E2V Elmsford N.Y. Kodak Rochester N.Y. and Atmel San Jose Calif. can be placed in the selected camera. The readout and digitization can use 16 bit digitizer. The pixel readout rate can be varied from 50 kHz to 1 MHz. The gain of the analog processor can be modified under computer control to compensate for the gain change of the dual slope integrator at different readout speeds. The 1000 Series system offers fully programmable readout of sub arrays and independent serial and parallel register binning. In addition specialized readout modes such as time delay and integration TDI using an internal or external time base can be used. These capabilities allow the readout of only the area of the CCD of interest at variable resolution in order to optimize image signal to noise ratio.

To facilitate a better understanding of the present invention the following examples of certain aspects of some embodiments are given. In no way should the following examples be read to limit or define the scope of the invention.

To verify and showcase the fast FBP algorithms of the present invention numerical tests were performed using the Clock phantom. This phantom consists of ellipses as parameterized in Table IV. In the simulations the origin of the reconstruction coordinate system was set to the center of each phantom. The spherical phantom support was of 375 mm for the experiment. Three sources were arranged uniformly along a circle with their corresponding detectors on the opposite side. The source detector distance was 1000 mm. Projections were generated from 1000 view angles while the sources and the detectors were constantly moved along three helixes in one turn. The helix was of 750 mm in radius and 100 mm in pitch. The detector plane consisted of 1300 200 detection elements of 1.0 1.0 mm.

The algorithms were coded in MATLAB and executed on a regular PC Intel Core2 Duo CPU 3.06 GHz 4 GB RAM . Reconstructed images are shown in . Our numerical results show that in the case of r 0.495 R both two algorithms produced high quality images.

Auxiliary Lemmas were used as described below. A point was fixed at x and its three associated inter PI lines were found as shown in . Then a source position was selected as s s s j 1 2 3 and how the inter PI lines project onto the corresponding detector plane was determined. For simplicity in this disclosure the projection of y s j 1 2 3 on a detector plane is denoted by .

On a detector plane the slopes of the projected inter PI lines and are always positive and that of the inter PI line j 1 2 3 is always negative.

Without loss of generality or wishing to be limited by theory the source position was selected to be y s s s s . By construction s s

The interior point of T curve can be any point of the T curve except an endpoint. It has been proved previously that a T curve is smooth everywhere except possibly at a cusp. When s i 1 2 3 is chosen to be the point where the cusp occurs. It was assumed that a T curve was tangent to an A curve at s . If s s s s where s swere the endpoints of the T curve then the osculating plane x intersected the helix y s at only one point and it contained one inter PI line. By construction x intersected the detector plane at the asymptote of the Tam Danielson window boundary and circumflex over x belonged to the asymptote. Connecting circumflex over x and circumflex over x and we detected two inter PI lines. Clearly x could not contain any of them. By Lemma 1 the third inter PI line had a negative slope thus it would not overlap the asymptote. Hence x could not contain it. Consequently s sand T curve was smooth in a neighborhood of s . If was chosen to be the polar angle for the great circle x y s s s s i 1 2 3 then the A curve could consist of all the unit vectors x y s . Clearly dot over could be perpendicular to and x y s . By construction the T curve was tangent to the A curve at s . Hence dot over s was be parallel to dot over . That is dot over s was perpendicular to and x y s . Because dot over s was also perpendicular to x y s s s s x y s was parallel to x y s and s s which contradicted the assumption that sis an inner point of the T curve. This finishes the proof.

Cases 1 and 2 were impossible because they mean that there can be a plane containing three inter PI lines or tangent to three inter PI arcs. In Case 4 there can be one plane containing one inter PI line and tangent to two inter PI arcs. If one assumes this inter PI line is chooses a point s son y s and denotes L DP s then by construction on the detector plane circumflex over x is on and it overlaps . Then L may tangent to and or and see . Because the points of tangency are on the inter PI arcs the endpoint is to the left of the tangency for case A and was to the right of the tangency for case B. Connecting and circumflex over x or and circumflex over x we find that the slope of the inter PI line could be negative. By Lemma 1 these two cases were impossible.

In Case 5 there was one plane containing one inter PI line and tangent to one inter PI arc at the inflection point. Thus the inter PI line on the detector overlapped the inflection line i.e. overlapped Lwhen s sand s 2s where sis difference between sand s. When looking at EQUATION 21 and sis fixed the absolute value of

In Case 6 a T curve will intersect one A curve twice before meeting a cusp. Suppose this took place at inter PI arc . A point s son y s was chosen and observations of what happens on the detector plane when s moves were taken. By construction the plane containing dot over y s and x intersected the detector plane at the line L which was parallel to the helix tangent across circumflex over x . At s s circumflex over x was on and contained inter PI line . As s moved along y s circumflex over x moved downwards. Notice that L was parallel to the asymptote of the Tam Dannielson window so it would not intersect provided that circumflex over x moved across the asymptote at where the cusp occurred. Hence would not contain the inter PI line and Case 6 was impossible. By Lemma 2 Case 7 was impossible. This finishes the proof.

If an L and A curve intersect an L line through circumflex over x can overlap the inter PI line. One point on the inter PI arc was chosen and the slope of the inter PI line was considered on the corresponding detector plane. By construction an L curve always started from a cusp of a T curve and ended on a cusp of another T curve. For the osculating plane its intersection with the detector plane was the line tangent to at . By Lemma 4 the endpoints of the inter PI arc on were on different sides of and one of them on the right left side was also an endpoint of the inter PI line for helices y s and y s and was denoted as in .

If circumflex over x was in Gand above the L line was formed by connecting circumflex over x and the inter PI line was formed connecting circumflex over x . If z was in Gand below we formed the L line by connecting circumflex over x and the inter PI line was formed by connecting circumflex over x . Clearly in any case the slope of L line was between zero and the slope of the inter PI line. That is the L line could not overlap the inter PI line. For other circumflex over x the L line was parallel to the u axis. By Lemma 1 it was always between two inter PI lines and could not overlap with any of them. For the point on other inter PI arcs the situation was the same. This finishes the proof.

The present invention has been described with reference to particular embodiments having various features. It will be apparent to those skilled in the art that various modifications and variations can be made in the practice of the present invention without departing from the scope or spirit of the invention. One skilled in the art will recognize that these features may be used singularly or in any combination based on the requirements and specifications of a given application or design. Other embodiments of the invention will be apparent to those skilled in the art from consideration of the specification and practice of the invention. It is intended that the specification and examples be considered as exemplary in nature and that variations that do not depart from the essence of the invention are intended to be within the scope of the invention.

Therefore the present invention is well adapted to attain the ends and advantages mentioned as well as those that are inherent therein. The particular embodiments disclosed above are illustrative only as the present invention may be modified and practiced in different but equivalent manners apparent to those skilled in the art having the benefit of the teachings herein. Furthermore no limitations are intended to the details of construction or design herein shown other than as described in the claims below. It is therefore evident that the particular illustrative embodiments disclosed above may be altered or modified and all such variations are considered within the scope and spirit of the present invention. While compositions and methods are described in terms of comprising containing or including various components or steps the compositions and methods can also consist essentially of or consist of the various components and steps. All numbers and ranges disclosed above may vary by some amount. Whenever a numerical range with a lower limit and an upper limit is disclosed any number and any included range falling within the range is specifically disclosed. In particular every range of values of the form from about a to about b or equivalently from approximately a to b or equivalently from approximately a b disclosed herein is to be understood to set forth every number and range encompassed within the broader range of values. Also the terms in the claims have their plain ordinary meaning unless otherwise explicitly and clearly defined by the patentee. Moreover the indefinite articles a or an as used in the claims are defined herein to mean one or more than one of the element that it introduces. If there is any conflict in the usages of a word or term in this specification and one or more patent or other documents that may be incorporated herein by reference the definitions that are consistent with this specification should be adopted.

Throughout this application various publications are referenced. The disclosures of these publications in their entireties are hereby incorporated by reference into this application in order to more fully describe the features of the invention and or the state of the art to which this pertains. The references disclosed are also individually and specifically incorporated by reference herein for the material contained in them that is discussed in the portion of this disclosure in which the reference is relied upon.

G. Wang C. R. Crawford and W. A. Kalender Guest editorial Multirow detector and cone beam spiral helical CT vol. 19 pp. 817 821 2000.

T. G. Flohr C. H. McCollough H. Bruder M. Petersilka K. Gruber C. S M. Grasruck K. Stierstorfer B. Krauss and R. Raupach First performance evaluation of a dual source CT DSCT system vol. 16 pp. 256 268 2006.

G. Wang S. Zhao H. Yu C. Miller P. Abbas B. Gantz S. Lee and J. Rubinstein Design analysis and simulation for development of the first clinical micro CT scanner1 vol. 12 pp. 511 525 2005.

G. Wang T. H. Lin P. C. Cheng and D. M. Shinozaki A general cone beam reconstruction algorithm vol. 12 p. 486 1993.

A. Katsevich Theoretically exact filtered backprojection type inversion algorithm for spiral CT vol. 62 p. 2012 2002.

S. S. Orlov Theory of three dimensional reconstruction. 1. Conditions of a complete set of projections vol. 20 pp. 312 314 1975.

I. Gel fand and M. Graev Crofton s function and inversion formulas in real integral geometry vol. 25 pp. 1 5 1991.

H. Rullgdot over a rd An explicit inversion formula for the exponential Radon transform using data from 180 Arkiv f r Matematik vol. 42 pp. 353 362 2004.

G. Wang Y. Ye and H. Yu Approximate and exact cone beam reconstruction with standard and non standard spiral scanning vol. 52 pp. 1 13 2007.

J. Zhao M. Jiang T. Zhuang and G. Wang An exact reconstruction algorithm for triple source helical cone beam CT vol. 14 p. 191 2006.

J. Zhao Y. Jin Y. Lu and G. Wang A Filtered Backprojection Algorithm for Triple Source Helical Cone Beam CT vol. 28 pp. 384 393 2009.

