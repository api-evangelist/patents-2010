---

title: Mapping wireless signals with motion sensors
abstract: A displacement device for mapping wireless signal fingerprints includes motion sensors and at least one of a received signal strength indicator (RSSI) sensor and a round trip time (RTT) sensor. The motion sensors may include a pedometer and one or more sensors to receive turn information. The start position of the displacement device is initialized and as the displacement device is moved through an environment, the position of each measurement location is determined using the initialized position and data from the motion sensors. The measurement position along with the RSSI and/or RTT measurement is stored in a database, from which a map can be generated. The position of the access point may be determined using the RSSI measurement or RTT measurement. Additionally, accumulated errors in the measurement position may be monitored and when greater than a threshold, a user may be prompted to reinitialize the position of the displacement device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08633817&OS=08633817&RS=08633817
owner: QUALCOMM Incorporated
number: 08633817
owner_city: San Diego
owner_country: US
publication_date: 20100805
---
This application claims the benefit of Provisional Application No. 61 253 767 filed Oct. 21 2009 which is assigned to the assignee hereof and hereby expressly incorporated by reference herein.

Accurate position information for mobile stations such as cellular or other wireless communication devices is becoming prevalent in the communications industry. The Global Positioning System GPS offers an approach to providing wireless mobile station position determination. A GPS user can derive precise navigation information including three dimensional position velocity and time through information gained from satellite vehicles SVs in orbit around the earth. The signals that are received from the SVs are typically rather weak. Therefore in order to determine the position of the receiver the receiver must be sufficiently sensitive to acquire these weak signals and interpret the information that is represented by them.

One limitation of current GPS receivers is that their operation is limited to situations in which multiple satellites are clearly in view without obstructions and where a good quality antenna is properly positioned to receive such signals. As such they normally are unusable in areas with blockage conditions such as where there is significant foliage or building blockage e.g. urban canyons and particularly within buildings.

One of the major holdups in implementation of current indoor location based services based on wireless signals is the prerequisites needed to enable such a system. At a minimum the indoor area has to be covered either by wireless access points deployed in the indoor area or the indoor area has to be covered by wireless access points deployed in the surrounding buildings that cover the indoor area. In addition prior knowledge of the locations mapped to the wireless signal fingerprints which enable the location based system are needed on the handset to enable a location fix. In addition many of the useful services such as routing and POI Point of Interest search that harness this system require a base map of the current location. This can be a significant problem as mapping and manually locating all access points and points of interest can be an extremely tedious time consuming and error prone task.

A displacement device for mapping wireless signal fingerprints includes motion sensors and at least one of a received signal strength indicator RSSI sensor and a round trip time RTT sensor. The motion sensors may include e.g. a 3 axis accelerometer driven pedometer and a sensor to receive user provided turn information such as 90 degree turn indications or at least one of a gyroscope accelerometer and magnetometer. Motion sensors may further include a satellite positioning system. The start position of the displacement device is initialized and as the displacement device is moved through an environment the position of each measurement location is determined using the initialized position and data from the motion sensors. The measurement position along with the RSSI and or RTT measurement is stored in a database from which a map can be generated. The position of the access point may be determined by the RSSI measurement or RTT measurement. Additionally accumulated errors in the measurement position may be monitored and when greater than a threshold a user may be prompted to reinitialize the position of the displacement device.

A system and method described herein automates the process of generating a wireless access fingerprint map and an annotation layer containing points of interest which may be anything that is wirelessly detected including wireless access points for an environment with blockage conditions such as an indoor environment. The system and method uses a displacement device that includes motion sensors to determine the magnitude and direction of changes in location from an initialized start location and a wireless signal measurement system to measure wireless signal parameters. The motion sensors may include e.g. 

including GPS and user input 90 degrees left turn 90 degrees right turn non 90 degrees turn to determine the magnitude and direction of changes in location from an initialized start location and a wireless signal measurement system to measure wireless signal parameters. The measured parameters of the wireless signals and the corresponding measurement locations are used to generate a wireless signal map or fingerprint map within a desired environment with respect to a coordinate system which may be a relative coordinate system or an absolute coordinate system. Accordingly a wireless signal fingerprint map is generated which will enable and enhance the location based system. Further by identifying access point locations using the recorded data there is no need to manually find these locations which may be a time intensive manual task.

The displacement device also includes means for sensing the displacement of the device e.g. one or more motion sensors . The motion sensors produce data with respect to the direction and the magnitude of movement of the displacement device from an initial position. Examples of motion sensors that may be used with the displacement device include 3 axis accelerometer to drive a pedometer a sensor e.g. keypad to receive user provided turn information e.g. 90 degrees left turn 90 degrees right turn non 90 degrees turn and a receiver for satellite positioning systems SPS such as the Global Positioning System GPS as well as Galileo Glonass or Compass as well as regional systems such as Quasi Zenith Satellite System QZSS over Japan Indian Regional Navigational Satellite System IRNSS over India Beidou over China etc. and or various augmentation systems e.g. an Satellite Based Augmentation System SBAS that may be associated with or otherwise enabled for use with one or more global and or regional navigation satellite systems. Additional or alternative motion sensors may include magnetometer solid state compasses gyroscopes and pressure sensors. If the displacement device is not a commercial available mobile platform motion sensors such as wheel sensors and odometers may be included as well. The motion sensors may be coupled to wheels on the displacement device to detect the distance traveled by the displacement device . The direction of travel may be determined using e.g. multiple wheel sensors or at least one of a gyroscope accelerometer and magnetometer or compass.

The transceiver and motion sensors communicate with a control unit that accepts and processes data from the wireless transceiver and motion sensors as well as controls the remainder of the operation of the displacement device . The vector displacement data from the motion sensors is provided to the control unit which includes a position database that is used to store and update the position of the displacement device . As the control unit determines new position of the displacement device using the motion sensors the position database is updated with the new positional information.

The control unit may be provided by a processor and associated memory a clock hardware software and firmware . It will be understood as used herein that the processor can but need not necessarily include one or more microprocessors embedded processors controllers application specific integrated circuits ASICs digital signal processors DSPs and the like. The term processor is intended to describe the functions implemented by the system rather than specific hardware. Moreover as used herein the term memory refers to any type of computer storage medium including long term short term or other memory associated with the mobile platform and is not to be limited to any particular type of memory or number of memories or type of media upon which memory is stored.

The control unit further includes a received signal strength indicator RSSI system and RTT sensor which may be separate from or part of the processor . The RSSI sensor determines the signal strength of any wireless signal received by the wireless transceiver . The RTT sensor determines the round trip time for a wireless signal by monitoring the time via clock to receive a signal from an access point in response to a signal sent by the transceiver .

The displacement device also includes a user interface that is in communication with the control unit e.g. the control unit accepts data from and provides data to the user interface . The user interface may include a display that displays e.g. a map of the environment as well as control menus and positional information. The user interface may also include a keypad or other input device through which the user can input information into the displacement device . In one embodiment the keypad may be integrated into the display such as a touch screen display. In another embodiment an application run on a commercially available mobile platform such as a smart phone may provide instructions via the user interface to guide the user to build the wireless signal fingerprint map and the user interface may serve as a motion sensor by receiving user provided turn information e.g. user designated 90 degrees left turn 90 degrees right turn and non 90 degrees turn.

Additionally the displacement device may include a motor to power wheels if used along with motor control and a location engine to control the motor . The motor motor control and location engine may be used to automatically move the displacement device around the environment during the mapping process. Sensors such as infrared light sensors or impact sensors may be used to detect obstacles in the path of the displacement device . The location engine may apply conventional coverage algorithms to ensure that the total desired environment is traversed and mapped. Alternatively the displacement device may be powered by a human in which case the motor motor control location engine and sensors are unnecessary. The displacement device may be a dedicated device or may be attached to another device such as a janitor s cart. The displacement device may include additional components such as batteries and a communication port for the displacement device to provide data to an external database. Alternatively the displacement device may be mobile platform such as a smart phone.

The methodologies described herein may be implemented by various means depending upon the application. For example these methodologies may be implemented in hardware software firmware or any combination thereof. For a hardware implementation the processing units may be implemented within one or more application specific integrated circuits ASICs digital signal processors DSPs digital signal processing devices DSPDs programmable logic devices PLDs field programmable gate arrays FPGAs processors controllers micro controllers microprocessors electronic devices other electronic units designed to perform the functions described herein or a combination thereof.

For a firmware and or software implementation the methodologies may be implemented with modules e.g. procedures functions and so on that perform the functions described herein. Any machine readable medium tangibly embodying instructions may be used in implementing the methodologies described herein. Memory may be implemented within the processor unit or external to the processor unit. As used herein the term memory refers to any type of long term short term volatile nonvolatile or other memory and is not to be limited to any particular type of memory or number of memories or type of media upon which memory is stored.

For example software codes may be stored in memory and executed by the processor and may be used to run the processor and to control the operation of the displacement device as described herein. For example a program code stored in a computer readable medium such as memory may include program code to determine at least one of received signal strength and round trip time for wireless signals from data provided by a RSSI sensor and a RTT sensor to determine a measurement position based on an initialized position and data from motion sensors when the at least one of received signal strength and round trip time is measured and to store the determined at least one of a received signal strength and round trip time in a database with the corresponding measurement position. The program code stored in a computer readable medium may further include program code to determine the position of the access point using the received signal strength or round trip time for the access point. The program code stored in a computer readable medium may further include program code estimate accumulated errors in the measurement position and to prompt the reinitializing of the position after the accumulated errors have exceeded a predetermined threshold. Alternatively software codes may be stored in an application store and may be downloaded on a mobile platform such as a cellular telephone or smart phone. The operating systems of the mobile platform provide standard application programming interfaces APIs to several relevant functional units such as wireless LAN and motion sensors such as accelerometer and SPS thereby reducing the size of the application itself.

If implemented in firmware and or software the functions may be stored as one or more instructions or code on a computer readable medium. Examples include computer readable media encoded with a data structure and computer readable media encoded with a computer program. Computer readable media includes physical computer storage media. A storage medium may be any available medium that can be accessed by a computer. By way of example and not limitation such computer readable media can comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that can be used to store desired program code in the form of instructions or data structures and that can be accessed by a computer disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

The displacement device is then moved to a plurality of measurement locations . Movement of the displacement device may be performed manually e.g. by a user holding a mobile platform while walking. Distance is estimated using the pedometer. Turns may be indicated by the user in form of 90 degree left 90 degree right or non 90 degree turn. Since most buildings have a rectangular layout many 90 degree turns are expected. Humans are good at recognizing 90 degree turns and thus orientation may be based on 90 degree turns rather than a compass reading which suffers from inaccuracies to due to magnetic anomalies.

However if desired alternative sensors may be used to determine whether and how much the device has turned. For example one or more of gyroscopes accelerometers and magnetometers may be used to detect turns of the displacement device . With the combination of multiple sensors such as gyroscopes accelerometers and magnetometers magnetic anomalies found in buildings may be adequately addressed. Limitations in the accuracy of the sensors may be addressed e.g. by assuming 90 degree turns are made when the sensors indicate a turn of 85 degrees to 95 degrees. The use of gyroscopes accelerometers and magnetometers may be particularly useful when the displacement device has a constant alignment angle i.e. the angle between the direction of motion and the direction that the displacement device is pointing remains constant such as when the displacement device is attached to the user s belt or held in a pocket. With a non constant alignment angle e.g. the displacement device is held in the hand drift may be reduced by attaching the displacement device to e.g. a shoe so that moments of no motion may be exploited to reset the filters.

Furthermore the user may close the loop several times. Loop closures can be recognized by repeating wireless signal fingerprint patterns and can be used to address inaccuracies in distance estimation. Additionally the user may provide a vertical vector displacement e.g. in the form of a building floor number. In an alternative embodiment movement of the displacement device may be performed by pushing the displacement device through the environment or automatically using e.g. the motor motor control sensors and location engine illustrated in . As the displacement device is moved the motion sensors provide data to the control unit indicating the distance and angle of movement of the displacement device . At each location that a parameter of the wireless signal is measured e.g. received signal strength and or RTT the position of the displacement device as determined from data produced by the motion sensors and is recorded and stored in memory .

At each measurement location a wireless signal parameter such as received signal strength and or RTT is determined and stored along with the corresponding measurement location in memory . The measurement location and parameters of the wireless signals are sometimes referred to as a wireless fingerprint. For example the signal strength of the wireless signals may be determined by the RSSI sensor . Alternatively or additionally the round trip time of the wireless signals may be determined using the RTT sensor which may control the wireless transceiver to produce a wireless signal to a local access point which responds with a return signal. The RTT sensor uses the clock to determine the RTT of the wireless signal. As a result each measurement location has a corresponding data set representing the received signal strength and or RTT of the wireless signals at that location. The received signal strength and or RTT of a plurality access points may be measured to provide a detailed wireless fingerprint for the environment.

Knowledge of the locations of access points within the environment may be useful in acquiring a position fix when SPS is unavailable. Accordingly in one embodiment the position of an access point may be determined using the RSSI measurements and or the RTT measurements and their corresponding positions. For example for each access point that is accessed a maximum value of the RSSI measurement and or minimum value for the RTT measurement may be maintained along with the corresponding measurement location. This measurement location can then be assigned as the actual location of the access point once the entire environment has been traversed. Alternatively the position of the access point may be determined by translating a plurality of the RSSI measurements and or RTT measurements into a distance estimate e.g. using ranging models that estimate RSSI and or RTT vs. distance and using the positions that correspond to the RSSI and or RTT measurements along with the distance estimates to determine the position of the access point using trilateration. Thus the wireless fingerprint including the locations of the access points is mapped and stored in a database.

In one embodiment accumulated errors of the motion sensors are tracked. illustrates the accumulation of errors of the displacement device while moving to record the wireless fingerprint. The initial location of the displacement device is illustrated along with several measurement locations . As the displacement device moves the error associated with the position of the displacement device accumulates. If the accumulated error exceeds an acceptable threshold as indicated at position the displacement device may provide an indication to a user that the accumulated errors have exceeded a threshold prompting the user to manually input the current position to reinitialize the system. The current position may be input by a user by indicating the position on a digital map on the display or by entering coordinates e.g. on the keypad .

Although the present invention is illustrated in connection with specific embodiments for instructional purposes the present invention is not limited thereto. Various adaptations and modifications may be made without departing from the scope of the invention. Therefore the spirit and scope of the appended claims should not be limited to the foregoing description.

