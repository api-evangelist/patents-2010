---

title: System and method for checking digital certificate status
abstract: A method for handling digital certificate status requests between a client system and a proxy system is provided. The method includes the steps of receiving at the proxy system digital certificate status request data transmitted from the client system and generating query data for the digital certificate status in response to receiving the digital certificate status request data. The query data is transmitted to a status provider system, and status data from the status provider system in response to the query data is received at the proxy system. Digital certificate status data based on the status data received is generated and transmitting to the client system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08103876&OS=08103876&RS=08103876
owner: Research In Motion Limited
number: 08103876
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20100428
---
This application is a continuation of the U.S. patent application Ser. No. 10 508 114 entitled System and Method for Checking Digital Certificate Status filed on Mar. 20 2003. The present application and the 114 application claim priority to and the benefit of the U.S. Provisional Application Ser. No. 60 365 518 filed Mar. 20 2002 entitled System and Method for Checking Digital Certificate Revocation Status. All of these are hereby incorporated into the present application by reference.

This invention relates generally to the field of secure electronic messaging and in particular to checking the status of digital certificates.

Known secure messaging clients including for example e mail software applications operating on desktop computer systems maintain a data store or at least a dedicated data storage area for secure messaging information such as digital certificates. A digital certificate normally includes the public key of an entity as well as identity information that is bound to the public key with one or more digital signatures. In Secure Multipurpose Internet Mail Extensions S MIME messaging for example a public key is used to verify a digital signature on a received secure message and to encrypt a session key that was used to encrypt a message to be sent. In other secure messaging schemes public keys may be used to encrypt data or messages. If a public key is not available at the messaging client when required for encryption or digital signature verification then the digital certificate is loaded onto the messaging client before these operations can be performed.

Normally a digital certificate is checked against a Certificate Revocation List CRL to determine if the digital certificate has been revoked by its issuer. This check is typically performed when a digital certificate is first received and periodically thereafter for example when a new CRL is received. However CRLs tend to be relatively bulky so that transfer of CRLs to messaging clients consume considerable communication resources and storage of CRLs at a messaging client may consume significant memory space. CRL based revocation status checks are also processor intensive and time consuming. These effects can be particularly pronounced in messaging clients operating on wireless mobile devices which operate within bandwidth limited wireless communication networks and may have limited processing and memory resources. In addition revocation status is updated in CRL based systems only when a new CRL is distributed.

One alternative scheme for digital certificate revocation status checking involves querying remote systems that maintain digital certificate revocation status information. This type of scheme requires transfer of less information reduces the complexity of operations that must be performed at a messaging client to check the revocation status of a digital certificate and may also provide more timely digital certificate revocation status information relative to CRL based schemes. The Online Certification Status Protocol OCSP is an illustrative example of such a scheme. However wireless communication system bandwidth limitations and latency render these known schemes inappropriate for secure messaging clients operating on wireless mobile devices.

A method of checking digital certificate status is provided. The method may include the steps of preparing an initial service request at a proxy system client sending the initial service request to a proxy system preparing a service request at the proxy system sending the service request from the proxy system to a digital certificate status information provider receiving a response to the service request from the status information provider at the proxy system and returning a response to the initial service request to the messaging client.

A digital certificate status checking system is also provided. The system may include a proxy system and a client system. The client system may be configured to prepare an initial service request and to process a response to the initial service request. The proxy system may be configured to prepare and send a service request to a status information provider responsive to the initial service request and to return a response to the service request from the status information provider to the client system as the response to the initial service request.

A secure message is a message that has been processed by a message sender or possibly an intermediate system between a message sender and a message receiver to ensure one or more of data confidentiality data integrity and user authentication. Common techniques for secure messaging include signing a message with a digital signature and or encrypting a message. For example a secure message may be a message that has been signed encrypted encrypted and then signed or signed and then encrypted messages prepared by a message sender according to variants of Secure Multipurpose Internet Mail Extensions S MIME .

A messaging client allows a system on which it operates to receive and possibly also send messages. Messaging clients may operate on a computer system a handheld device or any other system or device with communications capabilities. Many messaging clients also have additional non messaging functions.

An exemplary mobile device may be of the type disclosed in U.S. Pat. No. 6 278 442 entitled HAND HELD ELECTRONIC DEVICE WITH A KEYBOARD OPTIMIZED FOR USE WITH THE THUMBS the entire disclosure of which is incorporated herein by reference. The computer system may be a desktop or laptop PC which is configured to communicate to the WAN . WAN may be a large network such as the Internet for example. PCs such as computer system normally access the Internet through an Internet Service Provider ISP Application Service Provider ASP or the like.

The corporate LAN is illustratively a network based messaging client and can be located behind a security firewall . Within the corporate LAN a message server operating on a computer behind the firewall functions as the primary interface for the corporation to exchange messages both within the LAN and with other external messaging clients via the WAN . Two exemplary message servers are Microsoft Exchange Server and Lotus Domino . These servers are often used in conjunction with Internet mail routers that typically use UNIX based Sendmail protocols to route and deliver mail. The message server may also provide additional functionality such as dynamic database storage for data related to calendars to do lists task lists e mail and documentation.

The message server provides messaging capabilities to networked computer systems coupled to the LAN . A typical LAN includes multiple computer systems each of which implements a messaging client such as Microsoft Outlook Lotus Notes etc. Within the LAN messages are received by the message server distributed to the appropriate mailboxes for user accounts addressed in the received message and are then accessed by a user through a messaging client operating on a computer system .

The wireless gateway provides an interface to a wireless network through which messages may be exchanged with a mobile device . The mobile device may for example comprise a data communication device a voice communication device a dual mode communication device such as most modern cellular telephones having both data and voice communications functionality a personal digital assistant PDA enabled for wireless communications or a laptop or desktop computer system with a wireless modem. An exemplary mobile device is previously described and as described further with reference to .

Such functions as addressing of the mobile device encoding or otherwise transforming messages for wireless transmission and any other required interface functions may be performed by the wireless gateway . The wireless gateway may be configured to operate with more than one wireless network in which case the wireless gateway may also determine a most likely network for locating a given mobile device user and possibly track mobile devices as users roam between countries or networks.

Any computer system with access to the WAN may exchange messages with the mobile device through the wireless network gateway . Alternatively private wireless network gateways such as wireless Virtual Private Network VPN routers could also be implemented to provide a private interface to a wireless network. For example a wireless VPN implemented in the LAN may provide a private interface from the LAN to one or more wireless mobile devices through the wireless network . Such a private interface to wireless mobile devices via the wireless network gateway and or the wireless network may also effectively be extended to entities outside the LAN by providing a message forwarding or redirection system that operates with the message server . In this type of system incoming messages received by the message server and addressed to a mailbox or data store associated with a user of a mobile device are sent through the wireless network interface either a wireless VPN router wireless gateway or other interface for example to the wireless network and to the user s mobile device . Another exemplary redirector system operating on the message server may be of the type disclosed in U.S. Pat. No. 6 219 694 entitled SYSTEM AND METHOD FOR PUSHING INFORMATION FROM A HOST SYSTEM TO A MOBILE DATA COMMUNICATION DEVICE HAVING A SHARED ELECTRONIC ADDRESS the entire disclosure of which is incorporated herein by reference.

Another alternate interface to a user s mailbox on a message server may be a Wireless Application Protocol WAP gateway. Through a WAP gateway a list of messages in a user s mailbox on the message server and possibly each message or a portion of each message may be sent to the mobile device .

A wireless network normally delivers messages to and from mobile devices via RF transmissions between base stations in the wireless network and mobile devices . The wireless network may for example be 1 a data centric wireless network 2 a voice centric wireless network or 3 a dual mode network that can support both voice and data communications over the same infrastructure. Illustrative wireless networks include 1 the Code Division Multiple Access CDMA network 2 the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS both developed by the standards committee of CEPT and 3 third generation 3G networks such as the Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS .

GPRS is a data centric that is a data overlay on top of the existing GSM wireless network. Some older examples of data centric network include but are not limited to 1 the Mobitex Radio Network Mobitex and 2 the DataTAC Radio Network DataTAC . Examples of voice centric data networks include Personal Communication Systems PCS networks like CDMA GSM and Time Division Multiple Access TDMA systems that have been available in North America and world wide for several years.

Perhaps the most common type of messaging currently in use is e mail. In a standard e mail system an e mail message is sent by an e mail sender possibly through a message server and or a service provider system and typically routed through the Internet to one or more message receivers. E mail messages are normally sent in the clear and use traditional Simple Mail Transfer Protocol SMTP RFC822 headers and MIME body parts to define the format of the e mail message.

In recent years secure messaging techniques have evolved to protect both the content and integrity of messages such as e mail messages. S MIME and Pretty Good Privacy PGP are two public key secure e mail messaging protocols that provide for both encryption and signing which protects the integrity of a message and provides for sender authentication by a message receiver. Secure messages may also be encoded compressed or otherwise processed in addition to being encrypted and or signed.

The e mail sender may be a PC such as the system in or may be a network connected computer such as the computer system or . The e mail sender may also be another mobile device on which e mail messages may be composed and sent. The WAN wireless gateway wireless network and mobile device are substantially the same as similarly labelled components in .

According to secure messaging schemes such as S MIME and PGP a message is encrypted using a one time session key chosen by the e mail sender . The session key is used to encrypt the message body and is then itself encrypted using the public key of each addressed message receiver to which the message is to be sent. As shown at a message encrypted in this way includes an encrypted message body and an encrypted session key . In this type of message encryption scheme a message sender such as e mail sender must have access to the public key of each entity to which an encrypted message is to be sent.

A secure e mail message sender typically signs a message by taking a digest of the message and signing the digest using the sender s private key. A digest may for example be generated by performing a check sum Cyclic Redundancy Check CRC or some other preferably non reversible operation such as a hash on the message. This digest is then signed by the sender using the sender s private key. The private key may be used to perform an encryption or other transformation operation on the digest to generate the digest signature. A digital signature including the digest and the digest signature is then appended to the outgoing message. In addition a digital certificate of the sender which includes the sender s public key and sender identity information that is bound to the public key with one or more digital signatures and possibly any chained digital certificates and CRLs associated with the sender s digital certificate and any chained digital certificates may also be attached to a secure message.

The secure e mail message sent by the e mail sender may include the digital signature as well as the encrypted message body and the encrypted session key both of which are signed. The sender s digital certificate any chained digital certificates and one or more CRLs may also be included in the message . In the S MIME secure messaging technique digital certificates CRLs and digital signatures are normally placed at the beginning of a message and the message body is included in a file attachment. Messages generated by other secure messaging schemes may place message components in a different order than shown or include additional and or different components. For example a secure message may include addressing information such as To and From e mail addresses and other header information.

When the secure e mail message is sent from the e mail sender it is routed through the WAN to the wireless network and the mobile device . The transmission path between the e mail sender and the mobile device may also include additional or different components than those shown in . For example the secure e mail message may be addressed to a mailbox or data store associated with a message server or data server which has been wirelessly enabled to forward or send received messages and data to the mobile device . Further intermediate systems may also store and or route the secure message to the mobile device . The exemplary redirector system as previously described and as disclosed in U.S. Pat. No. 6 219 694 is an example of one such system.

In addition the message may be routed or forwarded to the mobile device through other transport mechanisms than the wireless gateway . For example routing to the wireless network may be accomplished using a wireless VPN router associated with the e mail sender or in the case of a message being received at an intermediate computer system or server and then forwarded to the mobile device with the computer system or server.

Regardless of whether a signed message is sent directly to the mobile device or redirected to the mobile device when a signed message is received the mobile device may verify the digital signature by generating a digest of the message body and encrypted session key extracting the digest from the digital signature comparing the generated digest with the digest extracted from the digital signature and verifying the digest signature in the digital signature . The digest algorithm used by a secure message receiver is the same as the algorithm used by the message sender and may be specified for example in a message header or possibly in the digital signature . One commonly used digest algorithm is the so called Secure Hashing Algorithm 1 SHA1 although other digest algorithms such as Message Digest Algorithm 5 MD5 may also be used.

In order to verify the digest signature a message receiver must retrieve the sender s public key and verify the signature on the digest in the digital signature by performing a reverse transformation on the digest signature. For example if the message sender generated the digest signature by encrypting the digest using the sender s private key then a receiver would use the sender s public key to decrypt the digest signature to recover the original digest. If a secure message includes the sender s digital certificate or the sender s digital certificate has already been stored in a data store at the mobile device then the sender s public key may be extracted from the received or stored digital certificate. The sender s public key may instead be retrieved from a local store if the public key was extracted from an earlier message from the sender and stored in a key store in the receiver s local store. Alternatively the sender s digital certificate may be requested from a Public Key Server PKS . A PKS is a server that is normally associated with a Certifying Authority CA from which a digital certificate for an entity including the entity s public key is available. A PKS might reside within a corporate LAN such as or anywhere on the WAN Internet or other network or system through which message receivers may establish communications with the PKS. A sender s digital certificate may also possibly be loaded onto a mobile device from a PC or other computer system.

A digest algorithm is preferably a non reversible function that produces a unique output for every unique input. Therefore if an original message is changed or corrupted then the digest generated by the receiver will be different from the digest extracted from the digital signature and signature verification therefore fails. Because digest algorithms are publicly known however it is possible that an entity may alter a secure message generate a new digest of the altered message and forward the altered message to any addressed message receivers. In this case the digest generated at the receiver on the basis of the altered message will match the new digest that was added by the entity that altered the message. The digest signature check is intended to prevent verification of a digital signature in such a situation. Even though the generated and new digests will match since a sender signs the original digest using its own private key the entity that altered the message cannot generate a new digest signature that can be verified with the sender s public key. Therefore although the digests in the altered message match the digital signature will not be verified since the digest signature verification will fail.

These mathematical operations do not prevent anyone from seeing the contents of the secure message but do ensure the message has not been tampered with since it was signed by the sender and that the message was signed by the person as indicated on the From field of the message.

When the digital signature has been verified or sometimes even if digital signature verification fails the encrypted message body must then be decrypted before it can be displayed or further processed by a receiving messaging client operating on the mobile device in . A receiving messaging client uses its private key to decrypt the encrypted session key and then uses the decrypted session key to decrypt the encrypted message body and thereby recover the original message.

An encrypted message that is addressed to more than one receiver would include an encrypted version of the session key for each receiver that was encrypted using the public key of the receiver. Each receiver would perform the same digital signature verification operations but would decrypt a different one of the encrypted session keys using its own private key.

Therefore in a secure messaging system a sending messaging client must have access to the public key of any receiver to which an encrypted message is to be sent. A receiving messaging client must be able to retrieve the sender s public key which may be available to a messaging client through various mechanisms in order to verify a digital signature in a signed message. Although the mobile device is a receiver of the secure message the mobile device may be enabled for two way communications and may therefore require public keys for both message sending and message receiving operations.

Public keys are commonly provided in digital certificates. As described above a digital certificate for any particular entity typically includes the entity s public key and identification information that is bound to the public key with a digital signature. Several types of digital certificates are currently in widespread use including for example X.509 digital certificates which are typically used in S MIME. PGP uses digital certificates with a slightly different format. The system and method as disclosed herein may be used with any of these types of digital certificates as well as other types of digital certificates both currently known types as well as others that may be developed in the future.

The digital signature in a digital certificate is generated by the issuer of the digital certificate and can be checked by a message receiver substantially as described above. A digital certificate sometimes includes an expiry time or validity period from which a messaging client may determine if the digital certificate has expired. Verification of the validity of a digital certificate may also involve tracing a certification path through a digital certificate chain which includes a user s digital certificate as well as possibly other digital certificates to verify that the user s digital certificate is authentic.

A digital certificate may also be checked to ensure that it has not been revoked. As described above digital certificate revocation status may be checked by consulting a CRL or by requesting digital certificate status information from a digital certificate revocation status information source. In the system of a user of the mobile device may submit a revocation status request for any digital certificate stored at the mobile device to the revocation status information provider . The provider then returns revocation status information for that digital certificate to the mobile device .

OCSP is one scheme that provides for determination of digital certificate revocation status without requiring CRLs. Versions of OCSP have been defined for example in RFC 2560 and in the Internet Draft Online Digital Certificate Status Protocol version 2 both available from the Internet Engineering Task Force IETF . OCSP is one of the most widely used digital certificate revocation status check protocols and is therefore used herein as an illustrative example of such schemes. The systems and methods described herein however may also be applicable to other types of digital certificate revocation status checking schemes involving retrieval of revocation status information from remote sources.

According to OCSP a request is submitted to a status information provider generally referred to as an OCSP responder. Upon receipt of a properly formatted request an OCSP responder returns a response to the requestor. An OCSP request includes at least an OCSP protocol version number a service request and an identification of a target digital certificate to which the request is related.

The version number identifies the version of OCSP with which the request complies. The service request specifies the type of service being requested. For OCSP version 2 Online Revocation Status ORS Delegated Path Validation DPV and Delegated Path Discovery DPD services have been defined. Through the ORS service a messaging client may obtain revocation status information for digital certificates. The DPV and DPD services effectively delegate digital certificate validation path related processing to a remote system.

Normally a target digital certificate is identified in an OCSP request using a hash of the distinguished name DN of the issuer of the digital certificate as well as the serial number of the digital certificate. However since multiple digital certificate issuers may use the same DN further identification information in the form of a hash of the issuer s public key is also included in the request. Therefore target digital certificate information in an OCSP request includes a hash algorithm identifier a hash of the DN of the digital certificate issuer generated using the hash algorithm a hash of the issuer s public key also generated using the hash algorithm and the serial number of the target digital certificate.

The request may or may not be signed by a requestor. Further optional information may also be included in a request and processed by an OCSP responder.

When a messaging client is operating on a mobile device OCSP may be desirable in that it reduces the processing and memory resources necessary to check revocation status of a digital certificate relative to CRL based revocation status checking. However OCSP requests can be relatively long and thereby consume limited wireless communication resources. The proxy system in conjunction with an appropriately enabled mobile device may be used to optimize OCSP and similar protocols involving remote systems for mobile devices as described in further detail below.

The memory is illustratively a writeable store such as a RAM into which other device components may write data. The digital certificate store is a storage area dedicated to storage of digital certificates on the mobile device . Digital certificates may be stored in the digital certificate store in the format in which they are received or may alternatively be parsed or otherwise translated into a storage format before being written to the store .

The messaging system is connected to the wireless transceiver and is thus enabled for communications via a wireless network. The messaging system will in most implementations be a messaging client embodied in a software application.

The proxy system client which will also normally be implemented as a software application or component may be coupled to the messaging system the digital certificate store and the UI . Revocation status for any of the digital certificates stored in the digital certificate store as well as possibly any digital certificates received by the messaging system but not yet stored in the digital certificate store may be checked using the proxy system client as described in detail below.

The UI may include such UI components as a keyboard or keypad a display or other components which may accept inputs from or provide outputs to a user of the mobile device . Although shown as a single block in a mobile device typically includes more than one UI and the UI therefore represents one or more user interfaces.

The wireless network wireless gateway WAN and revocation status information provider are the same as similarly labelled components in .

The proxy system includes a proxy system service component and a status provider client . The proxy system illustratively comprises one or more computers connected to the WAN and operable to receive an encryption item status request from mobile device or some other client system and perform the status request and attendant processing steps on behalf of the mobile device . In one embodiment the proxy system is an intermediate computer that performs the status request on behalf of the mobile device . The intermediate computer may be further operable to provide the address of the mobile device with the status request. In another embodiment the proxy system may comprise a proxy server that is also operable to perform proxy server functions such as providing security administrative control and caching in addition to performing the status request on behalf of the mobile device .

The proxy system service component is configured to exchange information with the proxy system client and the status provider client is adapted to exchange information with the revocation status provider . Each of these components the status provider client and the proxy system server are preferably software applications or modules operating at the proxy system . The software applications may be a single program or may alternatively be separate programs executed independently.

In operation the messaging system on the mobile device may receive and possibly send secure messages via the wireless network as described above. When a signature on a received secure message is to be verified or a message is to be sent with an encrypted session key the messaging system may retrieve a public key for an entity i.e. a sender of a received message or a recipient of a message to be sent from a digital certificate. Before the public key is used however the messaging system or a user thereof may wish to check that the digital certificate containing the public key is valid and has not been revoked.

Digital certificate verification operations may be performed automatically when a digital certificate is received with a secure message for example. Alternatively the digital certificate verification operations may be performed periodically at predetermined or user configurable intervals or when invoked by a user through a UI .

Different types of digital certificate checking operations may also be dependent upon different controls. For example the validity and revocation status of a digital certificate may be checked automatically when the digital certificate is first loaded onto the mobile device and if valid and not revoked the digital certificate may then be assumed to be valid until an expiry time or during a validity period specified in the digital certificate whereas its revocation status may thereafter be checked once every week.

As described above digital certificate status information requests to a remote information provider such as may be relatively long and are therefore not optimal for implementation in a mobile device or other bandwidth limited communication systems. The proxy system client and service are preferably adapted to minimize the amount of information that must be sent from the mobile device to request status information for a digital certificate.

When a user of the mobile device wishes to check the revocation status of a digital certificate the proxy system client or possibly a software application which operates in conjunction with the proxy system client may be invoked by entering an appropriate command on a UI such as a keyboard for example. The user may also specify the particular digital certificate to be checked for instance using the serial number or subject name of the digital certificate. Alternatively the proxy system client may access the digital certificate store to display to the user a list of currently stored digital certificates from which the user may select one or more digital certificates to be checked.

The proxy system client then preferably either extracts from the selected digital certificate s or obtains from the user through a UI any information required by the proxy system service for a digital certificate revocation status check. Since the proxy system provides an interface between the mobile device and the status information provider requests and responses between the proxy system client and proxy system service need not conform to the protocol used between the status provider client and the status information provider . Therefore although the status provider and status provider client may support OCSP or a similar protocol the proxy system service and client proxy system preferably support a more wireless friendly protocol involving less data exchange such as smaller requests.

The particular information extracted or obtained by the proxy system client will be dependent upon the communication protocol implemented between the proxy system client and service . The proxy system client can preferably extract a digital certificate subject name serial number issuer name and other digital certificate information from a digital certificate stored in the digital certificate store .

If digital certificates are first parsed so that parsed data is stored in the digital certificate store then such information may be extracted from the parsed data in the digital certificate store by the proxy system client . If further information is required a user may be prompted to enter the information. For example if the proxy system is configured to store a mapping table or like element which maintains a correspondence between digital certificate issuers and serial numbers and or subject names then the status provider client may format a status request for the revocation status information provider based on only a serial number or subject name received by the proxy system service from the proxy system client .

When all required information has been extracted or otherwise obtained by the proxy system client a request is formatted and sent to the proxy system service . The content of this request is also dependent upon the communication protocol used between the proxy system service and client . If more than one type of service is supported then the request may specify which type of service is requested. In some implementations only a single service may be supported such that no service type need be specified.

Information received by the proxy system service is preferably passed to the status provider client . This information is then used by the status provider client to format a request for the status information provider . If the revocation status information provider and status provider client support OCSP for example information provided by the proxy system service as well as any further required information are formatted into an OCSP request. In some cases the information provided by the proxy system service may include all required information whereas in other cases further information may be extracted from other sources such as the above example mapping table and included in the request to the status information provider .

In it is assumed that the status provider supports an ORS or like service. Upon receiving a request the revocation status information provider which will be an OCSP responder when the provider and client support OCSP checks the request to ensure that it is formatted properly that the requested service is a service that it is configured to provide and that the request includes all of the information required for the requested service. If these conditions are not met then the provider may return an error message to the client . The client may then perform error processing to provide any missing required information or possibly to request missing information from the mobile device through the proxy system service or return an error message to the proxy system service which then formats and sends an error message to the proxy system client as a response to its initial service request. Other conditions such as when a provider receives an unsigned request but is configured to expect signed requests or when a provider service is unable to respond may also result in an error message being returned to the provider client .

If the request meets the above conditions then a definitive response is returned to the provider client . A definitive response may include one of a plurality of status indications such as a valid or like indication when a target digital certificate has not been revoked a revoked indication when the target digital certificate has been revoked or an unknown indication if the status provider has no record or knowledge of the target digital certificate.

Furthermore the proxy system client may also be operable to classify the digital certificate as pending when awaiting the status of the digital certificate after sending a request. The status of the digital certificate is then changed from pending to one of valid revoked or unknown after the proxy system client receives the corresponding status indication from the proxy system . The proxy system client may also be configured to prompt a user via an I O device on the mobile device to confirm an action to be executed on a data item if the data item includes a digital signature with a status of pending revoked or unknown. 

A response returned to the status provider client by the status information provider may be passed to the proxy system service which prepares and sends a response to the proxy system client . When the response from the provider is signed and the proxy system client or another component on the mobile device is configured to verify status response signatures then the entire response from the status provider or possibly the signed portions thereof may be forwarded to the proxy system client substantially unchanged. However if the proxy system service or the status provider client checks status response signatures on behalf of the mobile device then only certain parts of the response for example the status indication and the digital certificate serial number or subject name may be extracted by the proxy system service and formatted into a response that is then sent to the proxy system client . The response from the proxy system service is then processed by the proxy system client to determine whether or not the digital certificate has been revoked.

The presence of a proxy system client preferably does not preclude digital certificate validity and revocation status checks according to known techniques. Thus digital certificate status checks involving remote systems such as the status information provider may be complementary to other status check operations.

While the embodiment of depicts the wireless gateway the proxy system and the revocation status provider as separate systems communication over the WAN these systems may be combined. For example in an alternative embodiment a software application comprising the proxy system service and status provider client is stored and executed on the wireless gateway .

In yet another embodiment the software application comprising the proxy system service and status provider client is stored and executed on the revocation status provider . In still yet another embodiment the software application comprising the proxy system service and status provider client is stored and executed on the message server . Of course other configurations and communication paths for computer systems distributed throughout one or more networks that enable the functionality of the client proxy digital certificate status system as disclosed herein may also be used.

In yet another embodiment the wireless gateway may also be operable to determine if a data item such as an S MIME message to be transmitted to the mobile device is signed with a digital signature or includes a digital certificate. If so the wireless gateway may pre emptively query the revocation status provider to obtain the digital certificate status for the signer of the S MIME message as well as any other cryptographic information required to verify the S MIME message.

The digital certificate status and cryptographic information may be obtained before the S MIME message is transmitted to the mobile device in which case the S MIME message is stored at the wireless gateway . The wireless gateway may be further operable to discard the S MIME message if the digital certificate is not valid or expired or alternatively may transmit the S MIME message to the mobile device with a notification that the digital certificate status is not valid or is expired.

If the request does not satisfy these conditions then an error message is returned to the proxy system at step . Error processing may then be executed at step to obtain further information when the request does not include all required information for example after which a new service request may be prepared and sent to the provider at step . Alternatively an error message may be returned to the mobile device at step .

When the request satisfies the conditions in step the status information provider returns a status indication to the proxy system at step in response to the service request from the proxy system. Then at step the proxy system returns the entire response from the status information provider or at least parts thereof to the mobile device as a response to the initial service request from the mobile device.

Although the system and method described above relate to the illustrative example of digital certificate revocation status checking digital certificate validity checks according to the DPV and DPD services of OCSP or other protocols for example may similarly be optimized for mobile devices and other types of processing memory or communication resource constrained systems through a proxy system client and service. A proxy system may also be enabled to provide its proxy service to multiple mobile devices.

At step the wireless gateway receives a data item such as an S MIME message for example to be redirected to the mobile device . In step the wireless gateway determines if the data item includes encryption data such as a digital certificate. If the data item does not include encryption data then the data item is redirected to the mobile device as shown in step .

However if the data item does include encryption data such as a digital certificate then the wireless gateway stores the data item and prepares a service request that is sent to a status provider as shown in step .

The status information is received in step and in step the wireless gateway determines if the digital certificate status is valid revoked or unknown. If the digital certificate is valid then the wireless gateway attaches a valid indicator to the data item and the data item is then redirected to the mobile device as shown in consecutively executed steps and . If the digital certificate is revoked then the wireless gateway attaches a revoked indicator to the data item and the data item is then redirected to the mobile device as shown in consecutively executed steps and . If the digital certificate is unknown then the wireless gateway attaches an unknown indicator to the data item and the data item is then redirected to the mobile device as shown in consecutively executed steps and .

Thus upon receipt of the data item that includes a digital certificate or some other encryption data the mobile device may determine the status of the digital certificate immediately by interrogating the valid revoked or unknown indicator that is attached to the data item.

In another embodiment the message server also comprises a redirector system as described above. The redirector system is executing a proxy program as previously described and that is further operable to determine if a data item such as an S MIME message to be transmitted to the mobile device includes a digital certificate. If so the redirector system may pre emptively query the revocation status provider to obtain the digital certificate status for the signer of the S MIME message as well as any other cryptographic information required to verify the S MIME message. The redirector system performs similar processing steps as described with respect to the wireless gateway and .

In another embodiment a mobile device and proxy system may include multiple client and service modules. is a block diagram of a system implementing a digital certificate revocation status check system having multiple proxy system clients. In the memory data stores messaging system UI wireless transceiver wireless network wireless gateway and WAN are substantially the same as similarly labelled components in .

The mobile device includes client modules including proxy system client A and proxy system client N as well as possibly other proxy system clients. The proxy system includes corresponding proxy system services A and N and . The proxy system also includes status provider clients A and N and which are configured for communications with the status information provider A and status information provider N respectively.

The system shown in operates substantially as described above. When the status of one or more digital certificates such as revocation status for example is to be checked each proxy system client and preferably extracts or otherwise obtains information required in a service request to its respective proxy system service and . The status provider clients and then use the information from the service request from the mobile device and possibly information available at the proxy system to prepare a service request to status information providers and . Responses returned by the status information providers and or at least portions thereof are then reformatted if necessary and returned to the proxy system clients and at the mobile device .

Each proxy system client and may be adapted to collect request information and process response information for a different remote digital certificate status check protocol. However the information collected by both proxy system clients and may be combined into a single service request to the proxy system . Each proxy system service and may then extract information from the service request required for a service request to its associated status information provider and . Responses returned to the status provider clients and by the status provider systems and may be returned to the proxy system clients and separately or in a single response. For example when one or both of the status information providers and signs its responses and the proxy system clients and are configured to verify response signatures then separate responses are preferably returned to the proxy system clients and according to their respective protocols. If responses are not signed however the responses may be combined into a single response.

A multiple client system as shown in may be particularly useful when a user wishes to check validity and or revocation status of an entire digital certificate chain which includes digital certificates for which status information is available from different status information providers. In known systems separate requests for each digital certificate in the chain must be sent to the status information providers. In the system of however only a single request need be sent from the device to obtain status information from any number of status information providers. Furthermore common information that is required by all proxy system clients and services may be included only once in an initial service request sent to the proxy system thereby reducing redundancy in the initial service request.

The mobile device includes a transceiver a microprocessor a display Flash memory RAM auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and may also include other device sub systems . The transceiver preferably includes transmit and receive antennas a receiver Rx a transmitter Tx one or more local oscillators LOs and a digital signal processor DSP . Within the Flash memory the mobile device preferably includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions.

The mobile device is preferably a two way communication device having voice and data communication capabilities. Thus for example the mobile device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network. References to the network should therefore be interpreted as encompassing both a single voice and data network and separate networks.

The communication subsystem is used to communicate with the network . The DSP is used to send and receive communication signals to and from the transmitter and receiver and may also exchange control information with the transmitter and receiver . If the voice and data communications occur at a single frequency or closely spaced set of frequencies then a single LO may be used in conjunction with the transmitter and receiver . Alternatively if different frequencies are utilized for voice communications versus data communications then a plurality of LOs can be used to generate a plurality of frequencies corresponding to the network . Although two antennas are depicted in the mobile device could be used with a single antenna structure. Information which includes both voice and data information is communicated to and from the communication module via a link between the DSP and the microprocessor .

The detailed design of the communication subsystem such as frequency band component selection power level etc. will be dependent upon the communication network in which the mobile device is intended to operate. For example a mobile device intended to operate in a North American market may include a communication subsystem designed to operate with the Mobitex or DataTAC mobile data communication networks and also designed to operated with any of a variety of voice communication networks such as AMPS TDMA CDMA PCS etc. whereas a mobile device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Depending upon the type of network the access requirements for the mobile device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each device. In GPRS data networks however network access is associated with a subscriber or user of the mobile device . A GPRS device typically requires a subscriber identity module SIM which is required in order to operate the mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM but the mobile device will be unable to carry out any functions involving communications over the network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the mobile device may send and receive communication signals preferably including both voice and data signals over the network . Signals received by the antenna from the communication network are routed to the receiver which provides for signal amplification frequency down conversion filtering channel selection etc. and may also provide analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna . Although a single transceiver is shown in for both voice and data communications it is possible that the mobile device may include two distinct transceivers a first transceiver for transmitting and receiving voice signals and a second transceiver for transmitting and receiving data signals.

In addition to processing the communication signals the DSP may also provide for receiver and transmitter control. For example the gain levels applied to communication signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B may be stored in the Flash memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice devices via the network . Similarly the data communication module B may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the mobile device and a plurality of other data devices via the network . On the mobile device a secure messaging software application incorporating software modules corresponding to the messaging system and proxy system client or clients and for example may operate in conjunction with the data communication module B in order to implement the techniques described above.

The microprocessor also interacts with other device subsystems such as the display Flash memory random access memory RAM auxiliary input output I O subsystems serial port keyboard speaker microphone a short range communications subsystem and any other device subsystems generally designated as . For example the modules A N are executed by the microprocessor and may provide a high level interface between a user of the mobile device and the mobile device. This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O keyboard speaker or microphone . Such interfaces are designated generally as UI in .

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as keyboard and display may be used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a persistent store such as Flash memory . In addition to the operating system and communication modules A N the Flash memory may also include a file system for storing data. A storage area is also preferably provided in the Flash memory to store digital certificates address book entries and possibly other information required for messaging shown as data stores and in . The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in the persistent store .

An exemplary application module N that may be loaded onto the mobile device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module B for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The Flash memory preferably provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A B via the wireless network . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless network with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

The mobile device may also be manually synchronized with a computer system by placing the mobile device in an interface cradle which couples the serial port of the mobile device to the serial port of the computer system. The serial port may also be used to enable a user to set preferences through an external device or software application to download other application modules N for installation and possibly to load digital certificates onto a mobile device. This wired download path may further be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network .

Additional application modules N may be loaded onto the mobile device through the network through an auxiliary I O subsystem through the serial port through the short range communications subsystem or through any other suitable subsystem and installed by a user in the Flash memory or RAM . Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

When the mobile device is operating in a data communication mode a received signal such as a text message or a web page download will be processed by the transceiver and provided to the microprocessor which will preferably further process the received signal for output to the display or alternatively to an auxiliary I O device . A digital certificate received by the transceiver in response to a request to a PKS or attached to a secure message for example may be added to a digital certificate store in the Flash memory if it has not already been stored. Validity and or revocation status of such a digital certificate may also be checked as described above. A user of mobile device may also compose data items such as e mail messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the mobile device is further enhanced with a plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user may then be transmitted over the communication network via the transceiver .

When the mobile device is operating in a voice communication mode the overall operation of the mobile device is substantially similar to the data mode except that received signals are preferably output to the speaker and voice signals for transmission are generated by a microphone . In addition the secure messaging techniques described above might not necessarily be applied to voice communications. Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module A and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

A short range communications subsystem may also be included in the mobile device . For example the subsystem may include an infrared device and associated circuits and components or a Bluetooth short range wireless communication module to provide for communication with similarly enabled systems and devices.

It will be appreciated that the above description relates to preferred embodiments by way of example only. Other embodiments may be realized. For example although digital certificate status checks are described primarily in the context of a wireless mobile device the system and method disclosed herein is also applicable to messaging clients operating on other platforms including those operating on desktop and laptop computer systems networked computer workstations and other types of messaging clients for which digital certificate checks involving remote systems may be desired.

While the above description also relates primarily to OCSP other protocols may similarly be optimized through an intermediate proxy system which operates in conjunction with both remote systems and proxy system clients. Such other protocols are not limited to digital certificate status check protocols. A proxy system and proxy system clients may be configured to provide other services than digital certificate status check services.

The digital certificate status request is sent to a proxy system program running on a proxy system. The digital certificate status request sent to the proxy system program conforms to a client proxy protocol. The proxy system program is operable to receive the digital certificate status request and perform the status request and attendant processing steps on behalf of the client system as described with reference to the proxy system service and the status provider client . The client proxy protocol may conform to a known status protocol such as OCSP or may instead be a proprietary protocol.

The proxy system program then prepares the digital certificate status request to be sent according to a status query protocol to a status provider system running a status provider program . The status query protocol may conform to a known status protocol such as OCSP or may instead be a proprietary protocol. In one embodiment the client proxy protocol is a first protocol such as a proprietary protocol and the status query protocol is a second protocol such as OCSP.

The status provider program then processes the query and the status provider system provides digital certificate status data to the proxy system program . The digital certificate status data illustratively comprises a digital certificate status indicator. If the digital certificate comprises a chain of digital certificates then a corresponding number of digital certificate status indicators may be provided to the proxy system program . Furthermore the status provider program may require additional information from the proxy system program and thus multiple communications between the proxy system program and the status provider program may occur. Accordingly multiple communications and are represented between the proxy system program and the status provider program .

Upon completion of the digital certificate status request the proxy system program prepares the digital certificate status data for transmission back to the client system. In one embodiment the proxy system program selects the entire set of status replay data received from the status provider program to be transmitted to the client system. In another embodiment the proxy system program selects only a single status indicator such as valid invalid unknown or revoked to be transmitted to the client system. For example if one digital certificate in a chain of digital certificates is found to be invalid by the status provider program then the proxy system program may select only an invalid status indicator to be transmitted to the client system. Alternatively the proxy system program may select an invalid status indicator to be transmitted to the client system and also data to specify which digital certificate in a digital certificate chain is invalid. Other data combinations may also be derived to be sent back to the client system.

In another embodiment the client system and the proxy system may store corresponding a mapping tables and or like elements which maintain a correspondence between digital certificate issuers and serial numbers and or subject names. The client system may then provide only a unique indicator for a corresponding digital certificate such as a serial number or subject name. The proxy system program may then format a digital certificate status request according to the status query protocol for the status provider system running the status provider program based on only a serial number or subject name received from the client system. If the client system comprises a mobile device operable to communicate with the proxy system over a wireless network the mapping tables and may be used to conserve the relatively limited bandwidth of the RF network.

Still further examples of the wide scope of the systems and methods disclosed herein are illustrated in . describe additional uses of the systems and methods within different exemplary communication systems. is a block diagram showing an example communication system. In there is shown a computer system a WAN corporate LAN behind a security firewall wireless infrastructure wireless networks and and mobile devices and . The corporate LAN includes a message server a wireless connector system a data store including at least a plurality of mailboxes a desktop computer system having a communication link directly to a mobile device such as through physical connection to an interface or connector and a wireless VPN router . Operation of the system in will be described below with reference to the messages and .

The computer system may for example be a laptop desktop or palmtop computer system configured for connection to the WAN . Such a computer system may connect to the WAN via an ISP or ASP. Alternatively the computer system may be a network connected computer system that like the computer system for example accesses the WAN through a LAN or other network. Many modern mobile devices are enabled for connection to a WAN through various infrastructure and gateway arrangements so that the computer system may also be a mobile device.

The corporate LAN is an illustrative example of a central server based messaging system that has been enabled for wireless communications. The corporate LAN may be referred to as a host system in that it hosts both a data store with mailboxes for messages as well as possibly further data stores not shown for other data items that may be sent to or received from mobile devices and and the wireless connector system the wireless VPN router or possibly other components enabling communications between the corporate LAN and one or more mobile devices and . In more general terms a host system may be one or more computers at with or in association with which a wireless connector system is operating. The corporate LAN is one preferred embodiment of a host system in which the host system is a server computer running within a corporate network environment operating behind and protected by at least one security communications firewall . Other possible central host systems include ISP ASP and other service provider or mail systems. Although the desktop computer system and interface connector may be located outside such host systems wireless communication operations may be similar to those described below.

The corporate LAN implements the wireless connector system as an associated wireless communications enabling component which will normally be a software program a software application or a software component built to work with at least one or more message server. The wireless connector system is used to send user selected information to and to receive information from one or more mobile devices and via one or more wireless networks and . The wireless connector system may be a separate component of a messaging system as shown in or may instead be partially or entirely incorporated into other communication system components. For example the message server may incorporate a software program application or component implementing the wireless connector system portions thereof or some or all of its functionality.

The message server running on a computer behind the firewall acts as the main interface for the corporation to exchange messages including for example electronic mail calendaring data voice mail electronic documents and other PIM data with the WAN which will typically be the Internet. The particular intermediate operations and computers will be dependent upon the specific type of message delivery mechanisms and networks via which messages are exchanged and therefore have not been shown in . The functionality of the message server may extend beyond message sending and receiving providing such features as dynamic database storage for data like calendars to do lists task lists e mail and documentation as described above.

Message servers such as normally maintain a plurality of mailboxes in one or more data stores such as for each user having an account on the server. The data store includes mailboxes for a number of n user accounts. Messages received by the message server that identify a user a user account a mailbox or possibly another address associated with a user account or mailbox as a message recipient will typically be stored in the corresponding mailbox . If a message is addressed to multiple recipients or a distribution list then copies of the same message may be stored to more than one mailbox . Alternatively the message server may store a single copy of such a message in a data store accessible to all of the users having an account on the message server and store a pointer or other identifier in each recipient s mailbox . In typical messaging systems each user may then access his or her mailbox and its contents using a messaging client such as Microsoft Outlook or Lotus Notes which normally operates on a PC such as the desktop computer system connected in the LAN . Although only one desktop computer system is shown in those skilled in the art will appreciate that a LAN will typically contain many desktop notebook and laptop computer systems. Each messaging client normally accesses a mailbox through the message server although in some systems a messaging client may enable direct access to the data store and a mailbox stored thereon by the desktop computer system . Messages may also be downloaded from the data store to a local data store on the desktop computer system .

Within the corporate LAN the wireless connector system operates in conjunction with the message server . The wireless connector system may reside on the same computer system as the message server or may instead be implemented on a different computer system. Software implementing the wireless connector system may also be partially or entirely integrated with the message server . The wireless connector system and the message server are preferably designed to cooperate and interact to allow the pushing of information to mobile devices . In such an installation the wireless connector system is preferably configured to send information that is stored in one or more data stores associated with the corporate LAN to one or more mobile devices through the corporate firewall and via the WAN and one of the wireless networks . For example a user that has an account and associated mailbox in the data store may also have a mobile device such as . As described above messages received by the message server that identify a user account or mailbox are stored to a corresponding mailbox by the message server . If a user has a mobile device such as messages received by the message server and stored to the user s mailbox are preferably detected by the wireless connector system and sent to the user s mobile device . This type of functionality represents a push message sending technique. The wireless connector system may instead employ a pull technique in which items stored in a mailbox are sent to a mobile device responsive to a request or access operation made using the mobile device or some combination of both techniques.

The use of a wireless connector thereby enables a messaging system including a message server to be extended so that each user s mobile device has access to stored messages of the message server . Although the systems and methods described herein are not restricted solely to a push based technique a more detailed description of push based messaging may be found in the United States patent and applications incorporated by reference above. This push technique uses a wireless friendly encoding compression and encryption technique to deliver all information to a mobile device thus effectively extending the company firewall to include the mobile devices .

As shown in there are several paths for exchanging information with a mobile device from the corporate LAN . One possible information transfer path is through the physical connection such as a serial port using an interface or connector . This path may be useful for example for bulk information updates often performed at initialization of a mobile device or periodically when a user of a mobile device is working at a computer system in the LAN such as the computer system . For example as described above PIM data is commonly exchanged over such a connection for example a serial port connected to an appropriate interface or connector such as a cradle in or upon which a mobile device may be placed. The physical connection may also be used to transfer other information from a desktop computer system to a mobile device including private security keys private keys such as private encryption or signature keys associated with the desktop computer system or other relatively bulky information such as digital certificates and CRLs used in some secure messaging schemes such as S MIME and PGP.

Private key exchange using a physical connection and connector or interface allows a user s desktop computer system and mobile device or to share at least one identity for accessing all encrypted and or signed mail. The user s desktop computer system and mobile device or can also thereby share private keys so that either the host system or mobile device or can process secure messages addressed to the user s mailbox or account on the message server . The transfer of digital certificates and CRLs over such a physical connection may be desirable in that they represent a large amount of the data that is required for S MIME PGP and other public key security methods. A user s own digital certificate a chain of digital certificate s used to verify the user s digital certificate and CRL as well as digital certificates digital certificate chains and CRLs for other users may be loaded onto a mobile device from the user s desktop computer system . This loading of other user s digital certificates and CRLs onto a mobile device allows a mobile device user to select other entities or users with whom they might be exchanging secure messages and to pre load the bulky information onto the mobile device through a physical connection instead of over the air thus saving time and wireless bandwidth when a secure message is received from or to be sent to such other users or when the status of a digital certificate is to be determined.

In known synchronization type wireless messaging systems a physical path has also been used to transfer messages from mailboxes associated with a message server to mobile devices and .

Another method for data exchange with a mobile device is over the air through the wireless connector system and using wireless networks . As shown in this could involve a Wireless VPN router if available in the network or alternatively a traditional WAN connection to wireless infrastructure that provides an interface to one or more wireless networks . The Wireless VPN router provides for creation of a VPN connection directly through a specific wireless network to a wireless device . Such a Wireless VPN router may be used in conjunction with a static addressing scheme. For example if the wireless network is an IP based wireless network then IPV6 would provide enough IP addresses to dedicate an IP address to every mobile device configured to operate within the network and thus make it possible to push information to a mobile device at any time. A primary advantage of using a wireless VPN router is that it could be an off the shelf VPN component which would not require wireless infrastructure . A VPN connection may use a TCP IP or UDP IP connection to deliver messages directly to and from a mobile device .

If a wireless VPN router is not available then a link to a WAN normally the Internet is a commonly used connection mechanism that may be employed by the wireless connector system . To handle the addressing of the mobile device and any other required interface functions wireless infrastructure is preferably used. The wireless infrastructure may also determine a most likely wireless network for locating a given user and track users as they roam between countries or networks. In wireless networks such as and messages are normally delivered to and from mobile devices via RF transmissions between base stations not shown and the mobile devices .

A plurality of connections to wireless networks and may be provided including for example ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. The wireless networks and could represent distinct unique and unrelated networks or they could represent the same network in different countries and may be any of different types of networks including but not limited to data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same or similar infrastructure such as any of those described above.

In some implementations more than one over the air information exchange mechanism may be provided in the corporate LAN . In the exemplary communication system of for example mobile devices associated with users having mailboxes associated with user accounts on the message server are configured to operate on different wireless networks and . If the wireless network supports IPv6 addressing then the wireless VPN router may be used by the wireless connector system to exchange data with any mobile device operating within the wireless network . The wireless network may be a different type of wireless network however such as the Mobitex network in which case information may instead be exchanged with a mobile device operating within the wireless network by the wireless connector system via a connection to the WAN and the wireless infrastructure .

Operation of the system in will now be described using an example of an e mail message sent from the computer system and addressed to at least one recipient having both an account and mailbox or like data store associated with the message server and a mobile device or . However the e mail message is intended for illustrative purposes only. The exchange of other types of information between the corporate LAN is preferably also enabled by the wireless connector system .

The e mail message sent from the computer system via the WAN may be fully in the clear or signed with a digital signature and or encrypted depending upon the particular messaging scheme used. For example if the computer system is enabled for secure messaging using S MIME then the e mail message may be signed encrypted or both.

E mail messages such as normally use traditional SMTP RFC822 headers and MIME body parts to define the format of the e mail message. These techniques are all well known to one in the art. The e mail message arrives at the message server which determines into which mailboxes the e mail message should be stored. As described above a message such as the e mail message may include a user name a user account a mailbox identifier or other type of identifier that may be mapped to a particular account or associated mailbox by the message server . For an e mail message recipients are typically identified using e mail addresses corresponding to a user account and thus a mailbox .

The wireless connector system sends or mirrors via a wireless network or certain user selected data items or parts of data items from the corporate LAN to the user s mobile device or preferably upon detecting that one or more triggering events has occurred. A triggering event includes but is not limited to one or more of the following screen saver activation at a user s networked computer system disconnection of the user s mobile device or from the interface or receipt of a command sent from a mobile device or to the host system to start sending one or more messages stored at the host system. Thus the wireless connector system may detect triggering events associated with the message server such as receipt of a command or with one or more networked computer systems including the screen saver and disconnection events described above. When wireless access to corporate data for a mobile device or has been activated at the LAN for example when the wireless connector system detects the occurrence of a triggering event for a mobile device user data items selected by the user are preferably sent to the user s mobile device. In the example of the e mail message assuming that a triggering event has been detected the arrival of the message at the message server is detected by the wireless connector system . This may be accomplished for example by monitoring or querying mailboxes associated with the message server or if the message server is a Microsoft Exchange server then the wireless connector system may register for advise syncs provided by the Microsoft Messaging Application Programming Interface MAPI to thereby receive notifications when a new message is stored to a mailbox .

When a data item such as the e mail message is to be sent to a mobile device or the wireless connector system preferably repackages the data item in a manner that is transparent to the mobile device so that information sent to and received by the mobile device appears similar to the information as stored on and accessible at the host system LAN in . One preferred repackaging method includes wrapping received messages to be sent via a wireless network in an electronic envelope that corresponds to the wireless network address of the mobile device to which the message is to be sent. Alternatively other repackaging methods could be used such as special purpose TCP IP wrapping techniques. Such repackaging preferably also results in e mail messages sent from a mobile device or appearing to come from a corresponding host system account or mailbox even though they are composed and sent from a mobile device. A user of a mobile device or may thereby effectively share a single e mail address between a host system account or mailbox and the mobile device.

Repackaging of the e mail message is indicated at and . Repackaging techniques may be similar for any available transfer paths or may be dependent upon the particular transfer path either the wireless infrastructure or the wireless VPN router . For example the e mail message is preferably compressed and encrypted either before or after being repackaged at to thereby effectively provide for secure transfer to the mobile device . Compression reduces the bandwidth required to send the message whereas encryption ensures confidentiality of any messages or other information sent to mobile devices and . In contrast messages transferred via a VPN router might only be compressed and not encrypted since a VPN connection established by the VPN router is inherently secure. Messages are thereby securely sent via either encryption at the wireless connector system which may be considered a non standard VPN tunnel or a VPN like connection for example or the VPN router to mobile devices and . Accessing messages using a mobile device or is thus no less secure than accessing mailboxes at the LAN using the desktop computer system .

When a repackaged message or arrives at a mobile device or via the wireless infrastructure or via the wireless VPN router the mobile device or removes the outer electronic envelope from the repackaged message or and performs any required decompression and decryption operations. Messages sent from a mobile device or and addressed to one or more recipients are preferably similarly repackaged and possibly compressed and encrypted and sent to a host system such as the LAN . The host system may then remove the electronic envelope from the repackaged message decrypt and decompress the message if desired and route the message to the addressed recipients.

Another goal of using an outer envelope is to maintain at least some of the addressing information in the original e mail message . Although the outer envelope used to route information to mobile devices is addressed using a network address of one or more mobile devices the outer envelope preferably encapsulates the entire original e mail message including at least one address field possibly in compressed and or encrypted form. This allows original To From and CC addresses of the e mail message to be displayed when the outer envelope is removed and the message is displayed on a mobile device or . The repackaging also allows reply messages to be delivered to addressed recipients with the From field reflecting an address of the mobile device user s account or mailbox on the host system when the outer envelope of a repackaged outgoing message sent from a mobile device is removed by the wireless connector system . Using the user s account or mailbox address from the mobile device or allows a message sent from a mobile device to appear as though the message originated from the user s mailbox or account at the host system rather than the mobile device.

The wireless connector systems are similar to the wireless connector system described above in that it enables data items such as e mail messages and other items that are stored in mailboxes and possibly data items stored in a local or network data store to be sent from the LAN to one or more mobile devices . In however the network operator infrastructure provides an interface between the mobile devices and the LAN . As above operation of the system shown in will be described below in the context of an e mail message as an illustrative example of a data item that may be sent to a mobile device .

When an e mail message addressed to one or more recipients having an account on the message server is received by the message server the message or possibly a pointer to a single copy of the message stored in a central mailbox or data store is stored into the mailbox of each such recipient. Once the e mail message or pointer has been stored to a mailbox it may preferably be accessed using a mobile device or . In the example shown in the e mail message has been addressed to the mailboxes associated with both desktop computer systems and and thus both mobile devices and .

As those skilled in the art will appreciate communication network protocols commonly used in wired networks such as the LAN and or the WAN are not suitable or compatible with wireless network communication protocols used within wireless networks such as . For example communication bandwidth protocol overhead and network latency which are primary concerns in wireless network communications are less significant in wired networks which typically have much higher capacity and speed than wireless networks. Therefore mobile devices and cannot normally access the data store directly. The network operator infrastructure provides a bridge between the wireless network and the LAN .

The network operator infrastructure enables a mobile device to establish a connection to the LAN through the WAN and may for example be operated by an operator of the wireless network or a service provider that provides wireless communication service for mobile devices and . In a pull based system a mobile device may establish a communication session with the network operator infrastructure using a wireless network compatible communication scheme preferably a secure scheme such as Wireless Transport Layer Security WTLS when information should remain confidential and a wireless web browser such as a Wireless Application Protocol WAP browser. A user may then request through manual selection or pre selected defaults in the software residing in the mobile device any or all information or just new information for example stored in a mailbox in the data store at the LAN . The network operator infrastructure then establishes a connection or session with a wireless connector system using Secure Hypertext Transfer Protocol HTTPS for example if no session has already been established. As above a session between the network operator infrastructure and a wireless connector system may be made via a typical WAN connection or through the VPN router if available. When time delays between receiving a request from a mobile device and delivering requested information back to the device are to be minimized the network operator infrastructure and the wireless connector systems may be configured so that a communication connection remains open once established.

In the system of requests originating from mobile device A and B would be sent to the wireless connector systems and respectively. Upon receiving a request for information from the network operator infrastructure a wireless connector system retrieves requested information from a data store. For the e mail message the wireless connector system retrieves the e mail message from the appropriate mailbox typically through a messaging client operating in conjunction with the computer system which may access a mailbox either via the message server or directly. Alternatively a wireless connector system may be configured to access mailboxes itself directly or through the message server . Also other data stores both network data stores similar to the data store and local data stores associated with each computer system may be accessible to a wireless connector system and thus to a mobile device .

If the e mail message is addressed to the message server accounts or mailboxes associated with both computer systems and and devices and then the e mail message may be sent to the network operator infrastructure as shown at and which then sends a copy of the e mail message to each mobile device and as indicated at and . Information may be transferred between the wireless connector systems and the network operator infrastructure via either a connection to the WAN or the VPN router . When the network operator infrastructure communicates with the wireless connector systems and the mobile devices via different protocols translation operations may be performed by the network operator infrastructure . Repackaging techniques may also be used between the wireless connector systems and the network operator infrastructure and between each mobile device and the network operator infrastructure .

Messages or other information to be sent from a mobile device may be processed in a similar manner with such information first being transferred from a mobile device to the network operator infrastructure . The network operator infrastructure may then send the information to a wireless connector system for storage in a mailbox and delivery to any addressed recipients by the message server for example or may alternatively deliver the information to the addressed recipients.

The above description of the system in relates to pull based operations. The wireless connector systems and the network operator infrastructure may instead be configured to push data items to mobile devices and . A combined push pull system is also possible. For example a notification of a new message or a list of data items currently stored in a data store at the LAN could be pushed to a mobile device which may then be used to request messages or data items from the LAN via the network operator infrastructure .

If mobile devices associated with user accounts on the LAN are configured to operate within different wireless networks then each wireless network may have an associated wireless network infrastructure component similar to .

Although separate dedicated wireless connector systems are shown for each computer system in the system of one or more of the wireless connector systems may preferably be configured to operate in conjunction with more than one computer system or to access a data store or mailbox associated with more than one computer system. For example the wireless connector system may be granted access to the mailboxes associated with both the computer system and the computer system . Requests for data items from either mobile device A or B may then be processed by the wireless connector system . This configuration may be useful to enable wireless communications between the LAN and the mobile devices and without requiring a desktop computer system to be running for each mobile device user. A wireless connector system may instead be implemented in conjunction with the message server to enable wireless communications.

The wireless connector system provides for transfer of data items stored at the LAN to one or more mobile devices . These data items preferably include e mail messages stored in mailboxes in the data store as well as possibly other items stored in the data store or another network data store or a local data store of a computer system such as .

As described above an e mail message addressed to one or more recipients having an account on the message server and received by the message server may be stored into the mailbox of each such recipient. In the system of the external data store preferably has a similar structure to and remains synchronized with the data store . PIM information or data stored at data store preferably is independently modifiable to the PIM information or data stored at the host system. In this particular configuration the independently modifiable information at the external data store may maintain synchronization of a plurality of data stores associated with a user i.e. data on a mobile device data on a personal computer at home data at the corporate LAN etc. . This synchronization may be accomplished for example through updates sent to the data store by the wireless connector system at certain time intervals each time an entry in the data store is added or changed at certain times of day or when initiated at the LAN by the message server or a computer system at the data store or possibly by a mobile device through the access gateway . In the case of the e mail message for example an update sent to the data store some time after the e mail message is received may indicate that the message has been stored in a certain mailbox in the store and a copy of the e mail message will be stored to a corresponding storage area in the data store . When the e mail message has been stored in the mailboxes corresponding to the mobile devices and for example one or more copies of the e mail message indicated at and in will be sent to and stored in corresponding storage areas or mailboxes in the data store . As shown updates or copies of stored information in the data store may be sent to the data store via a connection to the WAN or the VPN router . For example the wireless connector system may post updates or stored information to a resource in the data store via an HTTP post request. Alternatively a secure protocol such as HTTPS or Secure Sockets Layer SSL may be used. Those skilled in the art will appreciate that a single copy of a data item stored in more than one location in a data store at the LAN may instead be sent to the data store . This copy of the data item could then be stored either in more than one corresponding location in the data store or a single copy may be stored in the data store with a pointer or other identifier of the stored data item being stored in each corresponding location in the data store .

The access gateway is effectively an access platform in that it provides mobile devices and with access to the data store . The data store may be configured as a resource accessible on the WAN and the access gateway may be an ISP system or WAP gateway through which mobile devices and may connect to the WAN . A WAP browser or other browser compatible with the wireless networks and may then be used to access the data store which is synchronized with the data store and download stored data items either automatically or responsive to a request from a mobile device . As shown at and copies of the e mail message which was stored in the data store may be sent to the mobile devices and . A data store not shown on each mobile device may thereby be synchronized with a portion such as a mailbox of a data store on a corporate LAN . Changes to a mobile device data store may similarly be reflected in the data stores and .

The embodiments described herein are examples of structures systems or methods having elements corresponding to the elements of the invention recited in the claims. This written description may enable those of ordinary skill in the art to make and use embodiments having alternative elements that likewise correspond to the elements of the invention recited in the claims. The intended scope of the invention thus includes other structures systems or methods that do not differ from the literal language of the claims and further includes other structures systems or methods with insubstantial differences from the literal language of the claims.

