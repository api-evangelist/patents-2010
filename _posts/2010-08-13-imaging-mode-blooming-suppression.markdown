---

title: Imaging mode blooming suppression
abstract: A minimally invasive surgical system includes a scene anti-bloom process that allows switching between imaging modes on a stereoscopic display without causing a surgeon to look-away or being momentarily distracted by sudden changes in overall scene luminance. The process receives a switch from a first imaging mode to a second imaging mode. An overall scene luminance of a scene in the first imaging mode is less than an overall scene luminance of a scene in the second imaging mode. The process delays the switch to the second imaging mode until after an illumination output level of a visible illumination source has changed to a higher output level, and then switches to the second imaging mode.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09019345&OS=09019345&RS=09019345
owner: Intuitive Surgical Operations, Inc.
number: 09019345
owner_city: Sunnyvale
owner_country: US
publication_date: 20100813
---
Aspects of this invention are related to endoscopic imaging and are more particularly related to switching between imaging modes having different overall scene luminance.

The da Vinci Surgical System commercialized by Intuitive Surgical Inc. Sunnyvale Calif. is a minimally invasive teleoperated surgical system that offers patients many benefits such as reduced trauma to the body faster recovery and shorter hospital stay. One key component of the da Vinci Surgical System is a capability to provide two channel i.e. left and right video capture and display of the captured visible images to provide stereoscopic viewing for the surgeon.

Such electronic stereoscopic imaging systems may output high definition video images to the surgeon and may allow features such as zoom to provide a magnified view that allows the surgeon to identify specific tissue types and characteristics as well as to work with increased precision. In a typical surgical field however certain tissue types are difficult to identify or tissue of interest may be at least partially obscured by other tissue. This complicates the surgical procedure.

In one aspect a minimally invasive surgical system includes a scene anti bloom process that allows switching between imaging modes on a stereoscopic display without causing a surgeon either to look away from or be distracted by sudden changes in overall scene luminance. In one aspect the process receives a command to switch from a first imaging mode to a second image mode of the display. An overall scene luminance of a scene in the first imaging mode is less than an overall scene luminance of a scene in the second imaging mode. The process delays the switch to the second imaging mode until after an illumination output level of a visible illumination source has changed to a higher output level and then switches to the second imaging mode.

In one aspect the first and second imaging modes have a same normal level of a display output gain of a display of the minimally invasive surgical system. In this aspect the delaying includes lowering the display output gain of the display from the normal level. The delaying also includes switching from a lower illumination output level of the visible illumination source to a higher illumination output level of the visible illumination source following lowering the display output gain. In another aspect the switching the imaging mode includes restoring the display output gain to the normal level.

A minimally invasive surgical system includes a display an output gain control unit coupled to the display an imaging mode switch and a controller coupled to the output gain control unit and to the imaging mode switch. Following receipt of an imaging mode change command from the image mode switch the controller configures the output gain control unit to attenuate an output image by decreasing the brightness of the output image.

In one aspect the system also includes an illuminator including a power and level controller and a visible light source. The controller configures the power and level controller to restore an output level of the visible light source from a reduced output level to a normal illumination output level. In another aspect the reduced output level corresponds to the visible light source being powered off. In yet another aspect the reduced output level is less than one hundred percent of the normal illumination output level. Following the restoration of the output level of the visible light source the controller configures the output gain control unit to display an image on the display.

In the drawings the first digit of a reference number indicates the figure in which the element with that reference number first appeared.

In one aspect minimally invasive surgical system includes a scene anti bloom process that facilitates switching between imaging modes on stereoscopic display without causing a surgeon to look away from or to be distracted by sudden changes in overall scene luminance. In some conventional minimally invasive surgical systems when the surgeon switches the imaging mode of stereoscopic display from a fluorescence imaging mode to a normal imaging mode e.g. switches from illuminating tissue with illumination from fluorescence illumination source to illuminating tissue with the normal output illumination of white light illumination source the display of the scene that includes tissue becomes extremely bright and washed out i.e. the displayed scene blooms.

In these conventional minimally invasive surgical systems the displayed scene is so bright that typically the surgeon may divert his or her eyes from display . As explained more completely below aspects of this invention eliminate this blooming and so enhance the surgeon s performance because the surgeon can continue viewing display during all imaging mode changes.

Prior to considering process in further detail it is informative to understand the operation of system as illustrated in . There are other parts cables etc. associated with the da Vinci Surgical System but these are not illustrated in to avoid detracting from the disclosure. Further information regarding minimally invasive surgical systems may be found for example in U.S. patent application Ser. No. 11 762 165 filed Jun. 13 2007 disclosing Minimally Invasive Surgical System and U.S. Pat. No. 6 331 181 filed Dec. 18 2001 disclosing Surgical Robotic Tools Data Architecture and Use both of which are incorporated herein by reference.

For example while it is not shown in system includes a cart with a plurality of servo controlled robotic manipulators. Each manipulator can be coupled to and decoupled from master tool manipulators on surgeon s console . A stereoscopic endoscope is mounted on one of the manipulators. The interactions between the master tool manipulators the slave surgical devices and stereoscopic endoscope are the same as in a conventional system and so are known to those knowledgeable in the field.

Also as explained more completely below acquired images of a surgical site are directed to stereoscopic display . However each acquired image left or right can be directed to more places than just this display. For example other monitors video recorders video codecs for remote display via the Internet can all be used with system . The following description is directed at eliminating blooming so that the surgeon keeps his or her eyes on display . However the processes described herein are also applicable to any of the contexts of these other devices. Therefore eliminating blooming on display is illustrative only and is not intended to be limiting.

Also in the following example a stereoscopic endoscope left and right acquisition and display paths are described. This also is illustrative only. The processes described more completely below also are applicable to monoscopic systems that switch between normal and fluorescence imaging mode as described herein.

As described more completely below endoscope provides left and right images of tissue within a patient. The left and right images also include images of any slave surgical devices in the field of view of stereoscopic endoscope . The collection of images in a frame acquired from a channel of endoscope is referred to herein as a scene. The acquired scene has an overall luminance. Overall luminance is used to distinguish the scene luminance from the luminance of individual images in the acquired scene i.e. the luminance is over all of the images in the acquired scene.

In system an illumination system e.g. dual mode illuminator is coupled to endoscope . Dual mode illuminator includes a white light source and a fluorescence excitation source . The on and off state of each of sources and is independently controllable by power and level controller in response to commands from imaging mode controller . In addition at least the output level of white light source is controlled by power and level controller in response to commands from imaging mode controller .

Typically three or more visible color components make up white light i.e. white light includes a first visible color component a second visible color component and a third visible color component. Each of the three visible color components is a different visible color component e.g. a red component a green component and a blue component.

In one aspect white light source includes a source for each of the different visible color illumination components. For a red green blue implementation in one example the sources are lasers.

The use of lasers in white light source is illustrative only and is not intended to be limiting. White light source ill could also be implemented with multiple laser diodes or light emitting diodes LEDs for example. Alternatively white light source could use a Xenon lamp with an elliptic back reflector and a long band pass coating to create broadband white illumination light for visible images. The use of a Xenon lamp also is illustrative only and is not intended to be limiting. For example a high pressure mercury arc lamp other arc lamps or other broadband light sources may be used.

When the fluorescence excitation wavelength occurs outside the visible spectrum e.g. in the near infrared NIR spectrum a laser module or other energy source such as a light emitting diode or filtered white light is used as fluorescence excitation source .

In one example dual mode illuminator has a normal imaging mode and a fluorescence imaging mode. In the normal imaging mode white light source provides illumination that illuminates tissue in white light. The illumination output of white light source in the normal imaging mode is referred to as the normal illumination output level of white light source . Fluorescence excitation source is not used in the normal imaging mode.

In the fluorescence imaging mode fluorescence excitation source is turned on. Fluorescence excitation source provides a fluorescence excitation illumination component that excites fluorescence from tissue. For example narrow band light from fluorescence excitation source is used to excite tissue specific fluorophores so that fluorescence images of specific tissue within the scene are acquired by cameras L R.

In the fluorescence imaging mode white light source provides in one aspect one or more visible color illumination components to illuminate tissue . If one or more visible color illumination components are used in the fluorescence imaging mode the output level of those visible color illumination components is reduced to one part in ten relative to the normal illumination output level used in the normal imaging mode. In this aspect both visible and fluorescence images are acquired. In another aspect none of the visible color components of white light are used when fluorescence excitation source is on.

In any of the modes of operation of dual mode illuminator the light from the light source or light sources is directed into a fiber optic bundle . Fiber optic bundle provides the light to an illumination path in stereoscopic endoscope that in turn directs the light to tissue .

Endoscope also includes in this aspect two optical channels for passing light emanating from tissue and from any other objects in the field of view of endoscope . Reflected white light or a reflected visible color component of white light forms a visible image or images. Fluorescence may be either visible light or non visible light depending on the fluorophore that is used. In the fluorescence imaging mode an overall scene luminance of an acquired frame is generally much less than the overall scene luminance of an acquired frame in the normal imaging mode.

The light from tissue is passed by the stereoscopic optical path in endoscope to cameras L R. In the various modes of operation that correspond to the various imaging modes left image CCD L acquires a frame that includes a left image and right image CCD R acquires a frame that includes a right image. Each of left image CCD L and right image CCD R can be multiple CCDs that each capture a different visible color component a single CCD with different regions of the CCD that capture a particular visible color component etc. A three chip CCD sensor is illustrative only. A single CMOS image sensor with a color filter array or a three CMOS color image sensor assembly may also be used.

Camera L is coupled to a stereoscopic display in surgeon s console by a left camera control unit L. Camera R is coupled to stereoscopic display in surgeon s console by a right camera control unit R. Camera control units L R receive signals from an imaging mode controller and provide control signals to cameras L R. Each of camera control units L R includes an automatic gain controller AGC L R.

In one aspect each of camera control units L R also includes an output gain control unit L R that controls the display output gain for display . The inclusion of output gain control units L R in camera control units L R is illustrative only and is not intended to be limiting. In another aspect output gain control units L R are units positioned between camera control units L R and display . In still another aspect output gain control units L R are included in display .

Automatic gain controllers L R automatically adjust the gain for the acquired frames from cameras L and R. The output display gain can be set by commands from imaging mode controller to output gain control units L R.

When the illumination from dual mode illuminator changes the overall scene luminance of the acquired frames change. In changing from illumination in the fluorescence imaging mode to illumination in the normal imaging mode the automatic gain controllers L R are configured for the relatively lower overall scene luminance of frames acquired in the fluorescence imaging mode. However upon the illumination source switch the acquired frames have the normal overall scene luminance which is greater than the overall scene luminance for the frames in the fluorescence imaging mode. Consequently immediately following the switch the automatic gain controller is not configured correctly and in the conventional systems this contributed to the scene blooming.

In one aspect stereoscopic video output display sometimes referred to as display may be operated in various imaging modes. For example in a normal imaging mode only visible images are output to display . In fluorescence imaging mode fluorescence images are superimposed on visible images to create augmented images and the augmented images are output to display . One technique for superimposing the images is described below.

The imaging mode of display in one aspect is toggled between these two imaging modes by using imaging mode select switch e.g. a foot switch a double click of the master grips that control the surgical instruments voice control and other like switching methods. In response to the user input a MODE SWITCH check operation in imaging mode select switch sends a notification of the selected imaging mode to an EVENT HANDLER in a user interface . is a process flow diagram of one aspect of a method to suppress blooming.

In response to the notification EVENT HANDER in user interface sends a mode switch command to system process . System process forwards the mode switch command to imaging mode controller and also configures any other elements of system needed to process the acquired images so that the surgeon is presented the requested imaging mode in display . System process represents the various controllers etc. in system that are not illustrated in .

MODE SWITCH check operation in imaging mode controller determines the direction of the change in overall scene luminance. If the imaging mode is changed from the normal imaging mode to the fluorescence imaging mode the direction of the change in overall scene luminance is high to low. Conversely if the imaging mode is changed from the fluorescence imaging mode to the normal imaging mode the direction of the change in overall scene luminance is low to high. As explained above in the fluorescence imaging mode the illumination output from white light source in illuminator is less than the illumination output from white light source from illuminator in the normal imaging mode.

When the imaging mode switch is low to high MODE SWITCH check operation transfers to DELAY IMAGING MODE SWITCH process . In DELAY IMAGING MODE SWITCH process imaging mode controller configures output gain control units L R to attenuate output images to display . Imaging mode controller then sends a command to power and level controller to change the illumination source to white light source with the normal illumination output level. DELAY IMAGING MODE SWITCH process transfers processing to SWITCH IMAGING MODE process .

In SWITCH IMAGING MODE process imaging mode controller configures output gain control units L R to allow display to display images in the normal imaging mode. Since output images to display were greatly attenuated when the change in illumination was made the prior art blooming is prevented. Thus the surgeon sees a smooth transition from the fluorescence imaging mode to the normal imaging mode without any sudden bright distortion in the displayed scenes.

When the imaging mode switch command is from a high overall scene luminance to a low overall scene luminance MODE SWITCH check operation transfers to SWITCH ILLUMINATION process . In SWITCH ILLUMINATION process imaging mode controller sends a command to power and level controller to turn on fluorescence excitation source and to configure white light source for the fluorescence imaging mode of operation. As explained above in one aspect white light source is turned off.

In another aspect in process the output level of white light source is reduced to one part in ten relative to the normal illumination output level of white light source in the normal imaging mode. In yet another aspect one or more visible color component illumination sources are turned off and the output level of the visible color component illumination sources that remain on is reduced to one part in ten relative to the normal illumination output level of those sources in the normal imaging mode. The output level reductions are illustrative only and are not intended to be limiting to the specific values described. In this direction of change in overall scene luminance it is unnecessary to block output to display because the overall scene luminance is being decreased and so blooming is not an issue.

Processes and were described above and so that description is incorporated herein by reference with respect to . When the imaging mode switch is low to high processing transfers from MODE SWITCH check operation to DELAY IMAGING MODE SWITCH process A which is an example of delay display switch process .

In process A LOWER OUTPUT GAIN process communicates with output gain control units L R and instructs output control gain units L R to lower the display output gain from the normal display output gain used in the normal imaging mode. The display output gain is lowered so that irrespective of the overall scene luminance of an acquired frame from cameras L R any images displayed on stereoscopic display are greatly attenuated i.e. display goes dim.

In one aspect as many as three different commands are issued to output gain control units L R over a 9600 Baud communication link. Hence there is a delay associated with lowering the display output gain. In this aspect INITIALIZE TIMERS process initializes a mode switch timer that is used to provide configurable delays between various commands that are sent. If scene anti bloom process B should fail after initiation of LOWER OUTPUT GAIN process and before completion of RESTORE OUTPUT GAIN process display would be left in the blacked out state which is unsafe. Thus INITIALIZE TIMERS process also taps a system watchdog timer.

A system WATCHDOG TIMEOUT check operation monitors the system watchdog timer. If the system watchdog timer times out check operation transfers to a RESET process . In RESET process camera control units L R are commanded to reload a default configuration which is the normal imaging mode white light settings. RESET process also commands power and level controller to reload the default configuration which turns off fluorescence excitation source if necessary turns on white light source if necessary and sets white light source at the normal illumination output level. This process restores acquisition of useful images by cameras L R that are displayed on display .

Returning to INITIALIZE TIMERS process after initializing the mode switch timer process transfers to MODE SWITCH TIMEOUT check operation . When the mode switch timer times out sufficient time has passed that the necessary commands have been sent to output gain control units L R during the time period and the display output gains of output gain control units L R have been lowered. Thus when the mode switch timer times out processing transfers to SWITCH ILLUMINATION process .

In SWITCH ILLUMINATION process a command is sent to power and level controller to turn off fluorescence excitation source to turn on white light source if necessary and to restore white light source to the normal illumination output level. In one aspect two commands are sent during process . This completes DELAY IMAGING MODE process A and so SWITCH ILLUMINATION process transfers to SWITCH IMAGING MODE process A which is an example of SWITCH IMAGING MODE process .

RESTORE OUTPUT GAIN process in SWITCH IMAGING MODE process A communicates with output gain control units L R and instructs output gain control units L R to restore the display output gain to the normal display output gain of the normal imaging mode. When the display output gain is restored to normal any transients in automatic gain controllers L R have died out. Thus when the surgeon switches the imaging mode from the fluorescence imaging mode to the normal imaging mode there is no blooming. Anti bloom process B typically takes between 0.2 and 0.5 seconds to complete and so the display goes momentarily dim and then switches to the normal imaging mode. Typically however the surgeon does not notice the display going momentarily dim and is not distracted by this momentary display change.

The particular time aspects in processes A B depend on the camera control units used the location of output gain control units L R the speed of communication links the processing power of the hardware processor etc. Thus the timing of when the white light source is returned to the normal illumination output level may vary. However in each instance the white light source is returned to the normal illumination output level after the display output gains have been lowered from the normal gain and before the display output gains are returned to the normal gain. Also if the communications with the output gain control units are more rapid the time required for the automatic gain controllers to settle out after the white light source has been restored to the full output level may need to be explicitly accounted for with a timeout timer or some other means.

Thus in one aspect a plurality of programmable time delays are used in processes A B. For example a first programmable time delay and a second programmable time delay are used . In one aspect first and second programmable time delays are storage registers that are set to first and second values respectively during initialization of the process. The values are the delay time periods.

Storage registers are illustrative only and are not intended to be limiting. A storage register is an example of a storage element.

The delay time period of the delay in returning the white light source to the normal illumination output level is determined by first programmable time delay . The delay time period of the delay in switching the viewing mode after returning the white light source to the normal illumination output level is determined by second programmable time delay . The first and second programmable time delays are chosen to provide the appropriate synchronization between left and right camera control units L R and other equipment to eliminate the blooming. Thus either of first and second programmable time delays can be set to zero if the delay is not needed.

In one aspect of the fluorescence imaging mode as discussed above the scene on display includes a simultaneous display of a reflected visible light image of tissue referred to as a backlight image and a separately or simultaneously acquired enhanced image of tissue in the same surgical site. The enhanced image of tissue may be captured with technologies such as but not limited to near infrared NIR fluorescence visible light fluorescence multispectral imaging fluorescence lifetime imaging or a raster scan of non visible light characteristics that contains clinical information with spatial variation. In addition the enhanced image may be of an image constructed by overlaying point measurements of different types of measurable tissue parameters such as tissue impedance point detection of cancer or certain cell types on the clinical white light image.

Generally in this mode of display the backlight image is desaturated toward a grayscale or a black white image that is displayed to the surgeon or clinician instead of a color reflected light image. Desaturation of any image pushes the red green and blue hues towards gray thereby removing color from an image. Enhanced information regarding the clinical image is captured using one or more enhanced imaging techniques and represented in the visible spectrum with one or more colors in registration with the desaturated backlight image.

When the enhanced information typically invisible to the unaided eye is represented in the visible spectrum it is false colored. Examples of false colors also referred to as enhancement colors to color the enhanced images are but not limited to green blue and purple that may be used to represent one or more types of signals in the non visible electromagnetic spectrum detected by the enhanced imaging technology in the enhanced images.

The color version of the enhanced image is registered to the desaturated backlight clinical image and blended with superimposed on or overlaid on top of alternatively referred to as being combined with the desaturated clinical image. The combination of these two images in a blended image is displayed to the surgeon to increase the amount of clinically relevant information and to improve the detectability of low signal levels in the color enhanced images of the surgical site during surgery.

As the backlight clinical image is desaturated the color information in the image is removed but there is little loss in detail. The desaturated clinical image is sufficient to identify anatomy tissue landmarks and surgical instruments so that it allows safe manipulation thereof. Moreover with a desaturated clinical image there is no loss in contrast of the enhanced image due to interference by a color representation of a white light clinical image. The color enhanced image overlaid onto the desaturated clinical image provides improved information content regarding the surgical site to reduce the risk of injury to the patient and improve surgical efficiency. More detail about this mode of display is presented in U.S. patent application Ser. No. 12 575 093 filed Oct. 7 2009 disclosing Methods and Apparatus for Displaying Enhanced Imaging Data on a Clinical Image which is incorporated herein by reference in its entirety.

In the above methods various modules and operations and or processes were described. Each of these operations or processes is part of a module in central controller . While central controller is illustrated as a single structure in this is for ease of illustration only. The elements of central controller are typically distributed throughout system at appropriate locations.

User interface module is used to implement user interface . Imaging mode controller module is used to implement imaging mode controller . Similarly scene anti bloom module is used to implement scene anti bloom process . The modules may be implemented in hardware software that is executed on a processor firmware or any combination of hardware software or firmware. In one aspect scene anti bloom module includes computer executable instructions stored in memory . In this aspect no hardware changes are required to implement scene anti bloom process .

When the modules include one or more instructions stored on a non transitory storage medium the described operations and or processes are the result of retrieval and execution of the one or more instructions on at least one processor in processor module . Herein a processor is a hardware element. The particular modules described are illustrative only and are not intended to be limiting. In view of the disclosure one knowledgeable in the field can combine modules together or separate a module into one or more additional modules.

The above description and the accompanying drawings that illustrate aspects and embodiments of the present inventions should not be taken as limiting the claims define the protected inventions. Various mechanical compositional structural electrical and operational changes may be made without departing from the spirit and scope of this description and the claims. In some instances well known circuits structures and techniques have not been shown or described in detail to avoid obscuring the invention.

Further this description s terminology is not intended to limit the invention. For example spatially relative terms such as beneath below lower above upper proximal distal and the like may be used to describe one element s or feature s relationship to another element or feature as illustrated in the figures. These spatially relative terms are intended to encompass different positions i.e. locations and orientations i.e. rotational placements of the device in use or operation in addition to the position and orientation shown in the figures. For example if the device in the figures is turned over elements described as below or beneath other elements or features would then be above or over the other elements or features. Thus the exemplary term below can encompass both positions and orientations of above and below. The device may be otherwise oriented rotated 90 degrees or at other orientations and the spatially relative descriptors used herein interpreted accordingly. Likewise descriptions of movement along and around various axes include various special device positions and orientations.

The singular forms a an and the are intended to include the plural forms as well unless the context indicates otherwise. The terms comprises comprising includes and the like specify the presence of stated features steps operations elements and or components but do not preclude the presence or addition of one or more other features steps operations elements components and or groups. Components described as coupled may be electrically or mechanically directly coupled or they may be indirectly coupled via one or more intermediate components.

Memory refers to a volatile memory a non volatile memory or any combination of the two. A processor is coupled to a memory containing instructions executed by the processor. This could be accomplished within a computer system or alternatively via a connection to another computer via modems and analog lines or digital interfaces and a digital carrier line.

Herein a computer program product includes a non transitory medium configured to store computer readable code needed for any one or any combination of the operations described with respect to processes A or B in which computer readable code for any one or any combination of operations described with respect to processes A or B is stored. Some examples of computer program products are CD ROM discs DVD discs flash memory ROM cards floppy discs magnetic tapes computer hard drives servers on a network and signals transmitted over a network representing computer readable program code. A tangible non transitory computer program product includes a tangible non transitory medium configured to store computer readable instructions for any one of or any combination of operations described with respect to processes A or B or in which computer readable instructions for any one of or any combination of operations described with respect to the scene anti bloom process A or B are stored. Tangible non transitory computer program products include CD ROM discs DVD discs flash memory ROM cards floppy discs magnetic tapes computer hard drives and other physical non transitory storage mediums.

In view of this disclosure instructions used in any one of or any combination of operations described with respect to the processes A or B can be implemented in a wide variety of computer system configurations using an operating system and computer programming language of interest to the user.

All examples and illustrative references are non limiting and should not be used to limit the claims to specific implementations and embodiments described herein and their equivalents. The headings are solely for formatting and should not be used to limit the subject matter in any way because text under one heading may cross reference or apply to text under one or more headings. Finally in view of this disclosure particular features described in relation to one aspect or embodiment may be applied to other disclosed aspects or embodiments of the invention even though not specifically shown in the drawings or described in the text.

