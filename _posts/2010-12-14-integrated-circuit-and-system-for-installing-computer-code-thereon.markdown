---

title: Integrated circuit and system for installing computer code thereon
abstract: An integrated circuit  is provided, which is configured for authentication itself and technical information concerning the integrated circuit or its installed software to an external computing device . The integrated circuit  comprises a signer  for producing a signature over the information and a challenge using a cryptographic signing key, and a communication module  for providing the information and the signature to the computing device . In response to receiving the information and the authentication, the computing device  may install new application code on the integrated circuit. After the installation, the integrated circuit may authenticate information concerning the new application code to other computing devices. The integrated circuit is advantageously a multiple application smart card, since it allows application providers to obtain trust in the multiple application smart card without having a relationship with its manufacturer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08751811&OS=08751811&RS=08751811
owner: NXP B.V.
number: 08751811
owner_city: Eindhoven
owner_country: NL
publication_date: 20101214
---
This application claims the priority under 35 U.S.C. 119 of European patent application no. 09179104.6 filed on Dec. 14 2009 the contents of which are incorporated by reference herein.

The invention relates to an integrated circuit comprising a communication module for providing information representing technical capabilities of the integrated circuit to a computing device external to the integrated circuit.

The invention further relates to a system for installing application computer code on an integrated circuit.

The invention further relates to a method of providing information representing technical capabilities of an integrated circuit to a computing device external to the integrated circuit a method of installing application computer code on an integrated circuit and a corresponding computer program.

Many companies use integrated circuits e.g. secure microcontroller systems like smart card ICs to deliver services to consumers. Examples are payment cards payment tokens public transport cards Subscriber Identity Module SIM cards for mobile phones health cards etc.

Integrated circuits are often at the heart of commercial applications connected with large financial interest. The integrated circuit comprises confidential proprietary information such as cryptographic keys executable computer code etc stored in a memory of the integrated circuit. Examples include banking applications wherein the integrated circuit is responsible for the authentication of money transfers and content distribution systems wherein the integrated circuit is responsible for restricting access to the content to subscribers to the distribution systems.

For example content distribution may be done over a network comprising multiple set top boxes. In each set top box an integrated circuit typically integrated in a smart card comprises secret cryptographic keys and or secret decrypting algorithms for decrypting content e.g. music movies etc and or decrypting further cryptographic keys. Further cryptographic keys may include for example so called Control Words CW Entitlement Control Messages ECM and Entitlement Management Messages EMM . Further cryptographic keys may be used for increased security and regional control.

Naturally the security of these integrated circuits is important. Persons who try to manipulate integrated circuits in particular smart cards or use information contained thereon in an illegal and or unauthorized manner will be referred to as attackers . If an attacker manages to break the security of an integrated product he may be able to perform or initiate transactions for which he is not authorized.

Today those integrated circuits systems are typically application provider centric. This means that the product is defined and controlled by the application provider and that this entity is also the issuer of the hardware to provide a service e.g. a smart card. Consider a banking card as an example. The issuing bank defines the product including the secure hardware the operating system software as well as the application s being used. The source of all of the components is known to the issuer. Even though the bank did not manufacture the card himself he has selected all the components himself and so has a reasonable basis for trusting the resulting integrated circuit.

However as more and more services require a secure integrated circuit in particular a smart card to obtain access to the service it becomes less viable to use a different smart card for each new application and or service. Integrated circuits in particular a smart cards may be provided to a customer which circuits are configured to receive an application after the circuit has been delivered to the customer.

Examples for such products are NFC enabled mobile phones or smart cards configured for multiple applications. The hardware issuer of these devices is independent of the application provider. In particular the application provider may not have selected the hardware manufacturer himself. The application provider may not even know who manufactured the integrated circuit. Even if the application provider is told who the manufacturer is he does not know if the can trust this information. Typically the application provider has no knowledge about the product details such as hardware details of the circuit which has been provided by the hardware manufacturer.

For example an application provider of some sort e.g. a bank a content provider a loyalty program etc may download an application to an integrated circuit to enable that integrated circuit with new functionality. The new functionality allows the owner of the integrated circuit on which the application is installed access to new services such as banking content and loyalty programs respectively.

When a consumer wants a new service installed in his integrated circuit he may contact a selected application provider. The application provider should enable the new service in the customer s integrated circuit. Before installing a new application on the integrated circuit the application provider would like to know if the customer s integrated circuit is capable of running the new application. For security related services this may include ascertaining that the product is sufficiently secure.

Assuming there are a lot of companies providing products containing integrated circuits on which applications may be installed. The application provider will typically not trust them all. In particular if the application which is to be installed is sensitive security wise he will be hesitant to install his application since he cannot manage the risk. Without installing the new application the integrated circuit does not obtain access to the new service corresponding to it and consequently the application provider is not able to provide the service to the customer.

Various risks are associated with installing an application on untrustworthy hardware. For example an attacker may try to get an application provider to install his application on hardware which is under his control. In particular on hardware that allows the attacker access to the installed application or even on hardware that allows the attacker to modify the installed application.

Although computer application code like cryptographic algorithms which may be embedded in it are typically designed to be robust and secure even when their content is revealed to an attacker in practice it may be wise to make an effort to keep these assets secret. From the moment a cryptographic algorithm such as an encryption decryption signing verifying algorithm etc or computer code such as operating system code device drivers application code access algorithms etc are known to attackers they can start screening the algorithm or code for weaknesses. Cryptographic algorithms may allow cryptographic attacks which were not anticipated by the designer of the algorithms. Software code may comprise faults also known as bugs which can be exploited in order to obtain rights elevation. For example once software code is available it can be screened for so called buffer overflow problems. A buffer overflow problem arises when a temporary buffer is allocated with a smaller size than it is used. As a result an attacker can use such a software fault to overwrite parts of the memory. Although programmers typically strive to avoid programming faults such as buffer overflows they are nevertheless known to happen.

Moreover if an attacker also has the ability to modify the installed application he may be able to circumvent security measures in the application.

For example if an attacker gains read access to an application for a loyalty program he may find weaknesses which allow unauthorized increases in e.g. an allotment of points that can be used for future purchases. If an attacker gains writing access to the application for the loyalty program he may be able to increase the allotment of points directly.

As there are thousands of vendors of consumer products such as mobile phones or PCs and of smart cards such as multiple application cards and white label cards it is very hard for an application provider to verify if his application can run on the consumer products and if the application provider can trust the consumer product.

Problems such as these explain the slow uptake of multiple application smart cards in areas such as banking and content distribution.

It is an object of the invention to provide a mechanism to application providers with which they may obtain some measure of trust in an integrated circuit and or with which they may obtain technical information regarding the integrated circuit.

The integrated circuit according to the invention comprises a communication module for providing information representing technical capabilities of the integrated circuit to a computing device external to the integrated circuit. The integrated circuit further comprises a combiner for combining the information with a cryptographic challenge a key storage comprising a cryptographic signing key and a signer for producing a signature over the combined information and the challenge using the signing key. The providing of the information representing technical capabilities comprises providing the signature to the computing device.

The integrated circuit achieves the object. An application provider who considers installing an application on the integrated circuit can verify the authenticity of the integrated circuit by verifying the signature. Since the signature includes a challenge he is assured that the signature is not merely a replay of old information. The signature was created with a secret key which is known by the integrated circuit. By verifying the signature the application provider can establish that the integrated circuit indeed has access to the secret key. This provides then a measure of trust in the integrated circuit as other integrated circuits do not have access to this key. The application provider also obtains information regarding the integrated circuit s technical capabilities. From this information the application provider can derive at least to some extend if the integrated circuit has technical capabilities which are needed to run his application.

Without using a challenge the signature would still prove the authenticity of the information but with the challenge the signature also proves the authenticity of the hardware.

It is an insight of the inventors that providing authenticity of an integrated circuit and providing technical information concerning the smart card may be combined in a single step. Note that it is not needed to run two separate protocols. Instead a simple protocol having only a query and a response suffices. The application provider or any other party or external computer may simply query the integrated circuit and from the response derive both a measure of trust in the origin and therefore security of the integrated circuit and on the technical information regarding the integrated circuit. This is possible since the integrated circuit comprises a combiner which combines a challenge and the technical information. The challenge provides cryptographic freshness that is a measure of certainty that the message was created for this instance of the protocol and is not a replay of an earlier run of the protocol possibly on a different integrated circuit. Moreover only one signature operation is needed on the integrated circuit to authenticate both the integrated circuit and the information. Signature operations typically consume a relatively large amount of time. In particular on integrated circuits with limited processing capabilities such as smart cards and RFID tags reducing the number of required signatures is considered an important advantage.

An integrated circuit may be any suitable miniaturized electronic circuit comprising semiconductor devices possibly also including passive components. An integrated circuit may be manufactured in the surface of a thin substrate of semiconductor material. Integrated circuits may use semiconductors e.g. those produced using the CMOS technology.

Any integrated circuit according to the invention may be used in a smart card or an RFID tag etc. Smart cards according to the invention may be used in set top boxes mobile phones access systems etc. An RFID Radio frequency identification tag may be used for product identification and or tracking etc. The integrated circuit may be comprised in a Personal digital assistant PDA or in another product providing security features.

An integrated circuit according to the invention may be comprised in a home entertainment system a game console a game controller etc. The integrated circuit may be comprised in a device extension such as a device accessory e.g. an accessory for a phone in particular a smart phone.

The communication module allows digital communication between the integrated circuit and devices outside of the integrated circuit. For example communication module may be arranged for contact and or contact less communication using connector pads and or antenna respectively.

The information representing technical capabilities of the integrated circuit may represent capabilities of the hardware. The information may comprise a fixed string stored in a memory of the integrated circuit. All or part of the information may also be constructed as needed for example by querying hardware and or software subsystems of the integrated circuit. Technical information concerning the integrated circuit may comprise any one of the following 

It is convenient if the integrated circuit provides at least part of the information in a form which is readable by the external computing device without needing to verify the signature. For example the readable part may comprise an indication of the manufacturer of the integrated circuit. The readable part assists in verifying the signature.

The integrated circuit may be queried by a computing device external to the integrated circuit and the integrated circuit may provide its response to typically the same computing device external to the integrated circuit. For example the external computing device may be or comprise a card reader a server a desktop computer a laptop etc.

In an embodiment the integrated circuit comprises an application receiver for receiving application computer code from the external computing device and for installing the received application computer code in integrated circuit. For example the application receiver may be configured for receiving the application computer code after the providing of the signature to the computing device. The application receiver may retrieve the application code from the communication module in the form of a file transfer protocol. The application receiver may be configured for such activities as removing of frames verifying of checksum verifying authenticity discarding padding applying error correcting information etc. After the application receiver has received the application code is ready for installing in a code memory. Installing in a code memory may comprise registering the application with an operating system which is present on the card. For example installing of the application may comprise adding an entry address to a list of application entry addresses.

The combiner for combining the information with the cryptographic challenge may use various combining techniques. Preferably the combiner is configured such that the challenge and or the information are recoverable from the combination. For example the cryptographic challenge may be concatenated with the information. The signature can then be performed over the concatenation. The combiner may also construct a digital data structure in which one or more fields represent the challenge and or more fields represent the information.

The combiner may also combine the information and the challenge such that one or both of the information and the challenge is not recoverable. For example the combiner may compute a hash function such as sha 1 over the challenge and the information. Preferably the hash function is a cryptographic hash function. If the information is not recoverable from the combination then the information may be provided to the external computing device together with the signature. Note that also in this situation only two exchanges are needed between the external computing device and the integrated circuit also only one signature needs to be computed. For example the combiner may comprise a hash module for computing the hash function over the challenge and the information. The combiner may be integrated with the signer.

In an embodiment the challenge may be received from the computing device. This has the advantage that the external computing device can choose its own challenge. He can therefore be sure of the origin of the challenge. For example the computing device may use a random number to generate the challenge. In this case he can trust that the challenge is sufficiently random.

In an embodiment the challenge comprises a timestamp obtained from a clock of the integrated circuit. It is possible that a random challenge especially if it is relatively short may repeat itself. If this happens a replay is possible. By using a clock for the challenge the external computing device may simply compare the challenge with a clock of its own. In this way it is avoided that challenges are re used. Moreover it is also verified that the clock of the integrated circuit is accurate. For example if a digital rights management DRM or content management application will be installed on the integrated circuit an accurate clock is important. If the clock is not accurate time controlled rights cannot be accurately controlled and or executed.

In an embodiment the challenge comprises a nonce obtained from the counter comprised in the integrated circuit nonce being short for number used once . The counter is configured to increase whenever a nonce is obtained. Using a counter also has the advantage that guarantees can be given regarding the nonce s uniqueness at least until the counter rolls over without needing a clock. A clock may require too many gates and moreover permanent power e.g. battery power may not be available. Avoiding a clock is therefore of advantage. Signatures obtained in this embodiment may be verified by a signature verifier external to both the computing device and the integrated circuit. The signature verifier can keep track of the nonces he has seen and make sure that they do not repeat e.g. by making sure that they increase. Roll over of the counter need not be a problem for example the maximum number of times a signature may be requested can be limited. For example the maximum number of applications that can be installed can be limited. The limit may be chosen below the maximum value of the counter.

The cryptographic signing key is a secret key. Nevertheless some trusted parties may know the secret key. For example the secret key may be known to a signature verifier to the integrated circuit manufacturer etc.

In an embodiment the signing key is a private key from a public private key pair. The signing may then use a signature operation known from public private key cryptography also known as asymmetric cryptography. For example the RSA Cryptography Standard PKCS 1 v2.1 gives two examples of a signing verification algorithm based on RSA RSASSA PSS and RSASSA PKCS1 V1.5. For both of these algorithms a signing key is needed. Two key types are employed an RSA public key and an RSA private key. Together the RSA public key and the RSA private key form an RSA public private key pair. A public private key pair is also referred to simply as a key pair. For signing operations the RSA private key is needed. Other signature algorithms using a public private key pair include DSA ECDSA ElGamal signature scheme etc.

The signer is configured for producing a signature using a signature algorithm such as described above. If performance of the signer is important most or even the entire signer may be implemented in hardware. On the other hand the signer may also be implemented using a general purpose processor executing signing software.

An advantage of using an asymmetric signature scheme is that the signature may be verified with a verification key which is different from the signing. The verification key is not necessarily secret since the signing key cannot be derived from the verification key. The signing key is a private key. The verification key is a public key. This gives a key management advantage since security considerations may be relaxed for distribution of the verification key.

In an embodiment the signing key is a symmetric key for use in a symmetric authentication algorithm. The symmetric authentication algorithm is used to generate signature. To verify the signature access to the signing key may be needed. It is preferred to have the signature verification at a centralized location. For example the manufacturer may perform this service or a third party server designated for this purpose. Symmetric signatures need much fewer computation resources. This solution is well suited for application in RFIDs or Smart cards without a cryptographic co processor. Examples of symmetric authentication algorithms include Message authentication codes MACs . A MAC may be based on a block cipher. For example the block cipher may be used in CBC MAC or CMAC mode etc. Examples of block ciphers include DES AES etc. A MAC may be based on a cryptographic hash function for example by using the hash function in HMAC mode. Examples of hash functions include SHA 1 Ripemd sha 256 etc.

The key storage may be a secure key storage. For example key storage may store the secret key in designated EEPROM cells which are optimized regarding security. For example non volatile one time programmable OTP memory may be used for the key storage.

The signer for producing a signature over the combined information and the challenge using the signing key may produce a signature which is separable from the message. That is the integrated circuit may provide to the computing device first digital data comprising the information representing technical capabilities and second digital data comprising the signature. The signer may also produce a signature with message recovery. In that case only the signature needs to be provided to the external computing device. The signature may then be verified to verify authenticity but also the technical information may be recovered from it. When a signature with message recovery is used then preferably also a combiner with recovery is used.

If the challenge is not received from the external computing device it may be provided to the external computing device using any of the mentioned providing ways.

In an embodiment the integrated circuit comprises a code memory for storing computer code and a processing unit for executing code stored in the code memory. The combiner further combines the challenge with computer code information representing technical capabilities of the computer code.

An application provider may also be concerned about an operating system that is installed on the integrated circuit. By signing information of the operating system the application provider also is informed of the trustworthiness of the operating system. The operating system is typically installed on the integrated circuit during manufacture. For example most or all of the software code of the operating system may be installed in the integrated circuit in the form of a read only memory ROM . As the ROM is manufactured together with the hardware it is appropriate to inform the application provider about it. The technical information that may be communicated to the application provider includes the same and or similar information as the information which may be communicated about the hardware itself. For example the technical information about the operating system may include any one of the following 

The operating system id may be a unique id which is stored on the integrated circuit e.g. in a ROM. The operating system id may be queried with a third party server and or the manufacturer to see if that id has indeed been installed on precisely one integrated circuit manufactured by that manufacturer.

In an embodiment the integrated circuit comprises the application receiver is configured for receiving application information from the computing device. The application information may be stored with the application code or in an information memory etc. The combiner is configured for combining a further challenge with the application information after the application computer code has been installed.

A further application provider who wishes to see what applications have been installed in addition to the installed OS and hardware can request information of the application which may have been received by an application receiver. The application information is signed. This tells the application provider that the application was installed with a trusted OS and trusted hardware.

In an embodiment providing the information representing technical capabilities comprises providing a certificate to the computing device for use in verifying the signature wherein the certificate is authenticated and comprises the public key from the public private key pair.

One way to enable the external computing device e.g. the application provider to verify a signature created with a private signing key of the integrated circuit is to provide a certificate. A certificate comprises the public key corresponding to the private key. The certificate is signed by some signing authority or by the manufacturer. For example X.509 certificates may be used. The external computing device may obtain a root certificate such as the certificate of signing authority or of the manufacturer for verifying the certificate of the integrated circuit from a different source.

A further aspect of the invention concerns a system for installing application computer code on an integrated circuit. The system comprises the integrated circuit and the external computing device. The computing device comprises or is connectable to a signature verifier configured for verifying the signature.

In an embodiment of the system the signing key is a symmetric key and wherein the signature verifier is configured to contact a third party server for verifying the signature. The third party server is different from the external computing device. The third party server may be the manufacturer of the integrated circuit. The third party server has access to the symmetric key to verify the signature.

In an embodiment of the system the computing device comprises an information comparator for comparing the information representing technical capabilities received from the integrated circuit with a predetermined set of required technical capabilities the computing device being configured to allow installing application computer code in dependency on the comparison.

For example an application may be written using 8051 assembly. The received technical information may contain information indicating if 8051 assembly can be executed. For example a string may be comprised in the information signaling compatibility with a particular assembly code set. The string may be 8051 . After the computing device received the technical information he may scan it to see if the information signaling compatibility with the needed assembly code set is present. For example the information comparator may scan the information for the string e.g. the string 8051 . If the information is present and if the signature verification algorithm indicates that the signature was valid the computing device may proceed with installing the application.

The information comparator may be integrated in an application uploader of the external computing device. The application uploader is configured for installing on the integrated circuit the application code.

A further aspect of the invention concerns a method of providing information representing technical capabilities of an integrated circuit to a computing device external to the integrated circuit comprising receiving from the computing device a cryptographic challenge combining the information with the challenge and producing a signature over the combined information and the challenge using a cryptographic signing key. Providing the information representing technical capabilities comprises providing the signature to the computing device.

In an embodiment of the method the method comprises verifying the signature by the computing device and installing the application computer code on the integrated circuit.

A method according to the invention may be implemented on a computer as a computer implemented method or in dedicated hardware or in a combination of both. Executable code for a method according to the invention may be stored on a computer program product. Examples of computer program products include memory devices optical storage devices integrated circuits servers online software etc.

In a preferred embodiment the computer program comprises computer program code means adapted to perform all the steps of a method according to the invention when the computer program is run on a computer. Preferably the computer program is embodied on a computer readable medium.

An integrated circuit a system or a method according to the invention allows an application provider to obtain trust in an integrated hardware. By verifying the signature he is assured of the manufacturer of the hardware. That is he knows which manufacturer made the hardware. For example if an application provider determines through the signature that the integrated circuit was made by a particular well known manufacturer known for secure products then the application provider is assured of the high quality of the integrated circuit. Accordingly he will be more prepared to install his application on that device in particular applications which require a high security. Moreover if the information in the signature indicates that the manufacturer also installed an operating system he is further assured that this can be trusted since it was done by a party he trusts.

The hardware vendor is able to prove to application providers the uniqueness and authenticity of the hardware including the contained software configuration OS and optional applications . With that the hardware vendor indicates his trust that the installed operating system was delivered by the designated operating system vendor. The application provider gets to know the OS vendor and can check if the OS is trusted and again is able to see which applications are pre installed and if they are trusted as well.

An integrated circuit may contain a unique asymmetric private key created at hardware production time or at a subsequent wafer test time together with the asymmetric public key that is stored by the hardware vendor. The private key is used to generate the signature of the information from the application provider the application the OS and or the hardware. Through verification of this signature the origin of the secure hardware and therewith the root of trust can be proven at any point in the value chain.

Once applications are loaded into the integrated circuit even while being in the field or in consumer hands the application provider can use an application which was installed earlier as a starting point for the trust creation. As a result the application provider gets definite knowledge that the application is really running on top of a trusted secure hardware executing a trusted operating system.

The combiner may be configured to only use information stored in a read only memory. In that case only information known at manufacturer time e.g. hardware and OS information can be included in the signature. This has the security advantage that an attacker has less possibilities to tamper with the signature mechanism. Configuring the combiner in this way may be hardwired or done in software preferably stored in a read only memory as well.

An integrated circuit is provided which is configured for authentication itself and technical information concerning the integrated circuit or its installed software to an external computing device. The integrated circuit comprises a signer for producing a signature over the information and a challenge using a cryptographic signing key and a communication module for providing the information and the signature to the computing device. In response to receiving the information and the authentication the computing device may install new application code on the integrated circuit. After the installation the integrated circuit may authenticate information concerning the new application code to other computing devices. The integrated circuit is advantageously a multiple application smart card since it allows application providers to obtain trust in the multiple application smart card without having a relationship with its manufacturer.

While this invention is susceptible of embodiment in many different forms there is shown in the drawings and will herein be described in detail one or more specific embodiments with the understanding that the present disclosure is to be considered as exemplary of the principles of the invention and not intended to limit the invention to the specific embodiments shown and described.

System comprises an integrated circuit an external computing device and optionally a third party server . Integrated circuit may be comprised in a smart card an RFID tag a mobile phone a computer etc. Computing device may belong to an application provider and may be used to install applications on integrated circuit .

Computing device and integrated circuit are configured so that computing device may obtain technical information from integrated circuit and may verify the authenticity of integrated circuit .

Integrated circuit comprises a communication module . Computing device comprises a communication module . For example communication module may comprise a card reader and communication module may comprise connector pads. Computing device may comprise a server. Computing device and third party server may be connected with each other through some kind of network e.g. the Internet. Computing device and third party server may communicate using a secure channel e.g. using encryption and authentication mechanism. Communication module may be a passive module allowing computing device to read some of the registers and or memories of integrated circuit . Computing device may be an active module actively sending information to integrated circuit .

Integrated circuit comprises a combiner . Combiner combines information with a cryptographic challenge.

Integrated circuit optionally comprises an information storage for storing the information. For example the information may be stored in information storage during manufacture of integrated circuit . For example information storage may be a ROM. However the information may also be constructed when it is needed. For example combiner may query components of integrated circuit for information concerning their capabilities. Combiner may combine e.g. concatenate the queried and received information.

Computing device optionally comprises a challenger. Combiner may receive the challenge through communication module and communication module from challenger . However combiner may obtain a challenge from a different source. For example integrated circuit may comprise or be connectable to a clock not shown . In that case a time stamp may be used as challenge. For example integrated circuit may comprise a counter not shown which is incremented whenever a signature is produced. For example integrated circuit may comprise a non decreasing counter which provides a single interface which both reads out the counter and increments it.

Combiner is configured for combining a challenge with the information e.g. a challenge from challenger with information from information storage . Combiner may concatenate the information and the challenge for example put the challenge after the information. Combiner may use some other combination function.

Integrated circuit comprises a key storage for storing a cryptographic signing key. For example key storage may comprise non volatile memory e.g. E2PROM memory. For example key storage may comprise secure memory e.g. fuses.

Integrated circuit comprises a signer connected to combiner and key storage . Signer is configured to produce a signature over the combined information and the challenge using the signing key. For example signer may be configured to execute the RSA signing algorithm using an RSA private key on a concatenation of the information and the challenge.

The signature is send to computing device via communication module . Integrated circuit may also send the information. Integrated circuit may also send the challenge. If the signature allows message recovery then integrated circuit does not need to send the information separate from the signature.

If integrated circuit is used for receiving applications then integrated circuit may comprise an application receiver for receiving application computer code and possibly application information from an application uploader . The application uploader may be comprised in computing device . Integrated circuit may also be used for other purposes than receiving new applications. In that case application receiver and application uploader may be omitted. If so desired application uploader may format the application code in a format suitable for uploading to integrated circuit e.g. according to some file transfer protocol.

For example integrated circuit may be used to provide both authenticity of the integrated circuit and authenticated information to an external computing device. For example the integrated circuit may be used only with applications which come pre installed by the manufacturer and may not be able to receive and or install additional applications. In that case computing device may nevertheless need information on the applications which are installed.

Integrated circuit optionally comprises a code memory and a processing unit . Application receiver may then be configured to install the received application computer code in code memory .

Integrated circuit may comprise additional code possibly in code memory or in some other memory of integrated circuit not shown . For example code memory may comprise operating system code. Code memory may comprise applications which were installed previously. The previously installed applications may include applications which were installed during manufacture of . Operating code and or previously installed applications may be installed in ROM. The operating system and the installed applications may also provide information. Combiner may include the information from the operating system and or installed application in the information combined with the challenge.

An additional sign function may be provided by the operating system or an installed application. In this way the OS vendor could also sign the information and signature of the secure hardware manufacturer to indicate that he trusts the secure hardware manufacturer as well and so on. With that a bi directional chain of trust may be created if needed.

For example together with the OS or application code a second signing key e.g. a private key such as a RSA private key may be installed in a read only memory of the integrated circuit during manufacture. The OS or application may comprise signing algorithm code to produce a second signature using the second signing key over the information and or the signature produced by signing key stored in the key storage. The second signature may also be provided to the external computing device. The external computing device can verify both signatures.

Computing device optionally comprises a signature verifier . Alternatively computing device may contact an optional third party server comprising a signature verifier for verification of signatures. For additional assurance both signature verifier and signature verifier may be used but typically only one of signature verifier and signature verifier will be used. If third party server establishes that the signature is genuine he will inform the external computing device that the integrated circuit was indeed manufactured by the claimed manufacturer. If third party server establishes that the signature is forged he will inform external computing device not to install his application on the integrated circuit since he cannot vouch for the authenticity of the integrated circuit.

Third party server may perform additional functions. For example third party server may update a list of all the challenges used by integrated circuit . Third party server is then in a position to see if integrated circuit has re used the same challenge. In the latter situation the computing device may be informed not to upload applications to integrated circuit . If no third party server is used computing device is configured for verifying signatures using signature verifier .

Signature verifiers and use a signature verification algorithm compatible to the signature algorithm used by signer e.g. the RSA public key signature verification algorithm which is compatible with RSA private key signing.

System may also use symmetric algorithms. In that case it is preferred to omit signature verifier and verify the signatures using signature verifier .

One way of using system is as follows. A user of integrated circuit approaches an application provider. For example the customer takes his integrated circuit to a shop to have a loyalty program installed on integrated circuit . The loyalty application may keep track of the amount of money which spent at the shop. Discounts may be available once a certain amount of money has been spent. For example integrated circuit may be integrated in the customer s mobile phone. The store owner that is the application provider did not select the particular brand of mobile phone or SIM the customer is using let alone that the shop owner negotiated their security properties with the mobile phone manufacturer. Moreover the application provider does not know if integrated circuit is capable of running the application.

The computing device of the application provider asks integrated circuit for technical information. For example integrated circuit may have an interface that the application provider can reach. An interface could be a specific command or set of commands but it could also be realized as a specific or even dedicated physical interface. On the level of the operating system an application programming interface API might be defined that can be called by an application running on it. On the hardware of integrated circuit itself also an entry point may be defined so that the operating system can hand over the collected set of information and get back the signed extended set of information. This entry point might be realized as a normal function call into a specific memory area the trigger of a software interrupt or any other method supported by the secure hardware to start the execution etc.

Challenger may create a challenge say a random number say a random 32 bit number and send it to integrated circuit . As an example challenger may produce the hexadecimal number 0x2856a83b. Combiner then combines technical information. Part of the technical information may be stored in a fixed form in information storage part of the technical information may be obtained from the operating system etc. combiner combines the information with the challenge and forwards it to signer . For example the information may be a string. Technical information can also be represented as a bit string wherein a specific individual bit or bits represent the presence or absence of a specific technical feature. For example the string NXP 8051 indicating the manufacturer of the integrated circuit NXP and the type of assembly language that the integrated circuit is compatible with. The string may be also be represented as a hexadecimal number e.g. using ASCII representation. For example the hexadecimal number 4e58502038303531 represents the information string given in the example above. In embodiment using concatenation for combination the combiner may produce the combination 4e585020383035312856a83b . Signer signs the combination using any suitable signing algorithm. The signature and the technical information are then forwarded to computing device . For example the signature and the combination may be sent to the computing device. Combiner may also determine if the operating system of integrated circuit is present in a ROM and include this information in the combination of information and challenge.

Comparing the information representing technical capabilities of the integrated circuit with technical requirements of the application which is to be installed may be performed by an information comparator not separately shown . The information comparator may be integrated in application uploader . For example the information comparator may search the received information possibly after a decryption step for required substrings such as substring 8051 .

Information representing technical capabilities of the integrated circuit comprises information representing technical capabilities of the integrated circuit s hardware and or software installed in a read only memory ROM of the integrated circuit and or software installed in a non volatile memory such as flash memory of the integrated circuit.

Possibly integrated circuit also sends a certificate of its public key to computing device . Computing device uses signature verifier and the certificate to verify the signature. Alternatively computing device may send the data that it received from integrated circuit to third party server . Third party may comprises a list of all public keys used in the field and use that to verify the signature. Integrated circuit may also send an identifier identifying integrated circuit and or its public key to computing device and or third party server . For example the identifying identifier may be a hash of the public key. The identifier may be used as an in index in the list of public keys. If signature verifier or third party server confirms the authenticity of integrated circuit then computing device is assured that the hardware integrated circuit was really made by a known manufacturer which the application provider may trust. Alternatively it may turn out that integrated circuit was made by a manufacturer which is not trusted by the application provider. It may even turn out that integrated circuit is not able to prove its origins. For example it may turn out that the signature is incorrect or that no public key could be found corresponding to the public key identifier. After the application provider is satisfied that the hardware was made by manufacturer that it trusts he may consider the operating system. The operating system of integrated circuit is typically present in a ROM code. If the computing device determines that the information received from integrated circuit comprises the indication that the operating system was installed by the manufacturer of integrated circuit then the application provider may at least be assured that a party that it trusts has installed the operating system. By implication the application provider may also trust the operating system. Even applications installed on top of the operating system also during manufacture of integrated circuit may be trusted. It may be determined from the technical information that in fact they were installed during manufacture.

Applications installed on integrated circuit after manufacture for example using a method according to the invention may also use the mechanism described to make the installed applications known to further applications which are not yet installed. The application provider only receives limited trust in the later installed application since the manufacturer of integrated circuit did not known the contents of that application. But at least the application provider may be assured that the later application was installed with the operating system in a proper way at least up to the point that combiner is able to receive technical information from it.

When the application provider trusts integrated circuit sufficiently he may use the technical information to determine if this application will actually run on integrated circuit . For example if he may verify if the correct assembly language is used if a sufficient amount of memory is free if a co processor is available if the correct operating system is used etc. Note that an application designed for a co processor may work even though integrated circuit does not have the co processor if the operating system simulates the co processor. However an unacceptable loss of performance may result. Accordingly integrated circuit may decide that he is better off not installing the application rather than risk customer complaints. In this case the operating system may show a certain capability say large number arithmetic but since the technical information of the hardware does not show a co processor integrated circuit may still refrain from installing the application.

Once the application provider is satisfied that integrated circuit will be able to run the application application uploader may send the application to application receiver . Application receiver accepts the applications and installs it in code memory . Processing unit is then able to run the application.

If the application included technical information then after this installation combiner is able to combine additional information namely the information corresponding to the application with any further challenges it may receive. A further application provider is then able to see that the application was installed using this mechanism.

For example code in memory executable by processing unit may implement a combiner and a signer. The signing code may make use of the co processor for example to perform large number arithmetic used in some signing algorithms e.g. RSA. Co processor may also provide hardware support for other algorithms in particular cryptographic algorithms such as hashes. Memory may comprise key storage information storage and code memory . Code in memory using the communication element and executable by processing unit may implement application receiver .

Note that integrated circuit may also be implemented entirely in hardware or using a field programmable gate array.

Flow chart element represents receiving from the computing device a cryptographic challenge. Flow chart element represents combining the information with the challenge. Flow chart element represents producing a signature over the combined information and the challenge using a cryptographic signing key. Flow chart element represents providing the signature to the computing device. Flow chart element represents verifying the signature by the computing device. Flow chart element represents installing the application computer code on the integrated circuit.

Many different ways of executing the method are possible as will be apparent to a person skilled in the art. For example in between steps other method steps may be inserted either. The inserted steps may represents refinements of the method such as described herein or may be unrelated to the method. For example steps and may be combined. Moreover a given step may not have finished completely before a next step is started.

A method according to the invention may be executed using software which comprises instructions for causing a processor system to perform method . Software may only include steps taken by an integrated circuit or only those taken by an external computing device or third party server. The software may be stored in a suitable storage medium such as a hard disk a floppy a memory etc. The software may be sent as a signal along a wire or wireless or using a data network e.g. the Internet. The software may be made available for download and or for remote usage on a server.

It will be appreciated that the invention also extends to computer programs particularly computer programs on or in a carrier adapted for putting the invention into practice. The program may be in the form of source code object code a code intermediate source and object code such as partially compiled form or in any other form suitable for use in the implementation of the method according to the invention. It will also be appreciated that such a program may have many different architectural designs. For example a program code implementing the functionality of the method or system according to the invention may be subdivided into one or more subroutines. Many different ways to distribute the functionality among these subroutines will be apparent to the skilled person. The subroutines may be stored together in one executable file to form a self contained program. Such an executable file may comprise computer executable instructions for example processor instructions and or interpreter instructions e.g. Java interpreter instructions . Alternatively one or more or all of the subroutines may be stored in at least one external library file and linked with a main program either statically or dynamically e.g. at run time. The main program contains at least one call to at least one of the subroutines. Also the subroutines may comprise function calls to each other. An embodiment relating to a computer program product comprises computer executable instructions corresponding to each of the processing steps of at least one of the methods set forth. These instructions may be subdivided into subroutines and or be stored in one or more files that may be linked statically or dynamically. Another embodiment relating to a computer program product comprises computer executable instructions corresponding to each of the means of at least one of the systems and or products set forth. These instructions may be subdivided into subroutines and or be stored in one or more files that may be linked statically or dynamically.

The carrier of a computer program may be any entity or device capable of carrying the program. For example the carrier may include a storage medium such as a ROM for example a CD ROM or a semiconductor ROM or a magnetic recording medium for example a floppy disc or hard disk. Furthermore the carrier may be a transmissible carrier such as an electrical or optical signal which may be conveyed via electrical or optical cable or by radio or other means. When the program is embodied in such a signal the carrier may be constituted by such cable or other device or means. Alternatively the carrier may be an integrated circuit in which the program is embedded the integrated circuit being adapted for performing or for use in the performance of the relevant method.

It should be noted that the above mentioned embodiments illustrate rather than limit the invention and that those skilled in the art will be able to design many alternative embodiments without departing from the scope of the appended claims. In the claims any reference signs placed between parentheses shall not be construed as limiting the claim. Use of the verb comprise and its conjugations does not exclude the presence of elements or steps other than those stated in a claim. The article a or an preceding an element does not exclude the presence of a plurality of such elements. The invention may be implemented by means of hardware comprising several distinct elements and by means of a suitably programmed computer. In the device claim enumerating several means several of these means may be embodied by one and the same item of hardware. The mere fact that certain measures are recited in mutually different dependent claims does not indicate that a combination of these measures cannot be used to advantage

