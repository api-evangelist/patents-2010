---

title: Noise removal device and noise removal program
abstract: A noise removal unit  executes noise removal and flooring processing of an input signal, and a density calculating unit  calculates, as to a point of interest on a time-frequency plane of the input signal passing through the noise removal, a density of non-flooring processing points from the presence or absence of the flooring processing of individual points around the point of interest. A partial suppression unit  replaces, when the density is less than a threshold, the power of the point of interest with its flooring value by considering it as a musical noise component, thereby suppressing the musical noise component.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09087518&OS=09087518&RS=09087518
owner: Mitsubishi Electric Corporation
number: 09087518
owner_city: Tokyo
owner_country: JP
publication_date: 20101117
---
The present invention relates to a noise removal device and its program for eliminating musical noise remaining after noise removal.

Voice recognition processing and hands free telephone conversation have a problem in that voice recognition performance and articulation will deteriorate because of noise superposed on voice. To solve the problem various noise removal methods have been proposed. As the most common method a spectral subtraction algorithm referred to as SS algorithm from now on has been known. The SS algorithm estimates a noise spectrum from a non voice section where no voice is present in a voice signal and carries out noise removal by subtracting the estimated noise spectrum from a spectrum of any given frame of the voice signal. However when there is an error between the estimated noise spectrum and actual noise spectrum superposed on the voice signal over subtraction and under subtraction can occur depending on noise frequency. Although backfilling is made by flooring processing for the over subtraction a component of the under subtraction remains as it is. The component of the under subtraction is perceived as artificial sounds called musical noise which results in deterioration in the recognition performance and articulation.

As for the foregoing approach 1 since the noise is subtracted greatly even in a voice section the voice spectrum undergoes distortion which has an adverse effect on the voice recognition performance. As for the foregoing approach 2 although various methods have been proposed the noise superposed on a frame is basically unknown and the error cannot be made zero. As for the foregoing approach 3 a conventional method is known which calculates a power ratio of regions near a point of interest on a time frequency plane and eliminates a musical noise component see Non Patent Document 1 for example . More specifically it calculates cumulative power A of a region enclosed by a distance N from the point of interest on the time frequency plane and cumulative power B of a region enclosed by a distance M N

Non Patent Document 1 Gary Whipple Low Residual Noise Speech Enhancement Utilizing Time Frequency Filtering ICASSP94 1994.

With the foregoing configuration the conventional musical noise eliminating method has a problem in that when power fluctuations of the noise is large and hence power fluctuations of the under subtraction component is large an estimate error of the noise spectrum occurs and as a result the musical noise component is left as it is without being eliminated or a point to be considered as the voice component is eliminated as the musical noise component.

In addition after eliminating the musical noise component since the power in the region near the point of interest becomes zero a problem occurs in that temporal discontinuity occurs.

The present invention is implemented to solve the foregoing problems. Therefore it is an object of the present invention to suppress the musical noise component by appropriately discriminating it even when the power fluctuations of noise are large and hence the power fluctuations of the under subtraction component also are large and to avoid the temporal discontinuity by suppressing the musical noise component using a flooring value.

A noise removal device in accordance with the present invention comprises a noise estimating unit for estimating noise superposed on an input signal a noise removal unit for eliminating the noise superposed on the input signal and for executing flooring processing by using statistics of the noise the noise estimating unit estimates a density calculating unit for calculating with respect to a point of interest on a time frequency plane of the input signal from which the noise is removed a designated density of individual points around the point of interest and a partial suppression unit for replacing when the density of the point of interest on the time frequency plane is less than a threshold the power of the point of interest with a flooring value the noise removal unit uses in the flooring processing.

A noise removal program in accordance with the present invention causes a computer to function as a noise estimating step of estimating noise superposed on an input signal a noise removal step of eliminating the noise superposed on the input signal and for executing flooring processing by using statistics of the noise the noise estimating step estimates a density calculating step of calculating with respect to a point of interest on a time frequency plane of the input signal from which the noise is removed a designated density of individual points around the point of interest and a partial suppression step of replacing when the density of the point of interest on the time frequency plane is less than a threshold the power of the point of interest with a flooring value the noise removal step uses in the flooring processing.

According to the present invention since it is configured in such a manner as to calculate with respect to the point of interest on the time frequency plane of the input signal from which the noise is removed the designated density of the individual points around the point of interest and to replace when the density is less than the threshold the power of the point of interest with the flooring value it can appropriately discriminate and suppress the musical noise component even if the power fluctuations of noise is large and hence the power fluctuations of an under subtraction component is large. In addition since it suppresses the musical noise component using the flooring value it can prevent temporal discontinuity from occurring.

The best mode for carrying out the invention will now be described with reference to the accompanying drawings to explain the present invention in more detail.

The noise estimating unit estimates a noise spectrum superposed on the input signal calculates statistics of the estimated noise spectrum and updates them and supplies to the noise spectrum memory . The noise spectrum memory is a storage for storing the statistics of the estimated noise spectrum supplied from the noise estimating unit . The noise removal unit acquires the statistics of the estimated noise spectrum from the noise spectrum memory subtracts from the spectrum of the input signal carries out flooring processing for preventing excessive subtraction and supplies a flooring value and the presence or absence of the flooring processing for each time frequency to the flooring value memory .

The density calculating unit acquires and binarizes information about the presence or absence of the flooring for each time frequency from the flooring value memory calculates the density of the point of interest on the time frequency plane spectrogram by obtaining a product sum with the weight function and supplies the density to the partial suppression unit . The partial suppression unit compares the density supplied from the density calculating unit with a threshold and replaces the power of the point of interest less than the threshold by the flooring value the flooring value memory stores thereby suppressing the musical noise component.

As for a voice part and a non voice part in the input signal since the frequency of occurrence of the flooring in the surrounding grid of the point of interest differ significantly it is possible to calculate the density of the non flooring processing points in the surrounding grid and to discriminate the point of interest less than the threshold as the musical noise component.

Incidentally the noise removal device can be configured as hardware consisting of the noise estimating unit noise spectrum memory noise removal unit flooring value memory density calculating unit and partial suppression unit arranged as a dedicated circuit each or can be configured as a combination of a control circuit consisting of a general purpose CPU Central Processing Unit or the like with a computer program. When constructing the noise removal device from a computer it is enough that a noise removal program describing the processing contents of the noise estimating unit noise spectrum memory noise removal unit flooring value memory density calculating unit and partial suppression unit is stored in a memory of the computer and the control circuit such as a general purpose CPU of the computer executes the noise removal program stored in the memory.

Furthermore it goes without saying that a change of design and the like within the scope of the substance of the present invention is included in the present invention.

First the operation of the noise estimating unit will be described. is a flowchart showing the operation of the noise estimating unit shown in . The noise estimating unit calculates the mean value f and standard deviation f of the estimated noise spectrum with a frequency number f in the following procedure.

First the noise estimating unit cuts out frames with a sample frame number NFRAME from the input signal as a sample step ST . Subsequently the noise estimating unit applies a windowing function such as a Hanning window to the cut out N frames step ST and carries out an FFT Fast Fourier Transform with the number of points of N FFT step ST .

Subsequently the noise estimating unit sets the frequency number f at zero step ST and compares the frequency number f with the number of FFT points N FFT step ST . If the frequency number f is less than the number of FFT points N FFT YES at step ST the processing proceeds to step ST otherwise NO at step ST the processing is terminated.

Subsequently if the frame number t is less than the initialized frame number INIT FRAME or if the condition of the following Expression 1 is satisfied at step ST YES at step ST the noise estimating unit proceeds to step ST otherwise NO at step ST it proceeds to step ST. 

Incidentally the initialized frame number INIT FRAME is the frame number for learning the initial values of the mean value f and standard deviation f . When the foregoing Expression 1 is satisfied although the noise estimating unit updates the mean value f and standard deviation f successively as will be described below it must learn the initial values of the mean value f and standard deviation f using a certain number of frames.

When used for the purpose of voice recognition and telephone conversation since there is a speech pause section of some extent from the start of the noise removal device to actual utterance the initial learning becomes possible by setting the initialized frame number INIT FRAME at an appropriate value.

Subsequently the noise estimating unit updates the mean value f and standard deviation f according to the following Expressions 2 8 at step ST.

Subsequently the noise estimating unit increments the frequency number f by one at step ST returns to step ST again and executes the processing with the next frequency number f.

Through the foregoing processing the noise estimating unit calculates the mean value f and standard deviation f which are the statistics of the estimated noise spectrum and causes the noise spectrum memory to store these values.

Next the operation of the noise removal unit will be described. is a flowchart showing the operation of the noise removal unit shown in . The noise removal unit acquires the mean value f and standard deviation f from the noise spectrum memory and removes the noise from the input signal through the following procedure.

First the noise removal unit sets the frequency number f at zero step ST and compares the frequency number f with the number of FFT points N FFT step ST . When the frequency number f is less than the number of FFT points N FFT YES at step ST the processing proceeds to step ST otherwise NO at step ST the processing is terminated.

Subsequently the noise removal unit eliminates noise using the SS algorithm at step ST that is removes stationary noise from the input signal according to the following Expression 9 and backfills the over subtraction using the flooring processing. P t f is the power spectrum of the input signal from which the stationary noise is removed. MAX 9 where is a subtraction coefficient for designating by what factor the estimated noise spectrum should be multiplied when subtracted from the spectrum of the input signal and is a flooring coefficient for preventing excessive subtraction that is over subtraction .

Subsequently if the condition of the following Expression 10 is satisfied at step ST that is if the flooring does not occur in the spectrum after removing the stationary noise YES at step ST the noise removal unit proceeds to step ST otherwise NO at step ST it proceeds to step ST. 10 

When the flooring does not occur the noise removal unit substitutes values into the non flooring flag g t f and into the backup B t f of the flooring value according to the following Expressions 11 and 12 at step ST. 1 11 12 

On the other hand when the flooring occurs the noise removal unit substitutes values into the non flooring flag g t f and into the backup B t f of the flooring value according to the following Expressions 13 and 14 at step ST. 0 13 14 

Subsequently the noise removal unit increments the frequency number f by one at step ST returns to step ST again and executes the processing of the next frequency number f.

Through the foregoing processing the noise removal unit eliminates the noise superposed on the input signal and backfills the over subtraction component through the flooring processing. Furthermore to suppress the musical noise component which is the under subtraction component it causes the flooring value memory to store the backup B t f of the flooring value which is the flooring value at the noise removal and the non flooring flag g t f indicating the presence or absence of the flooring.

Next the operation of the density calculating unit will be described. is a flowchart showing the operation of the density calculating unit shown in . The density calculating unit acquires the non flooring flag g t f from the flooring value memory and calculates the density through the following procedure.

First the density calculating unit sets the frequency number f at a neighborhood number L that represents the size of the grid used for the density calculation step ST and compares the frequency number f with a variable N FFT L obtained by subtracting the neighborhood number L from the number of FFT points step ST . If the frequency number f is less than the variable N FFT L YES at step ST the processing proceeds to step ST otherwise NO at step ST the processing is terminated.

Subsequently the density calculating unit calculates the density D t f from the non flooring flag g t f according to the following Expression 15 at step ST.

Subsequently the density calculating unit increments the frequency number f by one at step ST returns to step ST again and executes the processing of the next frequency number f.

Through the foregoing processing the density calculating unit calculates the density D t f and supplies it to the partial suppression unit .

As the weight function various functions are applicable depending on purposes or operating environments. is a diagram showing weight of each point within the grid when the neighborhood number L 3 and the weight function w l l 1. The case is equivalent to the case where the number of points that are not subjected to the flooring within the grid of 2L 1 2L 1 whose center is the point of interest t f solid circle in is counted and is considered to be the simplest weight function.

On the other hand is a diagram showing the weight of each point in the grid when the neighborhood number L 3 and the weight function w l l is given by the following Expression 16 . Here dis is the urban distance from the point of interest t f solid circle in at the center of the grid. In the case shown in since the weight increases as the distance from the point of interest reduces even if the number of points that are not subjected to the flooring in the grid with 2L 1 2L 1 is the same if these points center round the point of interest it offers an advantage of increasing the density. 2 2 16 

Next the operation of the partial suppression unit will be described. is a flowchart showing the operation of the partial suppression unit shown in . The partial suppression unit acquires the non flooring flags g t f and the backup values B t f of the flooring values from the flooring value memory and the densities D t f supplied from the density calculating unit and suppresses the musical noise components of the input signal from which the stationary noise is eliminated by the noise removal unit through the following procedure.

First the partial suppression unit sets the frequency number f at the neighborhood number L step ST and compares the frequency number f with the variable N FFT L step ST . If the frequency number f is less than the variable N FFT L YES at step ST the processing proceeds to step ST otherwise NO at step ST the processing is terminated.

Subsequently if the non flooring flag g t f is 1 and the density D t f is less than the threshold THat step ST YES at step ST the partial suppression unit decides that the power spectrum P t f of the input signal after the stationary noise removal is a musical noise component and proceeds to step ST otherwise NO at step ST proceeds to step ST.

If the non flooring flag g t f is 1 and the density D t f is less than the threshold TH the partial suppression unit substitutes the backup value B t f of the flooring value for the power spectrum P t f at step ST.

Subsequently the partial suppression unit increments the frequency number f by one at step ST returns to step ST again and executes the processing of the next frequency number f.

Through the foregoing processing the partial suppression unit suppresses the musical noise component.

As described above according to the embodiment 1 the noise removal device is configured in such a manner as to comprise the noise estimating unit for estimating the noise superposed on the input signal the noise spectrum memory for storing statistics of the noise the noise removal unit for eliminating the noise superposed on the input signal using the statistics of the noise and for executing the flooring processing the flooring value memory for storing the flooring value for each time frequency and the flag indicating the presence or absence of the flooring processing the density calculating unit for calculating with respect to the point of interest on the time frequency plane of the input signal from which the noise is removed the density of the non flooring processing points from the flag indicating the presence or absence of the flooring processing of each point around the point of interest and the partial suppression unit for substituting when the density of the point of interest is less than the threshold the flooring value for the power of the point of interest. Accordingly compared with the conventional method and the like it can discriminate the musical noise component and suppress it appropriately even if the power fluctuations of noise are large and hence the power fluctuations of the under subtraction component are large. In addition by suppressing the musical noise component using the flooring values it can prevent the temporal discontinuity from occurring in the signal.

The local SNR memory is a storage unit for storing a frame number t the noise removal unit outputs and the value of a local SNR signal to noise ratio with a frequency number f referred to as the local SNR value from now on .

In the spectrogram a region where parts with high local SNR values are dense is very likely to be a voice component whereas the remaining region is very likely to be a noise component. Accordingly whether it is a musical noise component or not can be discriminated by calculating the density of the local SNR values and by deciding on whether the parts with the high local SNR values are dense or not.

Next the operation of the noise removal device will be described. Incidentally the operation of the noise removal unit local SNR memory and density calculating unit will be described here and the description of the operation of the remaining components will be omitted because it is the same as that of the foregoing embodiment 1.

Next the operation of the density calculating unit will be described. is a flowchart showing the operation of the density calculating unit shown in . It differs from that of the foregoing embodiment 1 in that at step ST it acquires the local SNR values r t f from the local SNR memory and calculates the density D t f of the local SNR values of the individual points around the point of interest according to the following Expression 18 . The partial suppression unit in the following state compares the density D t f with the threshold TH and makes a decision of a voice component when the density D t f is not less than the threshold TH that is a region where parts with high local SNR values are dense and a decision of a musical noise component when it is less than the threshold TH.

In addition it goes without saying that a method of binarizing the local SNR value r t f to 1 when it is not less than a particular reference value and to 0 when it is less than the particular reference value followed by calculating the density D t f according to the foregoing Expression 18 is within the scope of the present invention.

As described above according to the embodiment 2 the noise removal device is configured in such a manner that it newly comprises the local SNR memory for retaining the local SNR values of a single frequency component with the frame number t and frequency number f that the density calculating unit calculates as to the point of interest on the time frequency plane of the input signal from which the noise is removed the density of the local SNR values of the individual points around the point of interest and that the partial suppression unit replaces the power of the point of interest with the flooring value the noise removal unit uses in the flooring processing when the density of the point of interest is less than the threshold. As a result as the foregoing embodiment 1 the present embodiment 2 can appropriately discriminate and suppress the musical noise component even when the power fluctuations of noise are large and hence the power fluctuations of the under subtraction component are large. In addition by suppressing the musical noise component using the flooring value it can prevent the temporal discontinuity from occurring in the signal.

The global SNR estimating unit estimates a global SNR of the input signal and supplies it to the threshold selecting unit .

Here the difference between the global SNR and the local SNR described in the foregoing embodiment 2 will be described. Although the local SNR is an SNR calculated from the single frequency component as shown in the foregoing Expression 17 the global SNR is an SNR of the entire input signal calculated from a plurality of frequency components or prescribed upper and lower limit frequency components .

The threshold memory is a storage unit for storing a global SNR threshold correspondence table that determines correspondence between the global SNR and threshold. The threshold selecting unit selects the threshold corresponding to the global SNR estimate the global SNR estimating unit outputs by referring to the global SNR threshold correspondence table of the threshold memory . Incidentally the global SNR threshold correspondence table has been prepared for each global SNR by determining thresholds that will give optimum discriminating performance in the partial suppression unit by using data for learning in advance.

The threshold the threshold selecting unit selects is supplied to the partial suppression unit and the partial suppression unit uses as the threshold TH.

Next the operation of the noise removal device will be described. Incidentally the operation of the global SNR estimating unit and threshold selecting unit will be described here and the operation of the remaining portion will be omitted because it is the same as that of the foregoing embodiment 1.

Subsequently referring to the global SNR threshold correspondence table in the threshold memory at step ST the threshold selecting unit selects the threshold TH SNR t corresponding to the global SNR estimate SNR t the global SNR estimating unit estimates and substitutes it into the threshold TH.

According to the foregoing processing the threshold THused for the partial suppression processing by the partial suppression unit is determined.

As described above according to the embodiment 3 the noise removal device is configured in such a manner that it comprises the global SNR estimating unit for estimating a global SNR of the input signal the threshold memory for retaining the thresholds corresponding to the global SNR estimates and the threshold selecting unit for selecting from the threshold memory the threshold corresponding to the global SNR estimate the global SNR estimating unit estimates and that the partial suppression unit makes a decision on whether to substitute the flooring value for the musical noise component by using the threshold the threshold selecting unit selects. As a result it can select the optimum threshold in accordance with the global SNR estimate of the input signal. Accordingly it can prevent a failure to suppress the musical noise when the global SNR estimate is low and the mis suppression of a voice component when the global SNR estimate is high thereby being able to suppress the musical noise correctly.

Incidentally although the example of applying the embodiment 3 to the embodiment 1 is described above it is not limited to the example but is also applicable to the embodiment 2.

Although the noise removal device of the embodiment 3 is configured in such a manner as to select the optimum threshold THin accordance with the global SNR estimate the noise removal device of the present embodiment 4 is configured in such a manner as to select optimum values corresponding to the global SNR estimate with respect to the weight function w l l and neighborhood number L at the density calculation.

Referring to a global SNR neighborhood number weight function threshold correspondence table in the weight function memory the weight function selecting unit selects the neighborhood number weight function and threshold corresponding to the global SNR estimate the global SNR estimating unit outputs. The weight function memory is a storage unit for storing the global SNR neighborhood number weight function threshold correspondence table and the table is prepared in advance by determining using data for learning the neighborhood number weight function and threshold which will provide the optimum discriminating performance to the density calculating unit and partial suppression unit for each global SNR.

Next the operation of the noise removal device will be described. Incidentally the operation of the weight function selecting unit will be described here and as for the operation of the remaining portions since it is the same as that of the foregoing embodiments 1 and 3 its description will be omitted.

Subsequently the weight function selecting unit selects at step ST the weight function W l l corresponding to the global SNR estimate SNR t and substitutes it for the weight function W l l . Here it is assumed that L l L L l L.

Subsequently the weight function selecting unit selects at step ST the threshold TH SNR t corresponding to the global SNR estimate SNR t and substitutes it for the threshold TH.

Through the foregoing processing the neighborhood number L and weight function w l l the density calculating unit uses for the density calculation processing and the threshold THthe partial suppression unit uses for the partial suppression processing are decided.

As described above according to the embodiment 4 the noise removal device has a configuration that comprises the global SNR estimating unit for estimating the global SNR of the input signal the weight function memory for retaining the weight functions and thresholds each corresponding to the global SNR estimate and the weight function selecting unit for selecting from the weight function memory the weight function and threshold corresponding to the global SNR estimate the global SNR estimating unit estimates in which the density calculating unit assigns a weight to the flag indicating the presence or absence of the flooring using the weight function the weight function selecting unit selects and the partial suppression unit decides whether to substitute the flooring value for the musical noise component or not using the threshold the weight function selecting unit selects. Thus it can select the optimum neighborhood number and weight function in accordance with the global SNR estimate of the input signal. Accordingly it can make a decision of the musical noise component by emphasizing the more global information when the global SNR estimate is low and by emphasizing the more local information when the global SNR estimate is high thereby being able to improve the discriminating accuracy. In addition as for the effect of using the threshold it is the same as described in the foregoing embodiment 3.

Incidentally although the example of applying the embodiment 4 to the embodiment 3 is described above it is not limited to the example but is applicable to the embodiment 2 as well.

In addition a configuration is also possible in which the weight function selecting unit selects only the weight function and the density calculating unit assigns weights to the flags indicating the presence or absence of the flooring using the weight function. In this case as for the threshold the partial suppression unit uses for making decision of the musical noise component it can be any given value.

Although the noise removal devices of the foregoing embodiments 1 4 are not limited to any particular purposes they are particularly useful for improving the voice recognition performance or telephone conversation quality under a noisy environment in apparatuses such as a car navigation system cellular phone and information terminal.

