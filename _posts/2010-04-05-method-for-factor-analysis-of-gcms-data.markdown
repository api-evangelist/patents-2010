---

title: Method for factor analysis of GC/MS data
abstract: The method of the present invention provides a fast, robust, and automated multivariate statistical analysis of gas chromatography/mass spectroscopy (GC/MS) data sets. The method can involve systematic elimination of undesired, saturated peak masses to yield data that follow a linear, additive model. The cleaned data can then be subjected to a combination of PCA and orthogonal factor rotation followed by refinement with MCR-ALS to yield highly interpretable results.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08266197&OS=08266197&RS=08266197
owner: Sandia Corporation
number: 08266197
owner_city: Albuquerque
owner_country: US
publication_date: 20100405
---
This application is a continuation in part of application Ser. No. 11 233 223 filed Sep. 22 2005 now U.S. Pat. No. 7 725 517 which claims the benefit of U.S. Provisional Application No. 60 614 867 filed Sep. 29 2004 both of which are incorporated herein by reference.

This invention was made with Government support under contract no. DE AC04 94AL85000 awarded by the U.S. Department of Energy to Sandia Corporation. The invention was made with the support of the U.S. Department of Homeland Security through interagency agreement no. HSHQDC 10 00041 with the U.S. Department of Energy. The Government has certain rights in the invention.

The present invention relates to spectral image analysis and in particular to a method for factor analysis of gas chromatography mass spectroscopy GC MS data.

Several full spectrum imaging techniques have been introduced in recent years that promise to provide rapid and comprehensive chemical characterization of complex samples. These spectroscopic imaging techniques include Electron Probe Microanalysis EPMA Scanning Electron Microscopy SEM with attached Energy Dispersive X Ray Spectrometer EDX X Ray Fluorescence XRF Electron Energy Loss spectroscopy EELS Particle Induced X ray Emission PIXE Auger Electron Spectroscopy AES gamma ray spectroscopy Secondary Ion Mass Spectroscopy SIMS X Ray Photoelectron Spectroscopy XPS Infrared Spectroscopy IR Raman Spectroscopy Magnetic Resonance Imaging MRI scans Computerized Axial Tomography CAT scans IR reflectometry Mass Spectrometry MS multidimensional chromatographic spectroscopic techniques hyperspectral remote imaging sensors etc. These new spectroscopic imaging systems enable the collection of a complete spectrum at each point in a 1 2 or 3 dimensional spatial array. It is not uncommon that these spectral image data sets comprise tens of thousands of individual spectra or more.

One of the remaining obstacles to adopting these techniques for routine use is the difficulty of reducing the vast quantities of raw spectral data to meaningful chemical information. Multivariate factor analysis techniques have proven effective for extracting the essential chemical information from high dimensional spectral image data sets into a limited number of components that describe the spectral characteristics and spatial distributions of the chemical species comprising the sample. In mathematical terms given an m pixel n channel matrix of spectral data D we wish to approximate D by the matrix factorization 1 Here C is an m pixel p component matrix describing the distribution of the pure components at each spatial location and S is an n channel p component matrix representation of the pure component spectra. In the typical case that p

It is well known however that factor based methods suffer from a rotational ambiguity. Given any invertible p p transformation matrix R D can be equally well expressed as 2 That is an infinite number of rotated factor pairs and will provide equally good fits to the data. The key to deriving relatively unique factors then is to select those factor solutions that satisfy additional optimization criteria. Thus physically inspired constraints are often employed to derive relatively unique factor models that make the pure components more easily interpretable. In general one would expect that the extent to which these criteria or constraints actually reflect the physical reality of a given sample the higher the fidelity and reliability of the derived components.

Principal Component Analysis PCA used either by itself or to preprocess data is the most ubiquitous tool of factor analysis. The constraints imposed by PCA are that the spectral and concentration factors must contain orthogonal components and that the components serially maximize the variance in the data that each accounts for. Neither constraint has any basis in physical reality thus the factors obtained via PCA are abstract and not easily interpreted. Alternating Least Squares based Multivariate Curve Resolution MCR ALS is another common factorization method used for spectral image analysis. This technique may force spectra and concentrations to be non negative for instance yielding more physically realistic pure components. There are many cases however in which those constraints are not effective and where alternative approaches may provide new analytical insights.

For many cases of practical importance imaged samples are simple in the sense that they consist of relatively discrete chemical phases. That is at any given location only one or a few of the chemical species comprising the entire sample have non zero concentrations. In the limiting case that each location has only a single chemical component having non zero concentration the sample is said to be perfectly simple. The methods of the present invention exploit this simplicity to make the resulting factor models more realistic. Therefore more physically accurate and interpretable spectral and abundance components can be extracted from spectral images that have spatially simple structure.

In the present invention the methods for spectral image analysis by exploiting spatial simplicity as described in application Ser. No. 11 233 223 are adapted to provide a method for the fast robust and automated multivariate statistical analysis of gas chromatography mass spectroscopy GC MS data sets. The method can involve systematic elimination of undesired saturated peak masses to yield data that follow a linear additive model. The cleaned data can then be subjected to a combination of PCA and orthogonal factor rotation followed by MCR ALS refinement to yield highly interpretable results.

The present invention is directed a method for factor analysis of GC MS data comprising measuring a mass charge m z spectrum of a sample with a gas chromatograph mass spectrometer GC MS whereby the spectrum is represented a matrix of GC MS data factoring the data matrix into the product orthogonal scores vectors representing mass spectral space and orthonormal loading vectors representing chromatographic space using Principal Component Analysis PCA and rotating the PCA solution to provide more realistic factors. In general the pseudorank of the PCA solution can be selected to represent the number of chemically meaningful species in the sample. During the phase of acquiring the m z spectrum selective ion depletion of peaks can be used to eliminate one or more dominant species in the sample. Prior to factorization the GC MS data can be scaled so that it approximates the assumptions in the PCA factorization. The rotated PCA solution can be further refined for example using constrained alternating least squares to provide even more realistic mass spectral and chromatographic factors.

In general an image can comprise any arbitrary multidimensional array of points. The image can include a spatial dimension such as lines traditional 2D images or 3D volumes or a temporal dimension such as a time series of images. For example in the case of Energy Dispersive X ray EDS images the spatial dimension is a 2D pixel array. In the case of a GC MS image the temporal dimension is a separation coordinate. The description that follows will begin with a description of a generalized multivariate image analysis method as applied to a spatial dimension. This generalized method is described more fully in U.S. application Ser. No. 11 233 223 which is incorporated herein by reference. This general description is then followed by a detailed description of an application of the method to the factor analysis of GC MS data comprising a temporal dimension or chromatographic separation coordinate.

Multivariate spectral analysis can be performed on a full spectrum image that can be represented as a two dimensional data matrix D. The two dimensional data matrix D can be obtained by unfolding a measured multidimensional spectral data set. For example the multidimensional spectra data set can be a data cube that comprises a 1D spectrum at each pixel on a 2D spatial grid corresponding to the X Y coordinates of the pixel s location. The 2D data matrix D enables the easy and efficient use of standard linear algebra and matrix operations.

The data matrix D can be factored into the product of two matrices C and S according to Eq. 1 where D has dimensions of m n and m is the number of pixels and n is the number of spectral channels. The matrix C is a concentration matrix which is related to the concentration of the chemical phases e.g. a matrix representing a map of the pure component abundances and has dimensions of m p where p is the number of pure components. The matrix S is a spectral shapes matrix which contains information about the spectral shapes of the pure chemical components e.g. a matrix of the pure component spectra . S has dimensions n p.

The factorization of Eq. 1 can be accomplished by an image analysis of D. A number of prior image analysis methods are described in U.S. Pat. Nos. 6 584 413 and 6 675 106 to Keenan and Kotula which are incorporated herein by reference. A spectral image factorization method based on PCA has also been described. See M. R. Keenan and P. G. Kotula 36 203 2004 which is incorporated herein by reference.

If desired the measured data matrix D can be weighted depending on the type of experiment being analyzed and depending on the properties of the noise or background signal generated during data acquisition. Weighting is generally used whenever the properties of the noise are not uniform throughout the measurement space i.e. heteroscedastic noise . This is particularly true in the case of counting experiments in which the noise is characterized as following a Poisson probability distribution in which the magnitude of the uncertainty varies with the magnitude of the signal. For multi channel data acquisition the noise is not characterized by a single probability distribution but rather by a distribution whose parameters will in principle differ from channel to channel and from pixel to pixel within a channel. Additionally heteroscedasticity can also arise from other effects e.g. non uniform detector responses or mathematical transformations applied to the data e.g. taking logarithms .

Weighting is also useful when there is a large disparity between the total number of counts e.g. observations arising from different elements or phases e.g. a sample comprising a small amount of contaminant located on top of a substrate made of a single material . Weighting therefore is useful for accurately identifying minor phases trace elements or subtle gradients in composition across a sample. By properly accounting for experimental noise characteristics chemically relevant features having small numbers of counts can become more significant in a least squares sense than large magnitude noise associated with major spectroscopic features.

Therefore data matrix D can be weighted to create a weighted data matrix tilde over D according to 3 where G is a pre multiply weighting matrix having dimensions m m and H is a post multiply weighting matrix having dimensions n n. In general G is used to weight the row space of D and H is used to weight the column space of D. Obviously the weighting matrices G and H can be the identity matrix if no weighting is desired.

The matrix G can be used to account for unequal variance in the observations from pixel to pixel independent of channel number i.e. energy or wavelength . For example weighting by G could be used in the case where there are hot or dead pixels or if there was an array detector where different detector elements had different noise properties. Weighting by G also could be used in the situation where there were much higher total counts in some pixels as compared to others caused for example by unequal dwell times. The matrix H can account for unequal variance in the observations from channel to channel independent of pixel location. For example weighting by H could be used when the noise level varies from one energy channel to the next.

Spectral image analysis of the weighted data matrix tilde over D yields tilde over C GC which is the weighted concentration matrix and tilde over S SH which is the weighted spectral shapes matrix. The corresponding unweighted concentrations and spectra can be recovered as C Gtilde over C and S tilde over S H respectively. For simplicity the analysis of the unweighted data matrix D will be described hereinafter although it will be understood that the method of the present invention can also be applied to the weighted data matrix.

PCA is one of the core techniques of multivariate statistical analysis and it has been employed in numerous and diverse applications including dimensional reduction data compression exploratory data analysis factor analysis pattern recognition classification and multivariate calibration. In particular PCA can be used in the analysis of hyperspectral image data. See P. Geladi and H. Grahn Wiley Chinchester UK 1996 .

The goal of PCA is to extract the useful information in a high dimension data set into a lower dimension subspace. From a geometric point of view PCA begins by finding that single direction in the n dimensional space that best describes the location of the data. The vector describing that direction is the first principal component. Once found a second direction orthogonal to the first is determined that best accounts for the variation in the data that is orthogonal to the first. This is the second principal component. The process continues with each new principal component maximally accounting for the variation in the data that is orthogonal to all preceding components. The first few principal components will contain the chemical information of interest. If there are p such principal components the remaining n p principal components are assumed to describe experimental noise or error. Limiting further analysis to the p dimensional subspace defined by the first p principal components provides the desired dimensional reduction and data compression.

In matrix terms PCA is concerned with factoring a data matrix D into the product of two other matrices a scores matrix T whose columns are mutually orthogonal and a matrix P of orthonormal loading vectors according to 4 To take a spectroscopic example the loading vectors P describe the spectral characteristics of the chemical constituents of a sample and the scores T are related to their concentrations. The data set is then seen to be described as a linear combination of basis spectra. An alternative point of view can be obtained by performing PCA on the transposed data matrix D 5 In this case the orthonormal loading vectors describe the spatial or abundance characteristics of the data and the scores are related to the spectra. The data is now being represented as a linear combination of basis images. These two approaches are dual and the respective loading vectors span the same space namely that of the spectral data.

The close connection between these two points of view can be made apparent by considering singular value decomposition SVD of the data a method that is often used to compute PCA. SVD performs the factorization 6 If D is an m n matrix then U and V are m m and n n orthogonal matrices respectively and is an m n diagonal matrix containing the singular values along the diagonal ordered by decreasing size. The right singular vectors V provide abstract representations of the spectra of the individual chemical components e.g. elements or phases . The min m n singular values are related to the amount of variance in the data that is accounted for by the corresponding principal components. Specifically the isingular value is equal to the square root of the variance accounted for by the iprincipal component. The diagonal form indicates that the transformed data are uncorrelated. By decomposing the data into a set of uncorrelated factors of decreasing statistical significance data compression can be accomplished by selecting those factors having the greatest statistical significance and discarding the rest as noise or error.

SVD has the useful property that the space spanned by the first p columns of V represents in a least squares sense the best rank p approximation to the space spanned by the rows of D. The remaining n p columns of V represent experimental noise or error and can be discarded. Thus the scores and loading matrices can be truncated or compressed to contain only those vectors corresponding to significant singular values. Letting Vbe the matrix whose columns are the first p columns of V a p component PCA model can then be computed according to

The conclusion that arises from the foregoing discussion is that there are two equivalent and equally valid ways to describe the data matrix D in terms of a PCA model. In the picture provided by Eq. 7 the orthonormal basis is spectral in nature whereas the model in Eq. 8 has an orthonormal image basis. The difference between the two points of view is subtle but has major implications. These relate to how properties of orthogonal and orthonormal i.e. orthogonal and normalized to unit length vectors differ upon rotational transformation as will be described below.

While the matrices T and P include all of the information contained in the pure components they do not do so in a chemically recognizable form. Therefore a single principal component will not in general represent either a pure element or a multi element phase but rather a linear combination of such elements or phases. In other words there may not be a one to one correspondence between a selected principal component and a particular chemical phase or pure element. For example physically admissible concentrations must be non negative and the pure component spectra must be greater than the background signal whereas a general principal component analysis need not be thus constrained. The principal components produced by PCA often have negative values which presents a spectrum that is difficult for the practicing analyst to understand. Additionally a major disadvantage of PCA is that the principal components are constrained to be orthogonal while any chemical phase that contains overlapping spectral peaks or non specific spectral backgrounds will necessarily be non orthogonal. Therefore subsequent post processing of results obtained from PCA is useful for transforming the abstract principal components into physically meaningful pure components.

Transformation or rotation of PCA loading vectors has been commonly employed particularly in the psychometric community to obtain more readily interpretable factors. See H. H. Harman 3rd Revised ed. The University of Chicago Press Chicago 1976 M. W. Browne 36 111 2001 and M. Forina et al. 3 115 1988 . The general goal of such procedures is to rotate the factors to simple structure. Thus given a matrix of loading vectors P a rotation matrix R is sought such that the rotated loadings PR are in some sense simpler and hopefully easier to interpret that the original loadings. As is amply demonstrated by the references many definitions of simple structure have been proposed in the literature and many algorithms are available to determine R such that the simplicity of is maximized. At a very basic level however simplicity just means that there are many zeros in the matrix of loading vectors . A matrix that has perfectly simple structure is one that has one and only one non zero entry in every row of the matrix.

In the area of spectral image analysis rotation of the spectral principal components has been used to obtain simpler spectra that may be easier to interpret. Conversely the present invention uses rotation of the spatial domain loading vectors to obtain better more interpretable components in the spectral domain. Accordingly a rotation matrix R can be determined for instance by the Varimax procedure that maximizes the simplicity of . The inverse rotation can then be applied to the scores matrix T to yield a factor model that fits the original data equally as well as the PCA model. Assuming R is an orthogonal matrix i.e. a true rotation then spectral basis 10 spatial basis 11 Interestingly while the columns of the rotated loading matrix like those of the original loading matrix P are mutually orthonormal the columns of have lost the orthogonality present in the original scores matrix T. The implication of this result is that rotation allows the spatial and spectral orthogonality imposed by PCA to be relaxed in either the spatial domain through Eq. 10 or in the spectral domain via Eq. 11 .

The key observation now is that while spectra are rarely orthogonal that is pure component spectra typically overlap either one another or non specific backgrounds samples are often relatively orthogonal in a spatial sense. For example in a sample with discrete chemical phases X and Y and assuming boundary pixels make up a small fraction of the total any particular pixel is likely to represent either phase X or phase Y but not both. This observation suggests that the factorization approach indicated by Eq. 11 will be effective for the spectral image analysis of a large and important class of analytical problems having spatially simple structure i.e. substantially comprising pure pixels .

As demonstrated by the foregoing discussion regarding spatially simple samples excellent spectral estimates can be achieved by first rotating spatial domain loading vectors to simple structure and then applying the same rotation for the case of an orthogonal R to the scores matrix. The pure component concentration estimates on the other hand are still constrained to be orthogonal which can introduce bias into the results if the samples are not perfectly simple. Frequently these biases can be compensated by imposing additional constraints non negativity for instance on the derived components subsequent to factor rotation. Further exclusion of bias requires that refinements be made to both the rotated spectral and spatial components. This refinement can be accomplished using algorithms that impose additional constraints. Typically the refinement requires an iterative algorithm. Small changes in the spatial domain components will induce changes in the spectral domain estimates which induce additional changes in the spatial components and so on. For example the refinement can be accomplished using an alternating least squares algorithm. Alternatively a particularly suitable family of algorithms for the case of non negative concentrations and spectra is the maximum likelihood based non negative matrix factorization NNMF method which has been further elaborated for Poisson data. See D. D. Lee and H. S. Seung 401 708 1999 and P. Sajda et al. 5207 321 2003 .

In is shown a method for spectral image analysis by exploiting spatial simplicity using PCA as described above. At step is provided a two dimensional matrix of spectral image data D. The 2D matrix D can be obtained by unfolding a measured multidimensional spectral data set. Alternatively the data matrix D at step can be represented as an arbitrary factor model according to 12 where the data factor matrix A comprises spatial information and the data factor B comprises spectral information. At step the data matrix D can be weighted to create a weighted data matrix according to Eq. 3 . For ease of description the resulting weighted data matrix tilde over D can be assigned to data matrix D as indicated by the arrow .

PCA can be performed on either the unfactored data matrix D according to Eq. 4 or the transposed unfactored data matrix D according to Eq. 5 using a factorization algorithm. The data matrix is thereby factored into the product of a scores matrix T whose columns are mutually orthogonal and a matrix P of orthonormal loading vectors. As is well known to those having skill in the art there are many algorithms that can be used to perform the PCA factorization including nonlinear iterative partial least squares NIPALS eigenanalysis and SVD. The PCA will yield a very large number of principal components. In general the number of principal components representing noise greatly outnumbers the chemically relevant principal components. Therefore the f most significant components e.g. corresponding to the f most significant eigenvalues or singular values are selected. It is not necessary to know exactly how many significant components f are needed to represent the chemical information only that the number of f most significant components selected equals or exceeds the number of chemical pure components p in the sample i.e. f p . See R. Bro and C. Andersson 42 105 1998 . Accordingly at step the loading and scores matrices P and T can be truncated to matrices Pand Tby retaining only those vectors corresponding to the f most significant components.

At step the number of pure components p can be selected to provide a loading matrix Phaving mutually orthonormal columns and a scores matrix Thaving mutually orthogonal columns. The appropriate number of pure components p can be estimated for instance using the eigenanalysis as described by Keenan and Kotula.

At step an orthogonal rotation matrix R can be determined. For example the rotation matrix R can be determined by one of the Orthomax family of procedures e.g. Quartimax or Varimax . The rotation matrix R can be applied to the loading matrix Pto provide a rotated loading matrix having a maximally simple structure according to PR. For ease of description the rotated loading matrix tilde over P can be assigned to the loading matrix P.

At step the inverse rotation can be applied to the scores matrix Tto provide a rotated scores matrix according to TR. For ease of description the rotated scores matrix can be assigned to the scores matrix T. The data matrix D is thereby described in the spatial basis according to Eq. 11 .

While the rotated loading matrix is maximally simple the signs of the rotated principal components suffer a sign ambiguity. In the approximately perfectly simple case the elements of a given score vector i.e. a column of T will be either predominantly negative or predominantly positive. Since we desire non negative spectral components the columns of Tthat are predominantly negative along with the corresponding columns of Pare multiplied by 1 at step .

If no refinement of the rotated PCA solution is necessary the loading vectors matrix can be normalized and assigned to the concentration matrix i.e. C P and the scores matrix can be normalized and assigned to the spectral shapes matrix i.e. S T and these matrices can be interpreted at step .

Alternatively the rotated PCA solution can be further refined. Only the rotated loading matrix can be refined or both the loading and scores matrices can be refined. The rotated PCA solution can be refined either prior or subsequent to unweighting. At step the rotated PCA solution can be unweighted prior to refinement by recovering the unweighted loading matrix and unweighted scores matrix using the inverse of the pre and post multiply weighting matrices according to P GPand T HT. Obviously the inverse weighting matrices Gand Hcan be the identity matrix if the data matrix was not weighted at step . At step the unweighted PCA factors Pand Tcan then be refined yielding the concentration and spectral shapes matrices C and S. Alternatively the weighted PCA solution can be refined first at step to yield the weighted concentration and spectral shapes matrices and then these matrices can be unweighted at step according to C GC and S HS.

In are shown a number of methods for refining either the weighted PCA factors Pand Tat step or the unweighted PCA factors Pand Tat step depending on whether the full data matrix D or the factored representation A and B is used for refinement. Component refinement is accomplished by forcing the spectral and abundance components to satisfy physically motivated constraints. For example physically admissible concentrations and spectra must typically be non negative. The matrix R was obtained at step by rotating the loading matrix Pto simple structure for the purpose of obtaining physically realistic and easily interpretable spectral pure components Tin steps and . At step the initial estimate Tcan be made feasible by ensuring that no elements violate the constraints for instance by setting the remaining negative matrix elements to zero. Next as described below either the spatial or both the spatial and spectral rotated components can be further refined to exclude bias by using algorithms that impose additional constraints.

Step shows a constrained least squares approach e.g. MCR ALS to refine either the unweighted rotated loading matrix i.e. at step or the weighted rotated loading matrix i.e. at step using the data matrix D. The refined loading matrix Pcan be computed from the data and the feasible estimate for the scores matrix Tby least squares subject to constraints according to

Alternatively at step if the data matrix is represented as an arbitrary factor model i.e. as AB the refined rotated loading matrix can be computed subject to constraints according to

If the rotated PCA factors have been unweighted at step a refined factorization including refined estimates of both Pand Tcan be computed in general using an alternating sequence of conditional refinements with the data matrix D according to step . One specific refinement algorithm is based on constrained alternating least squares. Given an initial feasible estimate for the scores matrix T an updated Pcan be computed subject to constraints according to

Another refinement algorithm at step for the case of Poisson data is the constrained non negative matrix factorization algorithm of Sajda et al. The Sajda algorithm naturally imposes non negativity constraints and is suitable for count data.

Steps and show alternative refinement approaches based on the NNMF algorithm of Lee and Seung. This method iteratively updates the non negative rotated PCA factors under the assumption of uniform Gaussian noise. For heteroscedastic data these algorithms are appropriately applied in the weighted space.

At step a refined weighted PCA factorization can be computed using the data matrix D. Given an initial feasible estimate for the scores matrix T the loading matrix Pcan be updated according to

Alternatively at step a refined weighted PCA factorization can be computed using a pre factored data matrix AB. Given T an updated Pcan be computed according to

Hyphenated chromatographic methods are some of the most powerful techniques for analysis of mixtures available. See G. Cudiamat GC MS Advanstar Communications Inc. Woodland Hills Calif. http chromatographyonline.findanalytichem.com lcgc Research GCndashMS ArticleStandard Article detail 623723 retrieved 2 Nov. 2009 . Gas chromatography coupled with mass spectrometry GC MS is one of the most widely utilized methods for the analysis of volatile species. A very powerful technique for improving the selectivity and signal to noise ratio SNR of GC MS is selected ion monitoring SIM . See D. A. Skoog and J. J. Leary Saunders College Publishing Fort Worth 1992 . SIM works by limiting the mass spectral filter to those ions associated with a chemical species of interest. See C. G. Herbert and R. A. W. Johnstone CRC Press Boca Raton Fla. 2003 . It can produce spectacular results when the analysis is limited to a few species. However when the analysis is intended to find minor or unknown species in a mixture use of SIM could result in missing important information.

There have been numerous methods developed to analyze GC MS data over the years. One early method focused on identifying m z indices which represented the pure chromatogram of each chemical component. See J. E. Biller and K. Biemann 7 515 1974 . Knorr et al. took a different tack by modeling chromatogram peaks as skewed Gaussian functions while using a SIMPLEX minimization. See F. J. Knorr et al. 53 821 1981 . Various modifications and advancements of the first theme have led to a very popular and versatile approach which has become known as AMDIS. See R. G. Dromey et al. 48 1368 1976 B. N. Colby 3 558 1992 S. E. Stein 10 770 1990 and W. G. Mallard and J. Reed Automated Mass Spectral Deconvolution Identification System AMDIS USER GUIDE National Institute of Standards and Technology NIST Gaithersburg Md. 1997 . These approaches use the mass spectral information as well as assumptions about peak shape to deconvolute the chromatogram.

Factor analysis methods that assume no analytic model of the character of the data are often called soft models or matrix based methods. Such self modeling methods typically make only limited assumptions about the nature of the data but impose constraints such as non negativity to achieve physically meaningful results. Alternating least squares ALS or alternating regression AR methods have been employed successfully in GC MS analysis. See E. J. Karjalainen et al. Vol. 14 E. J. Karjalainen et al. Eds. Elsevier Amsterdam The Netherlands pp 595 609 1998 . Unfortunately that algorithm was initiated with random starting points which can lead to solutions trapped in local minima.

Analysis of forensic samples presents a case where the identification of minor or unsuspected chemical species is very important. Minor components may present themselves as evidence of the source of a compound used in a criminal activity such as an accelerant in arson or a byproduct from production of material used in a chemical attack. Separating the small but important components from a solvent or a dominant agent can be critical to identifying the source of the material. In the case of GC MS identifying minor components can be quite a challenge when the data are dominated by solvents or the major components which may even saturate the column and or detector.

In is shown a flow diagram for the method of the present invention. The method applies the general method for spectral image analysis by exploiting spatial simplicity described above to the factor analysis of GC MS data wherein a temporal dimension or chromatographic separation coordinate replaces the spatial coordinate. The factor analysis method takes special advantage of the simple character of GC MS data. A chromatogram is simple in the sense that it consists of relatively discrete elution peaks that represent separated chemical species. The method of the present invention exploits this simplicity in the temporal domain to make the resulting factor model more realistic. The method is fast reasonably straightforward and easy to apply.

The method can begin with measuring a mass charge m z spectrum of a sample with a gas chromatograph mass spectrometer GC MS at step . The spectrum can be represented an m n matrix of GC MS data D wherein m is a number of mass spectra and n is a number of eluted chromatographic peaks.

An alternative embodiment of the method enables a rapid analysis of GC MS data containing large interfering solvent peaks. The embodiment relies on extracting information on minor components while reducing the impact of dominant components is the mass spectral information originating from dominant species is ignored using the technique of selected ion depletion SID .

Selected ion monitoring is a technique that is implemented in the data acquisition phase of an experiment. It is accomplished by tuning the mass spectrometer to a suitable mass charge m z value or set of values and acquiring the current s as counts as a function of elution time. See D. A. Skoog and J. J. Leary Saunders College Publishing Fort Worth 1992 . In this way the mass spectrometer becomes a very effective mass filter with high SNR at the expense of mass spectral range. By contrast with selective ion depletion the mass spectrometer is scanned continually over an applicably wide m z range sufficient to capture all of the fragments that one could reasonably expect in the sample. This may be seen as a more traditional if brute force method of obtaining data where a larger range of m z is collected at the expense of SNR. The advantage of collecting the full mass spectral range is that one has access to all mass fragments which may include information on unexpected chemical species.

Often chromatographic data contain peaks from dominant species or solvent that may be saturated either in the chromatographic domain or the mass spectral domain. Saturation or overloading in the chromatographic domain is frequently manifested as a distorted non Gaussian shaped peak with excessive tailing. See C. F. Poole and S. K. Poole Elsevier Science Amsterdam The Netherlands 1991 . Saturation in the mass spectral domain can be recognized as distorted mass spectra across the chromatographic peak with the most populated mass channels saturating resulting in reduced relative ratios to unsaturated peaks. These effects can make factor analysis more difficult by obscuring small peaks and increasing the complexity of the data. As intensity of the saturated peaks no longer increases with concentration they are highly non linear and thus linear factor analysis methods fail to produce easily interpretable results. A solution for this type of problem is to remove the m z channel data for major components and solvents via SID during the acquisition phase as shown at step to provide the matrix D of measured GC MS data at step .

Preferably prior to performing factor analysis the GC MS data can be appropriately scaled weighted at step so that it approximates the assumptions of the factor analysis method. The factor analysis method of the present invention can use least squares which assumes that the errors are independently and identically distributed i.i.d. normal. Since these GC MS data are collected as counts from a quadrupole mass spectrometer the first principles assumption is that the data are actually Poisson distributed. See C. Hackett et al. 28 774 1999 I. S. Begley and B. L. Sharp 12 395 1997 and B. El Abbassi et al. 141 171 1995 . Techniques are known for optimal scaling of multivariate Poisson distributed data. See M. R. Keenan Vol. Grahn H. F. Geladi P. Eds. John Wiley Sons Ltd Chichester West Sussex England pp 89 126 2007 M. R. Keenan and P. G. Kotula 231 232 240 2004 and M. R. Keenan and P. G. Kotula 36 203 2004 . Briefly the data can be scaled using the inverse of the square root of the mean mass spectrum.

Consider some GC MS data in the m n matrix D oriented as mass spectral domain by chromatographic domain with mean m z spectrum given by

As described above PCA is a statistical method that decomposes a matrix into two sets of orthogonal basis vectors ordered by decreasing variance that model the row and column spaces of the matrix. See E. R. Malinowski John Wiley and Sons Inc. New York 1991 and M. R. Keenan 23 746 2004 . It is often used as an initial data reduction method whose subspace representation may be readily factor analyzed by additional statistical treatments. See M. R. Keenan Vol. Grahn H. F. Geladi P. Eds. John Wiley Sons Ltd Chichester West Sussex England pp 89 126 2007 .

As shown at step PCA can be represented in matrix form as 23 where tilde over T is an m p matrix which describes the column or mass spectral space of the scaled data in tilde over D P is an n p matrix describing the row or chromatographic space of tilde over D tilde over E is an m n matrix of scaled residuals or noise and the superscript T indicates the transpose of the preceding matrix or vector. p is used to define the size or pseudorank of the subspace model that describes the chemically meaningful information contained in tilde over D simply put the number of distinguishable pure chemical species in tilde over D . tilde over T is orthogonal and P is orthonormal having the properties 

There is a variety of methods to compute the PCA among these are nonlinear iterative partial least square NIPALS eigenanalysis and singular value decomposition SVD . See P. Geladi and B. R. Kowalski 185 1 1986 R. A. Johnson and D. W. Wichern Prentice Hall Englewood Cliffs N.J. 1992 G. H. Golub and C. F. Van Loan 3rd ed. Johns Hopkins University Press Baltimore 1996 and R. M. Larsen Lanczos bidiagonalization with partial reorthogonalization Report Number DAIMI PB 357 Department of Computer Science Daimi Aarhus University Aarhus Denmark 1998 . SVD is very convenient since it decomposes the matrix tilde over D as 25 where U and V are respectively the m p and n p matrices of orthogonal left and right singular vectors and S is the p p diagonal matrix of singular values. The singular values are the square roots of the eigenvalues viz. 26 Equations 23 and 25 can be combined to show that

After performing PCA an orthogonal rank p representation of the data is obtained that will probably not resemble any meaningful information to the chromatographer. Consequently additional factor analysis is required to transform the PCA factors into interpretable factors. A reasonable approach to transforming the factors is to use a factor rotation method.

Factor rotation methods seek to maximize or minimize some criterion that is consistent with the nature of the data. In the case of GC MS data the varimax rotation is an appropriate criterion for the chromatographic domain. See R. J. Rummel Northwestern University Press Evanston Ill. 1970 H. H. Harman University of Chicago Press Chicago 1976 and M. R. Keenan et al. Seattle Wash. USA Jul. 8 10 2002 SPIE The International Society for Optical Engineering 193 2002 . The varimax criterion seeks an orthogonal rotation matrix R which maximizes the row or chromatographic variance of the orthonormal matrix P thereby maximizing the simplicity of the rotated elution time or chromatographic factors.

As shown at step a rotation matrix R can be applied according to 29 Generally the factors of chromatographic domain are simple or sparse. For example when a species elutes it produces a peak in the chromatogram generating a chromatographic factor with a single peak and zeros or noise at all other times. Unless another species co elutes all other factors will be zero valued noisy at the elution times encompassing that species peak. So the chromatographic domain is generally sparse. Overlapping due to co elution or the presence of a large background is a violation of this premise. By contrast there is no reason to expect that the mass spectral domain is sparse since many different compounds generate the same mass fragments although not in the same pattern so this violates the simplicity assumption.

If all species were to elute at different times such that none were overlapped and no background arose from column packing loss and discharge then PCA and varimax rotation would be sufficient to produce interpretable results. Refinement of the rotated PCA solution can be used to deal with these problems. MCR ALS also called linear unmixing is a factor analysis method that utilizes an alternating least squares strategy while employing constraints the most common constraint used being non negativity. See M. R. Keenan et al. Seattle Wash. USA Jul. 8 10 2002 SPIE The International Society for Optical Engineering 193 2002 R. Tauler et al. 248 447 1991 M. H. Van Benthem et al. 16 613 2002 P. G. Kotula et al. 9 1 2003 R. Bro and S. DeJong 11 393 1997 and M. H. Van Benthem and M. R. Keenan 18 441 2004 .

At step MCR seeks to solve 30 where tilde over M is the nonnegative m p matrix modeling the column or mass spectral space of the scaled data in tilde over D C is the nonnegative n p matrix modeling the row or chromatographic space of tilde over D note that here M is a matrix of mass spectral factors that is equivalent to the pure component matrix C in Eq. 1 . C in Eq. 30 is a matrix of chromatographic factors that is equivalent to the pure component spectra matrix S in Eq. 1 .

As described above one specific refinement algorithm is based on constrained alternating least squares. Given an initial feasible estimate for the scores matrix T an updated P can be computed subject to constraints according to

Combining equations 30 and 29 provides the refined PCA solution 31 which represents the dimension reduction of tilde over D as well as the imposition of constraints on the rotated PCA factors.

Finally following MCR the factors in tilde over M can be rescaled if necessary using the appropriate substitution into Eq. 28 . At step an m p matrix M of refined mass spectral factors and an n p matrix C of refined chromatographic factors can be interpreted for the p chemically meaningful species in the sample.

The method of the present invention is illustrated by the analysis of two data sets on standard mixtures which are highlighted by separation and identification of heavily overlapped peaks caused by an isotopic chlorine effect. Two known mixtures were analyzed. Commercially available volatile organic compound VOC mixtures VOC Mix 6 and VOC Mix 8 Supelco Inc. Bellefonte Pa. were analyzed as received. VOC Mix 6 contains six compounds dichlorofluoromethane chloromethane vinyl chloride bromomethane ethyl chloride and trichlorofluoromethane dissolved in methanol. VOC Mix 8 contains 11 compounds trans 1 2 dichloroethylene cis 1 2 dichloroethylene 1 2 dichloropropane toluene tetra per chloroethylene PCE chlorobenzene ethylbenzene p xylene styrene o xylene 1 2 dichlorobenzene dissolved in methanol. These mixtures were analyzed using an Agilent 6890 gas chromatograph 5975N mass spectrometer equipped with a J W DB 5 ms 60m 0.32 mm 1.0 m film thickness gas chromatography column. The analytical conditions for the mixture were modified for each mixture. The GC conditions used for VOC Mix 6 were isothermal at 35 C. for 7 minutes helium carrier gas flow rate of 1.2 mL min splitless injection of 0.2 L of solution into 250 C. injector. The mass spectrometer was operated in the full scan mode from m z 27 120. The GC conditions used for the VOC Mix 8 were isothermal at 35 C. for 2 minutes then ramped at 10 C. min to 200 C. and held for 2 minutes then 20 C. min to 290 C. and held for 15 minutes. The helium carrier gas was kept at a constant flow rate of 1.4 mL min. A splitless injection of 0.2 L of solution into 250 C. injector was used to introduce the mixture. The mass spectrometer was operated in the full scan mode from m z 27 120 to the 7 minute mark then m z 33 320 through 18 minutes then finally to m z 33 380 through the end of the analytical run. Mass data were collected in increments of 0.1 amu and binned to the nearest unit amu.

The VOC Mix 6 data were collected over a time range of approximately six minutes constituting 4287 time elements. The mass spectral domain covered m z 27 119 whose non zero entries consisted of 65 m z elements. An all zero column of mass spectral values was depleted and not analyzed since it contained no information. The top plot in is the total ion chromatogram of the raw data for VOC Mix 6 which is dominated by the methanol peak. The elution time range was truncated to a range of approximately 3 5.5 minutes to focus on the region of interest. In addition the range m z 28 33 represents the SID region for the methanol peak. See S. E. Stein NIST Mass Spectrometry Data Center 69 Linstrom P. J. Mallard W. G. Eds. National Institute of Standards and Technology Gaithersburg Md. 20899 2008 http webbook.nist.gov retrieved 24 Oct. 2009 . After this modification the data size was 741 time elements by 56 m z elements. The bottom plot in contains expanded scale total ion chromatogram of the raw data as well as the SID plot with the methanol m z eliminated. Most obvious here is complete loss of the methanol peak and its long tail but an important consequence is the appearance of a peak 4 that previously was concealed completely. Elimination of the methanol contribution is important for several reasons. Due to saturation effects it makes the data much more complex than simply the addition of another chemical species. Its long tail complicates the analysis of overlapped peaks since this behaves like a non zero baseline which prevents complete unmixing with PCA and presents special challenges for MCR.

The chromatographic factors for the varimax rotated PCA analysis are presented in the top plot of . While it is difficult to see the extent of negativity in the factors is very small even in the presence of overlap in the second and third peaks with centers at 3.67 and 3.71 minutes. For ease of viewing the scale of this region was expanded and superpositioned in the plot. Given the excellent performance of the rotated PCA algorithm minimal refinement with MCR was required. The bottom plot of contains the MCR factors of the nine factor model initialized using the varimax solution and completing only 10 iterations. Again the expansion of the overlap region demonstrates the ability of MCR with non negativity constraints to unmix these factors. The MCR mass spectral factors for the nine components are displayed in .

Identities of the six expected chemical species with peak labels 1 3 5 6 7 and 8 in and and Table 1 were confirmed using the mass spectral factors as inputs to a NIST mass spectral library search routine. In addition the NIST routine identified peak 2 as dimethyl ether a common contaminant of methanol and peak 9 as acetonitrile with a confirmatory match factor of 860. The presence of acetonitrile was confirmed by comparing its elution time to that of an independent experiment involving only acetonitrile in methanol. The identity of the final species eluting as peak 4 was not revealed using the NIST mass spectral library search routine. This lack of library match is not unexpected because this factor is believed to represent ion molecule reactions of methanol in the mass spectrometer source and thus not a separate distinct compound. The most abundant ion observed in the factors of peak 4 see was m z 34. For methanol there is a small 0.21 isotopic contribution at m z 34 likely which also has abundance from protonated methanol. This factor demonstrates the sensitivity of the method to very low abundance chromatographic peaks.

The original VOC Mix 8 data were collected over a time range of approximately 34 minutes constituting nearly 12 000 elements and a mass range m z 27 371 comprising 240 nonzero mass channels. Initial data trimming reduced the time domain to 3 24 minutes 7554 elements and the mass range m z 27 355 148 mass channels including SID of methanol m z 28 33 . The top plot in contains expanded scale total ion chromatogram of the raw data as well as the SID plot with the methanol m z eliminated. As in VOC Mix 6 complete loss of the methanol peak and its long tail are dramatic. The twelve major peaks have been numbered for convenience and their expected identities as per NIST MS library matching are contained in Table 2. The table lists only the best hit which misassigned the dichloroethylene xylene and dichlorobenzene isomers. This is common for these types of isomers in many other types of data processing and under such circumstances GC MS practitioners typically will employ retention time information or Kovats indices for confirmation. Browsing the NIST library matching results the correct assignment in each case is within 1 of the best hit match score and thus these misassignments are of minor concern. The important point is that the MCR is correctly modeling and separating the peaks. In addition to the eleven known constituents of the mix the first peak is that of dimethoxymethane. is a scree plot of the eigenvalues of the Poisson scaled data after trimming the time domain and removal of the methanol m z channels. Unfortunately in this plot there is not a distinct or obvious transition from data eigenvalues to noise eigenvalues. Upon expansion of the plot a 25 factor model was estimated to be appropriate.

The bottom plot in contains the rank 25 model chromatographic factors from MCR initiated using the varimax rotated PCA solution. All of the major peaks were modeled plus a significant number of minor peaks. A lettering scheme for the thirteen major MCR factor peaks that model the twelve major data elution peaks was used. Species whose mass spectra are highly correlated pose a special problem the results plotted in represent one such challenge.

The species giving rise to the peaks displayed in are from left to right ethylbenzene 8 p xylene 9 styrene 10 and o xylene 11 . The first two peaks at times 15.3 and 15.5 minutes are well resolved but have very similar but discernable mass spectra so they are separable with PCA and MCR. The second two peaks are highly overlapped but have very different mass spectra so they are mostly separable with varimax PCA with significant negative going lobe so as to be orthogonal. The problem arises because the mass spectra of ethylbenzene p xylene and o xylene are so similar that the o xylene peak is best modeled as a linear combination of ethylbenzene and p xylene. A separate analysis of the data was conducted for all times greater than 15.8 minutes and a distinct peak for styrene at 15.99 minutes and another distinct peak for o xylene at 16.02 minutes were obtained. While having to partition the data matrix in this manner not the most desirable situation it does represent an option for identifying isomeric species whose mass spectra are nearly indistinguishable.

Perhaps the most impressive demonstration of the power of the method of the present invention is represented in . The top plot shows the elution peak for PCE 6 its two varimax rotated PCA factors in F and G . Due to orthogonality constraints the peaks have both positive and negative lobes. Even in the bottom plot the MCR results nicely resolve the two peaks F and G with Gaussian shapes. contains the peak integrated mass spectrum and the mass spectral factors of the first factor left and second factor right in the top middle and bottom panels respectively. These plots reveal chlorine isotope abundance dependence as a function of elution time. An analysis of these plots is found in Tables 3 5. The theoretical probability for the two three and four chlorine fragments using a binomial probability distribution and a 24.22 natural abundance for Cl. See D. R. Lide Ed. 84 ed. CRC Press Boca Raton Fla. 2003 .

Table 3 is a comparison of the theoretical and actual proportions of CClfragment for the possible combinations of Cl and Cl. A comparison of the theoretical proportions with that of the integrated peak of the raw data shows excellent agreement as well as with the NIST Standard Data. However the first left peak appears to have enrichment in the lighter isotope since its 0 2 Cl Cl proportion is larger than the expected value while the 2 0 Cl Cl proportion is lower than expected. In contrast the second right peak values show enrichment in the heavier isotope. This pattern is repeated in the subsequent tables enrichment of Cl in the left peak and complementary enrichment of Cl in the right peak. This is entirely consistent with isotopic behavior in a diffusion controlled process.

The present invention has been described as method for factor analysis of GC MS data. It will be understood that the above description is merely illustrative of the applications of the principles of the present invention the scope of which is to be determined by the claims viewed in light of the specification. Other variants and modifications of the invention will be apparent to those of skill in the art.

