---

title: Secure PIN character retrieval and setting using PIN offset masking
abstract: Securely disclosing a personal identification number (“PIN”) associated with a financial account to an account holder and receiving a new PIN from the account holder. A PIN reveal application can interact with a hardware security module (“HSM”) using a PIN offset masking process and randomly generated account data to reveal the PIN to the account holder one or more PIN characters at a time. A PIN set application also can interact the HSM using a PIN offset masking process and randomly generated account data to receive a new PIN for the account one or more PIN characters at a time. In each of the PIN reveal and PIN setting processes, less than the entirety of the PIN is stored in an unencrypted format outside of the HSM only.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08312288&OS=08312288&RS=08312288
owner: Total System Services, Inc.
number: 08312288
owner_city: Columbus
owner_country: US
publication_date: 20100311
---
This non provisional patent application is a continuation in part of U.S. patent application Ser. No. 12 553 747 entitled Secure PIN Character Retrieval and Setting filed Sep. 3 2009 the complete disclosure of which is hereby fully incorporated herein by reference.

The invention relates generally to payment card security and more particularly to methods and systems for disclosing a personal identification number PIN associated with a financial account to an account holder and for allowing the account holder to set or modify the PIN.

With the explosion of electronic commerce and digital personal information facilitated by the rapid growth of the Internet focus has been placed on the protection of financial and personal data. One element in protecting these data is encryption. Encryption is the process of converting information into an unintelligible form except to holders of a specific cryptographic key. By encrypting the information it is protected against unauthorized disclosure.

Encryption is accomplished through a cryptographic algorithm. The algorithm is used to lock the information at one point and unlock it at another. Keys are used to lock and unlock the information. In a secret key or symmetric key encryption the same key is used to lock and unlock encrypt and decrypt the information. In public key or asymmetric key encryption a public key is used to encrypt the information and a private key is used to decrypt the information. A key is often a numerical value. The length of the key generally determines the relative security of the key.

Many types of information use encryption. One example is the payment card industry including credit card data and other financial information. Indeed the credit card industry had taken great steps to ensure that financial data and transaction data is protected. For example cardholder data must be encrypted when it is stored or transmitted over a public network. This requirement covers everything from producing the credit cards including information stored on the magnetic strip or embedded chip on the card to authenticating and authorizing transactions made with the card. One key piece of data that must be encrypted is a user s personal identification number PIN .

Financial institutions employ Internet web sites to support customer transactions and account access. A customer can log into the web site and select links to navigate to web pages having content associated with the account. The customer can also complete certain transactions such as transfers between multiple accounts and bill payments.

Financial institutions also employ interactive voice response IVR applications to support customer transactions. Typically a customer will call a telephone number for the system. An automated system will provide recorded instructions to the user such as for inquiries about a checking account press . The customer uses the number key pad on a telephone to select menu items and enter alphanumeric data such as an account number.

However one option that is not available to customers using an Internet web site or an IVR application is for the customer to access a PIN or password associated with an account while providing a secure platform for the information. Current standards and best practices require that a PIN remain encrypted at all times excepting when the PIN is in a hardware security module HSM or in a PIN mailer that is mailed to the customer when the customer opens an account or requests a new PIN. If a customer forgets a PIN associated with a financial card such as a credit or debit card the conventional solution is to generate a new PIN and mail the new PIN to the customer in a PIN mailer. This process is expensive and leaves the card unusable until the new PIN is received by the customer. With the advent of computers and online banking such delay is unacceptable and frustrating to the customer. This process also leads to confusion as customers frequently forget that a new PIN has been issued and continue to attempt to use the old PIN leading to even further administrative expense.

Accordingly systems and methods are needed to provide customers with quick and secure access to a PIN associated with a financial account. Another need exists for systems and methods for allowing an account holder to quickly set or modify the PIN.

The present invention provides systems and methods for disclosing a personal identification number PIN associated with a financial account to an account holder and for receiving a new PIN from the account holder. One aspect of the present invention provides a method for disclosing a PIN associated with an account. A request is received to disclose the PIN the PIN including PIN characters encrypted in a first PIN block. Account data is generated for the account. A hardware security module HSM generates a PIN offset including PIN offset characters using the account information and the PIN encrypted in the PIN block. A PIN application executing on a computer receives the PIN offset from the HSM. The PIN application modifies a portion of the PIN offset characters of the PIN offset and leaves one of the PIN offset characters unchanged. The HSM creates a second encrypted PIN block including a second PIN using the modified PIN offset and the account data. The HSM decrypts the second encrypted PIN block. A PIN character corresponding to the one unchanged PIN offset character is outputted. Certain steps in this method can be repeated for each PIN character and the PIN application can delete the previously decrypted PIN block prior to decrypting another PIN block.

Another aspect of the invention provides a system for disclosing at least one element of a PIN associated with a transaction account. A user interface can process a request for disclosure of a portion of the PIN in an unencrypted form the PIN including PIN characters stored in an encrypted data element. A PIN module logically coupled to the user interface and to an HSM can interact with the HSM to decrypt the portion of the PIN by applying a PIN mask to the portion of the PIN and randomly generated account information to generate the decrypted portion of the PIN for presentation via the user interface.

Another aspect of the present invention provides a method for setting a PIN of an account. A user interface is provided for a user to enter a PIN character for including in the PIN. A PIN application operating on a computer receives the PIN character. The PIN application appends one or more PIN characters to the received PIN character to create a second PIN. Random account data is generated. A secure platform logically coupled to the PIN application creates a PIN offset using the second PIN and the random account data. The aforementioned steps of this method can be repeated for each PIN character of the PIN. The PIN application creates a combined offset using each of the generated PIN offsets. The secure platform creates an encrypted PIN block using information associated with the account the random account data and the combined PIN offset.

These and other aspects objects features and embodiments of the invention will become apparent to a person of ordinary skill in the art upon consideration of the following detailed description of illustrative embodiments exemplifying the best mode for carrying out the invention as presently perceived.

Exemplary embodiments of the present invention are provided. These embodiments include systems and methods for securely disclosing a personal identification number PIN associated with a financial account to an account holder and for receiving a new PIN from the account holder. A PIN reveal application can interact with a hardware security module HSM using a PIN offset masking process and randomly generated account data to reveal the PIN to the account holder one or more PIN characters at a time. A PIN set application also can interact the HSM using a PIN offset masking process and randomly generated account data to receive a new PIN for the account one or more PIN characters at a time. In each of the PIN reveal and PIN setting processes less than the entirety of the PIN is stored in an unencrypted format outside of the HSM only.

The invention can include one or more computer programs that embody the functions described herein and illustrated in the appended flow charts. However it should be apparent that there could be many different ways of implementing aspects of the invention in computer programming and these aspects of the invention should not be construed as limited to any one set of computer instructions. Further a skilled programmer would be able to write such computer programs to implement an embodiment of the disclosed invention based on the flow charts and associated description in the application text. Therefore disclosure of a particular set of program code instructions is not considered necessary for an adequate understanding of how to make and use the invention. The inventive functionality of the claimed invention will be explained in more detail in the following description read in conjunction with the figures illustrating the program flow. Further those skilled in the art will appreciate that one or more stages described may be performed by hardware software or a combination thereof as may be embodied in one or more computing systems.

Turning now to the drawings in which like numerals indicate like elements throughout the figures aspects of the exemplary embodiments are described in detail. is a block diagram depicting a system architecture in accordance with certain exemplary embodiments. Referring to the system architecture includes a PIN application server having a PIN reveal application and a PIN set application . The PIN applications and are typically implemented by software modules that reside in a computer readable memory storage device of a programmed computing device e.g. PIN application server and can be executed by a processor via computer readable memory. The PIN applications and can comprise application programming interfaces APIs that interact with a user such as an account holder via a user interface provided by a Web IVR interface server . The user interface can be provided by the Web IVR interface server to a user device such as mobile phone computer or kiosk . The PIN applications and can also interact with one or more HSMs such as HSM that the PIN application server is connected to.

The HSM is typically implemented as a combination of hardware and software modules embodied in a HSM server having a computer readable storage medium for storing the software modules and a processor for executing the software modules. In certain exemplary embodiments the HSM may be embodied as software alone. The HSM provides a secure platform to generate store and protect cryptographic keys. The HSM component provides a secure platform to encrypt and decrypt account holder information such as a PIN. The HSM can include software code or hardware modules that allow the HSM to interact with the PIN reveal application and the PIN set application .

The PIN reveal application securely provides an account holder with a PIN associated with an account of the account holder. Current standards and best practices require that PINs associated with financial accounts are stored at a payment processor such as card processing server in an encrypted form. Typically these PINs are stored in encrypted PIN blocks that can also include other account related information. The PINs in their entirety must remain encrypted at all times excepting when the PIN is stored in an HSM or in a PIN mailer that is mailed to the account holder. The PIN reveal application provides a means for disclosing a PIN to an account holder by storing only a portion typically one PIN character of the PIN in a decrypted format at a given time and disclosing only that portion to the account holder. The portion of PIN characters disclosed at a given time can include any number of PIN characters less than the entirety of the PIN to remain compliant. In certain exemplary embodiments the PIN reveal application operates to reveal the entire PIN one PIN character at a time. In certain exemplary embodiments the PIN reveal application operates to reveal only a portion of the entire PIN one character at time. For example the PIN reveal application may operate as a memory jogger by only revealing up to the first two or three characters of the PIN one character at a time. Although conventional financial account PINs typically include four numerical PIN characters the PIN reveal application can be adapted to reveal PINs having any number of characters or symbols and is not limited to just numerical characters. The PIN reveal application is described in more detail below with reference to .

The PIN set application allows an account holder to set or modify a PIN associated with an account. The PIN set application can interact with the user via a user interface provided by the Web IVR interface server to receive a PIN from the account holder one or more characters at a time. The PIN set application can also interact with the HSM to encrypt the PIN into an encrypted PIN block and send the encrypted PIN block to the card processing server for storage in the PIN block repository . The PIN set application is described in more detail below with reference to .

The Web IVR interface server is connected to a network such as the Internet or a telephone network. The Web IVR interface server provides secure access between an account holder and a financial account such as a bank account or credit card account. The Web IVR interface server can include a web server application not shown that provides a user interface to the account holder in the form of an Internet web site not shown . The web site can be provided via the network e.g. the Internet to a user device having a web browser such as mobile phone computer kiosk or any other device having a web browser. The web site can provide secure access using a secure cryptographic network communication protocol such as transport layer security TLS or secure sockets layer SSL protocols or the like. The PIN reveal application and the PIN set application can interact with the web site to provide a PIN to or receive a PIN from the account holder in a secure manner.

Additionally or alternatively the Web IVR interface server can include an IVR application not shown that provides an automated user interface to the account holder via a telephone such a mobile phone or a conventional touch tone telephone not shown . The IVR application can solicit information e.g. account number password etc. and requests e.g. available balance from the account holder typically by using a pre recorded audio based menu. The IVR application can receive information and requests from the account holder in the form of speech or telephone touchtone keypad entries and decode this speech or tones representing the keypad entries. The IVR application can respond to requests using pre recorded audio or a speech synthesizing application not shown . In an IVR embodiment the network can comprise a cellular telephone network a public switched telephone network the Internet e.g. voice over Internet protocol or any other telephone network. The PIN reveal application and the PIN set application can interact with the IVR application to provide a PIN to or receive a PIN from the account holder in a secure manner.

The Web IVR server is connected to the card processing server . The card processing server supports financial transactions involving an account for an account holder. For example the card processing server may authorize transactions for an account such as a debit card account linked to a specific bank account a pre paid debit card a credit card or a retail card. Part of this process may be to verify a PIN supplied by an account holder in connection with a transaction. These cards may have a specific PIN or other security feature.

The card processing server can store information associated with financial accounts such as account number balance transaction history or any other account information that may be used to authorize transactions or that an account holder may request. As discussed above the card processing server can also store a PIN for the account in a PIN block repository . For security purposes the PIN can be stored in an encrypted PIN block. Typically the PIN block includes the PIN and at least a portion of the account number.

Although the Web IVR interface server the PIN application server the HSM server and the card processing server are illustrated in and described herein as being servers one skilled in the art would appreciate that these servers could be embodied as various other types of computing devices such as workstation and mainframe computers. Additionally the connections between these servers may be implemented using a computer network such as a local area network LAN or a wide area network WAN .

In step the account holder makes a request at the user interface to view or hear a PIN associated with an account such as a financial account. In an Internet web site embodiment the account holder may use a pointing device to click on a link or tab displayed on a web page associated with the account. In an IVR embodiment the account holder may press a key pad on the mobile phone that corresponds with a Request PIN selection.

In step the Web IVR interface server determines whether any additional security measures are required for the account holder to receive the PIN. This determination can be based on a status of the account holder or on the type of account that the PIN is associated with. Alternatively all account holders and all account types may require additional security. If additional security is required the method proceeds to step . If no additional security is required the method proceeds to step .

In step the account holder is authenticated based on the additional security measures. The user interface may prompt the account holder for additional security information such as a card verification value CVV number printed on a card associated with the account. The Web IVR interface server may then compare information received from the account holder to account information stored at the Web IVR interface server to authenticate the account holder. Alternatively the Web IVR interface server may send the information to a card processing server for authentication. Step is described in more detail below with reference to .

In step the user interface proceeds to a secure Internet web page in an Internet embodiment or to a PIN reveal menu in an IVR embodiment. In an Internet embodiment the web page for revealing a PIN to the account holder may include masked characters corresponding to characters of the PIN. The account holder can select the PIN characters to request that that PIN character be displayed on the web site. In an IVR embodiment the PIN reveal menu may prompt the user to select which PIN character to reveal using a telephone keypad.

In step the Web IVR interface server requests an encrypted PIN block for the account from a card processing server that stores the PIN block. In certain exemplary embodiments whereby the card processing server authenticates the account holder the Web IVR interface server may send a request for the encrypted PIN block with the additional security information obtained in step to the card processing server . Thus the Web IVR interface server does not have to send two separate requests to the card processing server to obtain the PIN block.

In step the card processing server sends the PIN block to the Web IVR interface server . In step the Web IVR interface server makes a call to a PIN reveal application at a PIN application server and sends the PIN block to the PIN reveal application .

In step the PIN reveal application sends the PIN block to an HSM at an HSM server and the HSM stores the PIN block in memory.

In step the PIN reveal application requests one character of the PIN from the HSM . In certain exemplary embodiments the requested character may be based on an input received at the user interface from the account holder. For example with reference to an exemplary screen image of a user interface provided in each PIN character A D may initially be masked using an asterisk or other symbol. The account holder can use a mouse or other pointing device to move a cursor and select e.g. click on or hover over one of the masked characters to generate a request for that PIN character. In the screen image the account holder has selected the first PIN character A having a value of 5. The other PIN characters B D remain masked.

In IVR embodiments the account holder can request a PIN character by pressing a key on a telephone keypad corresponding to one of the PIN characters. For example the IVR may prompt the account holder to select PIN character one by pressing a 1 key on the telephone keypad.

In certain embodiments the PIN characters may not be selectable by the user. Instead the PIN characters may be requested from the HSM sequentially.

In step the HSM decrypts the PIN block and returns the one requested PIN character to the PIN reveal application . That is the decryption takes place on a secure platform. In step the PIN reveal application provides the received PIN character to the Web IVR interface server and the user interface of the Web IVR interface server reveals the PIN character to the account holder. In an Internet embodiment the PIN character may be displayed on a web page. In an IVR embodiment the PIN character may be communicated to the account holder using a pre recorded message.

In step the Web IVR interface server determines whether to stop providing the PIN character to the account holder. Continuing the Internet example from step if the account holder deselects the PIN character A the web page can re mask the PIN character A. The Web IVR interface server can also determine to stop providing the PIN character based on a time period. For example the Web IVR interface server can stop providing the PIN character based on a period of inactivity. In an IVR embodiment the PIN character may be verbalized a single time. If the Web IVR interface server determines to stop providing the PIN character the method proceeds to step . Otherwise the method returns to step to continue providing the PIN character.

In step the PIN reveal application and the Web IVR interface server delete the previously displayed or verbalized PIN character. The PIN character can be deleted at both servers by overwriting memory used to temporarily store the PIN character with random data or by any other suitable means for clearing computer memory.

In step the PIN reveal application determines whether to request another PIN character from the HSM . For example the account holder may request each PIN character one at a time until the entire PIN has been revealed via the user interface one character at a time. Or in the alternative the PIN reveal application may operate to request the remaining PIN characters in sequential fashion until each character is presented via the user interface one character at a time. In another example the PIN reveal application may limit the account holder to retrieving a portion of the entire PIN only such as the first two PIN characters one character at a time. If another PIN character is requested the method returns to step . Otherwise the method proceeds to step .

In step the HSM deletes the PIN block from memory. Although this step is not necessary for security or compliance purposes the HSM can free the memory for other purposes. After step the method ends. Of course the Web IVR interface server may continue to interact with the account holder as necessary to complete the account holder s service.

Although the method for providing an account holder with a PIN has been described in terms of presenting an account holder with a PIN one character at a time the method can be adapted to present more than one PIN character at a time. For example conventional financial account PINs typically include four numerical characters. Based on current standards and best practices prohibiting the storage of a decrypted PIN in its entirety outside of an HSM or a PIN mailer the method could be adapted to present one two or three of the four PIN characters at a time via the user interface. However displaying multiple characters can present security risks. For example if a hacker or packet sniffing program somehow gains access to the communication between the PIN reveal application and the user interface the hacker could access half or more of the account holder s PIN leaving only one or two PIN characters to resolve. If the PIN comprises a common pattern such as 1 2 3 4 and the characters 1 and 2 are revealed the hacker could easily determine the remaining PIN characters.

In step the account holder makes a request at the user interface to set or modify a PIN associated with an account such as a financial account. In an Internet web site embodiment the account holder may use a pointing device to click on a link or tab displayed on a web page associated with the account. For example the account holder may use a mouse coupled to computer to click the link or tab. In an IVR embodiment the account holder may press a key pad on mobile phone that corresponds with a Set PIN selection.

In step the Web IVR interface server determines whether any additional security measures are required for the account holder to receive the PIN. This determination can be based on a status of the account holder or on the type of account that the PIN is associated with. Alternatively all account holders and all account types may require additional security. If additional security is required the method proceeds to step . If no additional security is required the method proceeds to step .

In step the account holder is authenticated based on the additional security measures. The user interface may prompt the account holder for additional security information such as a CVV number printed on a card associated with the account. The Web IVR interface server may then compare information received from the account holder to account information stored at the Web IVR interface server to authenticate the account holder. Alternatively the Web IVR interface server may send the information to a card processing server for authentication. Step may be substantially similar to that of step described in detail below with reference to .

In step the Web IVR interface server makes a call to a PIN set application at a PIN application server and sends account information to the PIN set application . The account information can include any information that is included in a PIN block such as an account number associated with the account. The account information may be stored at the Web IVR interface server . Alternatively the account information may be stored at a card processing server and the Web IVR interface server may retrieve the account information from the card processing server prior to sending the account information to the PIN set application .

In step the PIN set application sends the account information to an HSM at an HSM server along with a request to initialize a new PIN block for the account. The HSM creates a new PIN block for the account and waits for PIN characters from the PIN set application .

In step the PIN set application calls the user interface of the Web IVR interface server to prompt the account holder for a PIN character. In an Internet embodiment an Internet web site provided by the Web IVR interface server may provide a web page having a text entry box for entering a PIN character. In an IVR embodiment an IVR application at the Web IVR interface server may prompt the account holder for a PIN character using a pre recorded message.

In step the account holder provides the PIN set application with a PIN character via the user interface of the Web IVR interface server . In the Internet embodiment of step the account holder can enter a character into the text entry box using a keyboard coupled to the computer . In the IVR embodiment of step the account holder can press a key on a mobile phone keypad corresponding to the PIN character that the account holder selects.

In step the PIN set application receives the PIN character from the user interface and sends the received PIN character to the HSM . After sending the PIN character to the HSM in step the PIN set application deletes the PIN character. In certain exemplary embodiments the PIN set application immediately deletes the PIN character after sending to the HSM.

In step the PIN set application determines if all PIN characters have been received by the HSM . If all PIN characters have been received the method proceeds to step . If there are additional PIN characters that are required from the account holder the method returns to step to request another PIN character.

In step the HSM validates the received PIN comprising the received PIN characters. That is the HSM determines if the PIN is a weak PIN or a strong PIN. This validation may be completed by comparing the received PIN to a list of PINs that are identified as weak PINS. For example the PIN 1 2 3 4 may be classified as weak. The HSM may then send a message to the PIN set application to request that the account holder provide a new PIN. This validation step necessarily takes place before the PIN is encrypted. By having the HSM perform this validation the PIN is stored at a secure location rather than on a server that could be vulnerable to security breaches.

In step the HSM encrypts the PIN characters into the PIN block created in step . That is the encryption takes place on a secure platform. The HSM may also encrypt the account information into the PIN block.

In step the PIN set application requests the encrypted PIN block from the HSM . In step the HSM sends the encrypted PIN block to the PIN set application . In step the PIN set application sends the encrypted PIN block to the card processing server and the card processing server stores the encrypted PIN block in a PIN block repository . In step the card processing server implements the new PIN contained in the received PIN block. Thus the card processing server will reference the new PIN when processing transactions involving the account. After step the method ends. Of course the Web IVR interface server may continue to interact with the account holder as necessary to complete the account holder s service.

In step the account holder provides the user interface with the requested information and in step the requested information is received at the Web IVR interface server . In step the Web IVR interface server authenticates the account holder using the received additional security information. In certain exemplary embodiments the Web IVR interface server authenticates the account holder by comparing the received additional security information to account information stored at the Web IVR interface server . In certain embodiments the Web IVR interface server sends the received additional security information to a card processing server or other computing system to authenticate the user. The card processing server can send a message to the Web IVR interface indicating whether the account holder is authenticated.

In step if the account holder is authenticated the method proceeds to step of . If the account holder is not authenticated the method returns to step to prompt the account holder to re enter additional security information. In certain exemplary embodiments the account holder may be limited to a certain number of attempts to be authenticated by the Web IVR interface server . For example after three unsuccessful attempts the account that the account holder is attempting to access may be frozen until the account holder can verify their identity.

The user interface includes instructions to direct an account holder as to how to access a PIN associated with an account. Although in this exemplary embodiment the PIN includes 4 PIN characters A D one skilled in the art would appreciate that the user interface could be configured to support PINs having any number of characters. In this screen image of the user interface the account holder has placed a cursor over the PIN character A and clicked a pointing device such as a mouse coupled to computer to reveal the PIN character A. The remaining PIN characters B D are masked using an asterisk. If the account holder deselects the PIN character A the PIN character A would also become masked. The account holder could then select another PIN character such as PIN character B to reveal that PIN character.

A PIN can be stored in an encrypted PIN block as an offset to a natural PIN rather than storing the actual characters that make up the PIN. Typically the natural PIN is based on an account number or card number associated with a financial account and is determined by encrypting the account or card number using a key. The PIN offset is the difference between a PIN that the account holder selects and the natural PIN associated with the account. For example a natural PIN for an account may be 1234 and the account holder may select 4689 as their PIN for the account. In this example the PIN offset is the difference between 4689 and 1234 3455 . The method described below uses conventional calls to an HSM and a PIN offset masking technique to decrypt one or more characters of a PIN at a time and provide the decrypted characters to the account holder. For clarity of subsequent description the method is described in terms of providing a PIN to an account holder one PIN character at a time. One skilled in the art having the benefit of the present disclosure would appreciate that the method could be used to provide more than one PIN character simultaneously to the account holder. However as described above current standards and best practices prohibiting the storage of a decrypted PIN in its entirety outside of an HSM or a PIN mailer and providing more than one PIN character at a time presents additional security risks.

Referring to in step an account holder accesses a user interface provided by the Web IVR interface server and navigates to a PIN reveal web page or IVR menu to obtain one or more characters of a PIN associated with an account of the account holder. Step may be substantially similar to that of steps through of .

In step the Web IVR interface server requests an encrypted PIN block that stores the PIN offset for the account holder s account from a card processing server . In step the card processing server sends the PIN block to the Web IVR interface server . In step the Web IVR interface server makes a call to a PIN reveal application at a PIN application server to provide the one or more PIN characters to the account holder and sends the PIN block to the PIN reveal application .

In step random or pseudo random account data is generated. This random account data can include a card number for a payment card associated with the account such as a sixteen digit credit card number an expiration date for the payment card and any other account data. A payment card can be any type of card associated with a payment account including a debit card credit card pre paid gift card stored value card fleet card department store card or can simply be an account number where a physical card is not used. In certain exemplary embodiments the PIN reveal application or another application running on the PIN application server generates random account data for each session of an account holder accessing their PIN. In certain alternative embodiments the HSM generates one or more sets of random account data for use by the PIN reveal application .

In step the PIN reveal application makes a call to the HSM to generate a PIN offset using the encrypted PIN block received in step and the random account data generated in step . In step the HSM generates the new PIN offset using the encrypted PIN block and the random account data. To generate the new PIN offset the HSM can first determine the account holder s PIN by decrypting the encrypted PIN block. The HSM can then determine a natural PIN for the random account data and calculate the new PIN offset using the account holder s PIN and the natural PIN for the random account data.

In step the HSM sends the generated PIN offset to the PIN reveal application . In step the PIN reveal application randomizes a portion of the generated PIN offset. In this exemplary embodiment where the PIN is provided to the account holder one PIN character at a time each offset character except the one offset character corresponding to the PIN character to be provided to the account holder is randomized. This one offset character corresponding to the PIN character to be provided to the account holder is left unchanged. For example if the account holder s PIN has four characters and the PIN reveal application is working to provide the first PIN character to the account holder the PIN reveal application leaves the first character of the generated PIN offset unchanged and randomizes the other three PIN offset characters.

In step the PIN reveal application calls the HSM to create a new encrypted PIN block using the random account data and the modified PIN offset having the one unchanged PIN offset character and the randomized PIN offset characters and sends the random account data and the modified PIN offset to the HSM . In step the HSM creates a new encrypted PIN block using the random account data and the modified PIN offset.

In step the PIN reveal application calls the HSM to decrypt the new encrypted PIN block to determine the PIN corresponding to the modified PIN offset and the random account data. In step the HSM decrypts the new encrypted PIN block and sends the decrypted PIN to the PIN reveal application . This decrypted PIN includes the one PIN character from the account holder s actual PIN and random characters for each other PIN character. Continuing the example described in step if the first of the four PIN characters is to be provided to the account holder in this iteration the first PIN character in the decrypted PIN would match the account holder s actual PIN whereas the other three PIN characters are random. Thus less than the entirety of the account holder s PIN is decrypted.

In step the PIN reveal application extracts the one PIN character corresponding to the PIN offset character left unchanged in step . The PIN reveal application then provides this PIN character to the Web IVR interface server and the user interface of the Web IVR interface server provides the PIN character to the account holder. Similar to the method of the PIN character can be displayed on a web page in an Internet embodiment or communicated using a pre recorded message in an IVR embodiment.

In step the PIN reveal application and the Web IVR interface server delete the decrypted PIN. The decrypted PIN can be deleted at both servers by overwriting memory used to temporarily store the decrypted PIN with random data or by any other suitable means for clearing computer memory.

In step the PIN reveal application determines whether to provide the account holder with another PIN character. Similar to the method of the account holder may request each PIN character one at a time until the entire PIN has been revealed via the user interface one character at a time. Or in the alternative the PIN reveal application may repeat steps for each PIN character sequentially until each character is presented to the account holder one character at a time. In another example the PIN reveal application may limit the account holder to retrieving a portion of the entire PIN only such as the first two PIN characters one character at a time. If another PIN character is to be provided to the account holder the method returns to step . Otherwise the method proceeds to step . In step the HSM deletes the PIN block random account data and any other information stored while performing the steps of method . The PIN reveal application also deletes the random account data from the PIN application server . After step the method ends.

To illustrate the operation of one embodiment of this method an example is provided. The example disclosed herein is not intended to limit the scope of the foregoing disclosure and instead is provided solely to illustrate one particular embodiment of the method as the method relates to one specific four character PIN. In this example let the account holder s actual PIN be 5438 and the random account data include an card number of 4123123123123 and an expiration date of June 1965. In step the HSM may generate a PIN offset for this PIN and random account data of 8535 . To provide the first PIN character to the account holder in step the PIN reveal application randomizes the last three characters of the PIN offset and leaves the first character unchanged. For example this new PIN offset may be 8962 where the first offset character remains 8 while the other three offset characters are random numbers 962 . In step the HSM creates an encrypted PIN block using this PIN offset and random account data. In step the HSM decrypts the PIN block and outputs a decrypted PIN of 5897 where the first PIN character of the decrypted PIN matches the first character of the account holder s PIN while the other PIN characters are random. The PIN reveal application can then provide the first PIN character to the account holder in step . As described above the PIN reveal application can repeat this process to provide the account holder with each other PIN character.

In step random or pseudo random account data is generated. This random account data can include a card number such as a sixteen digit credit card number expiration date and any other account data. In certain exemplary embodiments the PIN set application or another application running on the PIN application server generates random account data for each session of an account holder setting or modifying their PIN. In certain alternative embodiments the HSM generates one or more sets of random account data for use by the PIN set application .

In step the PIN set application prompts the account holder for each PIN character to include in the PIN. For each PIN character the PIN set application appends random characters to the PIN character to create a complete PIN. The PIN set application then makes a call to the HSM to generate a PIN offset for the complete PIN using the random account data. The PIN set application repeats this process for each PIN character and creates a combination PIN offset using the PIN offset character in each generated PIN offset corresponding to each non random PIN character received from the account holder. Step is described in further detail below with reference to .

In step the PIN set application retrieves actual account information associated with the account holder s account. This actual account information can include any information that is included in a PIN block such as an account number associated with the account and a card number for a card e.g. credit or debit card associated with the account. The account information may be stored at the Web IVR interface server . Alternatively the account information may be stored at a card processing server and the Web IVR interface server may retrieve the account information from the card processing server prior to sending the account information to the PIN set application .

In step the PIN set application makes a call to the HSM to create a new encrypted PIN block and sends the actual account information created PIN offset and random account data to the HSM . The HSM can determine what the actual PIN is from the created PIN offset and the natural PIN of the random account data.

In step the HSM can validate the security strength of the PIN. That is the HSM determines if the PIN is a weak PIN or a strong PIN. This validation may be completed by comparing the received PIN to a list of PINs that are identified as weak PINS. For example the PIN 1 2 3 4 may be classified as weak. The HSM may then send a message to the PIN set application to request that the account holder provide a new PIN. This validation step necessarily takes place before the PIN is encrypted. By having the HSM perform this validation the PIN is stored at a secure location rather than on a server that could be vulnerable to security breaches. Step can be substantially similar to that of step of described above. In step the HSM creates a new encrypted PIN block using the actual PIN determined by the HSM and the actual account information.

In step the PIN set application requests the new encrypted PIN block from the HSM . In step the HSM sends the new encrypted PIN block to the PIN set application . In step the PIN set application sends the new encrypted PIN block to the card processing server and the card processing server stores the encrypted PIN block in a PIN block repository . In step the card processing server implements the new PIN contained in the received PIN block. Thus the card processing server will reference the new PIN when processing transactions involving the account. After step the method ends. Of course the Web IVR interface server may continue to interact with the account holder as necessary to complete the account holder s service.

In step the account holder provides the PIN set application with a PIN character via the user interface of the Web IVR interface server . In the Internet embodiment of step the account holder can enter a character into the text entry box using a keyboard coupled to the computer . In the IVR embodiment of step the account holder can press a key on a mobile phone keypad corresponding to the PIN character that the account holder selects.

In step the PIN set application places the received PIN character into the appropriate PIN position and appends random or pseudo random characters to the received PIN character to create a complete PIN. For example if the PIN includes four PIN characters and the received PIN character is the first PIN character the PIN set application places the received PIN character into the first PIN character position and places a random PIN character into each of the second third and fourth PIN character positions. The PIN set application follows a similar procedure for each of the second third and fourth PIN characters after they are obtained from the account holder.

In step the PIN set application makes a call to the HSM to generate a PIN offset using the complete PIN created in step and random account data such as the random account data generated in step of . In step the HSM generates a PIN offset using the complete PIN created in step and the random account data and sends this generated PIN offset to the PIN set application . In step the PIN set application stores the generated PIN offset at the PIN application server .

In step the PIN set application and the Web IVR interface server delete the PIN character received from the account holder. Thus only one actual PIN character is stored at the Web IVR interface server and the PIN set application at a time. The PIN character can be deleted at both servers by overwriting memory used to temporarily store the decrypted PIN with random data or by any other suitable means for clearing computer memory.

In step the PIN set application determines whether all of the PIN characters have been received and a corresponding PIN offset generated for each of the PIN characters. Steps through of the method repeat until each PIN character has been received and a PIN offset is generated for each of the PIN characters. If all PIN characters have been received the method proceeds to step . If there are additional PIN characters that are required from the account holder the method returns to step to request another PIN character.

In step the PIN set application creates a new PIN offset using appropriate characters from each of the PIN offsets. For example if the PIN includes four PIN characters the PIN set application extracts the PIN offset character in the first position of the PIN offset generated for the first PIN character and places that in the first position of the new PIN offset. Similarly the PIN set application extracts the PIN offset character in the second position of the PIN offset generated for the second PIN character and places that offset character in the second position of the new PIN offset. The PIN set application extracts the PIN offset character in the third position of the PIN offset generated for the third PIN character and places that offset character in the third position of the new PIN offset. Finally the PIN set application extracts the PIN offset character in the fourth position of the PIN offset generated for the fourth PIN character and places that offset character in the fourth position of the new PIN offset. Thus the new PIN offset includes the PIN offset corresponding to each of the received PIN characters in the appropriate PIN offset positions. After step the method proceeds to step as referenced in .

To illustrate the operation of one embodiment of the method an example is provided. The example disclosed herein is not intended to limit the scope of the foregoing disclosure and instead is provided solely to illustrate one particular embodiment of the method as the method relates to one specific four character PIN assembly example.

In step the account holder provides a first PIN character of 5 . In step the PIN set application appends three random or pseudo random characters 1 7 3 to the second third and fourth PIN character positions to create a first complete PIN of 5171 In step the HSM creates a first PIN offset of 1286 using the first complete PIN and the random account data . After the first PIN character is converted to a first PIN offset this first PIN offset is stored at the PIN application server in step and the first PIN character is deleted by the PIN set application and the Web IVR interface server .

After the first PIN character is received converted to a first PIN offset and stored at the PIN application server the process is repeated for the second PIN character . In step the account holder provides the second PIN character of 2 . In step the PIN set application appends three random or pseudo random characters 7 3 9 to the first third and fourth PIN character positions to create a second complete PIN of 7239 . In step the HSM creates a second PIN offset of 1286 using the second complete PIN and the random account data . After the second PIN character is converted to a second PIN offset this second PIN offset is stored at the PIN application server in step and the second PIN character is deleted by the PIN set application and the Web IVR interface server .

After the second PIN character is received converted to a second PIN offset and stored at the PIN application server the process is repeated for the third PIN character . In step the account holder provides the third PIN character of 8 . In step the PIN set application appends three random or pseudo random characters 8 3 5 to the first second and fourth PIN character positions to create a third complete PIN of 8385 . In step the HSM creates a third PIN offset of 4498 using the third complete PIN and the random account data . After the third PIN character is converted to a third PIN offset this third PIN offset is stored at the PIN application server in step and the third PIN character is deleted by the PIN set application and the Web IVR interface server .

After the third PIN character is received converted to a third PIN offset and stored at the PIN application server the process is repeated for the fourth PIN character . In step the account holder provides the fourth PIN character of 1 . In step the PIN set application appends three random or pseudo random characters 7 3 8 to the first second and third PIN character positions respectively to create a fourth complete PIN of 7381. In step the HSM creates a fourth PIN offset of 3494 using the fourth complete PIN and the random account data . After the fourth PIN character is converted to a fourth PIN offset this fourth PIN offset is stored at the PIN application server in step and the fourth PIN character is deleted by the PIN set application and the Web IVR interface server .

After all of the PIN characters are received and converted to PIN offsets the PIN set application extracts the appropriate PIN offset character from each of the PIN offsets to assemble a combined PIN offset in step . Specifically the PIN set application extracts the first PIN offset character of 1 from the first PIN offset and places this PIN offset character in the first position in the combined PIN offset . Likewise the PIN set application extracts the second PIN offset character of 3 from the second PIN offset and places this PIN offset character in the second position in the combined PIN offset . The PIN set application extracts the third PIN offset character of 9 from the third PIN offset and places this PIN offset character in the third position in the combined PIN offset . Finally PIN set application extracts the fourth PIN offset character of 4 from the fourth PIN offset and places this PIN offset character in the fourth position in the combined PIN offset . This produces a combined PIN offset of 1394 . In step the HSM creates a new encrypted PIN block having a PIN of 5281 using the combined PIN offset and the actual account information that the received PIN is associated with.

One of ordinary skill in the art would appreciate that the present invention supports systems and methods for securely disclosing a personal identification number PIN associated with a financial account to an account holder and for receiving a new PIN from the account holder are provided. A PIN reveal application can interact with a hardware security module HSM using a PIN offset masking process and randomly generated account data to reveal the PIN to the account holder one or more PIN characters at a time. A PIN set application also can interact the HSM using a PIN offset masking process and randomly generated account data to receive a new PIN for the account one or more PIN characters at a time. In each of the PIN reveal and PIN setting processes less than the entirety of the PIN is stored in an unencrypted format outside of the HSM only.

The exemplary methods and steps described in the embodiments presented previously are illustrative and in alternative embodiments certain steps can be performed in a different order in parallel with one another omitted entirely and or combined between different exemplary embodiments and or certain additional steps can be performed without departing from the scope and spirit of the invention. Accordingly such alternative embodiments are included in the invention described herein.

The invention can be used with computer hardware and software that performs the methods and processing functions described above. As will be appreciated by those skilled in the art the systems methods and procedures described herein can be embodied in a programmable computer computer executable software or digital circuitry. The software can be stored on computer readable media. For example computer readable media can include a floppy disk RAM ROM hard disk removable media flash memory memory stick optical media magneto optical media CD ROM etc. Digital circuitry can include integrated circuits gate arrays building block logic field programmable gate arrays FPGA etc.

Although specific embodiments of the invention have been described above in detail the description is merely for purposes of illustration. It should be appreciated therefore that many aspects of the invention were described above by way of example only and are not intended as required or essential elements of the invention unless explicitly stated otherwise. Various modifications of and equivalent steps corresponding to the disclosed aspects of the exemplary embodiments in addition to those described above can be made by a person of ordinary skill in the art having the benefit of this disclosure without departing from the spirit and scope of the invention defined in the following claims the scope of which is to be accorded the broadest interpretation so as to encompass such modifications and equivalent structures.

