---

title: Adaptive image maps
abstract: A computer implemented method of processing an image for display on a mobile communication device includes extracting a portion of an image based on an image map. The image map relates to the portion of the image. The method also includes generating a document that comprises the extracted portion of the image and transmitting the generated document to a remote device for display. The method may also include assigning a selectable link to the extracted portion of the image and receiving a request from the remote device for an initial document having the image and image map. Additionally, the method may include storing in a database the generated document and transmitting the stored generated document in response to future requests for the initial document.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08064727&OS=08064727&RS=08064727
owner: Google Inc.
number: 08064727
owner_city: Mountain View
owner_country: US
publication_date: 20100820
---
This application is a continuation application of and claims priority to U.S. application Ser. No. 11 233 288 filed on Sep. 22 2005 entitled System and Method for Image Processing the entire content of which are hereby incorporated by reference.

As computers and computer networks become more and more able to access a variety of graphical information people are demanding more ways to obtain that information. Specifically people now expect to have access on the road in the home or in the office to information previously available only from a permanently connected personal computer hooked to an appropriately provisioned network. They want images of current people in the news from their cell phones e mail with photographs of family from their personal digital assistants PDAs and up to date documents with embedded pictures from their palm tops. They also want all of this information when traveling whether locally domestically or internationally in an easy to use portable device.

Portability generally requires a device small in size which in turn limits the screen area available for displaying content. This limitation may require the portable device to reduce images to an illegible or unrecognizable state when displayed on a small screen. Alternatively the image may be displayed at a larger size but a user must scroll to see some parts of the image.

Additionally some images may be associated with image maps that defined portions of the image as hotspots or links a user may select to perform an action such as navigating to a web page. Some current portable devices do not maintain the link with the defined portions of the image. Instead the devices separate the links from the image and list them as textual links outside the image. These separated links however are no longer associated with the context provided by the image to guide the user in selecting the links. The separation of the links from the graphical context can confuse the user as to the content of the links.

This document discloses methods and systems for processing an image for display on a wireless device.

In accordance with one aspect a computer implemented method of processing an image for display on a mobile communication device is disclosed. The method includes extracting a portion of an image based on an image map which relates to the portion of the image generating a document that comprises the extracted portion of the image and transmitting the generated document to a remote device for display. Additionally a selectable link may also be assigned to the extracted portion of the image.

In one implementation the method may include receiving a request from the remote device for an initial document that has the image and image map and storing the generated document in a database. The stored generated document may be transmitted in response to future requests for the initial document. The request may also include information associated with display capabilities of the remote device. The method may include modifying dimensions of the extracted portion of the image based on the display capabilities. In addition the method may include cropping the extracted portion of the image based on the display capabilities.

In another implementation the method may also include retrieving the initial document from a remote web server. The image map may be selected by organizing elements in the initial document into a document object model tree and traversing the tree to locate the image map. The image map may also be selected by serially parsing elements in the initial document to locate the image map. Content of the image map may be generated using a facial recognition algorithm where the content includes coordinates used to specify the portion of the image for extraction. Also content of the image map may be generated using an optical character recognition algorithm where the content comprises coordinates used to specify the portion of the image for extraction.

As one example the image map includes a markup language tag used to specify that the extracted portion of the image should be sized for display on a mobile device browser. An area adjacent to the extracted portion may also be extracted so that a combination of the area and portion are a predetermined size or shape. Also image data may be generated for display in an area adjacent to the extracted portion so that a combination of the generated image data and the extracted portion are a predetermined size or shape.

In yet another implementation a second portion of the image may be extracted based on the image map and the second portion may be included in the generated document for display on the remote device. A position in which the portions are displayed is based on the image map where the image map further includes position indicators. Also a position in which the portions are displayed may be based on the content of the image. The second portion and the first portion may be a same size and shape.

In accordance with another aspect a computer implemented system for selecting portions of an image for display on a mobile device is disclosed. The system includes a parser to select an image and an image map from a first electronic document means for extracting a portion of the image wherein a position and perimeter of the portion are based on the image map a document generator to generate a second electronic document comprising the extracted portion of the image and an interface to transmit the second electronic document to a remote device.

In accordance with yet another aspect a system for extracting a portion of an image for display on a mobile device is disclosed. The system includes an extractor to divide an image into segments based on coordinates associated with the image a document generator to encode at least one of the segments for display in an electronic document and an interface to transmit the electronic document to a remote device.

The systems and techniques described here may provide one or more of the following advantages. A system may select and extract portions from an image so that a user may more conveniently view the image on a portable device. A system may extract portions of interest in the images to display. Also a system may enable a remote device to maintain a graphical context for links used within an image map. This maintenance of the graphical context may be possible even if the remote device does not have an algorithm to display image maps. Additionally the system can be implemented with portable systems such as cellular telephones having limited resources such as memory and processing power.

The details of one or more implementations are set forth in the accompanying drawings and the description below. Other features objects and advantages of the implementations will be apparent from the description and drawings and from the claims.

The image may be contained in an initial document having a format such as a word processing document a stand alone image file an electronic mail message or a web page. In one implementation the initial document contains an image with an associated image map. The image map may include information such as coordinates of opposite corners of a rectangle that specify one or more areas within the image that have an action associated with them. For example the image portion A of depicts the northeastern section of the United States. A user may select this image portion A and the browser may be directed to a website describing tourism in the Northeast.

In some implementations the processing of the document is initiated by a request represented by the arrow from the remote wireless communication device for the initial document having the image . An image processing system receives the request. A transcoder in the image processing system processes the image and the image processing system transmits the generated document containing the image portion A to the wireless communication device .

In other implementations the image processing system sends the generated document to the wireless communication device without a request from the wireless communication device . For example an image in an electronic mail message may be processed by the image processing system and transmitted to the wireless communication device without being requested by the wireless communication device .

In some implementations the image processing system retrieves the initial document from a remote web server as represented by the arrow . For example a user of the wireless communication device may view a list of web page links retrieved from a web search. The list may include a web page link specifying a web page at the remote web server such as 

For example selecting the Northeast area A may take the user to another web page that lists tourist destinations in the northeastern states of the US or it may initiate an electronic mail message with a To field directed to a member of the Northeast US board of tourism. Alternatively the areas A E may represent regions of particular interest in the image . For example an image of a person may have the person s face as a defined area. Additionally an image of a group of people may have a defined area around a particular person if the image is accompanied by text mentioning that person. The generated document contains the image portion A corresponding to the area A in the initial document . In the implementation of the generated document also contains other image portions B E corresponding to the other areas B E in the image .

In the implementation shown in the transcoder in the image processing system may extract the image portions A E from the image using the areas A E in the image map. Particularly each of the image portions A E corresponds to each of the areas A E in the image map respectively.

The image processing system is provided with an interface to allow communications with a network such as the Internet. The image processing system may communicate with various devices such as the wireless communication device and the remote web server . The communication flow for any device may be bidirectional so that the image processing system may receive information such as commands from the devices and may also send information to the devices.

Commands and requests received from devices may be provided to a request processor which may interpret a request associate it with predefined acceptable requests and pass it on such as in the form of a command to another component of the image processing system to perform a particular action. For example in an implementation where the image processing system is part of the Internet search provider s general system the request may include a search request. The request processor may cause a search engine to generate search results corresponding to the search request. The search engine may use data retrieval and search techniques like those used by the Google PageRank system. The results generated by the search engine may then be provided back to the original requester using a response formatter which carries out necessary formatting on the results.

The search engine may rely on a number of other components for its proper operation. For example the search engine may refer to an index of web sites instead of searching the web sites themselves each time a request is made so as to make the searching much more efficient. The index may be populated using information collected and formatted by a web crawler which may continuously scan potential information sources for changing information.

The transcoder may access a system storage . The system storage may be one or more storage locations for files needed to operate the system such as applications maintenance routines and management and reporting software. In some implementations the transcoder may store the generated document in the system storage . The image processing system may transmit the stored generated document in response to future requests for the initial document .

The transcoder may include several components used to process the initial document and the image . A parser may select the image and an image map associated with the image from the initial document . The parser may decode the entire initial document using an application programming interface API to access the content of the initial document . For example if the initial document is a web page the parser may access the elements or document objects of the web page using a document object model DOM API. Using the DOM API the parser may load the document objects from the initial document into memory using a variety of data structures such as an array a queue or a tree. The DOM may allow the document objects to be accessed randomly or in an order different from the order in which they are specified in the initial document . Alternatively the parser may input the initial document as a series of characters or character strings. The characters or strings may be serially compared with a set of predefined identifiers that specify the existence of an image and its associated image map.

The image map may contain one or more markup language tags that define the image map . For example hypertext markup language HTML uses the tag for an image and for an image map. The tag may contain tags that specify the coordinates and hyperlink of each of the areas A E in the image using a coords attribute and an href attribute respectively. The tag may also contain a shape attribute specifying the shape of the area in the image such as a rectangle a circle or a polygon. If the image has an associated image map the tag may include a usemap attribute. When parsing the document content randomly such as with a DOM the usemap attribute can be used to locate an image map associated with the image. The usemap attribute may precede the name of the image map which may be used to locate and access the image map within a data structure such as the DOM tree shown in .

The transcoder may also include an extractor that uses the coordinates contained in the image map to extract the image portion A from the image . The coordinates may indicate a position and a perimeter of the image portion A extracted. The coordinates may be components of a markup language such as attributes within an HTML tag as described above.

In some implementations a map content generator may provide coordinates of image portions to the extractor . The map content generator may contain a facial recognition FR module and an optical character recognition OCR module that determine the coordinates of faces and text respectively within an image or an image portion. The map content generator may contain other modules such as a module that recognizes areas of high contrast to locate objects within an image e.g. a dark building against a light colored sky . The coordinates may also supplement or modify the coordinates located in the image map . For example the FR module may determine coordinates of a face located in an image portion defined by an image map. Alternatively the map content generator may provide the coordinates for an image that does not have an associated image map included in the initial document . For example the OCR module may determine coordinates of text located in an image that has no image map generate an image map for the image and populate the image map with the coordinates .

The transcoder may make further modifications to the extracted portions A E before incorporating the portions A E into the generated document . For example the request from the wireless communications device may include display capability information regarding the physical capabilities of the display in the wireless communication device such as the display s dimensions and resolution.

The transcoder may use the display capability information to determine that the image portion A is for example either too large or too detailed for the wireless communication device to display effectively to the user. In this situation the map content generator may use modules such as the FR module and the OCR module to focus on relevant information in the image portion A such as a face or text. The output of the map content generator may include the coordinates that are used by the extractor to define how to process the extracted portions. For example the coordinates may define an area of the image portion A that should be cropped. Cropping may include shifting an image so that it is centered on a face or text and removing surrounding image data so that the resulting cropped image displays at a smaller size. The coordinates may include points along an x and a y axis where the points define boundaries of the cropped image.

In another implementation the display capability information may be used to determine coordinates generated by the map content generator . For example if the display capability information indicates the image is too large or too detailed for the wireless communication device to display the FR module and the OCR module could generate the coordinates defining relevant information in the image as described above.

In another implementation the coordinates may be used by the extractor to modify the dimensions of the image or the image portion A by magnifying or shrinking the image or the image portion A. For example the FR module or the OCR module may locate a face or text respectively in the image and may generate coordinates that define an area around these features. The map content generator may generate a magnification or shrinking factor using the display capability information to determine a size to display the image on the wireless communication device . For example each pixel of the shrunken image may be a weighted sum of linearly corresponding pixels such as in the following equation 3 5 2 5. The weights may be associated with the shrinking factor. For instance the shrinking factor may be used to look up the weights in an index or it may be used as a multiplier for a set of weights to produce the appropriate final weights for the shrinking process.

For example the display capability information may contain a resolution of the display used by the wireless communication device such as 480 pixels by 600 pixels. The map content generator may provide a shrinking factor that reduces an image larger than 480 pixels by 600 so that it can fit within the resolution displayed on the wireless communication device .

The coordinates output from the map content generator may include the points along the x and y axes and the magnification or shrinking factor. The extractor may use the coordinates to determine how to process the image or the image portion A. For example if the coordinates include a shrinking factor the extractor may selectively remove pixels in the image or the image portion A.

In some implementations the map content generator ensures that extracted portions are of a predetermined size and shape. For example the map content generator may ensure that image data adjacent to a circular image portion is extracted so that the image portion A is a rectangular shape. In other implementations an image data generator generates image data in an area adjacent to an image portion to ensure that the image portion is a predetermined size and shape. For example the image data generator may add a black rectangular background behind a circular image portion to ensure that the image portion A is rectangular. Additionally the image data generator may determine the color values of the image portion A and generate contrasting or complimenting image data for the background behind the image portion A.

The transcoder may also include a document generator . In one implementation the document generator creates the generated document using the image portion A provided by the extractor and content from the initial document . For example the area A within the image may have an associated HTML attribute specifying a hyperlink to another web page. The document generator may add a selectable link to the image portion A in the generated document corresponding to the hyperlink associated with the area A in the initial document . If the hyperlink is a link to another web page the selectable link within the generated document may contain the network address of the image processing system . In a manner similar to the search list described above the hyperlink first directs the web page request to the image processing system where the image processing system will retrieve the web page and forward it to the wireless communication device after processing the web page. For example the initial document may contain the following hyperlink to another document at a second remote web server 

In optional step the image processing system receives the request for the initial document. In optional step if a generated document corresponding to the initial document already exists the operations move to step . If the generated document does not yet exist the operations move to optional step . For example the image processing system may use an indexed list of generated documents to quickly determine if a generated document exists. In some implementations multiple generated documents may be stored for each initial document corresponding to possible display capabilities of wireless communication devices. For example the display capability information may indicate that the wireless communication device is a cell phone with a display resolution of 128 by 128 pixels. This information may be stored along with a document identifier when a document is generated. Subsequent requests may be compared to the document identifier and the display capability information to determine if a new document should be generated. In the case described above if a different or the same device with a display resolution of 128 by 128 pixels requests the same initial document the index may be queried to determine if the initial document has a version associated with this pixel resolution. If so this document can be returned without generating a new document.

In optional step the initial document may be requested from the remote web server. In optional step the remote web server receives the request and in optional step the remote web server sends a response to the request including the initial document. For example the image processing system requests a web page such as www.cnn.com from the remote web server that hosts the CNN web page. The CNN web server sends a response that includes the web page for www.cnn.com to the image processing system .

In step one or more portions of an image contained in the initial document are extracted based on an image map that may be contained in the initial document. For example the parser within the transcoder identifies the image and the image map contained in the initial document . The extractor extracts the image portion A using the image map . Alternatively the image map may not be contained in the initial document . Instead the map content generator may generate the image map used by the extractor to extract the image portion A.

In optional step selectable links are assigned to the image portions. For example the transcoder may assign the selectable link to the image portion A such as by assigning a hyperlink to the href attribute of an anchor tag placed around the tag associated with the image portion A.

In optional steps and content of the image map may be generated using a facial recognition algorithm and an optical character recognition algorithm respectively. For example the FR module or the OCR module or both may provide the coordinates to the extractor of an image portion that focuses on a face or text respectively. Steps through may occur in a different order. For example facial recognition and optical character recognition may occur before the image portion is extracted.

In step a document including the image portion is generated for the remote device. For example the document generator creates the generated document using the extracted image portion A and the initial document .

In optional step the generated document is stored in a database that may be accessed in response to subsequent requests for the initial document. For example the transcoder may store the generated document in the system storage . In some implementations the transcoder may store along with the generated document the display capability information used to modify the images in the generated document .

In step the generated document is transmitted to the remote device. For example the interface of the image processing system transmits the generated document through the network to the wireless communication device . The operations may complete in step where the generated document is displayed on the remote device.

In the example of the DOM tree contains an node a node and a node representing an tag a tag and a tag respectively in the initial document . The node has a child node . The node and its children may specify the coordinates of the areas A E used to extract the image portions. The node also has a child node . The node is a placeholder for the image . The src attribute of the node indicates the location and name of the image . The usemap attribute of the node indicates the name or id of the node associated with the image . The node may have several child nodes A C. Each of the nodes A C may have a coords attribute specifying the coordinates of the image portion associated with it and an href attribute specifying a hyperlink to be executed when the image portion is selected.

In some implementations the initial document is parsed and loaded into memory such as in the DOM tree of . Here the tag corresponds to the node in the DOM tree . The tags A E correspond to the nodes A C of the DOM tree and the tag corresponds to the node of the DOM tree .

The generated document may include the individual tags A E and tags subsequently referred to as tags A E. Each of the new tags A E specifies one of the image portions extracted by the transcoder . Here the names of the tags A E in the src attributes include the name of the original image and the coordinates of the tags A E respectively. Each of the tags A E is a child of the tags A E respectively which specify the hyperlinks associated with the image portions in the associated href attributes.

In some implementations the HTML tag or attributes in the initial document contain information about how a particular device such as the wireless communication device should size the image for display. For example the HTML code may include tags that identify content for a particular type of device such as a tag a tag a tag and a tag that identify content for a mobile device a personal digital assistant a cell phone and a specific type of cell phone respectively. The tags may also identify a particular type of content such as a tag or a tag that identify a portrait image and text in an image respectively. The map content generator may use these tags to determine the coordinates provided to the extractor .

In some implementations each extracted image portion is sized and shaped the same. For example the image portions A E may be extracted using the maximum size and shape that can be displayed on the wireless communication device . The display capability information may include the dimensions of the display used by the wireless communication device . The map content generator may generate magnification and shrinking factors such that two or more of the image portions A E are sized the same as the display dimensions.

In some implementations the image portions are displayed in an order other than the order of the tags A E such as by grouping image portions by size shape type hyperlink or other associated information within the HTML. For example image portions having hyperlinks to the same network address may be listed together. Circular image portions may be listed before rectangular image portions and polygonal image portions. Image portions may be listed in descending or ascending order according to the original size of the areas A E.

In some implementations the content of the image portions is used to order the image portions such as by grouping faces text or text styles together. For example image portions including bold or large text may be listed before plain or small text. Image portions containing faces may be listed before other image portions that do not contain faces.

Referring to the display order or positioning may be dictated by position indicators included in the image map of the initial document . For example the position indicators may specify that faces are displayed first or that the image portion A is displayed first the image portion B is displayed next and the image portion C is displayed third. In another implementation the position indicators may be generated by the map content generator and output for use by the document generator which may use the position indicators to generate the document with the image portions A E in the specified order.

The system includes a processor a memory a storage device and an input output device . Each of the components and are interconnected using a system bus . The processor is capable of processing instructions for execution within the system . In one implementation the processor is a single threaded processor. In another implementation the processor is a multi threaded processor. The processor is capable of processing instructions stored in the memory or on the storage device to display graphical information for a user interface on the input output device .

The memory stores information within the system . In one implementation the memory is a computer readable medium. In one implementation the memory is a volatile memory unit. In another implementation the memory is a non volatile memory unit.

The storage device is capable of providing mass storage for the system . In one implementation the storage device is a computer readable medium. In various different implementations the storage device may be a floppy disk device a hard disk device an optical disk device or a tape device.

The input output device provides input output operations for the system . In one implementation the input output device includes a keyboard and or pointing device. In another implementation the input output device includes a display unit for displaying graphical user interfaces.

The features described can be implemented in digital electronic circuitry or in computer hardware firmware software or in combinations of them. The apparatus can be implemented in a computer program product tangibly embodied in an information carrier e.g. in a machine readable storage device or in a propagated signal for execution by a programmable processor and method steps can be performed by a programmable processor executing a program of instructions to perform functions of the described implementations by operating on input data and generating output. The described features can be implemented advantageously in one or more computer programs that are executable on a programmable system including at least one programmable processor coupled to receive data and instructions from and to transmit data and instructions to a data storage system at least one input device and at least one output device. A computer program is a set of instructions that can be used directly or indirectly in a computer to perform a certain activity or bring about a certain result. A computer program can be written in any form of programming language including compiled or interpreted languages and it can be deployed in any form including as a stand alone program or as a module component subroutine or other unit suitable for use in a computing environment.

Suitable processors for the execution of a program of instructions include by way of example both general and special purpose microprocessors and the sole processor or one of multiple processors of any kind of computer. Generally a processor will receive instructions and data from a read only memory or a random access memory or both. The essential elements of a computer are a processor for executing instructions and one or more memories for storing instructions and data. Generally a computer will also include or be operatively coupled to communicate with one or more mass storage devices for storing data files such devices include magnetic disks such as internal hard disks and removable disks magneto optical disks and optical disks. Storage devices suitable for tangibly embodying computer program instructions and data include all forms of non volatile memory including by way of example semiconductor memory devices such as EPROM EEPROM and flash memory devices magnetic disks such as internal hard disks and removable disks magneto optical disks and CD ROM and DVD ROM disks. The processor and the memory can be supplemented by or incorporated in ASICs application specific integrated circuits .

To provide for interaction with a user the features can be implemented on a computer having a display device such as a CRT cathode ray tube or LCD liquid crystal display monitor for displaying information to the user and a keyboard and a pointing device such as a mouse or a trackball by which the user can provide input to the computer.

The features can be implemented in a computer system that includes a back end component such as a data server or that includes a middleware component such as an application server or an Internet server or that includes a front end component such as a client computer having a graphical user interface or an Internet browser or any combination of them. The components of the system can be connected by any form or medium of digital data communication such as a communication network. Examples of communication networks include e.g. a LAN a WAN and the computers and networks forming the Internet.

The computer system can include clients and servers. A client and server are generally remote from each other and typically interact through a network such as the described one. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client server relationship to each other.

Although a few implementations have been described in detail above other modifications are possible. Portions of this disclosure discuss the electronic documents including HTML but any number of formats may be processed by the described system including XML Extensible Markup Language WML Wireless Markup Language PDF Portable Document Format word processing formats and image formats. Also the logic flows depicted in the figures do not require the particular order shown or sequential order to achieve desirable results. Also other steps may be provided or steps may be eliminated from the described flows and other components may be added to or removed from the described systems. Accordingly other implementations are within the scope of the following claims.

