---

title: ROM-based direct digital synthesizer with pipeline delay circuit
abstract: A DDS system is disclosed that is configured to provide a variable clock delay that allows timing of data coming out of the ROM to be adjusted. In one example case, a DDS system is provided that includes a ROM for storing phase-to-amplitude conversion data and generating digital amplitude values corresponding to respective digital phase values, and delay circuitry for adjusting timing of data output by the ROM to compensate for propagation delay of the DDS system. The delay circuitry may include, for instance, delay elements that can be selected alone or in combination to adjust the timing. The timing can be adjusted, for example, by adjusting delay of a clock signal that clocks one or more ROM pipeline registers. The system may include a phase accumulator and DAC, and adjusting the timing may include adjusting delay of a clock signal that clocks one or more DAC pipeline registers.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08583714&OS=08583714&RS=08583714
owner: BAE Systems Information and Electronic Systems Integration Inc.
number: 08583714
owner_city: Nashua
owner_country: US
publication_date: 20100212
---
The invention was made with United States Government support under contract DAAD17 02 C 0115 awarded by the Army and the United States Government has certain rights in this invention.

This disclosure relates to communications and more particularly to ROM based direct digital synthesizer architectures.

Direct digital synthesizers DDS include a phase accumulator a phase to amplitude converter and a digital to analog converter DAC . In high speed applications these functional blocks are generally clocked with pipeline registers internal to each block. The phase to amplitude converter can be implemented by various techniques including using a read only memory ROM logic gates or by a combination of logic gates and a sine weighted DAC. ROMs however are typically not used in high speed DDS circuits because propagation delays in the ROM circuit make it either impossible to pipeline at high speed or are too costly to pipeline in terms of power consumption. As such instead of a ROM high speed DDS circuits typically implement the phase to amplitude converter as a combination of logic gates and a sine weighted DAC. Such conventional approaches suffer from limited spurious free dynamic range SFDR typically in the range of 30 dBc to 40 dBc i.e. with respect to carrier frequency amplitude at best.

One embodiment of the present invention provides a direct digital synthesis DDS system. The system includes a read only memory ROM for storing phase to amplitude conversion data and generating digital amplitude values corresponding to respective digital phase values. The system further includes delay circuitry operatively coupled to the ROM and for adjusting timing of data output by the ROM to compensate for propagation delay of the DDS system the delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the ROM. The system may include a phase accumulator for computing the phase values based on a frequency control word. The system may include a digital to analog converter DAC for converting the digital amplitude values into corresponding analog amplitude values. In one such configuration the delay circuitry may also be operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system. In another such configuration the system may include additional delay circuitry operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system the additional delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the DAC. In one particular case the delay circuitry may be responsive to a control signal that can change automatically during operation of the DDS system in response to a change in a DDS operating parameter. In one such configuration the DDS operating parameter may include for example a frequency control word input to DDS system a clock signal for clocking one or more pipeline registers of the ROM and or an environmental variable. In another such configuration the system may further include a processor for generating the control signal. The system may be included for example in a system on chip configuration and may also be implemented with discrete components.

A number of variations will be apparent in light of this disclosure. For instance another example embodiment of the present invention provides a DDS system that includes a phase accumulator for computing the phase values based on a frequency control word. The system further includes a ROM for storing phase to amplitude conversion data and generating digital amplitude values corresponding to respective digital phase values provided by the phase accumulator. The system further includes delay circuitry operatively coupled to the ROM and for adjusting timing of data output by the ROM to compensate for propagation delay of the DDS system the delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the ROM and the delay circuitry adjusts the timing of the data output by the ROM by adjusting delay of a clock signal that clocks one or more pipeline registers of the ROM. The system further includes a DAC for converting the digital amplitude values into corresponding analog amplitude values. In one particular such case the delay circuitry may also be operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system. In another particular case the system may further include additional delay circuitry operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system the additional delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the DAC. In another particular case the delay circuitry may be responsive to a control signal that can change automatically during operation of the DDS system in response to a change in a DDS operating parameter. In one such case the DDS operating parameter may include at least one of the frequency control word the clock signal and or an environmental variable. In another such particular case the system may include a processor for generating the control signal. The system may be included for example in a system on chip or chip set configuration.

Another example embodiment of the present invention provides a DDS system that includes a phase accumulator for computing the phase values based on a frequency control word and a ROM for storing phase to amplitude conversion data and generating digital amplitude values corresponding to respective digital phase values provided by the phase accumulator. The system further includes delay circuitry operatively coupled to the ROM and for adjusting timing of data output by the ROM to compensate for propagation delay of the DDS system the delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the ROM and the delay circuitry adjusts the timing of the data output by the ROM by adjusting delay of a clock signal that clocks one or more pipeline registers of the ROM. The system further includes a DAC for converting the digital amplitude values into corresponding analog amplitude values. The system further includes a processor for generating a control signal to which the delay circuitry is responsive and changing the control signal in response to a change in a DDS operating parameter the DDS operating parameter including at least one of the frequency control word the clock signal and or an environmental variable. In one such case the delay circuitry is also operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system. In another such case the system includes additional delay circuitry operatively coupled to the DAC and for adjusting timing of data output by the DAC to compensate for propagation delay of the DDS system the additional delay circuitry including a plurality of delay elements that can be selected alone or in combination to adjust the timing of the data output by the DAC and the additional delay circuitry adjusts the timing of the data output by the DAC by adjusting delay of a clock signal that clocks one or more pipeline registers of the DAC. The system may be included for example in a system on chip configuration or in a chip set or with discrete components .

The features and advantages described herein are not all inclusive and in particular many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims. Moreover it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and not to limit the scope of the inventive subject matter.

A ROM based DDS system is disclosed that is configured to provide a variable clock delay that allows timing of data coming out of the ROM to be matched to the timing of the DAC. This variable clock delay approach further allows compensation for variations in propagation delays due to process variations and or environmental conditions. The disclosed techniques can be implemented in any number of configurations including integrated system on chip or chip set configurations as well as on printed circuit boards configured with various discrete DDS system components. The speed of the DDS system e.g. below 1 GHz or in the range of 1 to 20 GHz or in excess of 20 GHz will depend on the manufacturing processes employed as well as the particular application at hand as will be appreciated in light of this disclosure.

As previously explained ROMs are typically not used to implement the phase to amplitude converter of a high speed DDS circuit because propagation delays in the ROM circuit make it either impossible to pipeline at high speed or are too costly to pipeline in terms of power consumption. The ROM however can allow for improved SFDR over other approaches. Overcoming the limitations associated with a ROM based DDS to exploit the improved SFDR is not a trivial task.

Thus and in accordance with an embodiment of the present invention a DDS system is provided that is configured with a phase accumulator a ROM based phase to amplitude converter and a DAC. The output bits of the ROM generally have similar propagation delays. An adjustable clock delay circuit is used to take advantage of this approximately uniform although larger than a clock cycle propagation delay of the ROM bits so the ROM can be pipelined and used in high speed DDS circuits to enable improved SFDR.

In one specific example case the adjustable clock delay circuit is used for the pipeline registers at the output of the ROM and in the DAC to match the delayed pipeline timing. The variable clock delay allows the digital timing of the data coming out of the ROM to be matched to the timing of the DAC. Ideally one might consider determining and implementing an appropriate fixed clock delay that would accomplish this timing match between the ROM and DAC. However there are a number of issues associated with using a fixed delay.

For instance and assuming modeling would be used in determining the appropriate fixed clock delay the device models and parasitic extraction are not always sufficiently accurate. As such there is some degree of ambiguity in simulations of a fixed clock delay circuit. In addition there are variations in the devices and metallization from circuit to circuit within a single wafer as well as variation between lots of wafers that impact how well the simulation models match what is actually implemented as circuits which can be measured. In short depending on how tightly the process for making the devices is controlled variations in actual circuits versus models can be relatively high. Moreover even if all the models were perfect the performance of the devices varies for instance with temperature and supply voltages. For example the timing seen at 0 C. will be different than the timing seen at 100 C. This is also the case for example for 10 of nominal voltage supplies versus 10 of nominal voltage supplies. So while it may be possible to design and model a correct timing relationship at one operating condition the design may not work over a wide range of operating conditions.

The adjustable clock delay provided in accordance with an embodiment of the present invention allows for different timing settings to be used depending on variables such as the process variations temperature and supply voltages and also allows for flexibility if there is ambiguity in the modeling. In addition if there are any variations in the expected timing of a simulated DDS circuit compared to the actual timing of a fabricated measured DDS circuit different delay settings can be used to ensure that timing of ROM and DAC meet. This flexibility improves circuit yield and leads to a better chance of circuits working the first time they are fabricated.

The techniques provided herein are particularly suitable for high speed DDSs such as those operating in the 20 to 40 GHz range. These DDSs can be used for example as fast agile local oscillator generators and jammers for system on chip applications in commercial and military platforms. Note however that the techniques here may also be used in lower speed DDS applications if so desired. Numerous other applications will be apparent in light of this disclosure.

As can be seen the DDS system includes a phase accumulator ROM based phase to amplitude converter and a DAC each of which operates in conjunction with a clock signal. The phase accumulator further receives a frequency control word as input as will be explained in turn. In operation the phase accumulator computes phase values representing phase angles and the phase to amplitude converter outputs digital amplitude values corresponding to the phase values e.g. a sine of the phase angle . The DAC converts the digital amplitude values into a corresponding analog amplitude e.g. voltage or current thereby producing an analog sinusoidal output signal e.g. sine wave square wave triangle wave etc .

Any number of suitable process technologies and material systems can be used in fabricating the DDS system. For example for higher speed applications e.g. in excess of 10 GHz the DDS system can be implemented for instance in heterojunction bipolar transistor HBT and or high electron mobility transistor HEMT technology. However if such high speeds are not necessary e.g. less than 2 GHz then other technologies such as complementary metal oxide semiconductor CMOS technology can be utilized. Example materials from which the system can be implemented include III V material systems such as gallium arsenide GaAs or indium phosphide InP or other suitable semiconductor material systems

The phase accumulator can be implemented as typically done and determines the frequency range and resolution of the DDS system. In particular the clock speed at which the phase accumulator operates determines frequency range and the bit width of the frequency control word determines the resolution. The phase accumulator essentially is a counter that increments its count for each pulse of the clock received. The magnitude of the increment is determined by the frequency control word FCW which is binary coded. This FCW sets the phase step size between the clock updates. In general the larger the phase step size the faster the phase accumulator reaches full count and completes the corresponding sinusoidal cycle. Once overflowed the counter effectively wraps around and repeats the counting process.

In operation for instance an 8 bit wide phase accumulator would provide a DDS frequency resolution of 1 256 of the clock frequency with 128 steps of frequency control and a 12 bit wide phase accumulator would provide a DDS frequency resolution of 1 4096 of the clock frequency with 2048 steps of frequency control. For an 8 bit wide phase accumulator an FCW of 1 00000001 would result in the phase accumulator overflowing after 2clock cycles 256 increments and an FCW of 128 01111111 would result in the phase accumulator overflowing after two clock cycles which is the minimum per Nyquist sampling theory. The bit width of the phase accumulator can vary from one embodiment to the next e.g. from 4 to 48 bits and the claimed invention is not intended to be limited to any particular phase accumulator configuration.

As is known the basic tuning equation for a DDS architecture which is f FCW F 2 where fis the output frequency of the DDS system FCW is the binary frequency control word Fis the frequency of the clock signal and n is the bit length of the phase accumulator. Changes to the value of FCW result in immediate and phase continuous changes in the output frequency f. As the fis increased the number of samples per cycle decreases. Since sampling theory dictates that at least two samples per cycle are required to reconstruct the output waveform the maximum fundamental output frequency fis one half the clock frequency F. For instance and assuming the DDS has a 12 bit phase accumulator n 12 and a clock frequency Fof 24 GHz the DDS would be capable of synthesizing output frequencies up to 12 GHz in steps that are 1 4096 of the 24 GHz clock rate. Note however the output frequency may be limited to slightly less than that giving consideration to real life factors such as improving the quality of the reconstructed waveform and output filtering. When generating a constant frequency the output of the phase accumulator increases linearly so the waveform generated by the phase accumulator is effectively a ramp in the digital domain .

The digital phase value output of the phase accumulator is applied to the ROM based phase to amplitude converter which includes one or more ROMs for storing phase to amplitude conversion data and generating the corresponding digital amplitude values for each phase value received from the phase accumulator. As previously explained ROM technology can limit the speed of a DDS. To this end the overall speed of the DDS can be increased by reducing the bit access time of the ROM. For instance and in one example embodiment the ROM included in the ROM based phase to amplitude converter can be implemented with a 16 by 6 bit 36 GHz clock frequency ROM fabricated in any suitable process e.g. InP DHBT process . Any number of fast access ROMs can be used here as will be appreciated. Other embodiments not concerned with speed may of course use slower ROM technology.

The input bit width of the ROM based phase to amplitude converter can vary from one embodiment to the next e.g. from 4 to 24 bits and the claimed invention is not intended to be limited to any particular input bit width range. Likewise the DDS system clock frequency can vary as well and in some embodiments ranges from to 20 GHz to 40 GHz but other embodiments may have a lower or higher clock frequency depending on the given application.

In addition to the ROM technology the phase to amplitude converter is further configured to adjust the digital timing delay of the data coming out of the ROM with respect to the timing of the DAC. The adjustment can be made based on the delay select control signal as will be explained in turn. Among other things the adjustable delay allows for different timing settings to be used depending on factors such as the process variations environmental conditions and supply voltages e.g. emitter coupled logic or transistor transistor logic supply voltages . For instance the adjustable delay can be used to compensate for variations in propagation delays through the ROM and or DAC circuitry due to process variations associated with HBT implementations and or temperature in which the DDS is operating.

The adjustable delay in this example embodiment is shown as being integrated into the ROM based phase to amplitude converter circuitry. However in other embodiments it may be implemented in a separate dedicated component that operatively couples with the ROM based phase to amplitude converter. Moreover the adjustable delay can be implemented for both the ROM and DAC. Alternatively each of the ROM and DAC can have its own independent adjustable delay. Numerous configurations will be apparent in light of this disclosure. The ROM based phase to amplitude converter will be discussed in more detail with reference to and .

The digital amplitude value output of the ROM based phase to amplitude converter is applied to the DAC which can be implemented as conventionally done to convert the digital amplitude signal into its analog equivalent. The resolution of the DAC can vary from one embodiment to the next but in some example embodiments is in the range of 4 to 12 bits. The claimed invention is not intended to be limited to any particular DAC configuration. Just as with the ROM based phase to amplitude converter the DAC is referenced to the clock signal and a clock delay associated with the DAC can be adjusted in accordance with an embodiment of the present invention. Among other standard DAC componentry e.g. resistive ladder network current sources and switches bias circuit reference current etc the DAC includes one or more pipeline registers clocked by the clock signal as adjusted by an adjustable clock delay circuit in accordance with one example embodiment.

Any number of variations on the DDS shown in will be apparent in light of this disclosure. For instance other embodiments may include other componentry such as a buffer circuit on the output of the DAC to drive a 50 ohm differential load off chip or to some other target destination. In addition the components may be integrated into a signal circuit e.g. system on chip configuration or may be implemented as separate modules that operatively couple to provide the desired DDS functionality. Other circuitry such as processors or control circuitry for providing control and clock signals power supply circuitry filtering and or signal shaping circuitry may also be provided as desired depending on the application.

In an alternative embodiment shown in each of the ROM and DAC is coupled to its own adjustable clock delay circuit. In particular adjustable clock delay circuit receives the clock signal and ROM delay select control signal and outputs the delay adjusted clock signal to the ROM. In a similar fashion adjustable clock delay circuit receives the clock signal and DAC delay select control signal and outputs the delay adjusted clock signal to the DAC. As previously explained the adjustable clock signal delays allow for compensation of propagation delays associated with the corresponding ROM and DAC circuits and or operating conditions. Using separate adjustable clock delay circuit allows for independent delay adjustment to ROM and DAC.

The clock delay control signal is a digital signal that can be generated off chip or by on chip or otherwise external or internal to the DDS circuitry for example by a processor and essentially configures the adjustable clock delay circuit to provide the desired amount of delay. The number of available clock delay control signals can be set to 2 where N is the number of bits in the clock delay control signal. In general some of the clock delay control signals will result in poor or otherwise sub optimal DDS performance where the timing relationship between the ROM and DAC is incorrect and as a result digital glitches wrong data are processed through the DAC thereby causing erroneous DDS outputs and some of the clock delay control signals will result in good or otherwise sufficient DDS performance where the ROM DAC data is properly aligned and the correct data is processed through the DAC thereby causing correct DDS outputs . Thus in accordance with one embodiment of the present invention a calibration routine can be run where each of the available clock delay control signals are sequentially applied in conjunction with a known FCW and the DAC output can be monitored for correct signal value. For any given set of test parameters e.g. FCW operating temp clock frequency at least one of the clock delay control signals will cause a best or otherwise optimal DAC output relative to DAC outputs caused by the other clock delay control signals. Such a calibration routine can be carried out for example either manually as part of an initial check of the DDS and or as part of an automated calibration that can be run periodically or as requested.

The phase accumulator and DAC can be implemented as previously discussed with reference to and that disclosure is equally applicable here. The ROM can be implemented as conventionally done and in one embodiment includes an address decoder row and column select circuits an array of memory cells sense amplifiers and one or more pipeline registers clocked by the clock signal output by the adjustable clock delay circuit . As will be appreciated the input bits from which the address of interest is decoded can be set based on the coding scheme and output bits of the phase accumulator and the output of the ROM can be configured to provide the number of bits desired and may be for example thermometer coded and or binary coded. Example ROM configurations may range from 4 to 48 input bits and 4 to 64 output bits but any other suitable configuration can be used. Note that the least significant bits of any stage digital output can be truncated or otherwise ignored if so desired to reduce the number of output bits to suit the input bit range of the next stage.

The LUT entries can be for example empirically developed by manually or automatically testing the given DDS for proper operation over a range of DDS operating parameter sets and testing each available corresponding delay select control signal for each DDS operating parameter set to identify the best performing delay select control signal for a given parameter set. For instance and with reference to the example of Table 1 if the DDS clock is set to 40 GHz FCW is set to 001 assuming a 3 bit wide phase accumulator and the operating temperature of the environment in which the DDS is operating is in the range of 35 to 45 C. then a delay select control signal of 011 assuming a 3 bit DSCS is the one that provided the most accurate DAC output for the known set of stimulus of all the available delay select control signals.

The processor can be implemented with any suitable processor technology such as a programmable microprocessor or a microcontroller programmed or otherwise configured to carry out the methodologies described herein. For example a microcontroller configured with a number of input output ports and a number of embedded routines for interrogating the current DDS operating parameter set and identifying a suitable DSCS as described herein. The input ports can each receive signals indicative of a given operating parameter and an output port can provide the desired DSCS. The LUT can be stored in a memory on board or otherwise accessible by the microcontroller. The microcontroller may further include memory e.g. ROM or flash for storing the various routines as well as workspace e.g. random access memory for executing those routines. Any number of processor configurations can be used.

Variations on the example embodiments shown in and will be apparent in light of this disclosure. For instance in another embodiment rather than using a look up table populated with empirically developed data the processor can be programmed to monitor for changes in the DDS operating parameter set and when such a change is detected the calibration mode can be entered where known stimulus clock FCW etc are input to the DDS in the given environment of interest . During calibration mode the DAC output can be monitored in real time for accuracy as the available delay select control signals are sequentially cycled through. After all available delay select control signals are tested the one providing the DAC output closest in value to the desired DAC output value can be used for normal mode operation.

This configuration allows for the selection of discrete delay increments as provided by the buffers A G. In general each of the buffers A G is associated with a fixed propagation delay which can be exploited to delay the clock signal input by a known amount. The buffers can be implemented with any suitable buffer technology and in one example case are implemented with unity gain buffers voltage followers . Other embodiments may utilize buffers having amplifying or attenuating capability if so desired. The multiplexers Mux 0 Mux 1 and Mux 2 can be implemented for example with a conventional high speed multiplexer circuit design e.g. such as the SN54 74LS157 and are used to select the desired amount of delay.

In operation this example adjustable clock delay circuit allows for selection of 0 to 6 buffer delays not counting buffer A the delay of which is constantly applied . Such an implementation can be used for instance to provide full clock coverage for DDS systems operating up to 30 GHz. Note however that higher operating frequencies can be used by scaling the number of buffers and multiplexers accordingly. Table 2 demonstrates the operation of the adjustable clock delay circuit.

As can be seen if the DSCS bit is logic 0 then the corresponding multiplexer switches the L input to the multiplexer output which is effectively a non delay feed through path i.e. no buffers on path . However if the DSCS bit is logic 1 then the corresponding multiplexer switches the H input to the multiplexer output which will provide a unit of delay for each buffer on that path. A clock delay of 1 unit buffer A is provided for all DSCS. Note that for a delay of 4 units there are two possible buffer delay paths generally designated as or in Table 2 where buffers A B C D or A E F G respectively are switched into the delay path .

This configuration allows for the selection of discrete delay increments as provided by the buffers A H each of which is associated with a fixed propagation delay that can be connected into the delay path by a combination of the multiplexers to delay the clock signal input by a known amount. The previous disclosure with respect to the buffers and multiplexers of is equally applicable here. This configuration is also scalable to cover additional delays. Table 3 demonstrates the operation of the alternate adjustable clock delay circuit configuration of .

Just as with the embodiment of if the DSCS bit is logic 0 then the corresponding multiplexer switches the L input to the multiplexer output. However if the DSCS bit is logic 1 then the corresponding multiplexer switches the H input to the multiplexer output. Note that a clock delay of 1 unit buffer A is provided for all DSCS. Further note the layout symmetry and duplicate conductor lengths for each of buffers B H and muxes 0 6 such that the delay adjustment is predominantly provided by the buffers rather than the conductors coupling the buffers and muxes from the clock input to the clock output .

The foregoing description of the embodiments of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of this disclosure. It is intended that the scope of the invention be limited not by this detailed description but rather by the claims appended hereto.

