---

title: Network security system
abstract: A method and system for preventing an unacceptable data packet directed at a computing device on a first network and sent from a client device. The method includes a step of providing a network security system remotely from the first network and the client device, the network security system having a public address and including a load balancer and at least one network security subsystem having a private address, the network security subsystem further including an intrusion detection module, the load balancer of the network security subsystem receiving the data packet destined for the computing device. The load balancer translates the destination address of the packet from the public address of the network security system to the private address of the network security subsystem and forwards the packet to the intrusion detection module of the network security subsystem. The intrusion detection module then determines whether the packet is an intrusion attempt. If the packet is not the intrusion attempt, the destination address for the packet is translated to the address of the computing device, the packet source address is translated to the public address of the network security system and the packet is forwarded to the computing device. Finally, if the packet is the intrusion attempt, a network intrusion prevention technique is performed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08689319&OS=08689319&RS=08689319
owner: Sollitionary, Inc.
number: 08689319
owner_city: Omaha
owner_country: US
publication_date: 20100301
---
This application claims priority to and incorporates by reference in its entirety U.S. patent application Ser. No. 10 918 171 filed on Aug. 13 2004 and entitled Network Security System in turn claiming priority to U.S. Provisional Application Ser. No. 60 563 437 filed Apr. 19 2004.

The present application is directed to intrusion detection for computer based systems. More particularly the present application is directed to methods and systems for inhibiting intrusion attempts originating from a networked client host from reaching a networked server host.

Computer networks provide connectivity between computing devices on local networks and or remote networks. A connection between two remote networks typically occurs through a communications network such as the Internet. Communications over the Internet pass through a series of communication links and routers switches many of which are located within third party networks that are also interconnected with the Internet. Thus communications between two remote networks across the Internet are typically open because neither the sender nor the receiver controls the path that the communications traffic travels from source to destination. Rather the path is controlled by the various providers and devices located on the Internet itself.

The connectivity between remote networks can be used to allow a client host to utilize a network accessible service provided by a remote server host. Common network accessible services include but are not limited to Finger Echo SMTP Telnet SSH FTP DNS HTTP and HTTPS as well as those services utilizing IP Protocol 50 ICMP TCP IP and UDP.

Because private networks are connected to an open system such as the Internet security is of great concern when communicating with other private networks via network accessible services. Often network administrators install firewall devices intrusion detection devices intrusion prevention devices and or other buffers on a local area network LAN in order to screen and or filter incoming and or outgoing content from the local network. Alternatively system administrators can install firewall intrusion detection or intrusion prevention software on a local host within a LAN in order to screen and or filter incoming and or outgoing content from the local host. This can require the network administrator and or the system administrator to install complex and costly equipment and or software in order to ensure that the local network and or local host is protected.

Exemplary network security systems are described in U.S. Pat. No. 6 687 831 to Albaugh et al. U.S. Pat. No. 6 654 882 to Froutan et al. U.S. Pat. No. 6 321 336 to Applegate et al. U.S. Pat. No. 5 892 903 to Klaus and U.S. Pat. No. 5 557 752 to Smaha et al. However each of these network security systems requires the installation of costly and or complex equipment and or software.

What are needed are improved methods and systems for inhibiting intrusion attempts directed at network accessible services.

Before the present methods systems and materials are described it is to be understood that this invention is not limited to the particular methodologies systems and materials described as these may vary. It is also to be understood that the terminology used in the description is for the purpose of describing the particular versions or embodiments only and is not intended to limit the scope of the invention which will be limited only by the appended claims.

It must also be noted that as used herein and in the appended claims the singular forms a an and the include plural references unless the context clearly dictates otherwise. Thus for example reference to a communication request is a reference to one or more communications requests and equivalents thereof known to those skilled in the art and so forth. Unless defined otherwise all technical and scientific terms used herein have the same meanings as commonly understood by one of ordinary skill in the art. Although any methods materials and devices similar or equivalent to those described herein can be used in the practice or testing of embodiments of the invention the preferred methods materials and devices are now described. All publications mentioned herein are incorporated by reference. Nothing herein is to be construed as an admission that the invention is not entitled to antedate such disclosure by virtue of prior invention.

In an embodiment a system provides protection against intrusion attempts directed at network accessible services and methods covering the initiation of the use of the system and the perfection of the intrusion protection provided by the system through a demonstrative base lining process.

In an embodiment the system includes one or more networks network devices and computing devices that provide firewall intrusion detection and or intrusion prevention protection for a server host on a private network that provides network accessible service s through a connection to an open communications network such as the Internet from intrusion attempts initiated by a client host on a private network connected to an open communications network such as the Internet.

In an embodiment the system includes one or more networks network devices and computing devices that provide firewall intrusion detection and or intrusion prevention protection for a client host on a private network connected to an open communications network such as the Internet from intrusion attempts initiated by a server host on a private network that provides network accessible service s through a connection to an open communications network such as the Internet.

In an embodiment the system provides intrusion protection for a plurality of client hosts and multiple server hosts providing network accessible service s limited only by the number of public IP addresses available to the service provider hosting the system.

The system in conjunction with the methods may permit the protection of a client host on a private network connected to an open communications network such as the Internet or a server host providing network accessible service s on a private network connected to an open communications network such as the Internet with no hardware or software installation required on the client host client private network server host or server private network.

Through execution of the invented method of initiating protection of a server host providing network accessible service s on a private network connected to an open communications network such as the Internet the system may intercept the traffic between the client host and server host by having a domain name server which provides authoritative responses for the server host advertise the public IP address of the system as the actual public IP address of the server host.

In an embodiment the system does not store the intercepted traffic other than to process the traffic. The system may examine the traffic in real time such that communications between the client host and the server host providing the network accessible service s are not perceptibly delayed. In this embodiment the system is used for many or all network accessible services such as interactive network accessible services.

The system is capable of providing intrusion protection for any common interactive network accessible service s including but not limited to Finger Echo SMTP Telnet SSH FTP DNS HTTP and HTTPS as well as those services utilizing IP Protocol 50 ICMP TCP IP and UDP.

Embodiments of the present invention include methods and systems for inhibiting or preventing intrusion attempts from occurring between a client host on a private network connected to an open communications network such as the Internet and a server host providing network accessible service s on a private network connected to the open communications network. In an embodiment the present invention may prevent intrusion attempts without the need for substantial additional computer software or hardware devices on the private networks the client host or the server host.

In order to communicate with a network accessible service on the server host the client host may transmit a request step in to an authoritative domain name server for the server host to resolve its public IP address. The authoritative domain name server may respond step in with a public IP address e.g. 66.207.129.215 in for a separate security system or network assigned to protect the server host providing the network accessible service instead of as is typically done the true public IP address of the server host e.g. 151.52.26.63 in .

The client host may then transmit its communication request step in . The communication request step in is transmitted to the security system because of the IP address provided by the DNS server. The security system may perform a series of processing steps in to determine whether the communication request is an intrusion attempt. If the communication request is determined to be non intrusive the security system may forward the communication request step in to the network accessible service on the server host . The client firewall permits the communication request step in to enter the corporate network because it comes from a public IP address of the security system . The server host then receives the communication request step in .

The server host may perform any necessary processing and generate a response to the forwarded communication request if required. If generated the response may first be sent to the security system step in since the forwarded communication request originated from the security system . The security system may receive the response step in and perform a series of processing steps in designed to determine whether the response is an intrusion attempt. If the response is determined to be non intrusive the security system may then forward the response step in to the client host which processes the response . In an embodiment the server host transmits the response directly to the client host .

In an embodiment some or all of the processing steps performed by the security system between the original communication request and the forwarded communication request and or between the response and the forwarded response occur in real time without storing the communications requests and or the responses and other than as required for real time processing. Thus the security system may permit interactivity between the client host and server host without any perceptible delay in communication between the two systems. This allows the security system to be used for providing intrusion protection to interactive and or batch network accessible services including but not limited to Finger Echo SMTP Telnet SSH FTP DNS HTTP and HTTPS as well as those services utilizing IP Protocol 50 ICMP TCP IP and UDP.

In an alternate embodiment the devices of the security system may be located on the corporate network . In such an embodiment the devices of the security system perform the series of processing steps in to determine whether the communication request is an intrusion attempt and forward the communication request steps and in to the network accessible service on the server host if the communication request is non intrusive. Likewise the devices of the security system may perform the series of processing steps in to determine whether the response is an intrusion attempt and forward the response step in to the client host via the communications network if the response is non intrusive.

In an alternate embodiment the devices of the security system are located on the client network . In such an embodiment the devices of the security system perform the series of processing steps to determine whether the communication request is an intrusion attempt and forward the communication request steps and in via the communications network to the network accessible service on the server host if the communication request is non intrusive. Likewise the devices of the security system may perform the series of processing steps in to determine whether the response is an intrusion attempt and forward the response step in to the client host if the response is non intrusive.

In an embodiment the security system may maintain an event log of the requests and responses that pass through the security system . In an embodiment the event log may maintain only a partial copy of a request or a response .

The service provider may then communicate step the assigned public IP address 66.207.129.215 to the owner of the server host . The owner of the server host may update step the configuration of its domain name server such that the A record for the server host indicates the service provider provisioned public IP address 66.207.129.215 rather than the public IP address of the server host e.g. 151.52.26.63 in . The nature of the domain name server infrastructure dictates that this change will propagate step through the entire communications network within a specified time period such as 72 hours.

In an embodiment the owner of the server host may configure a perimeter firewall to restrict inbound network traffic with a destination address corresponding to the public IP address of the server host e.g. 151.52.26.63 to traffic having a source address corresponding to the public IP address assigned by the security system step . Such an embodiment may provide a heightened level of network intrusion protection.

By providing network intrusion protection between the client host and the server host the security system inhibits or prevents viruses worms directed intrusion attempts and other malicious traffic from reaching and or being delivered from the server host . In addition by being loosely coupled with both the private network of the client host and the private network of the server host through an open communications network the security system may provide network intrusion protection for multiple client hosts belonging to multiple private networks and multiple server hosts belonging to multiple private networks simultaneously. As such economies of scale may be achieved since no additional devices or computing software are required on the client host the client host s private network the server host or the server host s private network .

The server host may be part of a second private network such as a corporate network connected to the open communications network . The second private network may include network devices such as routers firewalls proxies etc. that connect the server host to the corporate network . These network devices may perform address translations routing and or other communication techniques and functions. Regardless of the intermediary network devices and intermediary network processing the server host may be reachable via a public IP address e.g. 151.52.26.63 in . The public IP address may allow the server host to communicate over the open communications network .

The private IP addresses for use on the private network segment within the security system may be assigned a private IP address e.g. 10.0.2.1 10.0.2.2 and 10.0.2.3 may each be assigned to a security sub system within the security system . As such a one to many relationship may exist between the public IP address 66.207.129.215 and the private IP addresses 10.0.2.1 10.0.2.2 and 10.0.2.3 .

Within the security system the assigned public IP address 66.207.129.215 may exist as a virtual IP address assigned to and shared between IP network load balancers . The load balancers may provide address translation and routing between the public network segment within the security system and the private network segment within the security system. More specifically the network load balancers may perform network address translation and routing between the virtual public IP address 66.207.129.215 and the private IP addresses 10.0.2.1 10.0.2.2 and 10.0.2.3 .

The security system may include the above described network communications framework and a security sub system . The security sub system may include computing devices that perform load balancing and failover protection. The computing devices may be configured with multiple computer software programs referred to herein as modules which provide network firewall functionality network intrusion prevention IPS functionality and or network intrusion detection IDS functionality.

Each computing device may operate in one of two modes passive and active. When the computing devices are passive no network intrusion prevention functionality is performed. However network intrusion protection may still be realized through the network firewall module and the intrusion detection module. When the computing devices are active full network intrusion protection may be provided including network intrusion prevention. Each assigned private IP address 10.0.2.1 10.0.2.2 and 10.0.2.3 may be assigned to a particular security sub system computing device.

The network firewall modules of the security sub system may perform TCP IP layer 3 network traffic filtering based on for example source and or destination IP addresses source and or destination TCP IP ports and IP protocols. The network firewall modules may further perform network address translation between private IP addresses. In addition a firewall module may be implemented as an Ethernet router device. In other words the firewall module may perform inbound and outbound processing using for example two Ethernet network interface controllers that route traffic between inbound and outbound interfaces. As such the firewall module may perform inbound processing including filtering and network address translation outbound processing including filtering and network address translation and additional in between processing including forwarding IP packets to an intrusion prevention module for examination.

Each firewall module of each computing device within the security sub system may be configured to allow communication requests using the specified IP protocol s and or TCP IP port s for the protected network accessible service s provided by the protected server host . In addition each firewall module of each computing device may be configured to perform network address translation between an assigned private IP address e.g. 10.0.2.2 and the public IP address 151.52.26.63 of the protected server host .

In an embodiment if the firewall module receives an IP packet that does not meet its filtering criteria for allowed network traffic the IP packet is discarded. In an embodiment the discard event is logged. In an alternate embodiment at least a portion of the IP packet is saved. In an embodiment an alert is sent to a system administrator or a network administrator. In an embodiment a message is transmitted to the sender of the IP packet.

The network intrusion prevention module of the security sub system may perform for example TCP IP layer 3 through TCP IP layer 7 packet examinations. The network intrusion prevention module may reassemble IP packets that have been fragmented whether intentionally to mask the contents of the IP packet or because of IP packet size limitations within any of the network devices through which the IP packet traversed. The network intrusion prevention module may then examine characteristics of the IP packet including for example various packet header values and or the contents of the packet data payload. These characteristics and packet data payload may then be compared with a database of known network intrusion attempt signatures. If a match exists the mode passive v. active of the computing device on which the network intrusion prevention module resides may determine how the IP packet is handled . If the computing device is passive the matched IP packet may not be discarded. However the fact that the IP packet would have been discarded had the computing device been active and data including for example at least a partial copy of the IP packet header and IP packet data payload may be logged. If the computing device is active the matched IP packet may be discarded. Moreover the fact that the IP packet was discarded and data including for example at least a partial copy of the IP packet header and IP packet data payload may be logged. If a match does not exist the IP packet may be forwarded to its destination.

The network intrusion detection module of the security sub system may similarly be capable of performing for example TCP IP layer 3 through TCP IP layer 7 packet examinations. The network intrusion detection module may first reassemble IP packets that have been fragmented whether intentionally to mask the contents of the IP packet or because of IP packet size limitations within any of the network devices through which the IP packet traversed. The network intrusion detection module may then examine characteristics of the IP packet including for example various packet header values and or the contents of the packet data payload. This examination may occur because the intrusion detection module listens to all IP traffic traversing the routed Ethernet interface of the computing device. These characteristics and packet data payload may be compared with a database of known network intrusion attempt signatures. If a match exists the fact that the IP packet was matched and data including for example at least a partial copy of the IP packet header and or the IP packet data payload may be logged. If a match does not exist the IP packet may be permitted to continue toward its destination.

Referring to a communication request may be transmitted from a client host with a public IP address e.g. 48.2.56.67 as in . The communication request may be directed by the end user of the client host to a protected network accessible service provided by a server host with a public IP address e.g. 151.52.26.63 as in . The security system may intercept the request because of the special configuration of the domain name server that provides authoritative responses for the server host . As such this communication request has a source IP address equal to the public IP address of the client host 48.2.56.67 and a destination IP address equal to the public IP address assigned for the protection of the server host to the security system e.g. 66.207.129.215 as in .

Referring to the network load balancers of the security system may receive the communication request . The network load balancers may translate the destination IP address to one of the private IP addresses assigned for the protection of the server host to a specific computing device within the security system s security sub system e.g. 10.0.2.2 as in . The communication request may then be routed to the specific computing device within the security sub system.

The computing device may perform intrusion protection processing including for example the firewall module making a determination of whether the communication request is permitted based on the firewall module s filtering criteria. If the communication request is not permitted the fact that it is not permitted may be logged and the communication request may be discarded . In an alternate embodiment the computing device generates an alert if the request is not permitted. In an alternate embodiment the computing device generates a message to the sender if the request is not permitted. In an alternate embodiment the computing device saves at least a portion of the communication request if the request is not permitted.

If the communication request is permitted it may be presented to the intrusion prevention module for examination. The intrusion prevention module may determine whether the communication request is permitted based on whether or not it matches one of a plurality of intrusion prevention signatures. If the communication request matches an intrusion prevention signature the fact that it matched and data including for example at least a partial copy of the communication request s IP packet header and or the IP packet data payload may be logged . A determination of the operating mode of the current security sub system computing device may be made. If the current computing device is active the communication request may be discarded . Alternately at least a portion of the communication request may be saved. Alternately or additionally an alert and or a message may be generated. If the current computing device is passive the communication request may be allowed to pass to the outside interface of the routed Ethernet connection maintained by the firewall module of the security sub system .

During the traversal of the routed Ethernet interface the intrusion detection module may examine the communication request to determine whether the communication request matches one of a plurality of intrusion detection signatures. If the communication request matches an intrusion detection signature the fact that it matched and data including for example at least a partial copy of the communication request s IP packet header and IP packet data payload may be logged . Alternatively the intrusion detection module may include additional decision capabilities to identify and prevent malicious or undesirable communication requests . Such decision capabilities may include an application security aware detection e.g. SQL injection cross site scripting and or command injection. Additionally the communication request may be filtered based on message content. For example a user may specify certain inappropriate or undesirable content which is not allowed to be passed through the intrusion detection module . The intrusion detection module then scans the content of the communication request and determines whether it includes the specified inappropriate or undesirable content. If the communication request is determined to include such content the communication request may be discarded or quarantined until a user a network administrator or any other entrusted person makes a determination of whether the communication request may be passed through. Further the intrusion detection module may include a source based identification capability. In this embodiment if the source of the communication request has been identified as a malicious source preferably by a data source outside the networks e.g. google safe browsing list the communication request is similarly discarded or quarantined. If the communication request was not discarded during the prior processing upon reaching the outside interface of the routed Ethernet connection the firewall module may translate the source IP address of the communication request to the private IP addresses assigned for the protection of the server host to the current computing device within the security system s security sub system 10.0.2.2 .

The firewall module may then translate the destination IP address of the communication request to the public IP address of the protected server host 151.52.26.63 . The computing device may then route the communication request to the network load balancers which may translate the source IP address of the communication request to the public IP addresses assigned for the protection of the server host to the security system 66.207.129.215 . The communication request may then be routed normally through the open network to the protected server host .

Referring to a response to a previous communication request may be transmitted from a protected server host having an IP address e.g. 151.52.26.63 . The response may be directed towards the security system with a destination IP address of for example 66.207.129.215. This may occur because the communication request originated from the security system . As such the response may have a source IP address equal to the IP address of the server host 151.52.26.63 and a destination IP address equal to the public IP address assigned for the protection of the server host to the security system 66.207.129.215 .

Referring to the network load balancers of the security system may receive the response and may translate its destination IP address to one of the private IP addresses assigned for the protection of the server host to a specific computing device within the security system s security sub system e.g. 10.0.2.2 . The response may be routed to the specific computing device.

The computing device may perform intrusion protection processing including for example the firewall module making a determination of whether the response is permitted based on the firewall module s filtering criteria. Such filtering criteria may include content filtering to ensure that confidential or sensitive information is not included in the response . If the response is not permitted the fact that it is not permitted may be logged and the response may be discarded . In an alternate embodiment the computing device generates an alert if the response is not permitted. In an alternate embodiment the computing device generates a message to the sender if the response is not permitted. In an alternate embodiment the computing device saves at least a portion of the response if it is not permitted.

If the response is permitted it may be presented to the intrusion prevention module for examination. The intrusion prevention module may determine whether the response is permitted based on whether or not it matches one of a plurality of intrusion prevention signatures. If the response matches an intrusion prevention signature the fact that it matched and data including for example at least a partial copy of the response s IP packet header and or the IP packet data payload may be logged . A determination of the operating mode of the current security sub system computing device may be made. If the current computing device is active the response may be discarded . Alternately at least a portion of the response may be saved. Alternately or additionally an alert and or a message may be generated. If the current computing device is passive the response may be allowed to pass to the outside interface of the routed Ethernet connection maintained by the firewall module of the security sub system .

During the traversal of the routed Ethernet interface the intrusion detection module may examine the response to determine whether the response matches one of a plurality of intrusion detection signatures. If the response matches an intrusion detection signature the fact that it matched and data including for example at least a partial copy of the response s IP packet header and IP packet data payload may be logged . If the response was not discarded during the prior processing upon reaching the outside interface of the routed Ethernet connection the firewall module may translate the source IP address of the response to the private IP addresses assigned for the protection of the server host to the current computing device within the security system s security sub system 10.0.2.2 .

The firewall module may then translate the destination IP address of the response to the public IP address of the client host 48.2.56.67 . The computing device may then route the response to the network load balancers which may translate the source IP address of the response to the public IP addresses assigned for the protection of the server host to the security system 66.207.129.215 . The response may then be routed normally through the open network to the client host .

Although the invention is described in connection with specific networks the system may include a capability allowing an outside party outside the networks to retrieve operating information using a defined application programming interface. The inventive system is then placed in a cloud and a customer is allowed to quest it for some specific information for example throughput statistics security status and statistics capacity status and statistics security logging information and or operational logging information. Further when the inventive system is placed in the cloud it may be further include an access and configuration capability to allow the outside party to customize the inventive system to for example manage users enable disable decisioning services adjust decisioning services and or manage outside data sources.

Finally as shown in each security sub system may include transformation capability i.e. the encryption module allowing the sub system to decrypt encrypted data. Preferably the invention is utilized with format preserving encryption. In this embodiment the security system is used in conjunction with a separate client side system which transparently format preserving encrypts the response data before the transmission thereof to the security system .

It is to be understood that the invention is not limited in its application to the details of construction and to the arrangements of the components set forth in this description or illustrated in the drawings. The invention is capable of other embodiments and of being practiced and carried out in various ways. Hence it is to be understood that the phraseology and terminology employed herein are for the purpose of description and should not be regarded as limiting.

As such those skilled in the art will appreciate that the conception upon which this disclosure is based may readily be utilized as a basis for the designing of other structures methods and systems for carrying out the several purposes of the present invention. It is important therefore that the description be regarded as including such equivalent constructions insofar as they do not depart from the spirit and scope of the present invention.

