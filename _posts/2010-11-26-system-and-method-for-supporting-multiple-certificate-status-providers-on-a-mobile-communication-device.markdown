---

title: System and method for supporting multiple certificate status providers on a mobile communication device
abstract: A method and system for supporting multiple digital certificate status information providers are disclosed. An initial service request is prepared at a proxy system client module and sent to a proxy system service module operating at a proxy system. The proxy system prepares multiple service requests and sends the service requests to respective multiple digital certificate status information providers. One of the responses to the service requests received from the status information providers is selected, and a response to the initial service request is prepared and returned to the proxy system client module based on the selected response.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08423763&OS=08423763&RS=08423763
owner: Research In Motion Limited
number: 08423763
owner_city: Waterloo
owner_country: CA
publication_date: 20101126
---
This application is a continuation of earlier filed nonprovisional application having application Ser. No. 10 508 631 filed Sep. 17 2004 now U.S. Pat. No. 7 865 720 granted on Jan. 4 2011 which in turn is a National Entry of International Application No. PCT CA2003 000404 filed Mar. 20 2003 which in turn is claims priority to U.S. Provisional Patent Application No. 60 365 534 filed Mar. 20 2002. This application claims priority under 35 U.S.C. 120 to aforementioned application Ser. No. 10 508 631 filed Sep. 17 2004 National Entry of International Application No. PCT CA2003 000404 filed Mar. 20 2003 and said Application No. 60 365 534 filed Mar. 20 2002 and incorporates by reference the disclosures of both said applications in their entirety.

This invention relates generally to the field of secure electronic messaging and in particular to checking the status of digital certificates.

Known secure messaging clients including for example e mail software applications operating on desktop computer systems maintain a data store or at least a dedicated data storage area for secure messaging information such as digital certificates. A digital certificate normally includes the public key of an entity as well as identity information that is bound to the public key with one or more digital signatures. In Secure Multipurpose Internet Mail Extensions S MIME messaging for example a public key is used to verify a digital signature on a received secure message and to encrypt a session key that was used to encrypt a message to be sent. In other secure messaging schemes public keys may be used to encrypt data or messages. If a public key is not available at the messaging client when required for encryption or digital signature verification then the digital certificate or at least the public key must be loaded onto the messaging client before these operations can be performed.

Typically a digital certificate is checked against a Certificate Revocation List CRL to determine if the digital certificate has been revoked by its issuer. This check is typically performed when a digital certificate is first received and periodically thereafter for example when a new CRL is received. However CRLs tend to be relatively bulky so that transfer of CRLs to messaging clients consume considerable communication resources and storage of CRLs at a messaging client may consume significant memory space. CRL based revocation status checks are also processor intensive and time consuming. These effects can be particularly pronounced in messaging clients operating on wireless mobile communication devices which operate within bandwidth limited wireless communication networks and may have limited processing and memory resources. In addition revocation status is updated in CRL based systems only when a new CRL is distributed.

Another scheme for digital certificate revocation status checking involves querying remote systems which maintain digital certificate revocation status information. A difficulty with this scheme is that it requires a separate request response exchange for each remote system to be queried. These exchanges may cause significant time delays and consume significant amounts of available communication bandwidth particularly for secure messaging clients operating on wireless mobile communication devices.

Digital certificate validity checks may similarly be processor intensive and time consuming for messaging clients operating on constrained devices. Digital certificate validity checks may similarly be performed by remote systems and may be useful for such devices but as described above typical schemes are not particularly suitable when multiple remote systems are to be queried.

According to an aspect of the invention a method of accessing multiple digital certificate status information providers to obtain digital certificate status information comprises the steps of receiving a request for digital certificate status information from a communication device generating multiple service requests based upon the received request each of the multiple service requests corresponding to a digital certificate status information provider sending the generated multiple service requests to their corresponding digital certificate status information providers receiving a response comprising digital certificate status information from at least one of the digital certificate status information providers generating a response to the request for digital certificate status information using at least a portion of the received digital certificate status information and sending the generated response to the request to the communication device.

An apparatus for accessing multiple digital certificate status information providers to obtain digital certificate status information for a communication device according to another aspect of the invention comprises means for receiving a request regarding digital certificate status information from the communication device means for generating multiple service requests based upon the received request each generated service request corresponding to a digital certificate status information provider means for sending the generated multiple service requests to their corresponding status information providers over a computer network and means for receiving over a computer network a response containing digital certificate status information from at least one of the status information providers wherein at least a portion of the received digital certificate status information is used in providing a status information response to the communication device.

A secure message is a message that has been processed by a message sender or possibly by an intermediate system between a message sender and a message receiver to ensure one or more of data confidentiality data integrity and user authentication. Common techniques for secure messaging include signing a message with a digital signature and or encrypting a message. For example a secure message may be a message that has been signed or encrypted or encrypted and then signed or signed and then encrypted according to variants of Secure Multipurpose Internet Mail Extensions S MIME .

A messaging client allows a system on which it operates to receive and possibly also send messages. Messaging clients may operate on a computer system a handheld device or any other system or device with communications capabilities. Many messaging clients also have additional non messaging functions.

The system includes a Wide Area Network WAN coupled to a computer system a wireless network gateway and a corporate Local Area Network LAN . The wireless network gateway is also connected to a wireless communication network in which a wireless mobile communication device mobile device is configured to operate. An exemplary mobile device may be of the type disclosed in U.S. Pat. No. 6 278 442 entitled HAND HELD ELECTRONIC DEVICE WITH A KEYBOARD OPTIMIZED FOR USE WITH THE THUMBS the entire disclosure of which is incorporated herein by reference.

The computer system represents a desktop or laptop PC that is configured for connection to the WAN . The WAN can be a private network or a larger publicly accessible network such as the Internet. PCs such as the computer system normally access the Internet through an Internet Service Provider ISP Application Service Provider ASP or the like.

The corporate LAN is an example of a network based messaging client. As shown a corporate LAN is normally located behind a security firewall . Within the corporate LAN is a message server running on a computer within the firewall that functions as the main interface for the corporation to exchange messages both within the LAN and with other external messaging clients via the WAN . Two of the most common message servers are the Microsoft Exchange and Lotus Domino server products. These servers are often used in conjunction with Internet mail routers that route and deliver mail. A message server may extend beyond just message sending and receiving providing such functionality as dynamic database storage engines that have predefined database formats for data like calendars to do lists task lists e mail and documentation.

The message server provides messaging capabilities to one or more network computer systems in the LAN . A typical LAN includes multiple computer systems shown generally as computer systems each of which implements a messaging client most often as a software application such as Microsoft Outlook for messaging functions. In the network messages are received by the message server distributed to the appropriate mailboxes for user accounts addressed in the received message and can be accessed by a user through a computer in the one or more computer systems . Although messaging clients in the LAN operate on the computer systems there are also known messaging clients that operate in conjunction with handheld devices and other systems or devices with electronic messaging capabilities. Like the message server a messaging client may also have additional non messaging functions.

The wireless network gateway provides an interface to a wireless network through which messages may be exchanged with a mobile device . Such functions as addressing of a mobile device encoding or otherwise transforming messages for wireless transmission and any other required interface functions are performed by the wireless network gateway . Where the wireless network gateway is configured for operation in conjunction with more than one wireless network the wireless network gateway may also determine a most likely network for locating a given user and track users as they roam between countries or networks.

Any computer system with access to the WAN may exchange messages with a mobile device through the wireless network gateway . Alternatively private wireless network gateways such as wireless Virtual Private Network VPN routers could also be implemented to provide a private interface to a wireless network such as . For example a wireless VPN implemented in the LAN provides a private interface from the LAN to one or more mobile devices through the wireless network .

Such a private interface to wireless devices via the wireless network gateway and or the wireless network can effectively be extended to entities outside the LAN by providing a message forwarding or redirection system which operates with the message server . In this type of system incoming messages received by the message server and addressed to a user that has a mobile device are redirected through the wireless network interface either a wireless VPN router the gateway or another interface for example to the wireless network and to the user s mobile device . An exemplary redirector system operating on the message server may be of the type disclosed in U.S. Pat. No. 6 219 694 entitled SYSTEM AND METHOD FOR PUSHING INFORMATION FROM A HOST SYSTEM TO A MOBILE DATA COMMUNICATION DEVICE HAVING A SHARED ELECTRONIC ADDRESS the entire disclosure of which is incorporated herein by reference.

In wireless networks such as messages are normally delivered to and from mobile devices such as the mobile device via RF transmissions between base stations in the wireless network and mobile devices. Modern wireless networks typically serve thousands of subscribers each subscriber having a mobile device. The wireless network may be one of many different types of wireless network such as a data centric wireless network a voice centric wireless network or and a dual mode networks that can support both voice and data communications over the same physical base stations. Dual mode networks include but are not limited to recently developed Code Division Multiple Access CDMA networks the Groupe Special Mobile or the Global System for Mobile Communications GSM and the General Packet Radio Service GPRS and future third generation 3G networks like Enhanced Data rates for Global Evolution EDGE and Universal Mobile Telecommunications Systems UMTS . GPRS is a data overlay on the GSM wireless network operating in virtually every country in Europe. In addition to these illustrative wireless networks other wireless networks may also be used.

Other examples of data centric networks include but are not limited to the Mobitex Radio Network Mobitex and the DataTAC Radio Network DataTAC . Examples of older voice centric data networks include Personal Communication Systems PCS networks like CDMA GSM and Time Division Multiple Access TDMA .

The mobile device may be a data communication device a voice communication device or a multiple mode device capable of voice data and other types of communications. An exemplary mobile device is described in further detail below and with reference to .

Perhaps the most common We of messaging currently in use is e mail. In a standard e mail system an e mail message is sent by an e mail sender possibly through a message server and or a service provider system and typically routed through the Internet to one or more message receivers. E mail messages are normally sent unencrypted and use traditional Simple Mail Transfer Protocol SMTP RFC822 headers and MIME body parts to define the format of the e mail message. As described briefly above a message that is routed to an addressed message receiver can be redirected to a mobile device. Since a wireless link cannot be physically secured in the same way as a wired connection messages are often encrypted for transfer through a wireless network. Overall message security can be further enhanced if a secure transfer mechanism is also used between the message sender and each recipient.

In recent years secure messaging techniques have evolved to protect both the content and integrity of messages such as e mail messages. S MIME and Pretty Good Privacy PGP are two public key secure e mail messaging protocols that provide for both encryption to protect data content and signing which both protects the integrity of a message and provides for sender authentication by a message receiver. Secure messages may also be encoded compressed or otherwise processed in addition to being encrypted and or signed.

The e mail sender may be a PC such as the system in or may be a network connected computer such as a computer system in . The e mail sender may also be another mobile device on which e mail messages may be composed and sent. The WAN the wireless gateway the wireless network and the mobile device are substantially the same as similarly labelled components in .

According to secure messaging schemes such as S MIME and PGP a message is encrypted using a one time session key chosen by the e mail sender . The session key is used to encrypt the message body and is then itself encrypted using the public key of each addressed message receiver to which the message is to be sent. As shown at a message encrypted in this way includes an encrypted message body and an encrypted session key . In this type of message encryption scheme a message sender such as e mail sender must have access to the public key of each entity to which an encrypted message is to be sent.

A secure e mail message sender such as normally signs a message by taking a digest of the message and signing the digest using the sender s private key. A digest may for example be generated by performing a check sum a Cyclic Redundancy Check CRC a digest algorithm such as Message Digest Algorithm 5 MD5 a hash algorithm such as Secure Hashing Algorithm 1 SHA 1 or some other preferably non reversible operation on the message. In the example shown in both the encrypted message body and the encrypted session key are used to generate a digest. This digest is then signed by the sender using the sender s private key. The signature private key is used for example to perform an encryption or other transformation operation on the digest to generate the digest signature. A digital signature including the digest and the digest signature is then appended to the outgoing message as shown at . A digital certificate of the sender which includes the sender s public key and sender identity information that is bound to the public key with one or more digital signatures and possibly any chained digital certificates and CRLs associated with the sender s digital certificate and any chained digital certificates may also be attached to the secure message .

The secure e mail message sent by the e mail sender includes the digital signature as well as the encrypted message body and the encrypted session key both of which are signed. In the S MIME secure messaging technique digital certificates CRLs and digital signatures are normally placed at the beginning of a message and the message body is included in a file attachment. Messages generated by other secure messaging schemes may place message components in a different order than shown or include additional and or different components. For example a secure message such as may include addressing information such as To and From email addresses and other header information.

When the secure e mail message is sent from the e mail sender it is routed through the WAN to the wireless network and the mobile device . The transmission path between the e mail sender and the mobile device may also include additional or different components than those shown in . For example the secure e mail message may be addressed to a mailbox or data store associated with a message server or data server which has been wirelessly enabled to forward or send received messages and data to the mobile device . Further intermediate systems may also store and or route the secure message to the mobile device . The exemplary system as previously described and as disclosed in U.S. Pat. No. 6 219 694 is an example of one such system.

In addition the secure message maybe routed or forwarded to the mobile device through other transport mechanisms than the wireless gateway . For example routing to the wireless network may be accomplished using a wireless VPN router associated with the e mail sender or in the case of a message being received at an intermediate computer system or server and then forwarded to the mobile device with the computer system or server.

Regardless of whether a signed message is sent directly to the mobile device or forwarded to the mobile device by intermediate systems or components when a signed message is received the mobile device may verify the digital signature . In order to verify the digital signature the mobile device uses a digital signature check algorithm corresponding to the signature generation algorithm used by the message sender which may be specified in a message header or in the digital signature and the sender s public key. If a secure message includes the sender s digital certificate then the sender s public key may be extracted from the digital certificate. The sender s public key may instead be retrieved from a local store for example where the public key was extracted from an earlier message from the sender and stored in a key store in the receiver s local store or the sender s digital certificate is stored in the local store or from a Public Key Server PKS . A PKS is a server that is normally associated with a Certificate Authority CA from which a digital certificate for an entity including the entity s public key is available. A PKS might reside within a corporate LAN such as LAN of or anywhere on the WAN Internet or other network or system through which message receivers may establish communications with the PKS.

Although digital signature algorithms and digest algorithms may be publicly known a sender signs an original message using its own private key. Therefore an entity that alters an original message cannot generate a digital signature that can be verified with the sender s public key. If a sent message is altered by an attacker after it has been signed by a sender then the digital signature verification based on the sender s public key fails. These mathematical operations do not prevent anyone from seeing the contents of the secure message but do ensure that the message has not been tampered with because it was signed by the sender and that the message was signed by the person as indicated in the From field of the message.

When the digital signature has been verified or sometimes even if digital signature versification fails the encrypted message body is then decrypted before it can be displayed or further processed by a receiving messaging client operating on the mobile device in . A receiving messaging client uses its private key to decrypt the encrypted session key and then uses the decrypted session key to decrypt the encrypted message body and thereby recover the original message. Those skilled in the art will appreciate that an entity may have more than one associated cryptographic key pair such as a signature private public key pair and an encryption private public key pair. Thus the mobile device may use one private key to decrypt the encrypted message body and a different private key to digitally sign an outgoing secure message.

An encrypted message that is addressed to more than one receiver includes an encrypted version of the session key for each receiver that was encrypted using the public key of the receiver. Each receiver performs the same digital signature verification operations but decrypts a different one of the encrypted session keys using its own private key.

Therefore in a secure messaging system a sending messaging client should have access to the public key of any receiver to which an encrypted message is to be sent. A receiving messaging client should be able to retrieve the sender s public key which may be available to a messaging client through various mechanisms in order to verify a digital signature in a signed message. Although the mobile device is a receiver of the secure message the mobile device may be enabled for two way communications and may therefore access public keys for both message sending and message receiving operations.

Public keys are commonly provided in digital certificates. As described above a digital certificate for any particular entity typically includes the entity s public key and identification information that is bound to the public key with a digital signature. Several types of digital certificates are currently in widespread use including for example X.509 digital certificates which are typically used in S MIME. PGP uses digital certificates with a slightly different format. Systems and methods discussed herein may be used with any of these types of digital certificate as well as other types of digital certificates both currently known types as well as others that may be developed in the future. The digital signature in a digital certificate is generated by the issuer of the digital certificate and can be checked by a message receiver substantially as described above. A digital certificate sometimes includes an expiry time or validity period from which a messaging client may determine if the digital certificate has expired. Verification of the validity of a digital certificate may also involve tracing a certification path through a digital certificate chain which includes a user s digital certificate as well as other digital certificates to verity that the user s digital certificate is authentic.

A digital certificate may also be checked to ensure that it has not been revoked. As described above digital certificate revocation status may be checked by consulting a CRL or by requesting digital certificate status information from a digital certificate revocation status information source. In the system of a user of the mobile device may submit a revocation status request for any digital certificate stored at the mobile device to one of the status information providers and . The provider or then returns revocation status information for that digital certificate to the mobile device . In order to query both of the status providers and a separate request is sent to each status provider.

Online Certificate Status Protocol OCSP is one scheme that provides for determination of digital certificate revocation status without requiring CRLs. Versions of OCSP have been defined for example in RFC 2560 and in the Internet Draft Online Digital Certificate Status Protocol version 2 both available from the Internet Engineering Task Force IETF . OCSP is one of the most widely used digital certificate revocation status check protocols and is therefore used herein as an illustrative example of such schemes. The systems and methods described herein however may also be applicable to other types of digital certificate revocation status checking schemes involving retrieval of revocation status information from remote sources.

According to OCSP a request is submitted to a status information provider generally referred to as an OCSP responder. Upon receipt of a properly formatted request an OCSP responder returns a response to the requestor. An OCSP request includes at least an OCSP protocol version number a service request and an identification of a target digital certificate to which the request is related.

The version number identifies the version of OCSP with which the request complies. The service request specifies the type of service being requested. For OCSP version 2 Online Revocation Status ORS Delegated Path Validation DPV and Delegated Path Discovery DPD services have been defined. Through the ORS service a messaging client may obtain revocation status information for digital certificates. The DPV and DPD services effectively delegate digital certificate validation path related processing to a remote system.

Normally a target digital certificate is identified in an OCSP request using a hash of the distinguished name DN of the issuer of the digital certificate as well as the serial number of the digital certificate. However since multiple digital certificate issuers may use the same DN further identification information in the form of a hash of the issuer s public key is also included in the request. Therefore target digital certificate information in an OCSP request includes a hash algorithm identifier a hash of the DN of the digital certificate issuer generated using the hash algorithm a hash of the issuer s public key also generated using the hash algorithm and the serial number of the target digital certificate.

The request may or may not be signed by a requestor. Further optional information may also be included in a request and processed by an OCSP responder.

When a messaging client is operating on a mobile device OCSP may be desirable in that it reduces the processing and memory resources necessary to check revocation status of a digital certificate relative to CRL based revocation status checking. However OCSP requests can be relatively long and thereby consume limited wireless communication resources. Request overhead can be particularly large when requests are submitted to more than one status provider for example when an error message is returned in response to a request to a status provider. The proxy system in conjunction with an appropriately enabled mobile device or possibly any other system on which a messaging client operates may be used to optimize OCSP and similar protocols for multiple remote systems as described in further detail below.

The memory is illustratively a writable store such as a RAM into which other device components may write data. The digital certificate store is a storage area that is dedicated to storage of digital certificates on the mobile device . Digital certificates may be stored in the digital certificate store in the format in which they are received or may alternatively be parsed or otherwise translated into a storage format before being written to the store .

The messaging system is connected to the wireless transceiver and is thus enabled for communications via a wireless network. The messaging system may be a messaging client embodied in a software application.

The proxy system client module which may be implemented as a software application or component may be coupled to the messaging system the digital certificate store and the mobile device s UI as shown. Revocation status for any of the digital certificates stored in the digital certificate store or those received by the messaging system but not yet stored in the digital certificate store may be checked using the proxy system client module .

The UI may include such UI components as a keyboard or keypad a display or other components which accept inputs from or provide outputs to a user of the mobile device . Although shown as a single block in a mobile device typically includes more than one UI and the UI therefore represents one or more user interfaces.

The wireless network the wireless gateway the WAN and the status information providers and are substantially the same as similarly labelled components in .

The proxy system includes a proxy system service module or component and status provider client modules and . The proxy system service component is configured to exchange information with the proxy system client module and the status provider client modules and are respectively adapted to exchange information with the status information providers and . The status provider client modules and and the proxy system service module are preferably software applications or modules operating at the proxy system . These software applications may be a single program or may alternatively be separate programs executed independently.

In operation the messaging system on the mobile device receives and possibly sends secure messages via the wireless network as described above. When a signature on a received secure message is to be verified or a message is to be sent with an encrypted session key the messaging system may retrieve a public key for an entity i.e. a sender of a received message or a recipient of a message to be sent from a digital certificate or a key store on the mobile device . Before the public key is used however the messaging system or a user thereof may wish to check that a digital certificate containing the public key is valid and has not been revoked.

Digital certificate checking operations may be performed automatically when a digital certificate is received for example periodically at predetermined or user configurable intervals or when invoked by a user through a UI . Different types of digital certificate checking operations may also be dependent upon different controls. For instance where the validity and revocation status of a digital certificate is checked when the digital certificate is first loaded onto the mobile device the digital certificate may be assumed to be valid until an expiry time or during a validity period specified in the digital certificate. However its revocation status may thereafter be checked once every week.

As described above digital certificate status information requests to a remote information provider such as or may be relatively long and are therefore not optimal for implementation in a mobile device or other bandwidth limited communication systems. Time delays and data transfers involved in submitting requests to each of multiple status information providers can be undesirable even for less constrained systems. The proxy system client module and service module are preferably adapted to gather digital certificate status request information which is used to request status information for a digital certificate from all known status information providers.

When a user of the mobile device wishes to check the revocation status of a digital certificate for example the proxy system client module or possibly a software application which operates in conjunction with the proxy system client module may be invoked by entering an appropriate command on a UI such as a keyboard. The user may also specify the particular digital certificate to be checked for instance using the serial number or subject name of the digital certificate. Alternatively the proxy system client module may access the digital certificate store to display to the user a list of currently stored digital certificates from which the user may select one or more digital certificates to be checked.

The proxy system client module then preferably either extracts from the selected digital certificates or obtains from the user through a UI any information required by the proxy system service module for a digital certificate revocation status check. Since the proxy system provides an interface between the mobile device and the status information providers and requests and responses between the proxy system client module and proxy system service module need not conform to the protocol used between the status provider client modules and and the respective status information providers and . Therefore although the status providers and and client modules and may support OCSP or a similar protocol the proxy system service module and client module may support a more compact protocol involving less data exchange.

The particular information extracted or obtained by the proxy system client module is dependent upon the communication protocol implemented between the proxy system client module and service module . The proxy system client module can preferably extract a digital certificate subject name serial number issuer name and other digital certificate information from a digital certificate in the digital certificate store . If digital certificates are first parsed and then parsed data is stored in the digital certificate store then such information may be extracted from the parsed data in the digital certificate store by the proxy system client module . If further information is required a user may be prompted to enter the information. For example if the proxy system is configured to store a mapping table or like element which maintains a correspondence between digital certificate issuers and serial numbers and or subject names then the status provider client modules and may format requests for the status information providers and based on only a serial number or subject name received by the proxy system service module from the proxy system client module .

The proxy system client module preferably gathers all information that is required for requests to any of the status information providers and . When all required information has been extracted or otherwise obtained by the proxy system client module a request is formatted and sent to the proxy system service module . The content of this request is also dependent upon the communication protocol used between the proxy system service module and client module . If more than one type of service is supported then the request may specify which type of service is requested. In some implementations only a single service may be supported such that no service type need be specified.

Information received by the proxy system service module is preferably passed to each status provider client module and . This information is then used by the status provider client modules and to format a request for the respective status information providers and . If the revocation status information providers and and status provider client modules and support OCSP for example information provided by the proxy system service module as well as any further required information are formatted into an OCSP requests. In some cases the information provided by the proxy system service module may include all required information whereas in other cases further information may be extracted from other sources such as the above example mapping table and included in the requests to the status information providers and .

Since the status provider client modules and may support different protocols or require different information for service requests each provider may extract or use different information provided in the initial service request received by the proxy system service module . For example if the provider client module requires only a subset of the information required by the provider client module then each status provider client module preferably extracts the information it requires from the initial request or retrieves the information it requires from the initial request or from a version of the initial request or parsed data extracted therefrom stored to a data store at the proxy system . Alternatively the proxy system service module is configured to pass any required information to each provider client module and . The length of the initial request may then be further reduced by configuring the proxy system client module to include any information required by the provider client modules and in the initial request only once. Redundancy in and thus the length of the initial request is thereby reduced since common information required by more than one provider client module appears in the initial request only once but can be extracted or retrieved by or passed to each provider client module and .

Thus the proxy system requests digital certificate status information from multiple status information providers for which a provider client module has been implemented responsive to a single initial request to the proxy system . According to known techniques separate requests are submitted to each status information provider and by the mobile device .

A determination of the particular status information providers to which a request will be sent in response to an initial request from the mobile device may be made in any of several ways. A proxy system may send a request to every status information provider for which a provider client module has been implemented or possibly to each status information provider in a default list stored at the proxy system . Similarly a default possibly user configurable list of status information providers may be stored at the mobile device and included in the initial request sent from the mobile device . In this case the proxy system may store the default list received in an initial request from the mobile device and then use the default list for subsequent initial requests from the mobile device until a new default list for the mobile device is received. Alternatively a user may select or specify status information providers to be used to provide the requested service. User selected or specified status information providers in an initial request may over ride any default list of status information providers. Preferred status information providers may also be included in each digital certificate stored in the digital certificate store or received by the mobile device and submitted to the proxy system service module when such a digital certificate is a target digital certificate in an initial request.

In the status provider may support an ORS or like service. Upon receiving a request each status information provider and which will be OCSP responders when the providers and and client modules and support OCSP checks the request to ensure that it is formatted properly that the requested service is a service that it is configured to provide and that the request includes all of the information required for the requested service. If these conditions are not met then a provider or may return an error message to its client module or . Each client module and may then perform error processing if it is so configured including such operations as providing any missing required information requesting missing information from the mobile device through the proxy system service module or returning an error message to the proxy system service module . Responsive to an error message from a client module or the proxy system service module preferably formats and sends an error message to the proxy system client module as a response to its initial service request. Other conditions such as when a provider or receives an unsigned request but is configured to expect signed requests or when a provider service is unable to respond may also result in an error message being returned to a provider client module or . Since digital certificate status information is requested from multiple status information providers and however error processing may possibly be invoked only when all status information providers and to which requests have been sent return an error message.

If the request meets the above conditions then a so called definitive response is returned to the corresponding provider client module or . A definitive response typically includes one of a plurality of status indications such as a valid or like indication when a target digital certificate has not been revoked a revoked indication when the target digital certificate has been revoked or an unknown indication if the status provider or has no record or knowledge of the target digital certificate.

Since a request is sent to each status information provider and responses may be received by more than one of the provider client modules and . Any responses are preferably passed to the proxy system client module which selects one of the responses to be used in preparing a response that will be returned to the proxy system client module on the mobile device . In this configuration the proxy system service module uses the first definitive response to prepare a response to the proxy system client module . If no definitive response is received then an error or similar response may be prepared by the proxy system service module and returned to the proxy system client module to indicate this result. Other selection criteria including a status information provider ranking list for example may also be used to control which one of multiple responses will be returned to the proxy system client module or used to prepare a response to the proxy system client module . Such a ranking may be established at the proxy system or at the mobile device or specified in a digital certificate. Relative ranking may also be inherent in the ordering of status information providers in a list that is used to control the particular status information providers to which requests will be sent by the proxy system as described above.

When a selected response from one of the status information providers and is signed and the proxy system client module or another component on the mobile device is configured to verify digital signatures on status responses then the entire selected response or possibly only the signed portions thereof may be forwarded to the proxy system client module substantially unchanged. If only portions of a response are signed then unsigned portions of the response are preferably removed by the proxy system service module to reduce the size of the response sent to the proxy system client module via the wireless network . However if the proxy system service module or the status provider client module checks status response signatures on behalf of the mobile device then certain parts of the response for example the status indication and the digital certificate serial number or subject name may be extracted by the proxy system service module and formatted into a response that is then sent to the proxy system client module . The response from the proxy system service module is then processed by the proxy system client module or possibly another component on the mobile device to determine whether or not the digital certificate has been revoked.

The presence of a proxy system client module preferably does not preclude digital certificate validity and revocation status checks according to known techniques. Thus digital certificate status checks involving remote systems such as the status information providers and may be complementary to other status check operations.

At step status information provider client modules at the proxy system prepare and send service requests to each status information provider such as an OCSP responder. Each status information provider then checks its request to ensure that it is formatted properly that the requested service digital certificate revocation status in this example is supported by the provider and that all required information is included in the request. These checks are performed by each status information provider at step .

If the request does not satisfy these conditions then an error message is returned to the proxy system at step . Error processing may then be executed at step to obtain further information when the request does not include all required information for example after which a new service request may be prepared and sent to the provider at step .

When the request satisfies the conditions in step the status information provider returns a status indication to the proxy system at step in response to the service request from the proxy system. The steps and are preferably performed by each status information provider to which a request has been sent at step .

At step the proxy system selects one of the responses to be used in preparing a response to the requestor the mobile device in for example. As described above the first definitive response is selected or other selection criteria may be applied. The selected response or at least parts thereof is then returned to the requestor as a response to the initial service request at step .

Although the system and method described above relate to the illustrative example of digital certificate revocation status checking digital certificate validity checks according to the DPV and DPD services of OCSP or other protocols for example may similarly be optimized for multiple status information providers through a proxy system client module and service module. A proxy system may also be enabled to provide its proxy service to multiple mobile devices and a mobile device may be configured to communicate with more than one proxy system.

In another embodiment a mobile device and proxy system include multiple client and service modules. is a block diagram of a system having multiple proxy system client modules which support multiple digital certificate status information providers. In the memory the data stores and the messaging system the UI the wireless transceiver the wireless network the wireless gateway and the WAN are substantially the same as similarly labelled components in .

The mobile device includes N client modules including the proxy system client module A and the proxy system client module N . The proxy system includes corresponding proxy system service modules A and N and . It should be appreciated that other proxy system client modules on the mobile device may be supported by other proxy system service modules in the proxy system or by proxy system service modules in other proxy systems. The proxy system also includes status provider client modules A and N and which are configured for communications with the status information provider A and the status information provider N respectively.

The system shown in operates substantially as described above. When the status of one or more digital certificates such as revocation status for example is to be checked each proxy system client module and preferably extracts or otherwise obtains information required in a service request to its respective proxy system service module and . The status provider client modules and then use the information from the service request from the mobile device and possibly information available at the proxy system to prepare a service request to status information providers and . The proxy system service modules and or possibly another component of the proxy system are preferably configured such that only one of the responses returned by the status information providers and or at least portions thereof is reformatted if necessary and returned to the proxy system client modules and at the mobile device . One of the responses may be selected according to any of the schemes described above.

Each proxy system client module and may be adapted to collect request information and process response information for a different remote digital certificate status check protocol. However the information collected by both proxy system client modules and may be combined into a single initial request to the proxy system . Each proxy system service module and then extracts information from the service request required for a service request to its associated status information provider and .

A multiple client module system such as shown in is particularly useful when a user wishes to check validity and or revocation status of an entire digital certificate chain which includes digital certificates for which status information is available from different status information providers. In known systems separate requests for each digital certificate in the chain must be sent to the status information providers. In the system of however only a single request need be sent from the mobile device to obtain status information from any number of status information providers.

The mobile device includes a transceiver a microprocessor a display a Flash memory a random access memory RAM auxiliary input output I O devices a serial port a keyboard a speaker a microphone a short range wireless communications sub system and other device sub systems . The transceiver includes transmit and receive antennas a receiver Rx a transmitter Tx one or more local oscillators LOs and a digital signal processor DSP . Within the Flash memory the mobile device includes a plurality of software modules A N that can be executed by the microprocessor and or the DSP including a voice communication module A a data communication module B and a plurality of other operational modules N for carrying out a plurality of other functions.

The mobile device is preferably a two way communication device having voice and data communication capabilities. Thus for example the mobile device may communicate over a voice network such as any of the analog or digital cellular networks and may also communicate over a data network. The voice and data networks are depicted in by the communication tower . These voice and data networks may be separate communication networks using separate infrastructure such as base stations network controllers etc. or they may be integrated into a single wireless network. References to the network should therefore be interpreted as encompassing both a single voice and data network and separate networks.

The communication subsystem is used to communicate with the network . The DSP is used to send and receive communication signals to and from the transmitter and receiver and may also exchange control information with the transmitter and receiver . If the voice and data communications occur at a single frequency or closely spaced set of frequencies then a single LO may be used in conjunction with the transmitter and receiver . Alternatively if different frequencies are utilized for voice communications versus data communications then a plurality of LOs can be used to generate a plurality of frequencies corresponding to the network . Although two antennas are depicted in the mobile device could be used with a single antenna structure. Information which includes both voice and data information is communicated to and from the communication module via a link between the DSP and the microprocessor .

The detailed design of the communication subsystem such as frequency band component selection power level etc. will be dependent upon the communication network in which the mobile device is intended to operate. For example a mobile device intended to operate in a North American market may include a communication subsystem designed to operate with the Mobitex or DataTAC mobile data communication networks and also designed to operated with any of a variety of voice communication networks such as AMPS TDMA CDMA PCS etc. whereas a mobile device intended for use in Europe may be configured to operate with the GPRS data communication network and the GSM voice communication network. Other types of data and voice networks both separate and integrated may also be utilized with the mobile device .

Depending upon the type of network the access requirements for the mobile device may also vary. For example in the Mobitex and DataTAC data networks mobile devices are registered on the network using a unique identification number associated with each device. In GPRS data networks however network access is associated with a subscriber or user of the mobile device . A GPRS device typically requires a subscriber identity module SIM which is required in order to operate the mobile device on a GPRS network. Local or non network communication functions if any may be operable without the SIM but the mobile device will be unable to carry out any functions involving communications over the network other than any legally required operations such as 911 emergency calling.

After any required network registration or activation procedures have been completed the mobile device may send and receive communication signals preferably including both voice and data signals over the network . Signals received by the antenna from the communication network are routed to the receiver which provides for such operations as signal amplification frequency down conversion filtering channel selection and analog to digital conversion. Analog to digital conversion of the received signal allows more complex communication functions such as digital demodulation and decoding to be performed using the DSP . In a similar manner signals to be transmitted to the network are processed including modulation and encoding for example by the DSP and are then provided to the transmitter for digital to analog conversion frequency up conversion filtering amplification and transmission to the communication network via the antenna . Although a single transceiver is shown in for both voice and data communications it is possible that the mobile device may include two distinct transceivers a first transceiver for transmitting and receiving voice signals and a second transceiver for transmitting and receiving data signals. Multiple transceiver may also be provided in a mobile device adapted to operate within more than one communication network or multiple frequency bands.

In addition to processing the communication signals the DSP also provides for receiver and transmitter control. For example the gain levels applied to communication signals in the receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP . Other transceiver control algorithms could also be implemented in the DSP in order to provide more sophisticated control of the transceiver .

The microprocessor preferably manages and controls the overall operation of the mobile device . Many types of microprocessors or microcontrollers could be used here or alternatively a single DSP could be used to carry out the functions of the microprocessor . Low level communication functions including at least data and voice communications are performed through the DSP in the transceiver . Other high level communication applications such as a voice communication application A and a data communication application B are stored in the Flash memory for execution by the microprocessor . For example the voice communication module A may provide a high level user interface operable to transmit and receive voice calls between the mobile device and a plurality of other voice devices via the network . Similarly the data communication module B may provide a high level user interface operable for sending and receiving data such as e mail messages files organizer information short text messages etc. between the mobile device and a plurality of other data devices via the network . On the mobile device a secure messaging software application incorporating software modules corresponding to the messaging system and the proxy system client module or client modules and for example may operate in conjunction with the data communication module B in order to implement the techniques described above.

The microprocessor also interacts with other device subsystems such as the display the Flash memory the RAM the auxiliary input output I O subsystems the serial port the keyboard the speaker the microphone the short range communications subsystem and any of the other device subsystems generally designated as . For example the modules A N are executed by the microprocessor and may provide a high level interface between a user and the mobile device . This interface typically includes a graphical component provided through the display and an input output component provided through the auxiliary I O the keyboard the speaker or the microphone . Such interfaces are designated generally as UI and in respectively.

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as the keyboard and the display are used for both communication related functions such as entering a text message for transmission over a data communication network and device resident functions such as a calculator or task list or other PDA type functions.

Operating system software used by the microprocessor is preferably stored in a non volatile store such as Flash memory . In addition to the operating system and communication modules A N the Flash memory may also include a file system for storing data. A storage area is also preferably provided in the Flash memory to store digital certificates address book entries and possibly other information required for messaging shown as data stores and in or the data stores and in . The operating system specific device applications or modules or parts thereof may be temporarily loaded into a volatile store such as RAM for faster operation. Moreover received communication signals may also be temporarily stored to RAM before permanently writing them to a file system located in the Flash memory .

An exemplary application module N that may be loaded onto the mobile device is a personal information manager PIM application providing PDA functionality such as calendar events appointments and task items. This module N may also interact with the voice communication module A for managing phone calls voice mails etc. and may also interact with the data communication module B for managing e mail communications and other data transmissions. Alternatively all of the functionality of the voice communication module A and the data communication module B may be integrated into the PIM module.

The Flash memory preferably provides a file system to facilitate storage of PIM data items on the device. The PIM application preferably includes the ability to send and receive data items either by itself or in conjunction with the voice and data communication modules A and B via the wireless network . The PIM data items are preferably seamlessly integrated synchronized and updated via the wireless network with a corresponding set of data items stored or associated with a host computer system thereby creating a mirrored system for data items associated with a particular user.

Although shown as a Flash memory those skilled in the art will appreciate that other types of non volatile store such as a battery backed up RAM for example could be used in addition to or instead of the Flash memory .

The mobile device may also be manually synchronized with a computer system by placing the mobile device in an interface cradle which couples the serial port of the mobile device to the serial port of the computer system. The serial port may also be used to enable a user to set preferences through an external device or software application to download other application modules N for installation and possibly to load digital certificates onto a mobile device. This wired download path may further be used to load an encryption key onto the device which is a more secure method than exchanging encryption information via the wireless network .

Additional application modules N may be loaded onto the mobile device through the network through an auxiliary I O subsystem through the serial port through the short range communications subsystem or through any other suitable subsystem and installed by a user in the Flash memory or RAM . Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

When the mobile device is operating in a data communication mode a received signal such as a text message or a web page download is processed by the transceiver and provided to the microprocessor which preferably further processes the received signal for output to the display or alternatively to an auxiliary I O device . A digital certificate received by the transceiver in response to a request to a PKS or attached to a secure message for example may be added to a digital certificate store in the Flash memory if it has not already been stored. Validity and or revocation status of such a digital certificate may also be checked as described above. A user of mobile device may also compose data items such as e mail messages using the keyboard which is preferably a complete alphanumeric keyboard laid out in the QWERTY style although other styles of complete alphanumeric keyboards such as the known DVORAK style may also be used. User input to the mobile device is further enhanced with a plurality of auxiliary I O devices which may include a thumbwheel input device a touchpad a variety of switches a rocker input switch etc. The composed data items input by the user may then be transmitted over the communication network via the transceiver .

When the mobile device is operating in a voice communication mode the overall operation of the mobile device is substantially similar to the data mode except that received signals are preferably output to the speaker and voice signals for transmission are generated by a microphone . In addition the secure messaging techniques described above might not necessarily be applied to voice communications. Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is preferably accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party the duration of a voice call or other voice call related information. For example the microprocessor in conjunction with the voice communication module A and the operating system software may detect the caller identification information of an incoming voice call and display it on the display .

The short range communications subsystem may include an infrared device and associated circuits and components or a short range wireless communication module such as a Bluetooth module or an 802.11 module to provide for communication with similarly enabled systems and devices. Those skilled in the art will appreciate that Bluetooth and 802.11 refer to sets of specifications available from the Institute of Electrical and Electronics Engineers relating to wireless personal area networks and wireless LANs respectively.

It will be appreciated that the above description relates to preferred embodiments by way of example only as many other variations and examples may occur to those skilled in the art. For example although digital certificate status checking according to aspects of the system and method are described primarily in the context of a wireless mobile communication device the system and method are also applicable to messaging clients operating on other platforms including those operating on desktop and laptop computer systems networked computer workstations and other types of messaging clients for which digital certificate checks involving remote systems may be desired.

The above description also relates primarily to OCSP although other protocols may similar be optimized through an intermediate proxy system which operates in conjunction with both remote systems and proxy system client modules. Such other protocols are not limited to digital certificate status check protocols. A proxy system and proxy system client modules may be configured to provide other services than digital certificate status check services.

The intermediate computer system uses a status information provider data structure in determining which status information providers are to receive a service request. A service request asks a status information provider to provide the status information. The data structure may be populated with provider information that was sent by the mobile device . There are many other ways for populating the data structure with provider information. For example a mapping table may be stored in the data structure which maintains a correspondence between digital certificate issuers and serial numbers and or subject names. In this example the intermediate computer system may format requests for the status information providers based on only a serial number or subject name sent from the mobile device .

A service message handler is used by the intermediate computer system to generate multiple service requests based upon a request received from the mobile device . Each of the generated service requests corresponds to a status information provider and asks for status information from a provider. At least one of the responses from the status information providers is used in reply to the mobile device s request for status information.

Still further examples of the wide scope of the systems and methods disclosed herein are illustrated in . describe additional uses of the systems and methods within different exemplary communication systems.

The computer system is for example a laptop desktop or palmtop computer system configured for connection to the WAN . Such a computer system may connect to the WAN via an ISP or ASP. Alternatively the computer system may be a network connected computer system that like the computer system for example accesses the WAN through a LAN or other network. Many modem mobile devices are enabled for connection to a WAN through various infrastructure and gateway arrangements so that the computer system may also be a mobile device.

The corporate LAN is an illustrative example of a central server based messaging system that has been enabled for wireless communications. The corporate LAN may be referred to as a host system in that it hosts both a data store with mailboxes for messages as well as possibly further data stores not shown for other data items that may be sent to or received from mobile devices and and the wireless connector system the wireless VPN router or possibly other components enabling communications between the corporate LAN and one or more mobile devices and . In more general terms a host system is one or more computers at with or in association with which a wireless connector system is operating. The corporate LAN is one preferred embodiment of a host system in which the host system is a server computer running within a corporate network environment operating behind and protected by at least one security communications firewall . Other possible central host systems include ISP ASP and other service provider or mail systems. Although the desktop computer system and interface connector may be located outside such host systems wireless communication operations may be similar to those described below.

The corporate LAN implements the wireless connector system as an associated wireless communications enabling component which will normally be a software program a software application or a software component built to work with at least one message server . The wireless connector system is used to send user selected information to and to receive information from one or more mobile devices and via one or more wireless networks and . The wireless connector system may be a separate component of a messaging system as shown in or may instead be partially or entirely incorporated into other communication system components. For example the message server may incorporate a software program application or component implementing the wireless connector system portions thereof or some or all of its functionality.

The message server running on a computer behind the firewall acts as the main interface for the corporation to exchange messages including for example electronic mail calendaring data voice mail electronic documents and other PIM data with a WAN such as the Internet. The particular intermediate operations and computers are dependent upon the specific type of message delivery mechanisms and networks via which messages are exchanged and therefore have not been shown in . The functionality of the message server may extend beyond message sending and receiving providing such features as dynamic database storage for data like calendars to do lists task lists e mail and documentation as described above.

Message servers such as normally maintain a plurality of mailboxes in one or more data stores such as for each user having an account on the server. The data store includes mailboxes for a number n of user accounts. Messages received by the message server that identify a user a user account a mailbox or possibly another address associated with a user account or mailbox as a message recipient is typically stored in the corresponding mailbox . If a message is addressed to multiple recipients or a distribution list then copies of the same message may be stored to more than one mailbox . Alternatively the message server may store a single copy of such a message in a data store accessible to all of the users having an account on the message server and store a pointer or other identifier in each recipient s mailbox . In typical messaging systems each user then accesses his or her mailbox and its contents using a messaging client such as Microsoft Outlook or Lotus Notes which normally operates on a PC such as the desktop computer system connected in the LAN . Although only one desktop computer system is shown in those skilled in the art will appreciate that a LAN typically contains many desktop notebook and laptop computer systems. Each messaging client normally accesses a mailbox through the message server although in some systems a messaging client may enable direct access to the data store and a mailbox stored thereon by the desktop computer system . Messages may also be downloaded from the data store to a local data store on the desktop computer system .

Within the corporate LAN the wireless connector system operates in conjunction with the message server . The wireless connector system may reside on the same computer system as the message server or may instead be implemented on a different computer system. Software implementing the wireless connector system may also be partially or entirely integrated with the message server . The wireless connector system and the message server are preferably designed to cooperate and interact to allow the pushing of information to the mobile devices . In such an installation the wireless connector system is preferably configured to send information that is stored in one or more data stores associated with the corporate LAN to one or more of the mobile devices through the corporate firewall and via the WAN and one of the wireless networks . For example a user that has an account and associated mailbox in the data store may also have a mobile device such as . As described above messages received by the message server that identify a user account or mailbox are stored to a corresponding mailbox by the message server . If a user has a mobile device such as messages received by the message server and stored to the user s mailbox are preferably detected by the wireless connector system and sent to the user s mobile device . This type of functionality represents a push message sending technique. The wireless connector system may instead employ a pull technique in which items stored in a mailbox are sent to a mobile device or responsive to a request or access operation made using the mobile device or some combination of both techniques.

The use of a wireless connector thereby enables a messaging system including a message server to be extended so that each user s mobile device has access to stored messages of the message server . Although the systems and methods described herein are not restricted solely to a push based technique a more detailed description of push based messaging may be found in the United States patent and incorporated by reference above. This push technique uses a wireless friendly encoding compression and encryption technique to deliver all information to a mobile device thus effectively extending the company firewall to include the mobile devices and .

As shown in there are several paths for exchanging information with a mobile device from the corporate LAN . One possible information transfer path is through the physical connection such as a serial port using an interface or connector . This path is useful for example for bulk information updates often performed at initialization of a mobile device or periodically when a user of a mobile device is working at a computer system in the LAN such as the computer system . For example as described above PIM data is commonly exchanged over a such a connection as a serial port connected to a cradle in or upon which a mobile device may be placed. The physical connection may also be used to transfer other information from a desktop computer system to a mobile device including private security keys private keys such as private encryption or digital signature keys associated with the desktop computer system or other relatively bulky information such as digital certificates and CRLs.

Private key exchange using the physical connection and the connector or interface allows a user s desktop computer system and mobile device or to share at least one identity for accessing all encrypted and or signed mail. The user s desktop computer system and mobile device or can also thereby share private keys so that either the host system or the mobile device or can process secure messages addressed to the user s mailbox or account on the message server . The transfer of digital certificates and CRLs over such a physical connection is desirable in that they represent a large amount of the data that is required for S MIME PGP and other public key security methods. A user s own digital certificate a chain of digital certificates used to verify the user s digital certificate and a CRL as well as digital certificates digital certificate chains and CRLs for other users may be loaded onto a mobile device from the user s desktop computer system . This loading of other user s digital certificates and CRLs onto a mobile device allows a mobile device user to select other entities or users with whom they might be exchanging secure messages and to pre load the bulky information onto the mobile device through a physical connection instead of over the air thus saving time and wireless bandwidth when a secure message is received from or to be sent to such other users or when the status of a digital certificate is to be determined based on one or more CRLs. CRL based status checks can also be avoided where the systems and methods described herein are employed.

In known synchronization type wireless messaging systems a physical path has also been used to transfer messages from mailboxes associated with a message server to mobile devices and .

Another method for data exchange with the mobile devices and is over the air through the wireless connector system and using the wireless networks and . As shown in this could involve a Wireless VPN router if available in the network or alternatively a traditional WAN connection to wireless infrastructure that provides an interface to one or more wireless networks such as . The Wireless VPN router provides for creation of a VPN connection directly through a specific wireless network to a wireless device . Such a Wireless VPN router may be used in conjunction with a static addressing scheme. For example if the wireless network is an IP based wireless network then IPV6 would provide enough IP addresses to dedicate an IP address to every mobile device configured to operate within the network and thus make it possible to push information to a mobile device at any time. A primary advantage of using a wireless VPN router is that it could be an off the shelf VPN component which would not require wireless infrastructure . A VPN connection may use a TCP IP or UDP IP connection to deliver messages directly to and from a mobile device .

If a wireless VPN router is not available then a link to a WAN normally the Internet is a commonly used connection mechanism that may be employed by the wireless connector system . To handle the addressing of the mobile device and any other required interface functions wireless infrastructure is preferably used. The wireless infrastructure may also determine a most likely wireless network for locating a given user and track users as they roam between countries or networks. In wireless networks such as and messages are normally delivered to and from mobile devices via RF transmissions between base stations and the mobile devices.

A plurality of connections to wireless networks and may be provided including for example ISDN Frame Relay or T1 connections using the TCP IP protocol used throughout the Internet. The wireless networks and could represent distinct unique and unrelated networks or they could represent the same network indifferent countries and may be any of different types of networks including but not limited to data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same or similar infrastructure such as any of those described above.

In some implementations more than one over the air information exchange mechanism may be provided in the corporate LAN . In for example the mobile devices and associated with users having mailboxes associated with user accounts on the message server are configured to operate on different wireless networks and . If the wireless network supports IPv6 addressing then the wireless VPN router may be used by the wireless connector system to exchange data with any mobile device operating within the wireless network . The wireless network may be a different type of wireless network however such as the Mobitex network in which case information is instead exchanged with the mobile device operating within the wireless network via a connection to the WAN and the wireless infrastructure .

Operation of the system in will now be described using an example of an e mail message sent from the computer system and addressed to at least one recipient having both an account and mailbox or like data store associated with the message server and a mobile device or . However the e mail message is intended for illustrative purposes only. The exchange of other types of information between the corporate LAN is preferably also enabled by the wireless connector system .

The e mail message sent from the computer system via the WAN may be fully in the clear or signed with a digital signature and or encrypted depending upon the particular messaging scheme used. For example if the computer system is enabled for secure messaging using S MIME then the e mail message may be signed encrypted or both.

E mail messages such as normally use traditional SMTP RFC822 headers and MIME body parts to define the format of the e mail message. These techniques are all well known to one in the art. The e mail message arrives at the message server which determines into which mailboxes the e mail message should be stored. As described above a message such as the e mail message may include a user name a user account a mailbox identifier or other type of identifier that is mapped to a particular account or associated mailbox by the message server . For an e mail message recipients are typically identified using e mail addresses corresponding to a user account and thus a mailbox .

The wireless connector system sends or mirrors via the wireless network or certain user selected data items or parts of data items from the corporate LAN to the user s mobile device or preferably upon detecting that one or more triggering events has occurred. A triggering event includes but is not limited to one or more of the following screen saver activation at a user s networked computer system disconnection of the user s mobile device or from the interface or receipt of a command sent from a mobile device or to the host system to start sending one or more messages stored at the host system. Thus the wireless connector system may detect triggering events associated with the message server such as receipt of a command or with one or more networked computer systems including the screen saver and disconnection events described above. When wireless access to corporate data for a mobile device or has been activated at the LAN for example when the wireless connector system detects the occurrence of a triggering event for a mobile device user data items selected by the user are preferably sent to the user s mobile device. In the example of the e mail message assuming that a triggering event has been detected the arrival of the message at the message server is detected by the wireless connector system . This may be accomplished for example by monitoring or querying mailboxes associated with the message server or if the message server is a Microsoft Exchange server then the wireless connector system may register for advise syncs provided by the Microsoft Messaging Application Programming Interface MAPI to thereby receive notifications when a new message is stored to a mailbox .

When a data item such as the e mail message is to be sent to a mobile device or the wireless connector system preferably repackages the data item in a manner that is transparent to the mobile device or so that information sent to and received by the mobile device or appears similar to the information as stored on and accessible at the host system LAN in . One preferred repackaging method includes wrapping received messages to be sent via a wireless network or in an electronic envelope that corresponds to the wireless network address of the mobile device or to which the message is to be sent. Alternatively other repackaging methods could be used such as special purpose TCP IP wrapping techniques. Such repackaging preferably also results in e mail messages sent from a mobile device or appearing to come from a corresponding host system account or mailbox even though they are composed and sent from a mobile device. A user of a mobile device or may thereby effectively share a single e mail address between a host system account or mailbox and the mobile device.

Repackaging of the e mail message is indicated at and . Repackaging techniques may be similar for any available transfer paths or may be dependent upon the particular transfer path either the wireless infrastructure or the wireless VPN router . For example the e mail message is preferably compressed and encrypted either before or after being repackaged at to thereby provide for secure transfer to the mobile device . Compression reduces the bandwidth required to send the message whereas encryption ensures confidentiality of any messages or other information sent to the mobile devices and . In contrast messages transferred via a VPN router might only be compressed and not encrypted since a VPN connection established by the VPN router is inherently secure. Messages are thereby securely sent via either encryption at the wireless connector system which may be considered a non standard VPN tunnel or a VPN like connection for example or the VPN router to mobile devices and . Accessing messages using a mobile device or is thus no less secure than accessing mailboxes at the LAN using the desktop computer system .

When a repackaged message or arrives at a mobile device or via the wireless infrastructure or via the wireless VPN router the mobile device or removes the outer electronic envelope from the repackaged message or and performs any required decompression and decryption operations. Messages sent from a mobile device or and addressed to one or more recipients are preferably similarly repackaged and possibly compressed and encrypted and sent to a host system such as the LAN . The host system may then remove the electronic envelope from the repackaged message decrypt and decompress the message if desired and route the message to the addressed recipients.

Another goal of using an outer envelope is to maintain at least some of the addressing information in the original e mail message . Although the outer envelope used to route information to mobile devices is addressed using a network address of one or more mobile devices the outer envelope preferably encapsulates the entire original e mail message including at least one address field possibly in compressed and or encrypted form. This allows original To From and CC addresses of the e mail message to be displayed when the outer envelope is removed and the message is displayed on a mobile device or . The repackaging also allows reply messages to be delivered to addressed recipients with the From field reflecting an address of the mobile device user s account or mailbox on the host system when the outer envelope of a repackaged outgoing message sent from a mobile device is removed by the wireless connector system . Using the user s account or mailbox address from the mobile device or allows a message sent from a mobile device to appear as though the message originated from the user s mailbox or account at the host system rather than the mobile device.

The wireless connector systems and are similar to the wireless connector system described above in that they enable data items such as e mail messages and other items that are stored in mailboxes and possibly data items stored in a local or network data store to be sent from the LAN to one or more of the mobile devices and . In however the network operator infrastructure provides an interface between the mobile devices and and the LAN . As above operation of the system shown in is described below in the context of an e mail message as an illustrative example of a data item that may be sent to a mobile device or .

When an e mail message addressed to one or more recipients having an account on the message server is received by the message server the message or possibly a pointer to a single copy of the message stored in a central mailbox or data store is stored in the mailbox of each such recipient. Once the e mail message or pointer has been stored to a mailbox it may preferably be accessed using a mobile device or . In the example shown in the e mail message has been addressed to the mailboxes associated with both desktop computer systems and and thus both mobile devices and .

As those skilled in the art will appreciate communication network protocols commonly used in wired networks such as the LAN and or the WAN are not suitable or compatible with wireless network communication protocols used within wireless networks such as . For example communication bandwidth protocol overhead and network latency which are primary concerns in wireless network communications are less significant in wired networks which typically have much higher capacity and speed than wireless networks. Therefore mobile devices and cannot normally access the data store directly. The network operator infrastructure provides a bridge between the wireless network and the LAN .

The network operator infrastructure enables a mobile device or to establish a connection to the LAN through the WAN and may for example be operated by an operator of the wireless network or a service provider that provides wireless communication service for mobile devices and . In a pull based system a mobile device or establishes a communication session with the network operator infrastructure using a wireless network compatible communication scheme preferably a secure scheme such as Wireless Transport Layer Security WTLS when information should remain confidential and a wireless web browser such as a Wireless Application Protocol WAP browser. A user then requests through manual selection or pre selected defaults in the software residing in the mobile device any or all information or just new information for example stored in a mailbox in the data store at the LAN . The network operator infrastructure establishes a connection or session with a wireless connector system using Secure Hypertext Transfer Protocol HTTPS for example if no session has already been established. As above a session between the network operator infrastructure and a wireless connector system or may be made via a typical WAN connection or through the VPN router if available. When time delays between receiving a request from a mobile device or and delivering requested information back to the device are to be minimized the network operator infrastructure and the wireless connector systems and may be configured so that a communication connection remains open once established.

In the system of requests originating from mobile device A and B would be sent to the wireless connector systems and respectively. Upon receiving a request for information from the network operator infrastructure a wireless connector system or retrieves requested information from a data store. For the e mail message the wireless connector system or retrieves the e mail message from the appropriate mailbox typically through a messaging client operating in conjunction with the computer system or which may access a mailbox either via the message server or directly. Alternatively a wireless connector system or may be configured to access mailboxes itself directly or through the message server . Also other data stores both network data stores similar to the data store and local data stores associated with each computer system and may be accessible to a wireless connector system or and thus to a mobile device or .

If the e mail message is addressed to the message server accounts or mailboxes associated with both computer systems and and devices and then the e mail message is sent to the network operator infrastructure as shown at and which then sends a copy of the e mail message to each mobile device and as indicated at and . Information is transferred between the wireless connector systems and and the network operator infrastructure via either a connection to the WAN or the VPN router . When the network operator infrastructure communicates with the wireless connector systems and and the mobile devices and via different protocols translation operations may be performed by the network operator infrastructure . Repackaging techniques may also be used between the wireless connector systems and and the network operator infrastructure and between each mobile device and and the network operator infrastructure .

Messages or other information to be sent from a mobile device or may be processed in a similar manner with such information first being transferred from a mobile device or to the network operator infrastructure . The network operator infrastructure then sends the information to a wireless connector system or for storage in a mailbox and delivery to any addressed recipients by the message server for example or may alternatively deliver the information to the addressed recipients.

The above description of the system in relates to pull based operations. The wireless connector systems and and the network operator infrastructure may instead be configured to push data items to mobile devices and . A combined push pull system is also possible. For example a notification of a new message or a list of data items currently stored in a data store at the LAN could be pushed to a mobile device or which may then be used to request messages or data items from the LAN via the network operator infrastructure .

If mobile devices associated with user accounts on the LAN are configured to operate within different wireless networks then each wireless network may have an associated wireless network infrastructure component similar to .

Although separate dedicated wireless connector systems and are shown for each computer system and in the system of one or more of the wireless connector systems and is preferably configured to operate in conjunction with more than one of the computer systems and or to access a data store or mailbox associated with more than one computer system. For example the wireless connector system may be granted access to the mailboxes associated with both the computer system and the computer system . Requests for data items from either mobile device A or B are then processed by the wireless connector system . This configuration is useful to enable wireless communications between the LAN and the mobile devices and without requiring a desktop computer system and to be running for each mobile device user. A wireless connector system may instead be implemented in conjunction with the message server to enable wireless communications.

The wireless connector system provides for transfer of data items stored at the LAN to one or more of the mobile devices and . These data items preferably include e mail messages stored in mailboxes in the data store as well as possibly other items stored in the data store or another network data store or a local data store of a computer system such as .

As described above an e mail message addressed to one or more recipients having an account on the message server and received by the message server are stored into the mailbox of each such recipient. In the system of the external data store preferably has a similar structure to and remains synchronized with the data store . PIM information or data stored at data store preferably is independently modifiable to the PIM information or data stored at the host system. In this particular configuration the independently modifiable information at the external data store may maintain synchronization of a plurality of data stores associated with a user i.e. data on a mobile device data on a personal computer at home data at the corporate LAN etc. . This synchronization may be accomplished for example through updates sent to the data store by the wireless connector system at certain time intervals each time an entry in the data store is added or changed at certain times of day or when initiated at the LAN by the message server or a computer system at the data store or possibly by a mobile device or through the access gateway .

In the case of the e mail message for example an update sent to the data store some time after the e mail message is received indicates that the message has been stored in a certain mailbox in the store and a copy of the e mail message is stored to a corresponding storage area in the data store . When the e mail message has been stored in the mailboxes corresponding to the mobile devices and one or more copies of the e mail message indicated at and in will be sent to and stored in corresponding storage areas or mailboxes in the data store . As shown updates or copies of stored information in the data store may be sent to the data store via a connection to the WAN or the VPN router . For example the wireless connector system may post updates or stored information to a resource in the data store via an HTTP post request. Alternatively a secure protocol such as HTTPS or Secure Sockets Layer SSL may be used. Those skilled in the art will appreciate that a single copy of a data item stored in more than one location in a data store at the LAN may instead be sent to the data store . This copy of the data item could then be stored either in more than one corresponding location in the data store or a single copy may be stored in the data store with a pointer or other identifier of the stored data item being stored in each corresponding location in the data store .

The access gateway is effectively an access platform in that it provides mobile devices and with access to the data store . The data store may be configured as a resource accessible on the WAN and the access gateway may be an ISP system or WAP gateway through which mobile devices and connect to the WAN . A WAP browser or other browser compatible with the wireless networks and may then be used to access the data store which is synchronized with the data store and download stored data items either automatically or responsive to a request from a mobile device or . As shown at and copies of the e mail message which was stored in the data store are sent to the mobile devices and . A data store on each mobile device and is thereby synchronized with a portion such as a mailbox of a data store on a corporate LAN . Changes to a mobile device data store are similarly reflected in the data stores and .

The embodiments described herein are examples of structures systems or methods having elements corresponding to the elements of the invention recited in the claims. This written description may enable those of ordinary skill in the art to make and use embodiments having alternative elements that likewise correspond to the elements of the invention recited in the claims. The intended scope of the invention thus includes other structures systems or methods that do not differ from the literal language of the claims and further includes other structures systems or methods with insubstantial differences from the literal language of the claims.

