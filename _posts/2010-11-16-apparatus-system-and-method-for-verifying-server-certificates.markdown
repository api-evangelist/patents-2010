---

title: Apparatus, system and method for verifying server certificates
abstract: A device and method are provided for a device that authenticates a server over a network. The device and method are operable to contact the server to initiate a handshaking operation. The device receives certificate information and handshaking information from the server. The device completes the handshaking operations to establish the connection with the server. The device downloads the content from the server through the connection before authenticating the server to establish a secure connection. In some aspects, the device may display a portion of the downloaded content before the server is authenticated.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09264235&OS=09264235&RS=09264235
owner: BlackBerry Limited
number: 09264235
owner_city: Waterloo
owner_country: CA
publication_date: 20101116
---
This application relates to on line communications. In particular it relates to a device system and method for improving a user s experience during on line communications

Secure on line communications rely upon the exchange and validation of security certificates. Checking the status of a security certificate particularly in a mobile or other bandwidth limited environment can be sufficiently time consuming as to disrupt a user s experience while obtaining on line content. In some instances delays in validating certificates can cause a connection with an on line content server to timeout requiring a user to re initiate the connection.

In general in order to conduct on line communications in a secure manner an agreed set of protocols must be established for the sender and receiver to follow to maintain a secure connection across a network. Currently a common mechanism used on line is the Transport Layer Security TLS Protocol. This protocol is well understood to skilled persons and is continually updated as a generally available standard. The TLS Protocol is generally described in the Internet Official Protocol Standards and updated from time to time see RFC 5246 standard for TLS version 1.2 . Prior to the adoption of TLS the Secure Sockets Layer SSL protocol was widely used.

This application is described with reference to the current protocol generally in use TLS though it will be understood that the methods may be applicable for other protocols for exchanging security certificates to authenticate an on line content provider and the specific sequence of steps to carry out the handshaking may vary in other protocols.

The TLS protocol provides a mechanism for a client to contact a server across a network in a secure manner. By following the protocol the client and server may establish endpoint authentication of the client and server and an encrypted communication channel between the client and the server. In a typical HTTP application the client contacts the server and requests the server to authenticate itself while the client may remain anonymous. TLS does more generally support authentication of both parties which requires each party to have its own security certificate. Most often such bi lateral authentication is reserved for enterprise applications.

In the example of a TLS protocol a handshake protocol is specified. The handshaking between the client and the server when first starting to communicate establishes i an agreed protocol version ii selection of a common cryptographic algorithm iii optionally authentication of one or both parties and iv exchange of public key encryption information to generate shared secrets private keys . Typically most secure communication protocols would generally include these four items.

The TLS Handshake Protocol involves the following steps for bi lateral authentication referenced from RFC 5246 

Once the Handshake Protocol has been completed the client and server can securely exchange information using the calculated security parameters.

In a typical on line web environment however a client device will conduct a unilateral authentication of an on line resource. That is the handshake will authenticate the server by its certificate but the device is not authenticated by a certificate.

For example a user attempting to access a secure on line resource will carry out the TLS handshake protocol except that the server does not authenticate the client. The client authenticates the server and exchanges the information required to calculate the security parameters to establish a secure connection to the server. This may include for instance the following steps 

Once connected the client device will download content from the server such as html code java script etc. . . . for execution by the client device to present an authentication portal to a user of the client device. The user may then interact with one or more user interfaces resident on the client device to enter authentication information which is sent by the client device to the server over the secure connection. The server may then authenticate the user by authenticating the user supplied authentication information with server resident authentication information.

The authentication may comprise a comparison of the received values to server resident values or may comprise processing or converting the received values for instance by using a hash function before comparing the processed received values with the server resident values. Other known methods of authentication may also be employed.

One problem faced with on line authentication especially in a bandwidth constrained or mobile application is the latency inherent in authenticating certificates. For mobile client devices for instance establishing a TLS connection may be challenged as the time required to carry out the steps necessary to verify the certificate s may be too long causing the TLS handshake with the server to time out.

It would be advantageous for a device system or method to alleviate some of the current problems relating to on line communications.

In an embodiment a method is provided for a client device authenticating a content server accessed over a network the method comprising the client device contacting the content server to initiate a handshaking operation to establish a connection the client device receiving from the content server handshaking information and content server certificate information to be authenticated and the client device authenticating the content server using the certificate information. Wherein the client device may complete the handshaking operation using the handshaking information to establish the connection with the content server prior to the client device authenticating the certificate information to establish a secure connection with the content server.

In an embodiment a client processing device operative to authenticate a content server may be provided. The client device may comprise a processing unit for executing instructions stored in a memory of the client device network connection means in communication with the processing unit for accessing the network and a user interface for displaying content to a user of the client device wherein the client device is operative to contact the content server to initiate a handshaking operation over the network receive certificate information and handshaking information from the content server complete the handshaking operations to establish a connection with the content server and authenticate the content server. After authenticating the content server the client device may treat the connection as a secure connection.

In an aspect the client device may download content from the content server before authenticating the content server. The client device may execute the downloaded content after authenticating the content server. In an aspect the executable content may comprise JavaScript instructions. In an aspect the non executable content comprises HTML code for rendering a web page. In an aspect after the device downloads the content but before the device authenticates the content server the device may further display non executable content from the downloaded content on a user interface of the device. In an aspect after the device displays the non executable content the device may collect user input responsive to the downloaded content but waits to forward the collected user input to the content server until the content server has been authenticated. In an aspect the device may complete the handshaking operations and download the content while the device authenticates the content server.

In an embodiment the client device may authenticate the content server using a certificate authority server.

In an embodiment if the client device fails to authenticate the content server the client device may terminate the connection.

In an embodiment the client device may be operable to operate in a limited functionality state and an expanded functionality state and wherein before the client device authenticates the content server the client device may operate in the limited functionality state and upon authentication the client device may transition to the expanded functionality state. The client device may receive instructions from a host server through the network to set conditions of the limited functionality state and the expanded functionality state.

In an embodiment the client device receives a request for server content from a requesting device and the client device contacts the content server to initiate the handshaking operation to obtain the requested content to forward to the requesting device. In an aspect the client device may forward the requested content to the requesting device before the client device authenticates the content server. The client device may authenticate the content server and then forward an authentication notification to the requesting device. In an aspect the client device may receive user input from the requesting device responsive to the requested content and the client device may forward the user input after the client device has authenticated the content server.

In an aspect of the method while the client device is completing the handshake and downloading the content the device authenticates the content server. The client device may authenticate the content server by contacting a certificate authority over the network to obtain certificate authentication information corresponding to the certificate information and the client device authenticating the content server by authenticating the certificate information with the certificate authentication information.

In an aspect of the method if the client device fails to authenticate the content server the client device terminates the secure connection. In another aspect of the method if the client device fails to authenticate the content server the client device contacts another certificate authority to authenticate the content server.

In an aspect of the method the client device is operable to operate in a limited functionality state and an expanded functionality state and before the client device authenticates the content server the client device operates in the limited functionality state. The limited functionality state may comprise executing only read operations and prohibiting write operations. The limited functionality state may further comprise prohibiting execution of scripts such as JavaScript. In an embodiment the limited functionality state may prohibit the sending of user or device information to the content server other than handshaking information.

In an aspect the client device may receive instructions from a host server through the network to set conditions of the limited functionality state and the expanded functionality state. The conditions may set the level of functionality of the client device or may set a trigger for when the state may change between levels. In an aspect the conditions comprise an identity of the content server.

In an embodiment a client computer processing device is provided the client device operative to authenticate a content server accessed over a network to obtain content over a secure connection the client device comprising a processing unit for executing instructions stored in a memory of the client device network connection means in communication with the processing unit for accessing the network a user interface for displaying content to a user of the client device and a user input interface for receiving content from the user. The client device is operative to contact the content server to initiate a handshaking operation over the network receive certificate information and handshaking information from the content server complete the handshaking operations to establish the secure connection with the content server and download the content from the content server through the secure connection before authenticating the content server.

In an aspect the client device is further operative to determine whether the content server has been authenticated and if the content server has been authenticated the processing unit executes executable content from the downloaded content. The executable content may comprise JavaScript instructions.

In an aspect the client device may be operative to display non executable content from the downloaded content on the user interface before authenticating the content server. The non executable content may comprise HTML code for rendering a web page.

In an aspect the client device may be operative to authenticate the content server while the client device completes the handshake and downloads the content. The device may to authenticate the content server be operative to contact a certificate authority over the network to obtain certificate authentication information corresponding to the certificate information and authenticate the server by authenticating the certificate information with the certificate authentication information.

In an aspect the client device may be operative to terminate the secure connection if the authentication fails.

In an aspect the client device may be operable to operate in a limited functionality state and an expanded functionality state and wherein the client device operates in the limited functionality state until the content server is authenticated. The client device may further be operable to receive instructions from a host server through the network the instructions executed by the processing unit to set conditions of the limited functionality state and the expanded functionality state. The conditions may comprise an identity of the content server.

In an embodiment the client device may comprise a client server that contacts the on line content server on behalf of a requesting device the requesting device submitting a request for content to the client server. In an aspect the client server may download content from the server before authenticating the content server. The client server may forward the downloaded content to the requesting device before the client server authenticates the content server. In an aspect the client server may be operable to forward an authentication notification to requesting device after the client server authenticates the on line content server.

The embodiments described herein may be implemented on a communication device such as that illustrated in . The communication device may communicate with other devices over a wireless communication system or enterprise system as illustrated in . The communication device may be a mobile device with two way communication and advanced data communication capabilities including the capability to communicate with other mobile devices or computer systems through a network of transceiver stations. The communication device can also have voice communication capabilities.

The communication subsystem receives messages from and sends messages to a wireless network . In this exemplary embodiment of the communication device the communication subsystem is configured in accordance with one or more of Global System for Mobile Communication GSM General Packet Radio Services GPRS standards Enhanced Data GSM Environment EDGE and Universal Mobile Telecommunications Service UMTS . New standards are still being defined but it is believed that they will have similarities to the network behavior described herein and it will also be understood by persons skilled in the art that the embodiments described herein are intended to use any other suitable standards that are developed in the future. The wireless link connecting the communication subsystem with the wireless network represents one or more different Radio Frequency RF channels operating according to defined protocols specified for GSM GPRS EDGE or UMTS and optionally other network communications. With newer network protocols these channels are capable of supporting both circuit switched voice communications and packet switched data communications.

Other wireless networks can also be associated with the communication device in variant implementations. The different types of wireless networks that can be employed include for example data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same physical base stations. Combined dual mode networks include but are not limited to Code Division Multiple Access CDMA or CDMA2000 networks GSM GPRS networks third generation 3G networks like EDGE HSPA HSPA EVDO and UMTS or fourth generation 4G networks such as LTE and LTE Advanced. Some other examples of data centric networks include WiFi 802.11 Mobitex and DataTAC network communication systems. Examples of other voice centric data networks include Personal Communication Systems PCS networks like GSM and Time Division Multiple Access TDMA systems. The mobile device may be provided with additional communication subsystems such as the wireless LAN WLAN communication subsystem also shown in . The WLAN communication subsystem may operate in accordance with a known network protocol such as one or more of the 802.11 family of standards developed by IEEE. The communication subsystem may be separate from or integrated with the communication subsystem or with the short range communications module . The main processor also interacts with additional subsystems such as a Random Access Memory RAM a flash memory a display an auxiliary input output I O subsystem a data port a keyboard a speaker a microphone the short range communications and other device subsystems . The communication device may also be provided with an accelerometer which may be used to detect gravity or motion induced forces and their direction. Detection of such forces applied to the device may be processed to determine a response of the device such as an orientation of a graphical user interface displayed on the display assembly in response to a determination of the current orientation of which the device .

Some of the subsystems of the communication device perform communication related functions whereas other subsystems can provide resident or on device functions. By way of example the display and the keyboard can be used for both communication related functions such as entering a text message for transmission over the network and device resident functions such as a calculator or task list.

A rendering circuit is included in the device . When a user specifies that a data file is to be viewed on the display the rendering circuit analyzes and processes the data file for visualization on the display . Rendering data files originally optimized or prepared for visualization on large screen displays on a portable electronic device display often requires additional processing prior to visualization on the small screen portable electronic device displays. This additional processing may be accomplished by the rendering engine . As will be appreciated by those of skill in the art the rendering engine can be implemented in hardware software or a combination thereof and can comprise a dedicated image processor and associated circuitry or can be implemented within main processor .

The communication device can send and receive communication signals over the wireless network after required network registration or activation procedures have been completed. Network access is associated with a subscriber or user of the communication device . To identify a subscriber the communication device requires a SIM RUIM card i.e. Subscriber Identity Module or a Removable User Identity Module or another suitable identity module to be inserted into a SIM RUIM interface in order to communicate with a network. The SIM RUIM card is one type of a conventional smart card that can be used to identify a subscriber of the communication device and to personalize the communication device among other things. Without the SIM RUIM card the communication device is not fully operational for communication with the wireless network . By inserting the SIM RUIM card into the SIM RUIM interface a subscriber can access all subscribed services. Services can include web browsing and messaging such as e mail voice mail Short Message Service SMS and Multimedia Messaging Services MMS . More advanced services can include point of sale field service and sales force automation. The SIM RUIM card includes a processor and memory for storing information. Once the SIM RUIM card is inserted into the SIM RUIM interface it is coupled to the main processor . In order to identify the subscriber the SIM RUIM card can include some user parameters such as an International Mobile Subscriber Identity IMSI . An advantage of using the SIM RUIM card is that a subscriber is not necessarily bound by any single physical mobile device. The SIM RUIM card can store additional subscriber information for a mobile device as well including datebook or calendar information and recent call information. Alternatively user identification information can also be programmed into the flash memory .

The communication device may be a battery powered device including a battery interface for receiving one or more rechargeable batteries . In at least some embodiments the battery can be a smart battery with an embedded microprocessor. The battery interface is coupled to a regulator not shown which assists the battery in providing power V to the communication device . Although current technology makes use of a battery future technologies such as micro fuel cells can provide the power to the communication device .

The communication device also includes an operating system and software components to which are described in more detail below. The operating system and the software components to that are executed by the main processor are typically stored in a persistent store such as the flash memory which can alternatively be a read only memory ROM or similar storage element not shown . Those skilled in the art will appreciate that portions of the operating system and the software components to such as specific device applications or parts thereof can be temporarily loaded into a volatile store such as the RAM . Other software components can also be included as is well known to those skilled in the art.

The subset of software applications that control basic device operations including data and voice communication applications will normally be installed on the communication device during its manufacture. Other software applications include a message application that can be any suitable software program that allows a user of the communication device to send and receive electronic messages. Various alternatives exist for the message application as is well known to those skilled in the art. Messages that have been sent or received by the user are typically stored in the flash memory of the communication device or some other suitable storage element in the communication device . In at least some embodiments some of the sent and received messages can be stored remotely from the device such as in a data store of an associated host system that the communication device communicates with.

The software applications can further include a device state module a Personal Information Manager PIM and other suitable modules not shown . The device state module provides persistence i.e. the device state module ensures that important device data is stored in persistent memory such as the flash memory so that the data is not lost when the communication device is turned off or loses power.

The PIM includes functionality for organizing and managing data items of interest to the user such as but not limited to e mail contacts calendar events voice mails appointments and task items. A PIM application has the ability to send and receive data items via the wireless network . PIM data items can be seamlessly integrated synchronized and updated via the wireless network with the mobile device subscriber s corresponding data items stored and or associated with a host computer system. This functionality creates a mirrored host computer on the communication device with respect to such items. This can be particularly advantageous when the host computer system is the mobile device subscriber s office computer system. Some or all of the data items stored at the communication device may be indexed for searching on the device either through a corresponding application such as the PIM or another suitable module. In addition the items may be searchable using a unified search process implemented in the device operating system . For example application data items can be encapsulated in a searchable entity class and registered with a unified search engine on the device that executes searches against all registered data repositories on the device based on received queries. The search engine can also be configured to invoke a search process of external resources such as Internet search engines or remote databases.

The communication device also includes a connect module and an information technology IT policy module . The connect module implements the communication protocols that are required for the communication device to communicate with the wireless infrastructure and any host system such as an enterprise system that the communication device is authorized to interface with. Examples of a wireless infrastructure and an enterprise system are given in which are described in more detail below.

The connect module includes a set of Application Programming Interfaces APIs that can be integrated with the communication device to allow the communication device to use any number of services associated with the enterprise system or with other systems accessible over the network . The connect module allows the communication device to establish an end to end secure authenticated communication pipe with the host system. A subset of applications for which access is provided by the connect module can be used to pass IT policy commands from the host system to the communication device . This can be done in a wireless or wired manner. These instructions can then be passed to the IT policy module to modify the configuration of the device . Alternatively in some cases the IT policy update can also be done over a wired connection.

Other types of software applications can also be installed on the communication device . These software applications can be third party applications which are added after the manufacture of the communication device . Examples of third party applications include games calculators utilities etc.

The additional applications can be loaded onto the communication device through at least one of the wireless network the auxiliary I O subsystem the data port the short range communications subsystem or any other suitable device subsystem . This flexibility in application installation increases the functionality of the communication device and can provide enhanced on device functions communication related functions or both. For example secure communication applications can enable electronic commerce functions and other such financial transactions to be performed using the communication device .

The data port enables a subscriber to set preferences through an external device or software application and extends the capabilities of the communication device by providing for information or software downloads to the communication device other than through a wireless communication network. The alternate download path can for example be used to load an encryption key onto the communication device through a direct and thus reliable and trusted connection to provide secure device communication. The data port can be any suitable port that enables data communication between the communication device and another computing device. The data port can be a serial or a parallel port. In some instances the data port can be a USB port that includes data lines for data transfer and a supply line that can provide a charging current to charge the battery of the communication device .

The short range communications subsystem provides for communication between the communication device and different systems or devices without the use of the wireless network . For example the subsystem can include an infrared device and associated circuits and components for short range communication. Examples of short range communication standards include standards developed by the Infrared Data Association IrDA Bluetooth and the 802.11 family of standards.

In use a received signal such as a text message an e mail message or web page download will be processed by the communication subsystem and input to the main processor . The main processor will then process the received signal for output to the display or alternatively to the auxiliary I O subsystem . A subscriber can also compose data items such as e mail messages for example using the keyboard in conjunction with the display and possibly the auxiliary I O subsystem . The auxiliary subsystem can include devices such as a touchscreen mouse track ball infrared fingerprint detector or a roller wheel with dynamic button pressing capability. The keyboard may be an alphanumeric keyboard and or telephone type keypad. However other types of keyboards can also be used. A composed item can be transmitted over the wireless network through the communication subsystem . It will be appreciated that if the display comprises a touchscreen then the auxiliary subsystem may still comprise one or more of the devices identified above.

For voice communications the overall operation of the communication device is substantially similar except that the received signals are output to the speaker and signals for transmission are generated by the microphone . Alternative voice or audio subsystems such as a voice message recording subsystem can also be implemented on the communication device . Although voice or audio signal output is accomplished primarily through the speaker the display can also be used to provide additional information such as the identity of a calling party duration of a voice call or other voice call related information.

Signals received by the antenna through the wireless network are input to the receiver which can perform such common receiver functions as signal amplification frequency down conversion filtering channel selection and analog to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding by the DSP . These DSP processed signals are input to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission over the wireless network via the antenna . The DSP not only processes communication signals but also provides for receiver and transmitter control. For example the gains applied to communication signals in the receiver and the transmitter can be adaptively controlled through automatic gain control algorithms implemented in the DSP .

The wireless link between the communication device and the wireless network can contain one or more different channels typically different RF channels and associated protocols used between the communication device and the wireless network . An RF channel is a limited resource that should be conserved typically due to limits in overall bandwidth and limited battery power of the communication device . When the communication device is fully operational the transmitter is typically keyed or turned on only when it is transmitting to the wireless network and is otherwise turned off to conserve resources. Similarly the receiver is periodically turned off to conserve power until it is needed to receive signals or information if at all during designated time periods. Other communication subsystems such as the WLAN communication subsystem shown in may be provided with similar components as those described above configured for communication over the appropriate frequencies and using the appropriate protocols.

In a GSM network the MSC is coupled to the BSC and to a landline network such as a Public Switched Telephone Network PSTN to satisfy circuit switched requirements. The connection through the PCU the SGSN and the GGSN to a public or private network Internet also referred to herein generally as a shared network infrastructure represents the data path for GPRS capable mobile devices. In a GSM network extended with GPRS capabilities the BSC also contains the Packet Control Unit PCU that connects to the SGSN to control segmentation radio channel allocation and to satisfy packet switched requirements. To track the location of the communication device and availability for both circuit switched and packet switched management the HLR is shared between the MSC and the SGSN . Access to the VLR is controlled by the MSC .

The station is a fixed transceiver station and together with the BSC form fixed transceiver equipment. The fixed transceiver equipment provides wireless network coverage for a particular coverage area commonly referred to as a cell . The fixed transceiver equipment transmits communication signals to and receives communication signals from mobile devices within its cell via the station . The fixed transceiver equipment normally performs such functions as modulation and possibly encoding and or encryption of signals to be transmitted to the communication device in accordance with particular usually predetermined communication protocols and parameters under control of its controller. The fixed transceiver equipment similarly demodulates and possibly decodes and decrypts if necessary any communication signals received from the communication device within its cell. Communication protocols and parameters can vary between different nodes. For example one node can employ a different modulation scheme and operate at different frequencies than other nodes.

For all communication devices registered with a specific network permanent configuration data such as a user profile is stored in the HLR . The HLR also contains location information for each registered mobile device and can be queried to determine the current location of a mobile device. The MSC is responsible for a group of location areas and stores the data of the mobile devices currently in its area of responsibility in the VLR . Further the VLR also contains information on mobile devices that are visiting other networks. The information in the VLR includes part of the permanent mobile device data transmitted from the HLR to the VLR for faster access. By moving additional information from a remote HLR node to the VLR the amount of traffic between these nodes can be reduced so that voice and data services can be provided with faster response times and at the same time requiring less use of computing resources.

The SGSN and the GGSN are elements added for GPRS support namely packet switched data support within GSM. The SGSN and the MSC have similar responsibilities within the wireless network by keeping track of the location of each communication device . The SGSN also performs security functions and access control for data traffic on the wireless network . The GGSN provides internetworking connections with external packet switched networks and connects to one or more SGSNs via an Internet Protocol IP backbone network operated within the network . During normal operations a given communication device must perform a GPRS Attach to acquire an IP address and to access data services. This requirement is not present in circuit switched voice channels as Integrated Services Digital Network ISDN addresses are used for routing incoming and outgoing calls. Currently all GPRS capable networks use private dynamically assigned IP addresses thus requiring the DHCP server connected to the GGSN . There are many mechanisms for dynamic IP assignment including using a combination of a Remote Authentication Dial In User Service RADIUS server and a DHCP server. Once the GPRS Attach is complete a logical connection is established from a communication device through the PCU and the SGSN to an Access Point Node APN within the GGSN . The APN represents a logical end of an IP tunnel that can either access direct Internet compatible services or private network connections. The APN also represents a security mechanism for the network insofar as each communication device must be assigned to one or more APNs and communication devices cannot exchange data without first performing a GPRS Attach to an APN that it has been authorized to use. The APN can be considered to be similar to an Internet domain name such as myconnection.wireless.com .

Once the GPRS Attach operation is complete a tunnel is created and all traffic is exchanged within standard IP packets using any protocol that can be supported in IP packets. This includes tunneling methods such as IP over IP as in the case with some IPSecurity Ipsec connections used with Virtual Private Networks VPN . These tunnels are also referred to as Packet Data Protocol PDP Contexts and there are a limited number of these available in the network . To maximize use of the PDP Contexts the network will run an idle timer for each PDP Context to determine if there is a lack of activity. When a communication device is not using its PDP Context the PDP Context can be de allocated and the IP address returned to the IP address pool managed by the DHCP server .

The host system comprises a number of network components connected to each other by a network . For instance a user s desktop computer with an accompanying cradle for the user s communication device is situated on a LAN connection. The cradle for the communication device can be coupled to the computer by a serial or a Universal Serial Bus USB connection for example. Other user computers are also situated on the network and each can be equipped with an accompanying cradle . The cradle facilitates the loading of information e.g. PIM data private symmetric encryption keys to facilitate secure communications from the user computer to the communication device and can be particularly useful for bulk information updates often performed in initializing the communication device for use. The information downloaded to the communication device can include certificates used in the exchange of messages.

It will be understood by persons skilled in the art that the user computers are typically also connected to other peripheral devices such as printers etc. which are not explicitly shown in . Furthermore only a subset of network components of the host system are shown in for ease of exposition and it will be understood by persons skilled in the art that the host system will comprise additional components that are not explicitly shown in for this exemplary configuration. More generally the host system can represent a smaller part of a larger network not shown of the organization and can comprise different components and or be arranged in different topologies than that shown in the exemplary embodiment of .

To facilitate the operation of the communication device and the wireless communication of messages and message related data between the communication device and components of the host system a number of wireless communication support components can be provided. In some implementations the wireless communication support components can include a message management server a mobile data server a web server such as Hypertext Transfer Protocol HTTP server a contact server and a device manager module . HTTP servers can also be located outside the enterprise system as indicated by the HTTP server attached to the network . The device manager module includes an IT Policy editor and an IT user property editor as well as other software components for allowing an IT administrator to configure the communication devices . In an alternative embodiment there can be one editor that provides the functionality of both the IT policy editor and the IT user property editor . The support components also include a data store and an IT policy server . The IT policy server includes a processor a network interface and a memory unit . The processor controls the operation of the IT policy server and executes functions related to the standardized IT policy as described below. The network interface allows the IT policy server to communicate with the various components of the host system and the communication devices . The memory unit can store functions used in implementing the IT policy as well as related data. Those skilled in the art know how to implement these various components. Other components can also be included as is well known to those skilled in the art. Further in some implementations the data store can be part of any one of the servers.

In this exemplary embodiment the communication device communicates with the host system through node of the wireless network and a shared network infrastructure such as a service provider network or the public Internet. Access to the host system can be provided through one or more routers not shown and computing devices of the host system can operate from behind a firewall or proxy server . The proxy server provides a secure node and a wireless internet gateway for the host system . The proxy server intelligently routes data to the correct destination server within the host system .

In some implementations the host system can include a wireless VPN router not shown to facilitate data exchange between the host system and the communication device . The wireless VPN router allows a VPN connection to be established directly through a specific wireless network to the communication device . The wireless VPN router can be used with the Internet Protocol IP Version 6 IPV6 and IP based wireless networks. This protocol can provide enough IP addresses so that each mobile device has a dedicated IP address making it possible to push information to a mobile device at any time. An advantage of using a wireless VPN router is that it can be an off the shelf VPN component and does not require a separate wireless gateway and separate wireless infrastructure. A VPN connection may be a Transmission Control Protocol TCP IP or User Datagram Protocol UDP IP connection for delivering the messages directly to the communication device in this alternative implementation.

Messages intended for a user of the communication device are initially received by a message server of the host system . Such messages can originate from any number of sources. For instance a message can have been sent by a sender from the computer within the host system from a different mobile device not shown connected to the wireless network or a different wireless network or from a different computing device or other device capable of sending messages via the shared network infrastructure possibly through an application service provider ASP or Internet service provider ISP for example.

The message server typically acts as the primary interface for the exchange of messages particularly e mail messages within the organization and over the shared network infrastructure . Each user in the organization that has been set up to send and receive messages is typically associated with a user account managed by the message server . Some exemplary implementations of the message server include a Microsoft Exchange server a Lotus Domino server a Novell Groupwise server or another suitable mail server installed in a corporate environment. In some implementations the host system can comprise multiple message servers . The message server can also be adapted to provide additional functions beyond message management including the management of data associated with calendars and task lists for example.

When messages are received by the message server they are typically stored in a data store associated with the message server . In at least some embodiments the data store can be a separate hardware unit such as data store with which the message server communicates. Messages can be subsequently retrieved and delivered to users by accessing the message server . For instance an e mail client application operating on a user s computer can request the e mail messages associated with that user s account stored on the data store associated with the message server . These messages are then retrieved from the data store and stored locally on the computer . The data store associated with the message server can store copies of each message that is locally stored on the communication device . Alternatively the data store associated with the message server can store all of the messages for the user of the communication device and only a smaller number of messages can be stored on the communication device to conserve memory. For instance the most recent messages i.e. those received in the past two to three months for example can be stored on the communication device .

When operating the communication device the user may wish to have e mail messages retrieved for delivery to the communication device . The message application operating on the communication device can also request messages associated with the user s account from the message server . The message application can be configured either by the user or by an administrator possibly in accordance with an organization s IT policy to make this request at the direction of the user at some pre defined time interval or upon the occurrence of some pre defined event. In some implementations the communication device is assigned its own e mail address and messages addressed specifically to the communication device are automatically redirected to the communication device as they are received by the message server .

The message management server can be used to specifically provide support for the management of messages such as e mail messages that are to be handled by mobile devices. Generally while messages are still stored on the message server the message management server can be used to control when if and how messages are sent to the communication device . The message management server also facilitates the handling of messages composed on the communication device which are sent to the message server for subsequent delivery.

For example the message management server can monitor the user s mailbox e.g. the message store associated with the user s account on the message server for new e mail messages and apply user definable filters to new messages to determine if and how the messages are relayed to the user s communication device . The message management server can also through an encoder not shown associated therewith compress message data using any suitable compression decompression technology e.g. YK compression JPEG MPEG x H.26x and other known techniques and encrypt messages e.g. using an encryption technique such as Data Encryption Standard DES Triple DES or Advanced Encryption Standard AES and push them to the communication device via the shared network infrastructure and the wireless network . The message management server can also receive messages composed on the communication device e.g. encrypted using Triple DES decrypt and decompress the composed messages re format the composed messages if desired so that they will appear to have originated from the user s computer and re route the composed messages to the message server for delivery.

Certain properties or restrictions associated with messages that are to be sent from and or received by the communication device can be defined e.g. by an administrator in accordance with IT policy and enforced by the message management server . These may include whether the communication device can receive encrypted and or signed messages minimum encryption key sizes whether outgoing messages must be encrypted and or signed and whether copies of all secure messages sent from the communication device are to be sent to a pre defined copy address for example.

The message management server can also be adapted to provide other control functions such as only pushing certain message information or pre defined portions e.g. blocks of a message stored on the message server to the communication device . For example in some cases when a message is initially retrieved by the communication device from the message server the message management server can push only the first part of a message to the communication device with the part being of a pre defined size e.g. 2 KB . The user can then request that more of the message be delivered in similar sized blocks by the message management server to the communication device possibly up to a maximum pre defined message size. Accordingly the message management server facilitates better control over the type of data and the amount of data that is communicated to the communication device and can help to minimize potential waste of bandwidth or other resources.

The mobile data server encompasses any other server that stores information that is relevant to the corporation. The mobile data server can include but is not limited to databases online data document repositories customer relationship management CRM systems or enterprise resource planning ERP applications. The mobile data server can also connect to the Internet or other public network through HTTP server or other suitable web server such as an File Transfer Protocol FTP server to retrieve HTTP webpages and other data. Requests for webpages are typically routed through mobile data server and then to HTTP server through suitable firewalls and other protective mechanisms. The web server then retrieves the webpage over the Internet and returns it to mobile data server . As described above in relation to message management server mobile data server is typically provided or associated with an encoder that permits retrieved data such as retrieved webpages to be decompressed and compressed using any suitable compression technology e.g. YK compression JPEG MPEG x H.26x and other known techniques and encrypted e.g. using an encryption technique such as DES Triple DES or AES and then pushed to the communication device via the shared network infrastructure and the wireless network . While encoder is only shown for mobile data server it will be appreciated that each of message server message management server and HTTP servers and can also have an encoder associated therewith.

The contact server can provide information for a list of contacts for the user in a similar fashion as the address book on the communication device . Accordingly for a given contact the contact server can include the name phone number work address and e mail address of the contact among other information. The contact server can also provide a global address list that contains the contact information for all of the contacts associated with the host system .

It will be understood by persons skilled in the art that the message management server the mobile data server the HTTP server the contact server the device manager module the data store and the IT policy server do not need to be implemented on separate physical servers within the host system . For example some or all of the functions associated with the message management server can be integrated with the message server or some other server in the host system . Alternatively the host system can comprise multiple message management servers particularly in variant implementations where a large number of mobile devices need to be supported.

The device manager module provides an IT administrator with a graphical user interface with which the IT administrator interacts to configure various settings for the communication devices . As mentioned the IT administrator can use IT policy rules to define behaviors of certain applications on the communication device that are permitted such as phone web browser or Instant Messenger use. The IT policy rules can also be used to set specific values for configuration settings that an organization requires on the communication devices such as auto signature text WLAN VoIP VPN configuration security requirements e.g. encryption algorithms password rules etc. specifying themes or applications that are allowed to run on the communication device and the like.

Referring to an embodiment is illustrated where mobile device is accessing a wireless network for instance through node . In the embodiment illustrated mobile device includes a mobile data store which may comprise a secure data store.

The wireless network is connected to a public or private network which provides connectivity to host system . As illustrated in this embodiment host system may comprise a host data store .

Also available on the network is an on line content server and a certificate authority . As illustrated in this embodiment the on line content server may comprise a content data store and the certificate authority may comprise an authority data store .

Depending upon the embodiment the host system on line content server and certificate authority may comprise different systems or the same system providing different functionality. A corporate application for instance may include a host system for data storage and control of the mobile device as described above. A personal application may include a host system that is transparent to the user or may exclude a host system entirely.

The certificate authority may comprise the host system or may comprise a third party Certificate Authority. The host system may maintain local copies of certificates and certificate authentication in host data store which may be periodically updated from certificate authority .

In an embodiment mobile device may attempt to access content available from the on line content server . In the embodiment the device seeks to establish a secure connection for instance a unilateral TLS connection with the on line content server . Instead of carrying out the standard mechanism however the mobile device may carry out a modified process to reduce the likelihood of a timeout while authenticating the on line content server .

Referring to the mobile device may for instance carry out the following steps as a client device contacting the on line content server . In step device acting as a client device contacts the on line content server to initiate the handshaking operations to establish a connection with the on line content server . An example of a suitable handshaking procedure would be the TLS handshake a widely used protocol for securing traffic carried by HTTP to form HTTPS. In an embodiment device may contact the on line content server by sending instructions through host system as a pass through server.

In step the device receives certificate information and handshaking information from the on line content server . The certificate information typically comprises a certificate or certificate chain that contains information about the on line content server that may be used by the device to authenticate the on line content server as known in the art. Typically authentication consists of verifying the certificate information with certificate authentication information. In some instances certificate authentication information may be obtained from a third party Certificate Authority such as certificate authority or host system illustrated in or some other external source. Authentication may alternatively consist of obtaining certificate authentication information from the certificate information such as an expiration date time and the device may perform authentication checks based upon the certificate information and information resident on the device .

In step the device completes the handshake with the on line content server to establish a connection. In step the device authenticates the certificate using certificate authentication information. Thus the device proceeds to establish the connection including exchanging necessary encryption keys before the device has authenticated the server but may not treat the connection as a secure connection until the server has been authenticated.

In step the device determines whether the on line content server has been authenticated in step . If the server has been authenticated then in step the device establishes a secure connection and may download content from the on line content server and proceed to execute the downloaded content and display if applicable. If the server has not been authenticated then in step the device may terminate the session with the server . In an embodiment the session may be terminated immediately upon failure to authenticate the server certificate.

In an alternate embodiment instead of terminating the session device may attempt to re authenticate the server by re initiating the handshake requesting an updated certificate or accessing a different certificate repository to authenticate the certificate. In a further embodiment an authentication status would be maintained to determine whether the server has been authenticated to maintain the device in a state of limited operability while the server has not been authenticated. In the further embodiment the device may maintain a checklist of authentication attempts re authentication contact a different certificate authority request updated certificate. While the device is attempting authentication by following the checklist of attempts the device is preferably in the state of limited operability. The device may either transition to a state of full operability upon successfully authenticating the server with one or more of the attempts from the checklist of attempts or if none of the attempts on the checklist of attempts are successful the server is not authenticated and the session may be terminated.

By way of example the device could start by requesting authentication of the certificate by contacting host system which may act as a local certificate authority for recently authenticated certificates. If host system supplied the initial certificate authentication information and authentication failed or was otherwise unable to provide certificate authentication information then device could request authentication from a third party Certificate Authority such as certificate authority illustrated in .

Referring to and depending upon the level of security required the process may be accelerated by allowing the device to carry out further steps in obtaining information from the on line content server before the certificate has been authenticated in step . Preferably the device is set to operate in a limited functionality mode until the certificate and associated on line content server has been authenticated to establish a secure connection.

Referring to after the device completes the handshake to establish a connection in step the device may proceed to download content from the on line content server in step . In step the device determines whether the on line content server has been authenticated in step . If the server has been authenticated then in step the device establishes a secure connection and may execute the downloaded content and display if applicable. If the server has not been authenticated then in step the device may terminate the session with the server and discard the downloaded content without execution.

In an alternate embodiment illustrated in device may take the additional step of displaying non executable content on a user interface of the device while the device is still authenticating the certificate in step . In this embodiment while device may render a web page based upon the downloaded content for instance executable content including scripts flash or other executable instructions are not executed.

While and illustrate the handshake completion and certificate authentication steps in parallel it is understood that they could be occurring sequentially though steps and would be carried out without waiting for conclusion of authentication step .

Referring to the device may perform steps and in sequence as indicated. In such a fashion the handshaking procedure is completed by the device before it has actually authenticated the on line content server . Similar to the embodiments illustrated in and the device may also carry out steps and in sequence before authenticating the certificate in step .

In all four cases device proceeds with safe steps such as opening a connection downloading content or displaying non executable content. In an embodiment device may further remain operative to receive input from the user. This may take place for instance through a user input field within a web page rendered by the device based upon content downloaded from the server in step .

In a typical application a device would access an on line content server authenticate the server and download content comprising a log in portal web page through which a user may authenticate themselves with the on line content server by inputting user identifying information into log in fields of the portal web page. In the embodiment described above the device may render the log in portal web page and collect user identifying information from a user while the device is still authenticating the on line content server . The device does not however execute instructions downloaded from the content server such as scripts and further does not send information collected from the user to the server until the server has been authenticated to establish a secure connection. Therefore step may further comprise sending user information to the server .

Generically and may be summarised in that the device accepts the server as being authenticated and the device proceeding as being operative to perform read operations e.g. HTTP GET on content downloaded form the server but the device being inoperative to write content e.g. HTTP POST to the server or execute instructions e.g. JavaScript downloaded from the server . Thus while the device establishes a connection and proceeds with obtaining content though the server has not yet been authenticated the device operates in a limited operability state that protects the user by restricting operations such as posting information other than handshaking information or executing JavaScript that could potentially harm the user if the server or the connection between the server and the device has been comprised.

Step where device authenticates the certificate with certificate authentication information may comprise different operations. In general these operations may require requesting and receiving certificate authentication information from a third party or may require the device assessing certificate authentication information received with the certificate or certificate chain to authenticate verify the certificate in order to authenticate the on line server . Both types of operations may take a sufficient amount of time that the handshaking procedure may time out before the authentication step is completed.

While the device is contacting the server completing the handshake in step downloading content in step or displaying non executable content in step the device may also in step contact a certificate authority to request authentication of the certificate received in step . In step the device receives certificate authentication information from the certificate authority . In either case device proceeds by completing the handshake step and downloading content step without waiting for server authentication to be completed.

Referring to examples of the types of operations that may occur in step are given. In operation the device may request and receive certificate authentication information from a certificate authority . In some circumstances the device may contact host system first and if the certificate authentication information is not available at host system either host system or the device may contact the certificate authority to obtain the certificate authentication information. In the case of host system contacting the certificate authority then host system may respond to device with the certificate authentication information received from the certificate authority .

In operation the device may check the certificate revocation status by checking a valid Certificate Revocation List CRL . The CRL may be resident on the device after being forwarded by the host system or a certificate authority .

In operation the device may request a valid CRL from a third party such as host system or certificate authority . The device may then receive the valid CRL and verify the certificate against the CRL.

In operation the device may perform certificate checks against the certificate or certificate chain received through the handshaking with on line content server . These checks may include validity checks confirming the certificate has not expired cryptography strength checks level of trust checks etc. . . .

In operation the device may perform the checks against the certificate chain to confirm that while the current certificate may be valid and secure a preceding certificate in the chain may have compromised the information. In embodiments where device receives the certificate as part of a certificate chain in step the device may check the received certificate chain. In embodiments where device receives only the certificate in step in operation device may request the certificate chain from the on line content server in order to carry out the checks.

In operation the device may transmit an Online Certificate Status Protocol OCSP request to host system or a certificate authority . In some circumstances the device may contact host system first and if an OCSP response is not available at host system either host system or the device may contact the certificate authority to obtain the OCSP response. In the case of host system contacting the certificate authority then host system may respond to device with OCSP response received from the certificate authority .

In all of the embodiments of possible operations that may be taken as part of step the device requires processing time to evaluate and check the status of a certificate in addition to any time required to contact and receive information from a third party.

Once the server has been authenticated by the device the device may treat the connection as secure and transition into an expanded or enhanced operability state that permits operations that are intended for the authenticated server including posting user or device information to the server or executing instructions received from the server such as JavaScript instructions.

In an embodiment the authentication status of the on line content server may be communicated to a user of the device through a visual indication on a user interface of the device . In one aspect the visual indication may comprise a highlighting of the address field or a portion of the address field for instance the https portion of the address field to alert the user that while a connection has been established and content may be downloaded or displayed the server has not been authenticated. In another aspect the visual indication may comprise an icon such as an unlocked padlock icon in place of the standard locked padlock icon present when a secure connection such as https has been established.

Referring to in an embodiment the device may operate as part of a system in conjunction with a client server which may include a client server data store . Client server may comprise host system or may comprise a different computing system. In the embodiment of the client server may act as a client with the content server on behalf of the device which is requesting data.

Referring to device may forward a request for on line content from on line content server to client server . Client server receives the request for on line content from the device in step . Client server may contact on line content server to initiate handshaking in step . Client server receives certificate information and handshaking information from on line content server in step . Client server then completes the handshake with the on line content server to establish a connection in step . Client server authenticates the certificate with certificate authentication information in step .

In step client server determines if the on line content server has been authenticated. If the on line content server is not authenticated client server terminates the session with the server . As indicated above for step client server may alternatively take additional methods to authenticate the server before terminating the session.

If the on line content server is authenticated client server treats the connection as a secure connection and may proceed to download content from the on line content server for forwarding to the device in step .

In an embodiment the device may enter a state of limited operability after forwarding the request for on line content to the client server . Alternatively the client server may send the device an instruction to enter the state of limited operability after receiving in step a request from the device for on line content from on line content server . In an aspect the client server may contact the on line content server after receiving the request for content from the device and determine that the on line content server is providing secure content that requires authentication. After making the determination the client server may send the device the instruction to enter the state of limited operability while initiating handshaking operations with the on line content server .

In an embodiment the client server may provide instructions to the device to set the level of functionality after handshaking has been completed but before the server has been authenticated. For instance the client server may send an instruction that limits the operability of the device to disable web page rendering prior to authentication of the server . Other operations may similarly be limited including executing JavaScript receiving user input through a user interface etc. . . .

In an aspect this embodiment may be dependent upon a particular on line content server accessed. Thus the level of functionality may be triggered by a server address being contacted. For instance in a corporate environment trusted web addresses may be accessed with greater functionality than unknown third party web addresses. While the functionality may be greater the device may preferably still be prohibited from executing scripts or posting information to defend against malicious third parties such as through a man in the middle attack.

In an embodiment similar to steps and the client server may download content from the on line content server before the client server has authenticated the certificate in step . In an embodiment the client server may forward the downloaded content to the device before the client server has authenticated the certificate in step . In an embodiment the device may receive content from the client server and display non executable content only before the client server has authenticated the on line content server . In this embodiment the client server may forward an authentication notification to the device that the on line content server has been authenticated. This notification may comprise an instruction to the device to enter a higher functionality state.

In an embodiment the device may be operative to receive instructions from a host server such as client server a server within host system or some other server which may in embodiments be located behind a firewall on the network. The instructions sent by the host server may set conditions of the limited functionality state and the expanded functionality state. The conditions may set the level of functionality of the device or may set a trigger for when the state may change between levels. In an aspect the conditions comprise an identity of the content server .

Referring to an embodiment is illustrated where client server carries out steps and in sequence. That is the client server completes the handshaking operation in step before authenticating the certificate in step . The embodiment of also illustrates the client server sending a notification to the device that the content server has been authenticated in step after the authentication decision step has been completed in the affirmative. The embodiment does not illustrate content downloading and display steps in the sequence. As discussed above these steps may take place before the content server has been authenticated such that the notification step comprises an indication to the device to execute the downloaded content.

In an embodiment the authentication status of the on line content server may be communicated to a user of the device through a visual indication on a user interface of the device until the device receives an authentication notification from the client server . The authentication status may be communicated to the user throughout the period that the device is operating in a state of limited functionality.

The systems and methods disclosed herein are presented only by way of example and are not meant to limit the scope of the subject matter described herein. Other variations of the systems and methods described above will be apparent to those in the art and as such are considered to be within the scope of the subject matter described herein. For example it should be understood that steps and the order of the steps in the processing described herein may be altered modified and or augmented and still achieve the desired outcome. It will also be appreciated that although the embodiments herein have been directed generally to calendar events similar systems and methods may be carried out in respect of other types of time or schedule based user data.

The systems and methods data may be stored in one or more data stores. The data stores can be of many different types of storage devices and programming constructs such as RAM ROM flash memory programming data structures programming variables etc. It is noted that data structures describe formats for use in organizing and storing data in databases programs memory or other computer readable media for use by a computer program.

Code adapted to provide the systems and methods described above may be provided on many different types of computer readable media including computer storage mechanisms e.g. CD ROM diskette RAM flash memory computer s hard drive etc. that contain instructions for use in execution by a processor to perform the methods operations and implement the systems described herein.

The computer components software modules functions and data structures described herein may be connected directly or indirectly to each other in order to allow the flow of data needed for their operations. It is also noted that a module or processor includes but is not limited to a unit of code that performs a software operation and can be implemented for example as a subroutine unit of code or as a software function unit of code or as an object as in an object oriented paradigm or as an applet or in a computer script language or as another type of computer code.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by any one of the patent document or patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyrights whatsoever.

