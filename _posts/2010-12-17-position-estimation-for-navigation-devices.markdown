---

title: Position estimation for navigation devices
abstract: A method of providing position estimation with a navigation device comprises periodically recording magnetic field strength of an area substantially surrounding a navigation device as a user of the navigation device traverses a select pathway. The method combines the recorded magnetic field strength with measurements from at least a dead reckoning portion of the navigation device to provide position estimates along the select pathway. The method further corrects each of the position estimates from a starting position on the select pathway, where each of the corrected position estimates have an error value below one or more previous position estimates and any intervening positions between each of the one or more previous position estimates and the starting position, with the error value corresponding to an error threshold based on the previous position estimates.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08207869&OS=08207869&RS=08207869
owner: Honeywell International Inc.
number: 08207869
owner_city: Morristown
owner_country: US
publication_date: 20101217
---
This application is a divisional of pending U.S. application Ser. No. 12 059 865 entitled POSITION ESTIMATION FOR NAVIGATION DEVICES filed Mar. 31 2008 which is incorporated herein by reference.

The U.S. Government may have certain rights in the present invention under contract No. HDTRA 06 6 C 0058 subcontract No. CHI 06022 001 as awarded by the Defense Threat Reduction Agency.

Reliable navigation systems and devices have always been essential for estimating both distance traveled and position. For example early navigating was accomplished with deduced or dead reckoning. In dead reckoning a navigator finds a current position by measuring the course and distance the navigator has moved from some known point. Starting from the known point the navigator measures out a course and distance from that point. Each ending position will be the starting point for the course and distance measurement. In order for this method to work the navigator needs a way to measure a course and a way to measure the distance traveled. The course is measured by a magnetic compass. In pedestrian dead reckoning the distance is the size of a single step. A position estimate is derived by the integration of distance and direction over a sequence of steps. This type of navigation however is highly prone to errors which when compounded can lead to highly inaccurate position and distance estimates.

In more advanced navigation systems such as an inertial navigation system INS positional errors can accumulate over time. For example any navigation performed in areas where satellite or radar tracking measurements are inaccessible or restrictive such as areas where global positioning system or GPS measurements are denied is susceptible to the accumulation of similar positional errors. Moreover in the dead reckoning methods discussed above these positional errors accumulate based on the distance traveled. There is a need in the art for improvements in position estimation for navigation devices.

The following specification provides for at least one method of position estimation for navigation devices using sensor data correlation. This summary is made by way of example and not by way of limitation. It is merely provided to aid the reader in understanding some aspects of at least one embodiment described in the following specification.

Particularly in one embodiment a method of providing position estimation with a navigation device comprises periodically recording magnetic field strength of an area substantially surrounding a navigation device as a user of the navigation device traverses a select pathway. The method combines the recorded magnetic field strength with measurements from at least a dead reckoning portion of the navigation device to provide position estimates along the select pathway. The method further corrects each of the position estimates from a starting position on the select pathway where each of the corrected position estimates have an error value below one or more previous position estimates and any intervening positions between each of the one or more previous position estimates and the starting position with the error value corresponding to an error threshold based on the previous position estimates.

Embodiments disclosed herein relate to position estimation for navigation devices using sensor data correlation. For example at least one navigation device discussed herein substantially reduces positioning errors when the device recognizes that a user of the device is at a previous position. In one implementation the navigation device discussed herein informs the user that a track crossing event has occurred based on the correlation of accumulated sensor data. Moreover this event occurrence can be determined manually by the user or automatically detected by the sensors within the navigation device. For example each track crossing event is detected at recognizable corners intersections or bottlenecks found inside a building or along a constrained that is a select pathway. In one embodiment a laser range finder or at least one sonar sounding sensor is coupled to the navigation device to record a characteristic fingerprint of each track crossing the user encounters while traversing a select pathway. The device is configurable to automatically and continuously mark likely track crossing points along the select pathway for example the device collects tracking data and provides an indication when a current record matches a previously encountered region . As discussed in further detail below the device is configurable to adjust and correct positional errors for each of the track crossings detected.

In at least one embodiment a dead reckoning DR navigation device comprises one or more inertial sensors and one or more magnetic sensors operable to obtain estimates of displacement from a starting point. The track correlation and position recognition discussed herein substantially reduces the accumulated positional errors. For example as the user travels indoors down halls or corridors or outdoors along trails and streets positional corrections can be applied to current and previous position measurements and continuously back propagated over a history of position estimates between the first and second times the user reaches the same spot. In one implementation track positions are stored in discrete steps and the device assigns a correction to each track position by dividing the total error by the number of steps in the interval.

The position estimation methods disclosed herein will not require any additional sensors or communications infrastructure along the select pathways discussed below. For example existing DR sensors can be used from the DR navigation device. In one embodiment the DR navigation device uses magnetic sensors for compassing and accelerometers for step counting. Moreover a processing unit on the DR navigation device is configured to perform the automatic track crossing recognition and processing based on magnetic field strength measurements of an area substantially surrounding the DR navigation device.

The sensor module comprises one or more accelerometers and one or more magnetometers . In one implementation the sensor module further comprises one or more gyroscopes and a barometric altimeter . It is understood that the sensor module is capable of accommodating any appropriate number and types of navigational sensors and sensor blocks operable to receive sensor input data for example one or more of the accelerometers the magnetometers the gyroscopes the barometric altimeter and the like in a single sensor module . In the example embodiment of the processing unit comprises at least one of a microprocessor a microcontroller a field programmable gate array FPGA a field programmable object array FPOA a programmable logic device PLD or an application specific integrated circuit ASIC . In one implementation the processing unit further comprises a memory block . The memory block records at least each of the recognized track crossings measured by the sensor module .

In operation the sensor module provides position estimates based on magnetic field strength and heading data for example azimuth data . In one embodiment the azimuth data is provided by the dead reckoning portion of the sensor module . The processing unit records the position estimates along with the magnetic field measured by the sensor module of an area substantially surrounding a user of the navigation device . The processing unit measures a track crossing based on a comparison of the magnetic field strength at a current position and one or more previous position estimates. As discussed in further detail below with respect to for each measured track crossing the processing unit aligns the current position with the one or more previous position estimates and adjusts an accumulation of measurement error below an error threshold based on the one or more previous position estimates. In the example embodiment of the processing unit corrects any intervening positions and error estimates between the current position and the one or more previous position estimates as discussed in further detail below.

In one embodiment the navigation device comprises at least three magnetometers to provide the heading data within the surrounding magnetic field in at least three orientations. Further the navigation device comprises at least three accelerometers for step counting and the estimation of vertical in three axes for movements in at least three dimensions. The position estimation performed by the navigation device provides at least one method of correction for position estimates based on at least an error threshold. For example the sensor module is operable to continually measure the azimuth data from the at least three magnetometers on a sensor channel. Moreover the sensor module is further operable to provide the position estimates to the processing unit . In the example embodiment of the position estimates are iteratively adjusted based on the error threshold as discussed in further detail below with respect to . In one implementation the processing unit automatically recognizes the measured track crossings by correlating the magnetic field strength and the heading data between the current position and the one or more previous position estimates. In this same implementation the processing unit qualifies the current position based on correlation threshold criteria for the sensor module discussed in further detail below with respect to .

In one implementation a measure of the accumulated error between positions and along the select pathway comprises two distances the first is the straight line distance DS between the two positions and the second is the length of the path traveled DT between the two positions and . A positional error measure E is provided below in Equation 1 further expressed as a percent in Equation 2 below. Equation 1 100 Equation 2 

In the example embodiment of the positional error is 25 m 75 m or 0.33 from Equation 1 or 33 Equation 2 . The select pathway depicted in illustrates the user traversing around a square path back to the starting position . As shown in positional errors accumulate in a position estimate provided by the navigation device resulting in the navigation device directing the user along a path to the position instead of . For example if position and position l are three meters apart then the measure of error is 3 m 100 m or 0.03 3 . For each position marking event all marks that lie outside a error threshold range are disregarded and marks at or below the error threshold are ranked according to the error measure in Equation 1.

As discussed in further detail below any accumulated positional errors from the last time the user was at that same position are substantially eliminated using the position estimation methods provided by the navigation device . For example when a position estimate drifts off by 3 meters as illustrated above the navigation device readjusts a current position back to the previous tracked position by subtracting off the 3 meter drift from a current position. As a result the position error estimate is reduced to that which was originally associated with that position. Moreover this correction is not only applicable to the current position but also back propagated continuously over a history of position estimates between the first and second times the same position was reached. In the example embodiments of track positions are stored by discrete steps in the navigation device . Accordingly a correction is assigned to each step by dividing the total error by the number of steps in the interval.

With respect to Equation 3 DS is the error in the east direction and DSis the error in the north direction and N is the number of data points. In one implementation a sample point measurement is taken by the navigation device at each step. In the example embodiment of there are 415 steps taken from start to finish. Moreover using sample error components of 2.4 meters east as DS and 5.3 meters north as DS a linear correction of 2.4 415 meters in the east direction and 5.3 415 meters in the north direction is applied to each step using Equation 3. The result is shown in . The positions and are aligned to provide details of the select pathway . It is understood that in alternate implementations additional methods of error correction based on time for example quadratic error growth estimation or similar variables can be used to provide the position estimation discussed herein. Moreover additional correlations are possible from the magnetic field strength recordings as discussed in further detail below with respect to .

In operation the track correlation process occurs in three interval phases 1 mark 2 link and 3 adjust. In the marking phase a region of interest is selected as the user passes it. In one implementation selecting the region of interest is done at discrete times manually by the user. In at least one alternate implementation selecting the region is accomplished continuously and automatically by the navigation device . When the region of interest is selected the selected position is compared pairwise with any prior position markings. When a match is found the two positions are automatically linked and the positions adjusted as discussed below with respect to . For example in one implementation the navigation device determines which of the positions to to link together. For each matching fingerprint identified in near real time the processing unit evaluates the error between a current position and all the previous matching positions. As discussed in further detail below with respect to the positional estimates are further reduced below a dead reckoning DR error threshold due to the correction of previous position estimates. When the estimate of the position is outside the DR error threshold with respect to the position the cascaded corrections between the positions to bring the estimates of the positions and below the DR error threshold for example below the estimated position error as a percentage of the distance traversed along the select pathway .

For an iterative adjustment applying multiple corrections can result in subsequent corrections reversing a portion of the adjustment of previous corrections. In one implementation the track correlation discussed above is performed automatically based on the correlation of sensor data from at least two different periods of recorded magnetic field strength on a sensor channel as shown by the repetitive traversal along the select pathway . For example when applying the correction between the positions and linearly to all the points between the positions and at least a portion of the points between the positions and will be separated. In one implementation adjustments are made from the positions to excluding the data between the positions and and the correction is further applied between the positions and . The track correlation discussed here substantially reduces errors in the position estimation as further discussed below with respect to .

In the example embodiment of a point at the bottom of the pathway near the first curve is marked with crossing points point point and point . Using the correlation tracking discussed above the navigation device discovers like points using the azimuth signature data within the magnetic field recordings. A sample result is shown in . For example point in represents a position of the most recent section of heading data that is point of . The two peaks and in the correlation graph are the other two linked data points points and . It is further indicated in that a majority of the correlation plot is flat line. In the example embodiment of data correlation is only performed when the DR constraint is met for example when the error threshold calculated in Equation 2 is less than 2 percent . When the DR constraint is not met then the correlation is set to zero. The source data for each of the linked data points and is shown in .

With respect to Equation 4 x is the mean of the n data points of x sis the standard deviation of x and similar definitions hold for the y data set. In the example embodiment of an auto correlation is determined meaning that the two sets of data x and y are taken from the same series of points but separated in time.

In detecting the azimuth signature data discussed here an acceleration vector is recorded by the navigation device to provide additional navigation information. For example as shown in Table 1 below an M A dot product of the acceleration vector with the magnetic vector is constant and proportional to the dip angle of the Earth s magnetic field. The dot product is used to detect ripples in the magnetic field strength recordings. Since the azimuth and magnetic field strength measurements are static the dot product is dependent on motion of the user. If the dot product correlates at any of the positions identified in then not only is the user at the identified position the user is also traveling with a near similar motion to when the user passes the position on the second and subsequent times. As a result the example data recordings shown in Table 1 below provide a fingerprinting capability based on the dead reckoning measurement portion of the sensor module . With respect to Table 1 below the columns of data are organized as follows 

Normalized magnetic field The magnitude of the observed magnetic field divided by the nominal field at the location

With respect to Table 1 above the recorded magnetic field is normalized to retain any measurement variations. The dot product between the normalized magnetic vector and the normalized gravity vector is relatively constant and equal to the cosine of the angle between the magnetic vector and the acceleration of gravity. The measurement variations discussed here are due to fluctuations in the magnetic field and user motion coupled with the estimation of the gravity vector.

In operation the navigation device periodically records magnetic field strength of an area substantially surrounding a user of the navigation device . The navigation device combines the recorded magnetic field strength with measurements from at least a dead reckoning portion of the navigation device to provide position estimates. The navigation device corrects each of the position estimates from a starting position where each corrected position estimate has the lowest error value of all the recorded position estimates provided by the navigation device and any intervening positions between each corrected position estimate and the starting position. In the example embodiment of the lowest error value corresponds to an error threshold based on previous position estimates as discussed in further detail below with respect to .

In one implementation the navigation device measures track crossings based on at least one terrain characteristic of a current track that the user of the navigation device is traversing for example the select pathway where the navigation device has no prior knowledge of the terrain or the track prior to the start of the movement. Moreover for each measured track crossing the navigation device correlates the current position at the track crossing with the recorded position estimates to adjustably align the position estimates processed at the navigation device to within the error threshold. The navigation device corrects the current position estimate by qualifying the accumulated magnetic field strength measurements where the accumulated measurements substantially within a sensor measurement range having at least one qualifier. For example as discussed in further detail below with respect to the navigation device applies measurement corrections in an iterative process until all accumulated position measurements are adjusted to within the error threshold.

In operation at a first time the navigation device continually records position estimate measurements along the select pathway based on a measured magnetic field strength. On at least a second time of traversing the select pathway the navigation device automatically determines and combines a first position estimate with a navigation signature from at least one data channel as a track crossing. In one embodiment the at least one data channel corresponds to at least one navigational sensor of the navigation device . Once the track crossing is determined the navigation device aligns the first position estimate of the track crossing with one or more previous position estimates from one or more previous track crossings where the first position estimate is adjusted to within a selectable error threshold based on at least one of the previous position estimates and any intervening positions between the at least one previous position estimate and the first position estimate.

In one implementation the processing unit continually records the position estimate measurements and combines the measured magnetic field strength with at least one azimuth measurement from the dead reckoning portion of the sensor module . Moreover in automatically determining and combining the first position estimate with the navigation signature from the at least one data channel the processing unit qualifies the magnetic field strength measurements based on at least one correlation qualifier corresponding to a sensor measurement range of the at least one data channel as discussed in further detail below with respect to . The processing unit further ranks the qualified measurements as a percentage of the actual distance between the one or more previous track crossings over a total distance traveled along the select pathway . For example the processing unit links a current track crossing with at least one of the previous track crossings based on a correlation of sensor data from at least the first and second time periods of magnetic field strength measurements and in one embodiment combines the correlation of sensor data at each of the track crossings to obtain a product correlation. In linking the current track crossing with the previous track crossing the processing unit iteratively applies a correlation process to each of the linked track crossings until all accumulated position estimate measurements are adjusted to substantially match the first position estimate within the selectable error threshold. As discussed in further detail below with respect to the processing unit uses the product correlation to adjust each of the position estimates between a pairing of the position estimates with the highest correlation that exceeds a correlation threshold until each of the previous position estimates are at or below the selectable error threshold.

As a user traverses a select pathway identifiable landmarks are marked block . For each marked position the method compares the marked position to all previously marked positions using the Equation 1 error estimate block . Next the method selects a point p that has the lowest value for the error estimate block . The method compares the error estimate at point p with the error threshold E block . When the error estimate is greater than or equal to E the method prepares to mark the next landmark block . When the error estimate at point p is less than the threshold the method adjusts the position of all the points from p 1 to n block . The incremental change applied to each point is DS n p . The method determines that the adjustment s made to the points between p and n have not disturbed any previous adjustments block . For example a disturbance occurs if the range of points overlaps with another adjustment. If no disturbances exist the method prepares to mark the next landmark block . When a previous correction is shifted the method readjusts all linked pairs until each error is at or below the value of E block before the method prepares to mark the next landmark block .

The method continues by selecting a pair of positions that has the highest correlation for example two linked points . If their correlation is higher than a correlation threshold T then they are a candidate. The candidate with the highest correlation for example the lowest error value is selected for adjustment block . Moreover when there are no candidates within a predetermined error threshold range block the method returns to block to wait for the next x dataset. The method adjusts the positions of p and n and all the points between similar to the method of . For example the method determines that the adjustment s made to the points between p and n have not disturbed any previous adjustments block . For example a disturbance occurs if the range of points overlaps with another adjustment. If none exists the method returns to block and prepares to mark the next landmark. When a previous correction is shifted the method readjusts all linked pairs until each error that is the largest displacement is less than an iteration error criterion E block before the method returns to block .

The methods and techniques described herein may be implemented in a combination of digital electronic circuitry and software or firmware residing in a programmable processor for example a special purpose processor or a general purpose processor in a computer . An apparatus embodying these techniques may include appropriate input and output devices a programmable processor and a storage medium tangibly embodying program instructions for execution by the programmable processor. A process embodying these techniques may be performed by a programmable processor executing a program of instructions that operates on input data and generates appropriate output data. The techniques may be implemented in one or more programs that are executable on a programmable system including at least one programmable processor coupled to receive data and instructions from and to transmit data and instructions to a data storage system at least one input device and at least one output device. Generally a processor will receive instructions and data from at least one of a read only memory ROM and a random access memory RAM .

Storage media suitable for tangibly embodying computer program instructions and data include all forms of non volatile memory and include by way of example semiconductor memory devices ROM and flash memory devices magnetic disks such as internal hard disks and removable disks magneto optical disks optical disks such as compact disks CDs digital video disks DVDs and other computer readable media. Any of the foregoing may be supplemented by or incorporated in specially designed application specific integrated circuits ASICs . When information is transferred or provided over a network or another communications connection either hardwired wireless or a combination of hardwired or wireless to a computer the computer properly views the connection as a computer readable medium. Thus any such combinations of connections are included within the scope of computer readable media.

This description has been presented for purposes of illustration and is not intended to be exhaustive or limited to the embodiments disclosed. Variations and modifications may occur which fall within the scope of the following claims.

