---

title: Activity filtering based on trust ratings of network
abstract: The filtering of activities generated by nodes of a network while interacting with a device may be performed by evaluating the desirability of the activities (e.g., a spam or not-spam determination of email messages sent by the node) and assigning a trust rating to the node. However, nodes are often identified by network address, and an operator of a node sending undesirable activities may reassign the network address of the node in order to avoid heavy filtering. Instead, nodes may be identified as being controlled by a network entity (e.g., an autonomous system identified in a border gateway protocol routing table.) The network entity is assigned a network entity trust rating based on the trust ratings of the nodes controlled thereby, and an appropriate level of activity filtering based on the network entity trust rating may be selected for subsequent activities received from all nodes controlled by the network entity.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09098459&OS=09098459&RS=09098459
owner: Microsoft Technology Licensing, LLC
number: 09098459
owner_city: Redmond
owner_country: US
publication_date: 20100129
---
Many computing scenarios involve a network connecting a device with one or more nodes of the network and that particularly involve the filtering of activity of the nodes while interacting with the device. For example an email server may receive email from many nodes but may filter out unsolicited bulk email messages spam from desired email messages a webserver may be configured to differentiate legitimate web requests from unproductive web requests such as disingenuous requests submitted as a denial of service attack and a file server may wish to provide service while identifying and blocking intrusion attempts e.g. attempts to install malware in order to commandeer the server for a botnet controlled by another individual. 

In each of these scenarios it may be desirable to implement filtering techniques on the device that successfully identify and exclude unwanted activity and that reduce the frequency of accidentally excluding wanted activity e.g. a false positive in a filtering scheme while efficiently utilizing the resources of the device e.g. memory network capacity and processor usage in performing the filtering. In the particular scenario of unsolicited bulk email messages filtering techniques often involve various properties of the email messages such as blacklists of notorious or suspected spammers whitelists of senders that are believed to be acceptable to recipients of such email messages and keywords that are often included in spam email messages such as the names of popular pharmaceuticals that are often advertised for sale via spam email messages. Increasing the aggressiveness of these filtering techniques may successfully reduce the delivery of spam email messages but may also raise the number of false positives of non spam email messages that are incorrectly identified as spam by the filtering techniques and withheld from delivery to users.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key factors or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

Alternatively or in addition to the filtering of particular activities of a node interacting over a network with the device techniques may be devised for identifying particular nodes that are believed to engage in high volumes of undesirable activity such as sending unsolicited bulk email messages participating in denial of service attacks and or attempting to deliver malware to the device. For example each node may have a particular network address on the network and a list may be generated that identifies a trust rating of the node at a particular network address such as a blacklist of nodes having a low trust rating such that the activities of such nodes may be more aggressively filtered throttled or completely blocked and whitelists of nodes having a high trust rating such that the activities of such nodes may be less aggressively filtered or unthrottled. However one difficulty with this technique involves the proclivity of the perpetrators of undesirable activity e.g. spammers hackers and botnet operators to determine that the network address of a node has been blacklisted and to switch to a different network address which is not yet blacklisted in order to continue the unwanted activity. For example an individual may register a particular domain having up to 256 distinctive network addresses e.g. the domain may be assigned by a network registrar to all internet protocol IP addresses between 32.64.128.0 and 32.64.128.255 and may frequently assign a new network address to a node in order to avoid the blacklisting of the node.

Presented herein are techniques for assigning trust ratings to network entities based on evaluations of activity of various nodes interacting with the device over the network where such techniques may reduce the avoidance of blacklisting through the switching of network addresses. These techniques involve the mapping of ranges of network addresses such as blocks of IP addresses to a particular network entity. For example the border gateway protocol BGP utilized by various network routers to establish routes of data packets may identify one or more autonomous systems ASes each of which may have an autonomous system number ASN and each of which may be associated in a BGP routing table with network addresses comprising a network address group. For respective nodes of the network associated with a network entity e.g. having a network address within the network address group of the network entity activities of the node interacting with the device may be evaluated to determine the desirability of the activity. Moreover a network entity trust rating may be assigned to the network entity based on the evaluated activities of the nodes controlled by the network entity. The network entity trust rating may then be used to determine a level of filtering of nodes controlled by the network entity e.g. any node having a network address within the network address group associated with the network entity. In this manner the activities of a node may be attributed to many nodes controlled by the network entity such that a perpetrator of undesirable activity may be unable to avoid filtering by switching to a different network address that is controlled by the same network entity e.g. a different IP address associated with the same domain. These techniques may be particularly effective because the routing tables stored by various routers according to the border gateway protocol BGP may be difficult for perpetrators to alter without interfering with the connectivity of the nodes to the network.

To the accomplishment of the foregoing and related ends the following description and annexed drawings set forth certain illustrative aspects and implementations. These are indicative of but a few of the various ways in which one or more aspects may be employed. Other aspects advantages and novel features of the disclosure will become apparent from the following detailed description when considered in conjunction with the annexed drawings.

The claimed subject matter is now described with reference to the drawings wherein like reference numerals are used to refer to like elements throughout. In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the claimed subject matter. It may be evident however that the claimed subject matter may be practiced without these specific details. In other instances structures and devices are shown in block diagram form in order to facilitate describing the claimed subject matter.

Within the field of computing many scenarios involve the communication of a device such as a server a router a firewall a workstation a notebook a smartphone or a network appliance with various nodes each node comprising another device over a wired or wireless network. However along with the proliferation of advantageous uses of network communication many uses of network communication have been developed that are undesirable to an owner of the device. As a first example the device may comprise an email server configured to receive email messages from various nodes and addressed to users of the device. However some of the nodes may send unsolicited bulk email messages spam to the device and the device may filter the received email messages to reduce the delivery of spam to users. As a second example the device may comprise a webserver configured to receive and fulfill web requests received from users of other nodes but some such requests may be disingenuous and intended to consume the resources of the webserver e.g. a denial of service attack. The webserver may be configured to identify and fulfill genuine requests in order to provide productive web service while disregarding disingenuous requests. As a third example the device may be exposed via the network to some nodes that attempt to deliver malware e.g. trojan software that surreptitiously commandeers a portion of the computing resources of the device on behalf of another individual such as by joining a botnet comprising a network of commandeered devices under the control of the other individual. The device may utilize various techniques to reduce contact from potentially malicious nodes such as a stateless or stateful firewall that excludes types of contact that are likely to be illegitimate.

In these and other scenarios an operator of the device may endeavor to configure the device to utilize various forms of filtering of activity of various nodes of the network that attempt to interact with the device. The operator may seek to employ one or more filtering techniques that achieve a high accuracy of excluding undesirable activity while reducing the mis identification and exclusion of desirable activity false positives and while conserving computing resources e.g. network bandwidth memory and processor usage and processing delays in evaluating the activity. Thus while more aggressive filtering may result in the exclusion of a higher percentage of undesirable activity such as the rerouting of spam email messages to a spam email folder instead of to users inbox folders the consequences of false positives e.g. non spam messages incorrectly routed to the spam email folder and or the consumption of computing resources may be too costly. Therefore efficient and accurate filtering techniques are desirable in configuring devices to filter the activity of nodes interacting with the device.

In particular email servers are often configured to reduce the delivery of spam to users by utilizing a combination of filtering techniques. Content based filters may be utilized to examine email messages received from various nodes for indicators of unsolicited bulk email e.g. spam email messages may be highly correlated with particular keywords such as the names of popular pharmaceuticals that are often offered for sale via spam email messages. Sender based filters may also be utilized to identify senders of email messages that are known to send large amounts of spam. For example some phishing spammers endeavor to send email that appears to originate from various trusted senders such as banks auction sites and software sites and that include a hyperlink that leads to a false representation of the website of the sender that captures valuable data provided by the user e.g. account identifiers and passwords and delivers such data to another individual. In order to detect and reduce phishing email messages an email server may be configured to identify email messages that appear to originate from such trusted websites and to contact the trusted website to verify the contents of the email message before delivering the email message to the recipient s . By using a combination of these and other techniques an email server may be configured to filter the activities of various nodes that send email messages to the email server thereby differentiating legitimate email messages from various types of spam. Email messages that are identified with a high degree of probability of comprising spam may be processed through various other techniques such as dropping the email message e.g. silently discarding the email message bouncing the email message back to the sender e.g. not delivering the email message to a recipient but instead sending back to the sender a non delivery report NDR indicating that the message was not delivered notifying the user that the email message may be spam delivering the email message to a spam email folder instead of the inbox email folder of the user delaying the receipt of the email message from the node thereby imposing a penalty on the node that reduces the rate of delivering spam email messages in bulk while not significantly affecting the delivery of legitimate email messages and time travel upon identifying an email message as spam identifying similar email messages within the inboxes of other users that have not yet been read or seen by the users and removing such email messages before delivery or even after a user has seen read or received the email message delivery viewing seen and read by the users. 

In the exemplary scenario of the device receives four email messages from four different nodes of the network and endeavors to filter these activities of the nodes to identify and remove spam email messages . The device may evaluate all four email messages with a first filtering technique comprising a keyword filter that identifies keywords that are highly correlated with spam email messages e.g. the term popular meds in the second email message and that routes email messages containing such keywords to the spam folder of the email account of the client . The device may next evaluate the remaining three email messages with a second filtering technique comprising a sender blacklist which identifies a list of senders that are known to send high volumes of spam email messages e.g. your friend spam.com the sender of the third email message and that routes email messages sent from such senders to the spam folder of the email account of the user . The device may next evaluate the remaining two email messages with a third filtering technique comprising sender authentication which identifies often impersonated senders e.g. security bank.com the sender of the fourth email message which contacts the senders in order to authenticate such email messages and which routes unverified email messages impersonating these senders to the spam folder of the email account. As a result of these filtering techniques the device presents to the client an inbox folder containing the single genuine email message and a spam folder containing the email messages that have been identified as spam.

One technique that may be utilized to filter activities relates to the evaluation of activities received from a particular node interacting with the device where the node is identified on the network according to a network address e.g. an internet protocol IP address selected by or assigned to the node . The device may be configured to evaluate activities received from a particular network address if these activities are determined to be undesirable the device may more heavily filter subsequent activities received from the network address or may altogether block communication with the network address.

While the evaluation of activities received from various nodes of the network as in the exemplary scenario of may enable a more informative evaluation and more accurate filtering of the nodes one potential problem with the exemplary scenario of is the relative ease in switching a node to a new network address if its current network address is identified as having a bad activity profile . In some scenarios an individual such as a spammer a hacker or a botnet operator may license a potentially large range of network addresses e.g. an entire range of IP addresses beginning with the numbers 16.32 comprising a total of 65 536 network addresses . If a network address used by a node is identified as associated with a bad activity profile that suggests heavier filtering of activities received from the node the individual may switch the node to a new network address that does not have a bad activity profile and may resume the sending of activities . The delivery of undesirable activities may be only briefly diminished during the switch to a new network address and may continue with only a brief interruption thereby reducing the effectiveness of the technique illustrated in the exemplary scenario of .

Presented herein are alternative techniques for evaluating the activities of nodes of a network that may be resistant to switches in network addresses of a node upon identifying a high volume of undesirable activities issuing therefrom. According to these techniques it may be possible to associate one or more nodes with a network entity such as a network operator company organization or government responsible for controlling the nodes . As a first example this identification may involve identifying an autonomous system number ASN of a network entity controlling a particular set of nodes . As a second example this identification may involve identifying a network name shared in common among several nodes such as a similar set of domain names that are assigned to the network addresses of a set of nodes . If a set of nodes may be identified as associated with a particular network entity it may be possible to evaluate activities of the nodes controlled thereby to determine the desirability of the activities . Moreover it may be observed that an individual seeking to distribute undesirable activities may be able to switch a particular node quickly to a new network address controlled by the network entity but may have more difficulty in switching the node to a network address associated with a different network entity e.g. because such switching may be complicated or expensive to achieve. For example for respective network addresses such as IP addresses activities received from the network address may be evaluated. Moreover several network addresses may be identified as controlled by a particular network entity and the evaluations of activities of the nodes using such network addresses may be aggregated to generate a network entity trust rating. This network entity trust rating may subsequently be applied to several or all nodes controlled by the network entity even for nodes that have not previously sent activities to the device . In this manner the evaluation of activities received from particular nodes controlled by a particular network entity may be ascribed to other or all nodes controlled by the network entity. An individual seeking to avoid this determination may have difficulty in reconfiguring the node to utilize a network address having a higher trust rating that is untainted by the previously received activities thereby improving the filtering of the node to reduce the receipt of undesirable activities .

Still another embodiment involves a computer readable medium comprising processor executable instructions configured to apply the techniques presented herein. An exemplary computer readable medium that may be devised in these ways is illustrated in wherein the implementation comprises a computer readable medium e.g. a CD R DVD R or a platter of a hard disk drive on which is encoded computer readable data . This computer readable data in turn comprises a set of computer instructions configured to operate according to the principles set forth herein. In one such embodiment the processor executable instructions may be configured to perform a method offiltering activities of nodes interacting with a device such as the exemplary method of . In another such embodiment the processor executable instructions may be configured to implement a system for filtering activities of nodes interacting with a device such as the exemplary system of . Some embodiments of this computer readable medium may comprise a nontransitory computer readable storage medium e.g. a hard disk drive an optical disc or a flash memory device that is configured to store processor executable instructions configured in this manner. Many such computer readable media may be devised by those of ordinary skill in the art that are configured to operate in accordance with the techniques presented herein.

The techniques presented herein may be devised with variations in many aspects and some variations may present additional advantages and or reduce disadvantages with respect to other variations of these and other techniques. Moreover some variations may be implemented in combination and some combinations may feature additional advantages and or reduced disadvantages through synergistic cooperation. The variations may be incorporated in various embodiments e.g. the exemplary method of and the exemplary system of to confer individual and or synergistic advantages upon such embodiments.

A first aspect that may vary among embodiments of these techniques relates to the scenarios wherein the techniques presented herein may be utilized. As a first example the techniques may be used to filter many types of activities received by many types of devices including email messages received by an email server text messages received by a text messaging server such as a chat server or a simple messaging service SMS server social network messages received by a social network server web request received by a webserver such as weblog posts received by a weblog server database queries received by a database server and invocations of services received by various types of servers such as accesses of files on a file server.

As a second example of this first aspect the activities may be received from many types of nodes interacting with the device . As a first variation a node may comprise a device legitimately operated by a user such as an individual a group of individuals an organization a corporation a government or even a fully autonomous device that sends legitimate activities to the device . As a second variation of this second example a node may be configured by a user to distribute undesirable activities to the device such as a spam email server a distributor of various forms of malware or a phishing server that attempts to impersonate a trusted server in order to extract sensitive information from unsuspecting visitors. As a third variation of this second example a node may have been accidentally misconfigured by a user in a manner that generates undesirable activities e.g. an email server that accidentally sends huge numbers of a particular email message to the device or that has been misconfigured as an open relay that is exploited by a spam email server to redeliver large volumes of spam email messages. As a fourth variation of this second example a node may be legitimately operated by a user and may therefore generate some legitimate activities but may have been commandeered by malware to generate undesirable activities e.g. a node may send legitimate web requests to a device comprising a webserver but may also have been infected with malware that attempts to deliver large volumes of spam messages and or perform denial of service attacks against the device and or other nodes of the network . 

As a third example of this first aspect the techniques may be implemented through many types of architectures. In a first variation of this third example the components of the exemplary method of may be performed in different concurrent or consecutive orders e.g. identifying a network entity controlling various nodes may be delayed until activity of a node identifying the network entity is received. In a second variation of this third example the architecture of the exemplary system of may vary in many different ways e.g. a single component may perform an activity evaluation of various nodes and also assign the network entity trust rating to the network entity based on the activity evaluation . The device might also comprise a plurality of interconnected and interoperating devices such as a set of network servers comprising a network farm that presents a website to various users. Those of ordinary skill in the art may devise many variations in the scenarios and architectures wherein the techniques presented herein may be implemented.

A second aspect that may vary among embodiments of these techniques relates to the manner of evaluating activities of a node . As a first example an embodiment of these techniques may evaluate the content of the activities of the node e.g. an email server may evaluate the contents of email messages received from various nodes based on keywords or patterns in the email message that are highly correlated with spam email messages and a webserver may evaluate the contents of web requests to differentiate legitimate web requests that may be productively fulfilled from disingenuous web requests sent as part of a denial of service attack.

As a second example of this second aspect an embodiment of these techniques may evaluate various activity properties of various activities of the node where such activity properties comprise metadata about the activities of the node such as a the result of a holistic evaluation of the activities . Activity properties that may be relevant to this evaluation may be selected from an activity property set comprising spam message reports which may relate to at least one spam message sent by the node e.g. records of a number of positively identified spam messages sent by the node which may be sent by a recipient who has determined that the sender is delivering spam email messages and possibly including statistics on the volume of spam email messages being sent by the node non spam message reports e.g. notifications that email messages sent by the node have been verified as legitimate non spam email messages phishing reports which may relate to phishing attempts initiated by the node and malware reports which may relate to malware items that may be stored by the node and may be transmitted to other devices. Other activity properties that may be relevant to the evaluation of the activities of the node comprise various metrics such as message metrics relating a volume of messages sent by the node e.g. where high rates of message sending may be indicative of bulk unsolicited email messages recipient metrics relating to the number of recipients of at least one message sent by the node e.g. where messages having a high number of recipients may be indicative of bulk unsolicited email messages and returned message metrics relating to the number or rate of returned messages sent to the node in response to a message sent by the node e.g. where high rates of bounced messages may be indicative of bulk unsolicited email messages. Still other metrics that may be relevant to the evaluation of the node include sender authentication failures relating to messages sent by the node where verification of the sender by a recipient subsequently failed e.g. which may be indicative of attempted impersonation of individuals connection metrics relating to the number of connections established by the node e.g. where high numbers of connections may be indicative of bulk unsolicited email messages and bandwidth metrics relating to network bandwidth utilized by the node e.g. where high usage of upload bandwidth may be indicative of a denial of service attack against another node over the network . Moreover these activity properties may be detected by the device and or may be detected by another device e.g. a centralized tracking database of well known spammers and transmitted to the device for use in evaluating the activities of the node . Other activity properties such as other types of reports and metrics may also be useful in evaluating the activities of a node to determine an activity evaluation.

As a third example of this second aspect the activity evaluation of a node may be based on various network properties exhibited by the node which may be indicative of the type configuration and uses of the node for distributing desirable or undesirable activities . Such network properties may be selected from a network property set comprising a name registry comprising a network name of the node e.g. some name registries such as domain registrars may be tolerant of nodes distributing undesirable activities and may even facilitate such distribution by quickly reassigning the network name of a node in order to avoid identification of the node as distributing the undesirable activities . Such network properties might also include the network port status of at least one network port of the node e.g. an open port on a node may be indicative of an open mail relay that may be exploitable by a spam email server to retransmit large volumes of spam messages as activities to the device a geographic location of the node e.g. where a node hosted in a first geographic area may be more or less trustworthy than a node hosted in a second geographic area and or at least one property of at least one network route associated with at least one network address of the node e.g. the node may be hosted within a virtual private network that is more or less trustworthy than nodes outside of the virtual private network and this factor may be identified according to the network route involved in reaching the node over the network . Such network routes may be determined e.g. by evaluating the results of a routing path trace performed over the network .

As a fourth example of this second aspect the activity evaluation of the node may be based on at least one user property of at least one user of the node where some users or types of users may be more or less trustworthy than other users or types of users . The user properties may be selected from a user property set comprising a geographic location of the user e.g. where users located in a first geographic region may be more or less trustworthy than users located in a second geographic region a user type of the user e.g. a node utilized by a government or a public corporation may be more trustworthy than a node utilized by a private corporation or an individual a reputation of the user e.g. some users may have verifiable identities associated with trustworthy reputations that suggest a higher trust level to be ascribed to nodes operated by the user while other users may have reputations of distributing undesirable activities such as notorious spammers and a financial status indicator of the user e.g. nodes operated by a publicly traded corporation with high revenue streams may be more trustworthy than nodes operated by bankrupt or struggling corporations or unknown corporations with indeterminate revenue streams. 

As a fifth example of this second aspect many types of evaluation may be applied to these various types of information about the activities and the nodes in order to evaluate the activities of a node . As a first variation of this fifth example an embodiment of these techniques may evaluate the activities of a node by querying a user to evaluate one or more activities e.g. the user may be queried to identify spam messages by examining the contents of various messages sent by a node and upon receiving from the user an activity evaluation of the node achieving the activity evaluation of the node . In other variations of this fifth example various automated techniques may be utilized such as the rule based filtering techniques illustrated in the exemplary scenario of . In a second variation of this fifth example a node activity classifier may be configured to evaluate the activities of various nodes and an embodiment of these techniques may use the node activity classifier to select a node activity classification of respective activities of a node and may generate the activity evaluation of the node based on the selected node activity classifications. For example a classifier technique such as a Bayesian network an artificial neural network a set of heuristics or an expert system may be configured to evaluate various properties of an email message and to output a node activity classification identifying the email message as a spam email messages or a non spam email message and an embodiment of these techniques may use the node activity classifications of the classifier to evaluate the activities of a node and to generate an activity evaluation of the node . As a third such variation a network entity classifier may be configured to generate activity evaluations of various nodes in order to generate a network entity classification e.g. a legitimate network a spam network a peer to peer network or a botnet and an embodiment of these techniques may use the network entity classifier to evaluate the activities of the nodes controlled by a network entity and to assign the network entity trust rating of the network entity based on a network entity classification.

A third aspect that may vary among embodiments of these techniques relates to the manner of determining a network entity controlling a particular node . As a first example the network entity may be determined by evaluating a routing table identifying at least one network entity and at least one network address of at least one node controlled by the network entity . This may be achieved e.g. by evaluating a border gateway protocol BGP routing table stored by a routing device of the network which may associate various nodes with a controlling network entity e.g. by identifying a network address group allocated to an autonomous system AS identified by an autonomous system number ASN where the network address group contains the network address of the node . Because the network routes identified for communicating with a particular node may be difficult to alter without disrupting network communication to the node the information within these routing tables maybe comparatively up to date and reliable for determining a network entity controlling a particular node . As a second example the network entity may be registered with a name registry e.g. a domain name service or a WHOIS service that is configured to associate node names with respective nodes of the network . An embodiment of these techniques may be capable of determining the network entity controlling a particular node by identifying a node name of the node according to the name registry and by associating the node name of the node with a network entity according to the name registry. For example a domain name service may be configured to associate nodes controlled by a network entity for a particular corporation with a domain name related to the name of the corporation e.g. a particular store existing as a network entity may register many controlled nodes with the domain name service as having various node names comprising variations of store.com . Those of ordinary skill in the art may devise many ways of identifying a network entity controlling a particular node of the network while implementing the techniques presented herein.

A fourth aspect that may vary among embodiments of these techniques relates to the manner of filtering activities of a node based on the network entity trust rating of the network entity controlling the node . As a first example upon determining that at least one network address of a node is within a network address group controlled by a network entity having a poor network entity trust rating an embodiment of these techniques may be configured to block activities received from the node e.g. by refusing any and all connections initiated by the node with the device over the network . Alternatively particular types of activities may be blocked. For example a node that is misconfigured as an open relay may be exploited to retransmit large volumes of spam messages but may otherwise generate legitimate activities accordingly an embodiment of these techniques may be configured to block email received from the node but to accept other types of activities sent by the node .

As a second example of this fourth aspect upon determining that at least one network address of a node is within a network address group controlled by a network entity having a poor network entity trust rating an embodiment of these techniques may be configured to reduce at least one service of the device provided to the node . For example network bandwidth of connections established between the node and the device over the network may be throttled the lag of such connections may be increased and a service usage quota may be reduced e.g. an email server may filter an email service used by a node or user to transmit spam messages may be restricted to a low limit of email messages that may be transmitted such as no more than 50 sent messages per day. 

As a third example of this fourth aspect upon determining that at least one network address of a node is within a network address group controlled by a network entity having a poor network entity trust rating an embodiment of these techniques may be configured to increase the filtering of the activities of the node . For example if a node is identified as sending large volumes of spam messages to the device the device may implement more rigorous spam evaluation techniques to achieve more successful exclusion of spam messages sent by the node .

As a fourth example of this fourth aspect specific types of filtering may be utilized by a device comprising an email server and configured to receive activities comprising email messages from other nodes where the email messages may or may not comprise spam email messages. In this scenario upon determining that at least one network address of a node sending email messages to the device is within a network address group controlled by a network entity having a poor network entity trust rating due to the delivery of a high volume of spam email messages the device may apply various email filtering techniques. Such techniques may be selected from an email filtering techniques set including dropping the email message e.g. silently discarding the spam email message bouncing the email message back to the node junking the email message e.g. delivering the email message to a client within a spam folder such as illustrated in the exemplary scenario of quarantining the email message e.g. notifying a client addressed as a recipient of the email message that a spam email message has been received but blocked and delaying receipt of the email message thereby imposing a time penalty on nodes endeavoring to deliver a high rate of spam email messages. Those of ordinary skill in the art may devise many ways of filtering the activities of various nodes based on the network entity trust rating of the controlling network entity while implementing the techniques presented herein.

A fifth aspect that may vary among embodiments of these techniques relates to additional actions that may be performed in relation to the evaluation of activities the assignment of trust ratings to nodes and network entities and the filtering of activities based on the trust ratings. As a first example of this fifth aspect an embodiment of these techniques maybe configured to exchange information about trust ratings assigned to nodes and or network entities with other devices such as other trusted servers in order to implement a distributed or broad consensus of trust ratings. In a first such variation upon identifying a network entity trust rating of a network entity an embodiment of these techniques may be configured to notify at least one trusted device of the network entity trust rating assigned to the network entity . For example a device implementing these techniques may generate and circulate to other devices a network entity trust ratings list that indicates various network entity trust ratings assigned by an embodiment of these techniques to various network entities . In a second such variation an embodiment of these techniques may be configured to receive at least one network entity trust rating from a trusted device and to assign to a network entity a network entity trust rating based on both the activity evaluations of nodes within the network address group of the network entity and the network entity trust rating received from the trusted device. In this manner a device and an embodiment of these techniques implemented thereupon may exchange trust ratings assigned to various nodes and or network entities in order to pool determinations of trust ratings among trusted devices.

As a second example of this fifth aspect additional actions relating to the assignment of network entity trust ratings and or activity evaluations may be taken following the assignment thereof to a network entity or node . For example the activities and types of nodes and network entities may change over time e.g. a node that is misconfigured as an open relay that is exploited to retransmit spam email messages may be reconfigured by a user to close the open relay thereby improving the activities of the node conversely a formerly trusted node may be infected with malware that begins generating large volumes of undesirable activities . Accordingly after assigning a network entity trust rating to a network entity an embodiment of these techniques may be configured to for nodes interacting with the device and controlled by the network entity evaluate at least one subsequent activity of the node in order to assign an updated activity evaluation of the node and may assign to the network entity an updated network entity trust rating based on the updated activity evaluation . In this manner the embodiment may maintain the freshness of the trust ratings assigned to various network entities and nodes based on changes to the activities thereof. Those of ordinary skill in the art may devise many ways of evaluating the activities of various nodes and network entities while implementing the techniques presented herein.

A third example of this fifth aspect relates to a trustworthy node generating legitimate activities that may be controlled by a network entity having a poor network entity trust rating . In some scenarios a network entity may be assigned a poor trust rating e.g. if several nodes controlled by the network entity are commandeered by malware or form a botnet or if the network entity is comparatively tolerant of undesirable activities of controlled nodes such as the transmission of spam. However the assignment of the poor trust rating to the network entity may be unfair to one or more nodes that generate legitimate and desirable activities while interacting with the device because such a node may be more heavily filtered than warranted by the activity evaluation of the node . For example a network entity that is determined to host nodes that are sending a high volume of spam email messages may result in heavy filtering of email messages received from any node controlled by the network entity . However such heavy filtering may result in a rise in false positives e.g. non spam email messages that are incorrectly identified as spam email messages thereby unfairly penalizing one or more nodes that send only non spam email messages.

In such scenarios an embodiment of these techniques may implement an auto rescue feature to permit a node to be rescued from overly heavy filtering due to a lower trust rating assigned to the controlling network entity of the node than the trust rating assigned to the node . For example upon identifying a node having at least one network address within a network address group controlled by a network entity where the node has a higher level of trust determined from the activity evaluation than the network entity trust rating of the network entity an embodiment of these techniques may be configured to filter the activities of the node based on the activity evaluation rather than the lower network entity trust rating . For example less stringent email filtering may be applied to a node having a high level of trust arising from the activity evaluation based on sending a low volume of spam email messages even if more stringent email filtering is applied to other nodes of the same controlling network entity that have poorer activity evaluations that are not higher than the network entity trust rating of the controlling network entity .

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

As used in this application the terms component module system interface and the like are generally intended to refer to a computer related entity either hardware a combination of hardware and software software or software in execution. For example a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a controller and the controller can be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers.

Furthermore the claimed subject matter may be implemented as a method apparatus or article of manufacture using standard programming and or engineering techniques to produce software firmware hardware or any combination thereof to control a computer to implement the disclosed subject matter. The term article of manufacture as used herein is intended to encompass a computer program accessible from any computer readable device carrier or media. Of course those skilled in the art will recognize many modifications may be made to this configuration without departing from the scope or spirit of the claimed subject matter.

Although not required embodiments are described in the general context of computer readable instructions being executed by one or more computing devices. Computer readable instructions may be distributed via computer readable media discussed below . Computer readable instructions may be implemented as program modules such as functions objects Application Programming Interfaces APIs data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the computer readable instructions may be combined or distributed as desired in various environments.

In other embodiments device may include additional features and or functionality. For example device may also include additional storage e.g. removable and or non removable including but not limited to magnetic storage optical storage and the like. Such additional storage is illustrated in by storage . In one embodiment computer readable instructions to implement one or more embodiments provided herein may be in storage . Storage may also store other computer readable instructions to implement an operating system an application program and the like. Computer readable instructions may be loaded in memory for execution by processing unit for example.

The term computer readable media as used herein includes computer storage media. Computer storage media includes volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions or other data. Memory and storage are examples of computer storage media. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM Digital Versatile Disks DVDs or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by device . Any such computer storage media may be part of device .

Device may also include communication connection s that allows device to communicate with other devices. Communication connection s may include but is not limited to a modem a Network Interface Card NIC an integrated network interface a radio frequency transmitter receiver an infrared port a USB connection or other interfaces for connecting computing device to other computing devices. Communication connection s may include a wired connection or a wireless connection. Communication connection s may transmit and or receive communication media.

The term computer readable media may include communication media. Communication media typically embodies computer readable instructions or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal may include a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal.

Device may include input device s such as keyboard mouse pen voice input device touch input device infrared cameras video input devices and or any other input device. Output device s such as one or more displays speakers printers and or any other output device may also be included in device . Input device s and output device s may be connected to device via a wired connection wireless connection or any combination thereof. In one embodiment an input device or an output device from another computing device may be used as input device s or output device s for computing device .

Components of computing device may be connected by various interconnects such as a bus. Such interconnects may include a Peripheral Component Interconnect PCI such as PCI Express a Universal Serial Bus USB firewire IEEE 1394 an optical bus structure and the like. In another embodiment components of computing device may be interconnected by a network. For example memory may be comprised of multiple physical memory units located in different physical locations interconnected by a network.

Those skilled in the art will realize that storage devices utilized to store computer readable instructions may be distributed across a network. For example a computing device accessible via network may store computer readable instructions to implement one or more embodiments provided herein. Computing device may access computing device and download a part or all of the computer readable instructions for execution. Alternatively computing device may download pieces of the computer readable instructions as needed or some instructions may be executed at computing device and some at computing device .

Various operations of embodiments are provided herein. In one embodiment one or more of the operations described may constitute computer readable instructions stored on one or more computer readable media which if executed by a computing device will cause the computing device to perform the operations described. The order in which some or all of the operations are described should not be construed as to imply that these operations are necessarily order dependent. Alternative ordering will be appreciated by one skilled in the art having the benefit of this description. Further it will be understood that not all operations are necessarily present in each embodiment provided herein.

Moreover the word exemplary is used herein to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as advantageous over other aspects or designs. Rather use of the word exemplary is intended to present concepts in a concrete fashion. As used in this application the term or is intended to mean an inclusive or rather than an exclusive or . That is unless specified otherwise or clear from context X employs A or B is intended to mean any of the natural inclusive permutations. That is if X employs A X employs B or X employs both A and B then X employs A or B is satisfied under any of the foregoing instances. In addition the articles a and an as used in this application and the appended claims may generally be construed to mean one or more unless specified otherwise or clear from context to be directed to a singular form.

Also although the disclosure has been shown and described with respect to one or more implementations equivalent alterations and modifications will occur to others skilled in the art based upon a reading and understanding of this specification and the annexed drawings. The disclosure includes all such modifications and alterations and is limited only by the scope of the following claims. In particular regard to the various functions performed by the above described components e.g. elements resources etc. the terms used to describe such components are intended to correspond unless otherwise indicated to any component which performs the specified function of the described component e.g. that is functionally equivalent even though not structurally equivalent to the disclosed structure which performs the function in the herein illustrated exemplary implementations of the disclosure. In addition while a particular feature of the disclosure may have been disclosed with respect to only one of several implementations such feature may be combined with one or more other features of the other implementations as may be desired and advantageous for any given or particular application. Furthermore to the extent that the terms includes having has with or variants thereof are used in either the detailed description or the claims such terms are intended to be inclusive in a manner similar to the term comprising. 

