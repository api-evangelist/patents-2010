---

title: Intrinsic detection of motion in segmented sequences
abstract: A self-navigating technique designed to detect motion in segmented sequences is disclosed. Certain embodiments compare a plurality of segments containing adjacent sets of k-space lines and produce an aliased error function which corresponds to a correlation of the segments. A global shift of the aliased error function may indicate the presence of in-plane rigid-body translation while other types of motion are evident in the dispersion or breadth of the error function. Some embodiments may then replace motion corrupted data with reacquired data. Further, some embodiments may correct or remove corrupted data retrospectively.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08811694&OS=08811694&RS=08811694
owner: University of Utah Research Foundation
number: 08811694
owner_city: Salt Lake City
owner_country: US
publication_date: 20100930
---
This invention was made with government support under Grants HL48223 and HL57990 awarded by the National Institute of Health. The government has certain rights in this invention.

The present disclosure relates generally to medical imaging and more particularly to detecting corrupt data caused by undesired motion of a subject.

Patient motion is one of the dominant sources of artifact in Magnetic Resonance Imaging MRI images. MRI techniques generally involve capturing data measurements sometimes referred to k space measurements for a sequence of slices over a period of time. During the capture stage movement of a subject may cause a particular slice to become corrupted. While many motion correction techniques for MRI have been proposed their use is often limited by the need for increased patient preparation decreased patient comfort additional scan time or the use of specialized sequences not available on many commercial scanners. Techniques developed to detect and correct motion include those that utilize specialized hardware to detect patient motion those that utilize special k space trajectories with some inherent motion correction ability those that acquire additional navigator data for the purpose of motion correction and those considered to be self navigating.

Motion detection techniques that rely on specialized hardware may include utilizing laser beams which reflect light off of specialized markers. Optical or infrared tracking systems which use multiple cameras or sensors may also be implemented. Other methods may implement tracking using small receiver coils configured to detect motion changes or by using spatial frequency tuned markers.

Techniques that use specialized k space trajectories for motion detection may include acquiring rotated sets of overlapping parallel lines or interleaving spiral trajectories. Other methods may include acquiring data in some sort of hybrid Radial Cartesian fashion or using alternating frequency phase encode directions.

Some motion detection techniques acquire additional navigator data as a Cartesian projection in the absence of either phase or frequency encoding or with a floating navigator. Orbital navigators utilize a circular k space trajectory to detect object motion while spherical navigators sample spherical k space shells. When multiple receive coils are used parallel imaging techniques such as SENSE or GRAPPA can use a subset of acquired data to predict other measurements that may or may not already be acquired. These predicted k space lines are compared to the same k space lines that are actually acquired. Both of these parallel imaging methods require the acquisition of additional calibration data thus increasing scan time. While all of these motion detection techniques have shown success in their respective applications their use is often limited by one or more of the following increased complexity in patient preparation decreased patient comfort additional scan time or the required use of specialized sequences not available on many commercial scanners.

Several proposed self navigating techniques address a specific type of motion typically in plane and rigid body but none address both rigid and non rigid body motion that can occur both in and out of plane. For example motion in the readout direction has been detected by taking the Fourier Transform of a line of acquired data and trying to determine the edges of the object s profile. The edges become increasingly difficult to determine from lines encoded near the edges of k space and high contrast markers are often added to the patient to overcome this problem. Motion in the phase encode direction can be detected using a symmetric density constraint along the phase encoding axis. However the algorithm is restrictive on the object type and may not perform well for large motion in the phase encode direction. Another approach is to apply a spatial constraint to the object and then use an iterative phase retrieval algorithm to calculate the desired phase of the object. The calculated phase is compared to the measured phase to simultaneously find motion in the readout and phase encode directions. The algorithm performs well for sub pixel motions but is unable to correct an artifact caused by large translations. Combinations of these self navigating methods have also been proposed to overcome some of their pitfalls but have not proven to be robust in the presence of out of plane or non rigid body motion.

Motion may also be determined by iteratively minimizing the entropy of motion induced ghosts and blurring in an otherwise dark region of an image. Alternatively data correlations between adjacent data lines can provide information about in plane rigid body translation. Radial sequences can provide a self navigating method for rigid body motion correction using moments of spatial projections or the phase properties of radial trajectories. Motion correction in the slice direction has also been explored by monitoring amplitude modulations of the acquired data. A combination of some of these proposed techniques can be utilized to correct for in plane rigid body motion but does not include the ability to address other types of motion.

The present application is directed to systems and methods which compensate for undesired motion utilizing an aliased error function derived using a plurality of data segments. In certain embodiments the error function may be employed to recognize corrupted data and reacquire the portions of data which correspond to the area of the corrupted data. Further embodiments may remove corrupted data retrospectively. In some embodiments data that is corrupted by out of plane and or non rigid body motion is detected and compensated for during image reconstruction. Such utilization of an error function and corresponding capabilities resulting therefrom represents significant advances over prior compensation techniques.

Certain embodiments of the present application provide for a self navigating technique designed to detect and compensate for undesired motion observed in segmented sequences. For example in some embodiments two segments containing adjacent sets of k space lines are compared and an aliased error function is produced which corresponds to a correlation of the two segments. In some embodiments a global shift of the aliased error function may be observed and seen as indicative of the presence of other types of motion. Such shifts may be evident in the dispersion or breadth of the error function.

While the concepts described herein may be employed for any imaging application some embodiments may be particularly useful for detecting and compensating for errors observed during carotid imaging applications such as detecting errors due to swallowing or head nodding. Certain embodiments may be implemented using existing legacy imaging systems which are adapted to utilize the methods described herein.

According to one embodiment an imaging system may be provided which comprises a processing device configured to receive raw image data. The processing device may be configured to analyze correlation factors between a plurality of image scans and calculate an error function corresponding to the correlation of the plurality of image scans e.g. comparing a subset of k space lines to another sub set or comparing an image frame to another image frame. The processing device may be further configured to output a control signal to a transducer device which instructs the transducer to reacquire a particular image scan of the plurality of image scans in the event that the error function indicates that corrupt data has been received. Alternatively other corrective or compensating measure may be triggered in response to the detection of corrupted data. For example the processor may implement parallel imaging or constrained reconstruction techniques in response to particular properties of the error function.

An additional embodiment provides for a self navigating method to compensate for motion of a subject being imaged. The method includes receiving image acquisition data and analyzing correlation information of the image acquisition data between a plurality of points in k space. The method further includes calculating an error function corresponding to the correlation information and determining whether new acquisition data is needed for a particular point in k space. If new acquisition data is needed embodiments may be configured to receive new acquisition data for the particular point in k space and reconstruct an image using the new acquisition data.

A further embodiment provides a computer program product having a computer readable media including instructions encoded thereon. When the instructions are executed the computer program product may cause a device to receive image data which has a plurality of sequences wherein at least one of the sequences are corrupted by motion of a subject being imaged. With the received sequences the program may analyze a correlation between the at least one corrupted sequence and an adjacent sequence of the plurality of sequences and calculate an error function corresponding to the correlation. Based on the error function the program may detect identify the corrupted sequence. In certain embodiments the program may e.g. in response to the detection of the corrupted sequence also acquire additional sequence data to replace the corrupted sequence in order to generate a reconstructed image.

The foregoing has outlined rather broadly the features and technical advantages of the present invention in order that the detailed description of the invention that follows may be better understood. Additional features and advantages of the invention will be described hereinafter which form the subject of the claims of the invention. It should be appreciated by those skilled in the art that the conception and specific embodiment disclosed may be readily utilized as a basis for modifying or designing other structures for carrying out the same purposes of the present invention. It should also be realized by those skilled in the art that such equivalent constructions do not depart from the spirit and scope of the invention as set forth in the appended claims. The novel features which are believed to be characteristic of the invention both as to its organization and method of operation together with further objects and advantages will be better understood from the following description when considered in connection with the accompanying figures. It is to be expressly understood however that each of the figures is provided for the purpose of illustration and description only and is not intended as a definition of the limits of the present invention.

In portions of the following description embodiments are illustrated in terms of a carotid imaging application. It is noted that the inventive aspects discussed herein are not limited in application to carotid imaging but may likewise be used in many imaging applications. For example the present methods may be used in brain or extremity imaging. Imaging implementations may be implemented anywhere on a subject where motion occurs occasionally and over brief intervals. Further inventive aspects discussed herein may be used when imaging any type of subjects e.g. humans animals machines devices etc. and while monitoring any form of undesired movement therein. The specific examples are utilized for descriptive purposes only and are not intended to be limiting. Alterations and further modifications of the inventive features illustrated herein and additional applications of the principles of the inventions as illustrated herein which would occur to one skilled in the relevant art and having possession of this disclosure are to be considered within the scope of the invention.

Directing attention to an imaging system adapted according to an embodiment of the present invention is shown as imaging system . Imaging system comprises processor based system operatively coupled to transducer for use in collecting imaging data with respect to subject . For example subject may comprise a patient for which imaging of a portion of the patient s body e.g. head torso leg shoulder etc. is desired. Such imaging as provided by imaging system may comprise reconstruction of images of internal body structure e.g. organs cavities bones etc. using one or more imaging modalities e.g. computed tomography CT magnetic resonance imaging MRI positron emission tomography PET etc. .

Processor based system of certain embodiments comprises a processor e.g. central processing unit CPU application specific integrated circuit ASIC etc. memory e.g. random access memory RAM read only memory ROM disk memory optical memory etc. and appropriate input output I O apparatus e.g. display pointing device keyboard printer speaker microphone etc. operable under control of an instruction set e.g. software firmware etc. defining operation as described herein. Such operation may provide image reconstruction using one or more imaging modality corresponding to the configuration of transducer . For example where a CT imaging modality is utilized transducer may comprise an X ray source and detector configuration where a MR imaging modality is utilized transducer may comprise a magnetic field generator and receiver configuration and where a PET imaging modality is utilized transducer may comprise a gamma ray source and detector configuration.

In some embodiments processor based system functions to control the hardware for data acquisition at transducer . Further in these embodiments the acquired data is sent through network medium to secondary processing system where reconstruction takes place. In these embodiments the secondary processing system may recognize corrupt data and send a signal to processor based system to reacquire portions of information. In other embodiments processor based system controls both transducer and implements all reconstruction processing and detection of corrupt data.

Imaging system of certain embodiments herein is adapted to utilize an image reconstruction framework to compensate for motion of a subject such as non rigid body or out of plane motion in an image reconstruction technique implemented thereby. An image reconstruction framework as may be utilized by imaging system is shown in as image reconstruction framework . Image reconstruction framework may be implemented in whole or in part as instructions operable upon the processor of processor based system and or secondary processing system of imaging system .

According to embodiments of the invention image reconstruction framework utilizes captured raw imaging data information of a particular imaging modality and implements processing methods to compensate for corrupted data e.g. or motion of a subject being imaged. Accordingly image reconstruction framework of the illustrated embodiment includes an acquisition system which functions to acquire imaging data and image reconstruction processing module which provides 2D and or 3D image reconstruction processing. Acquisition system may be embodied as imaging system or a portion thereof as discussed above. Acquisition data is sent to image reconstruction processing module . Further other parameters useful to image construction processing may be provided to image reconstruction processing module by acquisition system or image system data module . Such additional parameters may include information regarding the modality of data being received by acquisition system information regarding acquisition system such as coil sensitivities and the like additional sensor information related to the subject being imaged pressure sensor data vital statistic data etc. reference values related to patients or to a particular diagnostic procedure for signal processing etc.

Image reconstruction processing module comprises motion compensation block . Motion compensation block functions to receive acquisition data and to determine whether motion compensation processes should be undertaken whether additional acquisition scans are and or other compensation actions should be triggered for a particular location or portion of raw image data of a subject being imaged and whether other processing blocks such as parallel imaging block or constrained reconstruction block should be utilized to compensate for motion. In accordance with some embodiments described motion compensation block may be configured to compensate for both out of plane and non rigid body motion. Once image reconstruction processing module has completed its processing image reconstruction processing module outputs reconstructed image data. Such image data may be stored by a memory device which is either internal or external to image reconstruction framework and or the image data may be output to display device .

Image acquisition data e.g. captured by acquisition system may be received at by image reconstruction processing module and sent to motion compensation block . Motion compensation block functions to analyze correlation between a plurality of points in k space in operation . Such points may be adjacent directly in sequence or may be selected in accordance with other predetermined considerations which may select points that will be known to have some expected correlation. In some embodiments two points of k space are sufficient for analysis while other embodiments may utilize additional points.

Motion compensation block may then function to calculate the error function between the analyzed points of k space in operation . Examples of methods for error function calculation are discussed in detail below. With the error function data the method correlates the object motion such as in plane rigid body with the error function in operation .

Some embodiments may determine whether motion compensation should be rendered by motion compensation block . Such compensation may require additional data to be acquired from acquisition system . In some embodiments the error function may be minimal and no further compensation is undertaken. In other embodiments errors may be compensated for by utilizing additional processing techniques at operation . For example these processing techniques may include parallel imaging or constrained reconstruction techniques which may be implemented by parallel imaging block or constrained reconstruction block respectively. It is noted that these additional processing techniques may also be implemented within image reconstruction block .

In parallel imaging techniques a reduced data set in the phase encoding direction s of k space is acquired to shorten acquisition time combining the signal of several coil arrays on a transducer. The spatial information related to the phased array coil elements is utilized for filling in missing information corresponding to empty bins. Temporally constrained reconstruction techniques apply an a priori constraint that assumes that the object is not going to change very rapidly from one image bin to the next image bin. With the assumption that the changes in a given image will be relatively small with respect to a previous image an iterative algorithm may be utilized that uses the data measured along with these constraints and converges on the set of images that satisfy the constraints and satisfy the measured data. Any method such as discussed above which is able to compensate for a perceived error function may be utilized separately or in combination at block in order to yield a satisfactory result.

In some circumstances the error function will connote that the acquired data will have greater than acceptable impact on the reconstructed image. In such cases some embodiments may utilize motion compensation block to instruct image acquisition system to retrieve further data for the particular portions of k space being analyzed at block . With the newly acquired data embodiments may repeat the analysis and error function calculations or the new data may be sent directly to image reconstruction block .

Image reconstruction block will then function to output reconstructed image data. As part of image reconstruction block certain embodiments may compensate for parameters of the acquisition system. In such an event these embodiments may compensate for various acquisition system parameters. For example image data or signal intensity may be effected by parameters of an acquisition system such as the coil sensitivity profile of an MRI device. To compensate for this some embodiments may convolve the received image data with a Fourier transform of the receive coil s sensitivity profile.

In some embodiments of the present invention function data is detected that is corrupted by out of plane or non rigid body motion. Certain embodiments may utilize the fact that two adjacent points in k space will typically show some degree of correlation. This correlation can occur when the object being imaged does not fill the entire Field of View FOV or when the object s signal intensity is modified by the receive coil s sensitivity profile. In the latter case the k space data may be convolved with the Fourier transform of the receive coil s sensitivity profile which introduces correlations between data points.

These data correlations can be exploited with a proposed self navigating technique to detect various types of object motion. Consider an image acquisition that is divided into Nsegments that each sample a set of equally spaced k space lines with a sampling function 

The following description of describe example implementations and results of embodiments of the present invention. The specific methods used in this example are described for illustrative purposes only to facilitate one of ordinary skill in the art in understanding the concepts described herein and are not intended to limit the scope of the concepts. All data sets were obtained on a Siemens Trio 3T MRI scanner.

Turbo Spin Echo TSE 2D axial neck images were obtained from two subjects using a 2 element surface coil one anterior and one posterior coil and a third subject using a 4 element surface coil. Data from the first subject was acquired with 256 252 pixels a resolution of 0.8 mm 0.8 mm 5 mm TR 1.5 s TE 6.8 ms and 7 echoes per echo train. Data from the second subject B and was acquired with 512 512 pixels a resolution of 0.35 mm 0.35 mm 5 mm TR 1.5 s TE 8.6 ms and 16 echoes per echo train.

For the third subject reacquiring data prospectively was simulated by acquiring two complete data averages the first data average is acquired with subject motion while the second data average is acquired with no motion. Once the corrupt data segments are identified in the first average they are replaced with data from the second average. This replaced data is similar to what would have been received if the data was reacquired. The data from the third subject was acquired with a resolution of 0.6 mm 0.6 mm 2 mm 12 echoes per segment 2 averages 22 segments to fill k space and a TRITE of 2.5 s 61 ms.

To measure the dispersion of the error function embodiments may determine rigid body translation dx t and dy t in Equation 5 by measuring the offset of the correlation function from the origin. The dispersion of the error function may then be measured with a weighted summation such that pixels far from the error function s origin expected to increase with error function broadening contribute more significantly to the total summation. While several weighting schemes have been tested a simple linear weighting has been used to obtain robust results. Additionally since the maximum value of c x y t varies depending on which two data segments are compared c x y t can be normalized to unity prior to measuring dispersion. In this case the error function is estimated as 

Since the error function in Equation 5 is aliased and two dimensional embodiments may only display the central portion of a profile through the origin of the error function in the phase encode direction . While showing just a profile of a two dimensional error function does not yield a complete picture in some embodiments it may be sufficient for display purposes to show a trend or general concept. The actual motion detection is based on the dispersion of the error function Equation 6 and can consider the two dimensional error function rather than the profiles shown in the figures.

It is noted that the signals received which are used to detect object motion may also dependent on the sensitivity profile of the coil element being considered. illustrates effects of varying sensitivities of a two element coil in accordance with an embodiment of the present invention. While both elements were almost equally sensitive to the subject rotating their neck as shown in the anterior element was more sensitive to subject swallowing than the posterior element in .

With the error function data embodiments of the proposed self navigating correction technique is applied to a subject neck study as shown in . The motion corrupted image is shown in with the corrected image shown in . Several corrupt data segments appear in the original error function dispersion of . Once these corrupt data segments are replaced with reacquired data the error function dispersion no longer shows the presence of the corrupted data segments at in .

Accordingly rigid body translation can be detected and compensated using the correlation of adjacent data segments. Embodiments of the present invention further detect data measurements corrupted by other types of motion such as out of plane or non rigid body motions caused for example by swallowing or head movement. When such data is detected motion corrupted measurements may be reacquired or eliminated during reconstruction. This error function based motion detection method may implemented with the assistance of two assumptions First in the absence of motion the error function obtained from the correlation of any two adjacent data segments remains strongly peaked near the origin. Second when motion not classified as non rigid body translation occurs the error function becomes spread or dispersed with a greatly diminished or missing peak.

It is noted that a combination of rigid body translation with other types of object motion such as out of plane motion or swallowing may distort the error function appreciably so that it is difficult to quantify the rigid body translation. However even if the rigid body translation could be quantified in this case the data would still be corrupted with the other types of motion and a correction of just rigid body translation would result in limited improvements.

Some embodiments may also compensate for observed data that is analyzed in a retrospective manner. In this case even when the object s motion occurs over a single segment of data two segment comparisons with correspondingly high measures of dispersion are observed. For example in the second study in where the subject swallowed during the acquisition of the 22data segment both the error functions at L 21 comparing the 21and 22data segments and at L 22 comparing the 22and 23data segments show a large dispersion. Hence object motion will typically result in two or more closely spaced peaks in the measure of error function dispersion. In this case the motion corrupted segment is detected as the only segment with high dispersion on both adjacent comparisons. Segments that have a high dispersion in only one adjacent comparison are likely not corrupted by motion. Motions over longer periods of time can involve more segments and require a more complicated analysis to determine which lines are corrupted.

The proposed technique detects in which segment motion is likely to have occurred but embodiments need not attempt to quantify the motion or discern the type. Additional information about the motion type can be discerned by analyzing individual coils. When two channel coils are utilized the posterior receive coil is less sensitive to swallowing than the anterior receive coil because motion in the neck due to swallowing is mostly limited to the anterior portion of the neck. Conversely both receive coils appear to be equally sensitive to the rotation since the entire image is affected by that type of motion. One point of interest is that the anterior element appears to detect the rotation one segment earlier than the posterior element . It is noted that while lying on a table a rotation of the neck tends not to be rigid body and the rotation is about a point in the posterior of the neck rather than the middle. As a result the anterior part of the neck moves more than the posterior during the rotation and may therefore be detected as moving first.

In most imaging cases the number of corrupted data segments is small and the corrupted lines can be reacquired or can be recreated using parallel imaging techniques a constrained reconstruction or a variety of other methods which are suitable for compensating for motion. When segmented data is acquired in sets of adjacent lines in k space as it is often done in TSE and segmented GRE techniques embodiments correlate data between sets to detect various types of motion. While in most cases the motion can not be fully quantified the present methods provide a valuable and simple way to detect corrupted data so that it can be reacquired prospectively or removed from the data set retrospectively.

Although the present invention and its advantages have been described in detail it should be understood that various changes substitutions and alterations can be made herein without departing from the spirit and scope of the invention as defined by the appended claims. Moreover the scope of the present application is not intended to be limited to the particular embodiments of the process machine manufacture composition of matter means methods and steps described in the specification. As one of ordinary skill in the art will readily appreciate from the disclosure of the present invention processes machines manufacture compositions of matter means methods or steps presently existing or later to be developed that perform substantially the same function or achieve substantially the same result as the corresponding embodiments described herein may be utilized according to the present invention. Accordingly the appended claims are intended to include within their scope such processes machines manufacture compositions of matter means methods or steps.

