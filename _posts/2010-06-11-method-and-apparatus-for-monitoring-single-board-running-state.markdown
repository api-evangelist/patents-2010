---

title: Method and apparatus for monitoring single board running state
abstract: A method and an apparatus for monitoring single board running state are disclosed in the present invention. The above method comprises: establishing an Module Management Controller (MMC) communication channel between a slave board and a master control board when the slave board is powered up; and the slave board reporting running state information of the slave board to the master control board by the MMC communication channel according to one or more preset monitor information points. In the present invention, by the MMC function channel under the uTCA architecture, the slave board reports the master control board the running state of the working process from the moment of being powered-up to the time when the system runs stably, which solves the problem in the conventional art that the monitoring on the single aboard is incomprehensive and can record the running state of the slave board completely.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08799546&OS=08799546&RS=08799546
owner: ZTE Corporation
number: 08799546
owner_city: Shenzhen
owner_country: CN
publication_date: 20100611
---
This application represents a National Stage application of PCT CN2010 073838 entitled Method and Device for Monitoring Running State of Card filed Jun. 11 2010 pending.

The present invention relates to communication field and in particular to a method and an apparatus for monitoring single board running state.

Currently series of base stations of wireless communication use the Micro Telecom Computing Architecture uTCA increasingly and perform communication work by using the inter coordination between the master control board and the slave board. In the base station system of a wireless communication system monitoring the whole running process of the base station is critical. By monitoring the running process the single board and system condition can be controlled to the greatest extent providing troubleshooting basis for technical personnel and users. When a part of the single board have broken down for example it does not work after being powered up and the system cannot load normally and so on it is required to know what degree the single board runs to and what step is executed where the problem lies. Therefore during the running of the system monitoring single board running state as soon as possible and as much as possible has important meaning to system maintenance.

According to the conventional art the powered up running state of the single board is recorded after system initialization and the monitoring is carried out by a monitoring process for example the recording is carried out by using black box technology or single board alerting. However all these technologies are carried out on the basis of the operating system or by using the functions of the operating system after the single board is powered up successfully but when the single board breaks down during the power up process and the power up initialization is not completed so the operating system cannot be accessed these monitoring means will not work. If the power up of the single board breaks down the tools or devices that other monitoring means are dependent on have not been initialized yet and since the monitoring mechanism itself has not been built up the single board running state during this time period cannot be monitored. When the structure of the system itself is simple and the environmental resources are not enough to provide some communication modes such as network port and so on monitoring is also very difficult. At the same time under uTCA architecture each of the slave boards reports the information by the network port and once the network port appears abnormal it will cause all the information fails to be reported.

Therefore in order to monitor the running process of the system single board more comprehensively the monitoring has to be carried out since the single board is powered up. However no effective solution has been proposed in the conventional art.

The present invention is made upon considering the problem that the monitoring on the single board in the conventional art is incomprehensive and for this end the main object of the present invention is to provide a method and an apparatus for monitoring single board running state so as to solve the above problems in the conventional art.

A method for monitoring single board running state is provided according to one aspect of the present invention.

The method according to the present invention comprises establishing an Module Management Controller MMC communication channel between a slave board and a master control board when the slave board is powered up and the slave board reporting running state information of the slave board to the master control board by the MMC communication channel according to one or more preset monitor information points.

Preferably the step of the slave board reporting the running state information of the slave board to the master control board by the MMC communication channel further comprises the slave board sending the running state information of the slave board to an MMC and the MMC forwarding the running state information of the slave board to the master control board by an Intelligent Platform Management Interface IPMI channel.

Preferably the step of the slave board sending the running state information of the slave board to the MMC further comprises the slave board sending the running state information to the MMC by writing CPU serial port register when the initialization of a serial port which is used to communicate between the slave board and the MMC has been not completed and the slave board sending the running state information to the MMC by invoking a standard writing interface when the initialization of the serial port which is used to communicate between the slave board and the MMC has been completed.

Preferably when the slave board sends the running state information of the slave board to the MMC a preset time delay is added and or the running state information of the slave board is less than 20 bytes.

Preferably the monitor information points are used to indicate the running state of the running stages of the slave board wherein the running stages comprise at least one of the following an assembly code running stage a CPU minimum support system running stage a boot extended application execution stage a single board control running stage and an upper applications running stage.

An apparatus for monitoring single board running state is also provided according to another aspect of the present invention.

The apparatus according to the present invention comprises an establishment module configured to establish an MMC communication channel between a slave board and a master control board when the slave board is powered up and a reporting module configured to report running state information of the slave board to the master control board by the MMC communication channel according to one or more preset monitor information points.

Preferably the reporting module further comprises a first reporting sub module configured to send the running state information of the slave board to an MMC and a second reporting sub module configured for the MMC to forward the running state information of the slave board to the master control board through an PMI channel.

Preferably the first reporting sub module sends the running state information to the MMC by writing CPU serial port register or by invoking a standard writing interface.

Preferably the apparatus further comprises a setting module configured to preset one or more monitor information points wherein the monitor information point is used to indicate the running state of the running stages of the slave board wherein the running stages comprise at least one of the following an assembly code running stage a CPU minimum support system running stage a boot extended application execution stage a single board control running stage and an upper applications running stage.

According to the above technical solution of the present invention by the MMC function channel of the uTAC architecture the slave board reports the master control board the running state of the working process from the moment of being powered up to the time when the system runs stably which solves the problem in the conventional art that the monitoring on the single board is incomprehensive and can record the running state of the slave board completely so that the running state of the slave board can still be gathered in the case that the conventional monitoring means are not effective and it has important meaning for being referenced in system maintain and troubleshooting.

The main idea of the present invention mainly lies in the following by using the Module Management Controller MMC functional channel under the uTCA architecture the slave board reports the master control board the running state of the working process from the moment of being powered up to the time when the system runs stably which solves the problem in the conventional art that the monitoring on the single board is incomprehensive. By the present invention the running state of the slave board can be recorded completed and it has important meaning for being referenced by system maintain and troubleshooting. It is needed to note that the present invention is not only suitable for the base station systems with Code Division Multiple Access CDMA digital wireless technology but also suitable for the wireless communication base station systems with other communication systems such as World Interoperability for Microwave Access WiMAX Time Division Synchronous CDMA TD SCDMA Wideband CDMA WCDMA Global System for Mobile Communications GSM and so on.

For clearer understanding of the objects technical solutions and advantages of the present invention the present invention will be further described in detail hereinbelow with reference to the accompanying drawings and particular embodiments.

A method for monitoring single board running state is proposed according to the embodiments of the present invention. is a flowchart of a method for monitoring single board running state according to the embodiments of the present invention. As shown in the method comprises 

Step S establishing an MMC communication channel between a slave board and a master control board when the slave board is powered up and

Step S the slave board reporting the running state information of the slave board to the master control board by the MMC communication channel according to one or more preset monitor information points.

In order to make the slave board report the running state information as early as possible it is needed to establish a reporting channel to the master control board at the beginning of the slave board being powered up. Therefore the MMC communication channel should be initialized when the single board executes the assembly code immediately after being powered up. In particular the serial port which communicates with the MMC is initialized by the assembly code so that it is guaranteed that the slave board can report the running state information thereof completely. On the slave board after having received the data the MMC parses the received data and forwards it to the master control board by an Intelligent Platform Management Interface IPMI channel. The frame architectures of the master control board and the slave board can be known by referring to the master control board communicates with the slave board via a backboard and a running state reporting module of the slave board reports the running state data to a running state recording module of the master control board.

Step S the master control board starts up a message to receive monitoring process and prepares for receiving the running state data reported from the slave board at any time then guarantees the smoothness and accuracy of the MMC communication channel between the master control board and the slave board and ensures that the master control board has certain resources such as storage space task scheduling execution etc. in order to get ready for the preparation work of the monitoring process.

Step S determining whether the information of the monitor information points is reported. The single board running state can be divided into several stages and referring to the single board running state comprises an assembly code running stage a CPU minimum support system running stage a boot extended application execution stage a single board control running stage and an upper applications running stage. According to the monitoring requirements one or more monitory points can be arranged at each stage so as to monitor various running conditions of the single board. The general reporting procedure is starting reporting the start up state since executing the assembly code initialization at the being powered up stage and then selecting a start up point to send data to the MMC during the booting of the Boot application program. Analogically some specific stage points are selected to report the start up state at the single board control stage and the upper applications program stage. Certainly as to the running stage in which the monitoring is not needed it is also possible not to set the monitor information points.

Step S the start up track of the monitor information points is reported by the MMC and the. MMC parses the received message and then reports the message data to the master control board by the IPMI channel.

Step S after having received the data a message receiving process which resides on the master control board parses the data and records the data into a corresponding database.

Step S determining whether the running of the slave board is completed wherein if the running of the slave board not completed then Step S is performed otherwise this process is ended.

The slave board has some Power On Self Test POST during the powered start up process and the results of the POST will also be reported to the master control board together with the message. If the start up of the slave board being powered is successful then there are complete running state records and various detection results in the start up records and if the start up is failed then the recording will be persisted until the last moment before the start up fails and some POST results of this duration will be recorded. After the above processing the user invokes a corresponding command to look over the database on the master control board which can look up the track of the whole start up process of the corresponding slave board. The records of the track can be marked by using a series of code flag and when it is required to know the specific contents it is only needed to compare the recorded code flag and the corresponding reference table.

It is needed to note that since the CPU serial port cache buffer is small in order to avoid the data from being covered before being sent out the data frame format sent by the slave board to the MMC should be as simple as possible and certain time delay should be added when writing data to the serial port. is a flowchart of MMC communication according to the embodiments of the present invention and referring to at the later stage of the single board being started up after the MMC communication serial port device is initialized the serial port will be initialized as a standard I O device to perform the read and writing at this moment the serial port cannot be directly operated by writing CPU register again but data needs to be sent to the serial port through a writing Application Programming Interface API . Preferably the length of data frames sent by the slave board to the MMC should be less than 20 bytes.

By the above embodiments the running state of the single board from the moment of being powered up to the time when the whole system works stably can be monitored quite comprehensively which forms a link monitor means and can fill up some blank stages of single board monitoring in the conventional art. The embodiments of the present invention skilfully use the MMC function channel in the uTCA architecture such that the running state of the slave board can still be gathered in the case that the conventional channel is not effective.

According to the embodiments of the present invention an apparatus for monitoring single board running state is provided. The apparatus can be used to realize the method for monitoring single board running state which is provided by the above method embodiments.

As shown in the apparatus for monitoring single board running state according to the embodiments of the present invention comprises an establishment module and a reporting module . In the case the establishment module is configured to establish an MMC communication channel between a slave board and a master control board when the slave board is powered up and the reporting module connected to the establishment module is configured to report the running state information of the slave board to the master control board by the MMC communication channel according to one or more preset monitor information points.

As shown in based on the structure shown in the reporting module further comprises a first reporting sub module configured to send the running state information of the slave board to the MMC and a second reporting sub module configured for the MMC to forward the running state information of the slave board to the master control board through an IPMI channel. In the case the first reporting sub module sends the running state information to the MMC by writing CPU serial port register or by invoking a standard writing interface. Particularly the first reporting sub module operates the serial port by writing CPU register at the early stage of the single board s start up and the first reporting sub module sends data to the serial port of the MMC by invoking the standard writing interface at the later stage of the single board s start up.

It can be known from the above description that preferably the first reporting sub module is located at the slave board and the second reporting sub module is located at MMC. During the process that the first reporting sub module sends data to the second reporting sub module the data frame has to be as simple as possible and is preferably less than 20 bytes and when sending the data certain data delay may be added to avoid the running state data from being deleted before being sent out. The apparatus for monitoring single board running state according to this embodiment can also comprise a running state recording module located at the master control board and connected to the second reporting sub module which is configured to receive the running state data reported by the second reporting sub module .

In addition the apparatus can further comprise a setting module not shown configured to preset one or more monitor information points wherein the monitor information points are used to indicate the running state of the running stages of the slave board wherein the running stages comprises at least one of the following an assembly code running stage a CPU minimum support system running stage a boot extended application execution stage a single board control running stage and an upper applications running stage.

In the specific implementation the specific working procedure of the apparatus for monitoring single board running state provided by the embodiments of the present invention can be known referring to the procedures shown in .

In summary according to the above technical solution of the present invention by the MMC function channel under the uTCA architecture the slave board reports the master control board the running state of the working process from the moment of being powered up to the time when the system runs stably which solves the problem in the conventional art that the monitoring on the single aboard is incomprehensive and can record the running state of the slave board completely so that the running state of the slave board can still be gathered in the case that the conventional channel is not effective and it has important meaning for being referenced by system maintain and troubleshooting.

Above description is only to illustrate the preferred embodiments but not to limit the present invention. Various alterations and changes to the present invention are apparent to those skilled in the art. The scope defined in claims shall cover any modification equivalent substitution and improvement within the spirit and principle of the present invention.

