---

title: Transmitting keep-alive packets on behalf of a mobile communications device within a wireless communications system
abstract: In an embodiment, a mobile communications device (MCD) is positioned within an internal network that is separated from an external network by network address translation (NAT) and/or a firewall. The MCD establishes settings with the NAT and/or firewall by which the MCD can be contacted through from the external network. The settings are configured to be disabled by the NAT and/or firewall after a threshold period of traffic inactivity. An application server receives information associated with the settings, and instructs an assisting application server (AAS) within the internal network to transmit keep-alive packets on behalf of the MCD so as to maintain the settings for the MCD. The AAS receives the instructions from the application server, and instructs an assisting wireless communications device (WCD) within the internal network to transmit keep-alive packets on behalf of the MCD. The WCD then transmits the keep-alive packets in accordance with the instructions.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08490174&OS=08490174&RS=08490174
owner: QUALCOMM Incorporated
number: 08490174
owner_city: San Diego
owner_country: US
publication_date: 20101118
---
Embodiments of the invention relate to transmitting keep alive packets on behalf of a mobile communications device within a wireless communications system.

Wireless communication systems have developed through various generations including a first generation analog wireless phone service 1G a second generation 2G digital wireless phone service including interim 2.5G and 2.75G networks and a third generation 3G high speed data Internet capable wireless service. There are presently many different types of wireless communication systems in use including Cellular and Personal Communications Service PCS systems. Examples of known cellular systems include the cellular Analog Advanced Mobile Phone System AMPS and digital cellular systems based on Code Division Multiple Access CDMA Frequency Division Multiple Access FDMA Time Division Multiple Access TDMA the Global System for Mobile access GSM variation of TDMA and newer hybrid digital communication systems using both TDMA and CDMA technologies.

The method for providing CDMA mobile communications was standardized in the United States by the Telecommunications Industry Association Electronic Industries Association in TIA EIA IS 95 A entitled Mobile Station Base Station Compatibility Standard for Dual Mode Wideband Spread Spectrum Cellular System referred to herein as IS 95. Combined AMPS CDMA systems are described in TIA EIA Standard IS 98. Other communications systems are described in the IMT 2000 UM or International Mobile Telecommunications System 2000 Universal Mobile Telecommunications System standards covering what are referred to as wideband CDMA W CDMA CDMA2000 such as CDMA2000 1xEV DO standards for example or TD SCDMA.

In W CDMA wireless communication systems user equipments UEs receive signals from fixed position Node Bs also referred to as cell sites or cells that support communication links or service within particular geographic regions adjacent to or surrounding the base stations. Node Bs provide entry points to an access network AN radio access network RAN which is generally a packet data network using standard Internet Engineering Task Force IETF based protocols that support methods for differentiating traffic based on Quality of Service QoS requirements. Therefore the Node Bs generally interact with UEs through an over the air interface and with the RAN through Internet Protocol IP network data packets.

In wireless telecommunication systems Push to talk PTT capabilities are becoming popular with service sectors and consumers. PTT can support a dispatch voice service that operates over standard commercial wireless infrastructures such as W CDMA CDMA FDMA TDMA GSM etc. In a dispatch model communication between endpoints e.g. UEs occurs within virtual groups wherein the voice of one talker is transmitted to one or more listeners. A single instance of this type of communication is commonly referred to as a dispatch call or simply a PTT call. A PTT call is an instantiation of a group which defines the characteristics of a call. A group in essence is defined by a member list and associated information such as group name or group identification.

In an embodiment a mobile communications device MCD is positioned within an internal network that is separated from an external network by network address translation NAT and or a firewall. The MCD establishes settings with the NAT and or firewall by which the MCD can be contacted through from the external network. The settings are configured to be disabled by the NAT and or firewall after a threshold period of traffic inactivity. An application server receives information associated with the settings and instructs an assisting application server AAS within the internal network to transmit keep alive packets on behalf of the MCD so as to maintain the settings for the MCD. The AAS receives the instructions from the application server and instructs an assisting wireless communications device WCD e.g. using the same air interface mechanism as the MCD located within the internal network to transmit keep alive packets on behalf of the MCD. The WCD then transmits the keep alive packets in accordance with the instructions.

Aspects of the invention are disclosed in the following description and related drawings directed to specific embodiments of the invention. Alternate embodiments may be devised without departing from the scope of the invention. Additionally well known elements of the invention will not be described in detail or will be omitted so as not to obscure the relevant details of the invention.

The words exemplary and or example are used herein to mean serving as an example instance or illustration. Any embodiment described herein as exemplary and or example is not necessarily to be construed as preferred or advantageous over other embodiments. Likewise the term embodiments of the invention does not require that all embodiments of the invention include the discussed feature advantage or mode of operation.

Further many embodiments are described in terms of sequences of actions to be performed by for example elements of a computing device. It will be recognized that various actions described herein can be performed by specific circuits e.g. application specific integrated circuits ASICs by program instructions being executed by one or more processors or by a combination of both. Additionally these sequence of actions described herein can be considered to be embodied entirely within any form of computer readable storage medium having stored therein a corresponding set of computer instructions that upon execution would cause an associated processor to perform the functionality described herein. Thus the various aspects of the invention may be embodied in a number of different forms all of which have been contemplated to be within the scope of the claimed subject matter. In addition for each of the embodiments described herein the corresponding form of any such embodiments may be described herein as for example logic configured to perform the described action.

A High Data Rate HDR subscriber station referred to herein as a user equipment UE may be mobile or stationary and may communicate with one or more access points APs which may be referred to as Node Bs. A UE transmits and receives data packets through one or more of the Node Bs to a Radio Network Controller RNC . The Node Bs and RNC are parts of a network called a radio access network RAN . A radio access network can transport voice and data packets between multiple UEs.

The radio access network may be further connected to additional networks outside the radio access network such core network including specific carrier related servers and devices and connectivity to other networks such as a corporate intranet the Internet public switched telephone network PSTN a Serving General Packet Radio Services GPRS Support Node SGSN a Gateway GPRS Support Node GGSN and may transport voice and data packets between each UE and such networks. A UE that has established an active traffic channel connection with one or more Node Bs may be referred to as an active UE and can be referred to as being in a traffic state. A UE that is in the process of establishing an active traffic channel TCH connection with one or more Node Bs can be referred to as being in a connection setup state. A UE may be any data device that communicates through a wireless channel or through a wired channel. A UE may further be any of a number of types of devices including but not limited to PC card compact flash device external or internal modem or wireless or wireline phone. The communication link through which the UE sends signals to the Node B s is called an uplink channel e.g. a reverse traffic channel a control channel an access channel etc. . The communication link through which Node B s send signals to a UE is called a downlink channel e.g. a paging channel a control channel a broadcast channel a forward traffic channel etc. . As used herein the term traffic channel TCH can refer to either an uplink reverse or downlink forward traffic channel.

Referring back to the components of the wireless communications system and interrelation of the elements of the exemplary embodiments of the invention are not limited to the configuration illustrated. System is merely exemplary and can include any system that allows remote UEs such as wireless client computing devices to communicate over the air between and among each other and or between and among components connected via the air interface and RAN including without limitation core network the Internet PSTN SGSN GGSN and or other remote servers.

The RAN controls messages typically sent as data packets sent to a RNC . The RNC is responsible for signaling establishing and tearing down bearer channels i.e. data channels between a Serving General Packet Radio Services GPRS Support Node SGSN and the UEs . If link layer encryption is enabled the RNC also encrypts the content before forwarding it over the air interface . The function of the RNC is well known in the art and will not be discussed further for the sake of brevity. The core network may communicate with the RNC by a network the Internet and or a public switched telephone network PSTN . Alternatively the RNC may connect directly to the Internet or external network. Typically the network or Internet connection between the core network and the RNC transfers data and the PSTN transfers voice information. The RNC can be connected to multiple Node Bs . In a similar manner to the core network the RNC is typically connected to the Node Bs by a network the Internet and or PSTN for data transfer and or voice information. The Node Bs can broadcast data messages wirelessly to the UEs such as cellular telephone . The Node Bs RNC and other components may form the RAN as is known in the art. However alternate configurations may also be used and the invention is not limited to the configuration illustrated. For example in another embodiment the functionality of the RNC and one or more of the Node Bs may be collapsed into a single hybrid module having the functionality of both the RNC and the Node B s .

Generally GPRS is a protocol used by Global System for Mobile communications GSM phones for transmitting Internet Protocol IP packets. The GPRS Core Network e.g. the GGSN and one or more SGSNs is the centralized part of the GPRS system and also provides support for W CDMA based 3G networks. The GPRS core network is an integrated part of the GSM core network provides mobility management session management and transport for IP packet services in GSM and W CDMA networks.

The GPRS Tunneling Protocol GTP is the defining IP protocol of the GPRS core network. The GTP is the protocol which allows end users e.g. UEs of a GSM or W CDMA network to move from place to place while continuing to connect to the internet as if from one location at the GGSN . This is achieved transferring the subscriber s data from the subscriber s current SSGN to the GGSN which is handling the subscriber s session.

Three forms of GTP are used by the GPRS core network namely i GTP U ii GTP C and iii GTP GTP Prime . GTP U is used for transfer of user data in separated tunnels for each packet data protocol PDP context. GTP C is used for control signaling e.g. setup and deletion of PDP contexts verification of GSN reachability updates or modifications such as when a subscriber moves from one SGSN to another etc. . GTP is used for transfer of charging data from GSNs to a charging function.

Referring to the GGSN acts as an interface between the GPRS backbone network not shown and the external packet data network or Internet . The GGSN extracts the packet data with associated packet data protocol PDP format e.g. IP or PPP from the GPRS packets coming from the SGSN and sends the packets out on a corresponding packet data network. In the other direction the incoming data packets are directed by the GGSN to the SGSN which manages and controls the Radio Access Bearer RAB of the destination UE served by the RAN . Thereby the GGSN stores the current SGSN address of the target UE and his her profile in its location register e.g. within a PDP context . The GGSN is responsible for IP address assignment and is the default router for the connected UE. The GGSN also performs authentication and charging functions.

The SGSN is representative of one of many SGSNs within the core network A in an example. Each SGSN is responsible for the delivery of data packets from and to the UEs within an associated geographical service area. The tasks of the SGSN includes packet routing and transfer mobility management e.g. attach detach and location management logical link management and authentication and charging functions. The location register of the SGSN stores location information e.g. current cell current VLR and user profiles e.g. IMSI PDP address es used in the packet data network of all GPRS users registered with the SGSN for example within one or more PDP contexts for each user or UE. Thus SGSNs are responsible for i de tunneling downlink GTP packets from the GGSN ii uplink tunnel IP packets toward the GGSN iii carrying out mobility management as UEs move between SGSN service areas and iv billing mobile subscribers. As will be appreciated by one of ordinary skill in the art aside from i iv SGSNs configured for GSM EDGE networks have slightly different functionality as compared to SGSNs configured for W CDMA networks.

Referring to the RAN e.g. or UTRAN in Universal Mobile Telecommunications System UMTS system architecture communicates with the SGSN via an Iu interface with a transmission protocol such as Frame Relay or IP. The SGSN communicates with the GGSN via a Gn interface which is an IP based interface between SGSN and other SGSNs not shown and internal GGSNs and uses the GTP protocol defined above e.g. GTP U GTP C GTP etc. . While not shown in the Gn interface is also used by the Domain Name System DNS . The GGSN is connected to a Public Data Network PDN not shown and in turn to the Internet via a Gi interface with IP protocols either directly or through a Wireless Application Protocol WAP gateway.

The PDP context is a data structure present on both the SGSN and the GGSN which contains a particular UE s communication session information when the UE has an active GPRS session. When a UE wishes to initiate a GPRS communication session the UE must first attach to the SGSN and then activate a PDP context with the GGSN . This allocates a PDP context data structure in the SGSN that the subscriber is currently visiting and the GGSN serving the UE s access point.

Referring to the NAT Firewall is positioned between the GGSN and the Internet . The NAT Firewall separates the core network A from the Internet and or other core networks. For example the NAT Firewall may perform NAT functionality such that network address information in datagram IP packet headers that traverse the NAT portion are modified such that outgoing Internet Protocol IP packets appear to originate from the NAT portion instead of the originator of the IP packet. NAT can be implemented in a variety of schemes of translating addresses and or port numbers with each type of NAT scheme affecting application communication protocols differently. For example NAT types include full cone NAT also known as one to one NAT address restricted cone NAT port restricted cone NAT and symmetric NAT.

Firewalls can be implemented in hardware software or a combination of both. Firewalls are frequently used to prevent unauthorized Internet users from accessing private networks such as intranets that are connected to the Internet . The NAT Firewall is configured to permit or deny network transmissions based upon a set of rules and other criteria. All messages entering or leaving the intranet pass through the firewall which inspects each message and blocks those that do not meet the specified security criteria.

Firewalls often have functionality to protect hosts behind the network by implementing network address translation NAT functionality. The firewall provides private addresses as defined in RFC 1918 to the hosts protected behind a firewall. Once a pass through connection is opened through the firewall NAT translation association for the data session is often released within a few seconds of data inactivity for the session. Thus the NAT Firewall is used to collectively refer to the hardware and or software that performs the firewall and NAT functions for a particular intranet.

Referring to when the UE executes a client application that interacts with an application being hosted by the application server which is external to i.e. not behind the core network A it will be appreciated that this interaction must typically comply with the NAT and or firewall rules or settings of the core network A as enforced by the NAT Firewall . For example as will be described in greater detail below dormant or idle connections between the UE and the application server may be shut down by the NAT Firewall such that when the application server attempts to send data to the UE the connection requires re establishment. The UE can mitigate this problem somewhat by sending periodic keep alive packets over this connection during dormant or idle periods so that the NAT Firewall detects activity on the connection and refrains from shutting the connection down. However it will be appreciated that transmitting dummy packets in this manner drains battery life on the UE .

In the embodiment of the core network B includes a packet data serving node PDSN a broadcast serving node BSN and the NAT Firewall . Similar to the core network A of the components of the core network B are connected to an external data packet network or Internet and through the Internet are further connected to the application server . However it is appreciated that portions of the Internet and or other components may be located inside of the core network B in alternative embodiments.

Referring to the PDSN provides access to the Internet intranets and or remote servers e.g. application server for mobile stations e.g. access terminals such as from utilizing for example a CDMA2000 Radio Access Network RAN e.g. RAN of . Acting as an access gateway the PDSN may provide simple IP and mobile IP access foreign agent support and packet transport. The PDSN can act as a client for Authentication Authorization and Accounting AAA servers and other supporting infrastructure and provides mobile stations with a gateway to the IP network as is known in the art. As shown in the PDSN may communicate with the RAN e.g. the BSC RNC via a conventional A10 connection. The A10 connection is well known in the art and will not be described further for the sake of brevity.

Referring to the broadcast serving node BSN may be configured to support multicast and broadcast services. The BSN communicates with the RAN e.g. the BSC RNC via a broadcast BC A10 connection and with the application server via the Internet . The BCA10 connection is used to transfer multicast and or broadcast messaging. Accordingly the application server sends unicast messaging to the PDSN via the Internet and sends multicast messaging to the BSN via the Internet . Generally the RAN can transmit multicast messages received from the BSN via the BCA10 connection over a broadcast channel BCH of the air interface to one or more access terminals .

Referring to similar to the NAT Firewall is positioned between the PDSN and or BSN and the Internet . The NAT Firewall may be co located with the PDSN or may be logically implemented as a part of the PDSN . The NAT Firewall separates the core network B from the Internet and or other core networks. For example the NAT Firewall may perform NAT functionality such that network address information in datagram IP packet headers that traverse the NAT portion are modified such that outgoing Internet Protocol IP packets appear to originate from the NAT portion instead of the originator of the IP packet. NAT can be implemented in a variety of schemes of translating addresses and or port numbers with each type of NAT scheme affecting application communication protocols differently. For example NAT types include full cone NAT also known as one to one NAT address restricted cone NAT port restricted cone NAT and symmetric NAT.

Hereinafter references to components within the wireless communications system will for the most part be given with respect to W CDMA specific terminology for the sake of consistency such as Node B UE RNC GGSN SSGN etc. However it will be appreciated that any of the figures described below can be implemented within the W CDMA infrastructure e.g. as in EV DO infrastructure e.g. as in and or in accordance with infrastructure that conforms with other communication protocols.

While not shown explicitly in it will be appreciated that one or more NAT Firewalls can be positioned between the packet data network end points and and the Internet and or the servers and or . Also referring to UEs and . . . N are illustrated as wireless cell phones UE is illustrated as a wireless tablet PC and UE is illustrated as a wired desktop station. However in other embodiments it will be appreciated that the wireless communication system can connect to any type of UE and the examples illustrated in are not intended to limit the types of UEs that may be implemented within the system. Also while the AAA server the provisioning server the IMS SIP registration server and the application server are each illustrated as structurally separate servers one or more of these servers may be consolidated in at least one embodiment of the invention.

Further referring to the application server is illustrated as including a plurality of media control complexes MCCs . . . N B and a plurality of regional dispatchers . . . N A. Collectively the regional dispatchers A and MCCs B are included within the application server which in at least one embodiment can correspond to a distributed network of servers that collectively functions to arbitrate communication sessions e.g. half duplex group communication sessions via IP unicasting and or IP multicasting protocols within the wireless communication system . For example because the communication sessions arbitrated by the application server can theoretically take place between UEs located anywhere within the system multiple regional dispatchers A and MCCs are distributed to reduce latency for the arbitrated communication sessions e.g. so that a MCC in North America is not relaying media back and forth between session participants located in China . Thus when reference is made to the application server it will be appreciated that the associated functionality can be enforced by one or more of the regional dispatchers A and or one or more of the MCCs B. The regional dispatchers A are generally responsible for any functionality related to establishing a communication session e.g. handling signaling messages between the UEs scheduling and or sending announce messages etc. whereas the MCCs B are responsible for hosting the communication session for the duration of the call instance including conducting an in call signaling and an actual exchange of media during an arbitrated communication session.

Referring to a UE here a wireless device such as a cellular telephone has a platform that can receive and execute software applications data and or commands transmitted from the RAN that may ultimately come from the core network the Internet and or other remote servers and networks. The platform can include a transceiver operably coupled to an application specific integrated circuit ASIC or other processor microprocessor logic circuit or other data processing device. The ASIC or other processor executes the application programming interface API layer that interfaces with any resident programs in the memory of the wireless device. The memory can be comprised of read only or random access memory RAM and ROM EEPROM flash cards or any memory common to computer platforms. The platform also can include a local database that can hold applications not actively used in memory . The local database is typically a flash memory cell but can be any secondary storage device as known in the art such as magnetic media EEPROM optical media tape soft or hard disk or the like. The internal platform components can also be operably coupled to external devices such as antenna display push to talk button and keypad among other components as is known in the art.

Accordingly an embodiment of the invention can include a UE including the ability to perform the functions described herein. As will be appreciated by those skilled in the art the various logic elements can be embodied in discrete elements software modules executed on a processor or any combination of software and hardware to achieve the functionality disclosed herein. For example ASIC memory API and local database may all be used cooperatively to load store and execute the various functions disclosed herein and thus the logic to perform these functions may be distributed over various elements. Alternatively the functionality could be incorporated into one discrete component. Therefore the features of the UE in are to be considered merely illustrative and the invention is not limited to the illustrated features or arrangement.

The wireless communication between the UE or and the RAN can be based on different technologies such as code division multiple access CDMA W CDMA time division multiple access TDMA frequency division multiple access FDMA Orthogonal Frequency Division Multiplexing OFDM the Global System for Mobile Communications GSM or other protocols that may be used in a wireless communications network or a data communications network. For example in W CDMA the data communication is typically between the client device Node B s and the RNC . The RNC can be connected to multiple data networks such as the core network PSTN the Internet a virtual private network a SGSN a GGSN and the like thus allowing the UE or access to a broader communication network. As discussed in the foregoing and known in the art voice transmission and or data can be transmitted to the UEs from the RAN using a variety of networks and configurations. Accordingly the illustrations provided herein are not intended to limit the embodiments of the invention and are merely to aid in the description of aspects of embodiments of the invention.

As will be appreciated by one of ordinary skill in the art a given UE can be configured to execute a plurality of client applications that are each configured for interaction with an application server such as the application server . The application server at least partially supports one or more of the plurality of client applications. For example if the client application is a PTT client the application server can be responsible for setting up and arbitrating PTT sessions with one or more other UEs.

Accordingly the application server is expected to be able to send data to target UEs i.e. mobile terminated data relatively quickly. If these target UEs are served by a core network that includes a NAT Firewall i.e. an internal network that is separated by the NAT Firewall from external networks as shown in for example the mobile terminated data from the application server is required to traverse the NAT Firewall in the core network s of the UEs. In this case it is typical for the client applications to implement NAT traversal technique s to detect the IP and port translation by the NAT Firewall and to use a keep alive mechanism so as to maintain the NAT state. Similarly to maintain the firewall state with the NAT Firewall the client applications on the target UEs are required to transmit periodic keep alive packets to the application server through the NAT Firewall .

It will be appreciated that each client application on the given UE can potentially be required to send the keep alive packets to one or more application servers to maintain their respective states with the NAT Firewall . This means that the given UE will periodically wake up set up a traffic channel TCH with the RAN transmit the keep alive packet and then go back to sleep. As the number of client applications that are attempting to maintain their states with the NAT Firewall increases the given UE will consume more and more power which reduces battery life.

Referring to client application of the given UE sets up its NAT and firewall states with the NAT Firewall and then registers with the application server A. Client application of the given UE also sets up its NAT and firewall states with the NAT Firewall and then registers with the application server A. Client applications . . . N of the given UE also each set up their respective NAT and firewall states with the NAT Firewall and each of client applications . . . N then register with the application server A. At this point after A of the application server is capable of sending mobile terminated data to the given UE for any of client applications . . . N because each client application is registered and has active NAT and firewall states with the NAT Firewall .

As discussed above the NAT Firewall does not maintain the NAT and firewall states for client applications . . . N indefinitely. Rather the NAT Firewall will eventually reset or disable the NAT and firewall states for one or more of the client applications . . . N after a threshold period of inactivity. Accordingly the NAT Firewall monitors traffic inactivity timers for each of the client applications . . . N in A. As will be appreciated each traffic inactivity timer has an associated expiration period such that the NAT and or firewall states for a particular client application are torn down upon expiration of the associated traffic inactivity timer.

Next while the NAT and firewall states for client application remain active the application server sends mobile terminated data to the NAT Firewall for transmission to the given UE in association with client application A. The NAT Firewall receives the mobile terminated data performs any necessary translation functions and then forwards the mobile terminated data to the RAN e.g. via a SSGN GGSN via a PDSN etc. for transmission to the given UE A.

Next while the NAT and firewall states for client application remain active the application server sends mobile terminated data to the NAT Firewall for transmission to the given UE in association with client application A. The NAT Firewall receives the mobile terminated data performs any necessary translation functions and then forwards the mobile terminated data to the RAN e.g. via a SSGN GGSN via a PDSN etc. for transmission to the given UE A.

Next assume that the traffic inactivity timer s for client applications . . . N expire at the NAT Firewall A such that the NAT Firewall tears down the NAT and or firewall states that were set up for client applications . . . N A. At this point the NAT Firewall will no longer be able to forward IP packets to from the given UE based on the NAT and or firewall states that were set up in A and are now torn down.

Referring to after the NAT and firewall states for apps . . . N are torn down in A assume that the application server sends mobile terminated data to the NAT Firewall for transmission to the given UE in association with client application A. The NAT Firewall receives the mobile terminated data but the mobile terminated data is not forwarded to the given UE because the NAT and or firewall states for client application are no longer active A.

Referring to B through B correspond to A through A respectively of and as such will not be described further for the sake of brevity. After the NAT and firewall states for client applications . . . N are set up the client applications each begin transmitting periodic keep alive packets to the application server e.g. along routing paths A B as shown in so as to maintain the respective NAT and firewall states. Accordingly after a given period of time that is no greater than the expiration period of the traffic interactivity timer s the given UE periodically wakes up sets up a traffic channel TCH with the RAN transmits a keep alive packet for client application to the application server via the NAT Firewall and then goes back to sleep at least if the given UE is otherwise dormant or idle B. The NAT Firewall detects traffic in association with the NAT and or firewall states for client application and resets or restarts the traffic inactivity timer for client application B.

The transmission of the keep alive packet occurs in a similar manner in B for client application as in B for client application . Accordingly the NAT Firewall detects traffic in association with the NAT and or firewall states for client application and resets or restarts the traffic inactivity timer for client application B. Likewise the transmission of the keep alive packet occurs in a similar manner in B for client applications . . . N as in B for client application and or B for client application . Accordingly the NAT Firewall detects traffic in association with the NAT and or firewall states for client applications . . . N and resets or restarts the traffic inactivity timer s for client applications . . . N B. While the keep alive packets for client applications . . . N are shown as separate transmissions that occur at B B and B respectively it will be appreciated that the given UE can attempt to coordinate the respective transmissions to make better use of system resources and or battery life.

Next each of the client applications . . . N continues to send periodic keep alive packets to the application server B and the NAT Firewall continues to reset the traffic inactivity timers for client applications . . . N B such that their respective NAT and or firewall states are maintained. At some later point in time the application server sends mobile terminated data to the NAT Firewall for transmission to the given UE in association with any of client applications . . . N B. The NAT Firewall receives the mobile terminated data performs any necessary translation functions and then forwards the mobile terminated data to the RAN e.g. via a SSGN GGSN via a PDSN etc. for transmission to the given UE B.

As will be appreciated from a review of the given UE can conserve battery power by refraining from sending the periodic keep alive packets as in . However this risks losing the NAT and or firewall states with the NAT Firewall such that mobile terminated data intended for a client application on the given UE will be lost. Alternatively the given UE can transmit the keep alive packets such that the NAT and or firewall states are maintained as in albeit at the expense of increased power consumption at the given UE. Embodiments of the invention that will be described in more detail below are directed to a keep alive packet transmission assistance mechanism whereby the given UE is assisted by one or more other UEs in the same core network or packet core whereby the one or more other UEs send keep alive packets on behalf of the given UE.

Referring to a first packet core and a second packet core are illustrated. The packet core includes the NAT Firewall as well as any network components that are behind the NAT Firewall . Similarly the packet core includes another NAT Firewall as well as any network components that are behind the other NAT Firewall . Thus the term packet core is generally used to refer to an internal network that can be reached by external devices or networks such as the application server through a particular NAT Firewall . For example the packet core includes the NAT Firewall the GGSN or PDSN and the RAN which includes a Node B and RNC or a BS and BSC . A plurality of UEs can connect to the RAN in the packet core . Similar infrastructure is included in the packet core and will not be described further for the sake of brevity.

Referring to the packet core further includes an assisting application server AAS A. The AAS A is a server that is configured to interact with the application server and is coupled in some manner to the NAT Firewall within packet core . The coupling of the AAS A to the packet core can be achieved by maintaining a mapping of a particular AAS A to the IP address of the packet core elements like the GGSN or the PDSN at the application server . In an example the AAS A can correspond to a wireline device that need not have explicit wireless functionality although in at least one embodiment the AAS A could also be configured with its own wireless transceiver so as to conduct wireless communications.

The AAS A is also coupled to one or more assisting UEs . The assisting UEs are configured for wireless connectivity and can connect to the RAN within the packet core in the same manner as the UEs . In an embodiment the assisting UEs can be connected to a permanent power source so that their power consumption is not a critical issue. Alternatively it is possible that one or more of the assisting UEs could be deployed as mobile devices that rely at least partially on battery power. In an alternative embodiment multiple AAS A can be deployed in a given packet core when a relatively high number of client applications configured to receive keep alive packet assistance are deployed in the given packet core . Similarly the packet core includes an AAS B that is coupled to the NAT Firewall of the packet core and is also coupled to one or more assisting UEs . The AAS B in the packet core can be configured similar to the AAS A in the packet core . The operation of the application server with the AASs A and B as well the assisting UEs and will be described in more detail below with respect to .

Referring to after selecting the AAS A the application server provides the public IP address and the ports to the AAS A for UE A and B. The AAS A leverages or instructs the assisting UE s to send keep alive packets on behalf of UEs A and B over a wireless link or air interface to a serving NodeB or base station which then forwards the keep alive packets to a serving RNC or BSC which in turn sends the keep alive packets to the packet data network end point e.g. the GGSN or PDSN and then the NAT Firewall . The NAT Firewall performs a translation function on the keep alive packets and forwards the packets to the Internet . Eventually the keep alive packets arrive at the application server and can be discarded because the function of the keep alive packets is to maintain the respective NAT and firewall states of one or more client applications of the UEs A and B with the NAT Firewall .

As will be explained in greater detail below in an embodiment in order to ensure that the NAT state for the IP and Port of the UEs A and B is maintained the assisting UE s are configured to send keep alive packets by replacing the source IP address of UE with the source IP address of UEs A and B in the IP headers of the keep alive packets of the respective UEs sent to the application server . Similarly the source port of assisting UE s are replaced with the source port used the UEs A and B in the UDP or the TCP headers of the keep alive packets. At the NAT Firewall the source IP address source port destination IP address and destination port of the keep alive packets from the assisting UE s mimic the corresponding settings of packets sent from UE A and B the NAT Firewall state for UEs A and B is maintained. Due to the traffic associated with the keep alive packets from UEs A and B the respective NAT and firewall states of the one or more client applications of the UEs A and B are maintained by the NAT Firewall .

In the respective routing paths of the keep alive packets for UEs A and B are illustrated as routing path A and B respectively. Unlike it will be appreciated that the routing paths A and B originate from the assisting UE s instead of the UEs A and B such that the power consumption of UEs A and B can be reduced while maintain their respective NAT and or firewall states with the NAT Firewall of the packet core .

Referring to a given client application on UE establishes a packet data session with a packet data end point i.e. the PDSN or GGSN of the packet core A. The given client application on UE then obtains the IP address of the packet data end point i.e. the PDSN or GGSN of the packet core A. The given client application on UE sets up its NAT and firewall states with the NAT Firewall A. For example in setting up the NAT and firewall states in A the given client application detects the NAT portion of the NAT Firewall establishes public and private port numbers and IP addresses to be used for the given client application and establishes a firewall association for the given client application.

As discussed above with respect to the NAT Firewall does not maintain the NAT and firewall states for client applications . . . N indefinitely. Rather the NAT Firewall will eventually reset or disable the NAT and firewall states for one or more of the client applications . . . N after a threshold period of inactivity. Accordingly the NAT Firewall monitors a traffic inactivity timer for the given client application A. As will be appreciated the traffic inactivity timer has an associated expiration period such that the NAT and or firewall states for the given client application are torn down upon expiration of the associated traffic inactivity timer.

Referring to UE registers the given client application with the application server A. The registration of A includes conveying from UE to the application server i the private IP address and port number for the given client application as established in A ii the public IP address and port number for the given client application as established in A and iii the IP address of the PDSN or GGSN determined by UE at A. After registering the given client application with the application server in A UE does not send keep alive packets to the application server for maintaining the NAT and or firewall states for the given client application with the NAT Firewall A. Unlike the reason UE refrains from transmitting the keep alive packets in A is based on an expectation that the application server will facilitate some other UE s in the same packet core to transmit keep alive packets on behalf of UE so that the NAT and or firewall states for UE are maintained.

After the application server completes registration of the given client application for UE the application server selects an assisting application server AAS based on the IP address of the PDSN or GGSN that was reported by UE to the application server during the registration A. For example the application server can use the IP address of the PDSN or GGSN to identify an AAS that associates with the application server and is also located in the same packet core as UE such as packet core . The application server can then select the co located AAS that is in the same packet core as UE in A. As will be explained in more detail below one or more of the assisting UE s that are coupled to the selected AAS are expected to be capable of masquerading as UE at least from the perspective of the NAT Firewall of the packet core .

After selecting the AAS A based on the IP address of the PDSN or GGSN in A the application server instructs the selected AAS to transmit keep alive packets on behalf of the given client application of UE A. In this case the selected AAS corresponds to AAS A within the packet core . The AAS A receives the instructions from the application server and then selects one or more of its coupled assisting UEs to be responsible for periodically transmitting keep alive packets on behalf of the given client application of UE A. For example the selected assisting UE s can correspond to UE s that are co located with the AAS A and are connected to the AAS A via an interface like the USB or other similar interfaces. The AAS A can communicate with the assisting UE s over this interface instead of using the air interface to reduce contention for bandwidth and radio resources of the assisting UE s while the assisting UE s are sending keep alive packets. The AAS A then instructs the selected assisting UE s to begin transmitting keep alive packets to the application server on a periodic basis A. In an embodiment the period for keep alive packet repetition is established to be no greater than the expiration timer of the associated traffic inactivity timer e.g. 15 seconds 30 seconds 1 minute etc. that is maintained at the NAT Firewall .

In A the selected assisting UE s each configure a keep alive packet in a manner that conforms with UE A. This essentially means that the selected assisting UE s are each masquerading as UE so as to fool the NAT Firewall into interpreting the configured keep alive packet from the selected UE s as if the packet actually originated from UE . For example the public IP addresses and public port numbers and for UE assigned by the NAT Firewall that were conveyed to the application server can be passed to the AAS A and then to the selected assisting UE s . Instead of using their own IP address and port in the source IP and port fields of the IP headers of the keep alive packet the selected assisting UE s can then use the public IP addresses and public port numbers for UE in the IP TCP UDP headers as the source IP address and port information to configure the keep alive packet in A for transmission to the application server . Since the source IP address destination IP address source port and destination port combination used by the selected assisting UE s within the keep alive packet is associated with UE the NAT Firewall can interpret these packets as data traffic from UE and thus can extend the associated NAT settings for the given client application of UE .

After configuring the keep alive packet in A the selected assisting UE s sets up a TCH with the RAN if necessary transmits the configured keep alive packet to the application server via the NAT Firewall and then optionally tears down the TCH A. The NAT Firewall detects the keep alive packet from the selected assisting UE s as traffic in association with the NAT and or firewall states for the given client application and thereby resets or restarts the traffic inactivity timer for the given client application A. As will be appreciated A through A can repeat any number of times such that the NAT and or firewall states for the given client application on UE can be maintained for an indefinite period of time. Similarly A through A can repeat any number of times for one or more other UE s whereby at least one assisting UE can send keep alive packets on behalf of multiple UEs . In other words the process shown in can be executed concurrently on behalf of a plurality of UEs and or on behalf a plurality of a plurality of client applications for a given UE.

At some later point in time while the NAT and firewall states for the given client application remain active the application server sends mobile terminated data to the NAT Firewall for transmission to the given client application on UE A. The NAT Firewall receives the mobile terminated data performs any necessary translation functions and then forwards the mobile terminated data to the RAN e.g. via a SSGN GGSN via a PDSN etc. for transmission to UE A.

After updating the settings in C UE notifies the application server with regard to the updated settings C. The application server in turn notifies the AAS A regarding the update C and the AAS A in turn notifies the selected assisting UE s with regard to the update so that the selected assisting UE s can modify the manner in which the periodically transmitted keep alive packets are configured C.

In C the selected assisting UE s configure a keep alive packet in a manner that conforms with UE in accordance with the updated setting information. For example if the updated setting information corresponds to a change in the given client application s public IP address then the selected assisting UE s configure subsequent keep alive packets with the updated public IP address in C and so on.

After configuring the keep alive packet in C the selected assisting UE s set up a TCH with the RAN if necessary transmit the configured keep alive packet to the application server via the NAT Firewall and then optionally tear down the TCH C. The NAT Firewall detects the keep alive packet from the selected assisting UE s as traffic in association with the NAT and or firewall states for the given client application and thereby resets or restarts the traffic inactivity timer for the given client application C. As will be appreciated C through C can repeat any number of times such that the NAT and or firewall states for the given client application on UE can be maintained for an indefinite period of time. Similarly C through C can repeat any number of times for one or more other UE s within packet core whereby at least one assisting UE is sending keep alive packets on behalf of multiple UEs . In other words the process shown in can be executed concurrently on behalf of a plurality of UEs and or on behalf of a plurality of client applications for a given UE.

While not shown explicitly in it will be appreciated the handoff of D can include i obtaining the IP address of the PDSN or GGSN of packet core ii setting up the NAT and firewall states with the NAT Firewall of packet core and iii obtaining new private and public port numbers and IP addresses for UE if necessary . In other words blocks A A and A of can be performed at D within packet core if necessary.

After performing the handoff from packet core to packet core UE notifies the application server with regard to the new settings of UE subsequent to the handoff e.g. the IP address of the PDSN or GGSN in packet core etc. as in A of D. Also after performing the handoff the NAT Firewall in the packet core begins to monitor a traffic inactivity timer for the given client application D. As will be appreciated the traffic inactivity timer has an associated expiration period such that the NAT and or firewall states for the given client application are torn down upon expiration of the associated traffic inactivity timer.

After the application server is notified of the handoff of UE from packet core to packet core the application server determines that the NAT and firewall states no longer need to be maintained for the given client application in packet core . Accordingly the application server instructs AAS A to stop transmitting keep alive packets on behalf of the given client application of UE D. The AAS A within the packet core receives the instructions from the application server and in turn instructs the selected assisting UE s in packet core to stop transmitting the periodic keep alive packets for UE D. The selected assisting UE s receive the instructions from the AAS A and stop transmitting the periodic keep alive packets D. However if necessary the assisting UE s in packet core can continue to send keep alive messages for other UE s that are still associated with packet core .

Also after the application server is notified of the handoff of UE from packet core to packet core the application server selects an assisting application server AAS in packet core based on the IP address of the PDSN or GGSN that was reported by UE to the application server in D D. For example the application server can use the IP address of the PDSN or GGSN in packet core to identify an AAS that associates with the application server and is also located in the same packet core as UE . The application server can then select the co located AAS i.e. AAS B in the same packet core as UE in D.

After selecting the AAS B based on the IP address of the PDSN or GGSN in the packet core in D the application server instructs the selected AAS i.e. AAS B to transmit keep alive packets on behalf of the given client application of UE D. In this case the selected AAS corresponds to AAS B within the packet core .

Also at some point in time the traffic inactivity timer for the given client application expires at the NAT Firewall of packet core D due to the cessation of keep alive packet transmissions by the selected assisting UE s in packet core in D. Accordingly in D assume that this traffic inactivity timer expires and that the NAT Firewall in packet core tears down the NAT and or firewall states that were set up for the given client application of UE .

The AAS B receives the instructions from the application server and then selects one or more of its coupled assisting UEs in packet core to be responsible for periodically transmitting keep alive packets on behalf of the given client application of UE in packet core D. The AAS B then instructs the selected UE s to begin transmitting keep alive packets to the application server on a periodic basis D. In an embodiment the transmission interval or period for keep alive packet repetition is established to be no greater than the expiration period of the associated traffic inactivity timer e.g. 30 seconds 1 minute etc. that is maintained at the NAT Firewall in the packet core .

In D the selected assisting UE s configure a keep alive packet in a manner that conforms with UE in the packet core e.g. see similar to A of . After configuring the keep alive packet in D the selected assisting UE s set up a TCH with the RAN if necessary transmit the configured keep alive packet to the application server via the NAT Firewall and then optionally tear down the TCH D. The NAT Firewall of the packet core detects the keep alive packet from the selected assisting UE s as traffic in association with the NAT and or firewall states for the given client application and thereby resets or restarts the traffic inactivity timer for the given client application D. As will be appreciated D through D can repeat any number of times such that the NAT and or firewall states for the given client application on UE can be maintained for an indefinite period of time in packet core . Similarly D through D can repeat any number of times to maintain NAT and or firewall states for one or more other client applications on the same UE and or one or more other UEs altogether.

At some later point in time while the NAT and firewall states for the given client application remain active in packet core the application server sends mobile terminated data to the NAT Firewall in packet core for transmission to the given client application on UE D. The NAT Firewall in packet core receives the mobile terminated data performs any necessary translation functions and then forwards the mobile terminated data to the RAN e.g. via a SSGN GGSN via a PDSN etc. for transmission to UE D.

Those of skill in the art will appreciate that information and signals may be represented using any of a variety of different technologies and techniques. For example data instructions commands information signals bits symbols and chips that may be referenced throughout the above description may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof.

Further those of skill in the art will appreciate that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware computer software or combinations of both. To clearly illustrate this interchangeability of hardware and software various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.

The various illustrative logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

The methods sequences and or algorithms described in connection with the embodiments disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal e.g. UE . In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

In one or more exemplary embodiments the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or transmitted over as one or more instructions or code on a computer readable medium. Computer readable media includes both computer storage media and communication media including any medium that facilitates transfer of a computer program from one place to another. A storage media may be any available media that can be accessed by a computer. By way of example and not limitation such computer readable media can comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices or any other medium that can be used to carry or store desired program code in the form of instructions or data structures and that can be accessed by a computer. Also any connection is properly termed a computer readable medium. For example if the software is transmitted from a website server or other remote source using a coaxial cable fiber optic cable twisted pair digital subscriber line DSL or wireless technologies such as infrared radio and microwave then the coaxial cable fiber optic cable twisted pair DSL or wireless technologies such as infrared radio and microwave are included in the definition of medium. Disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

While the foregoing disclosure shows illustrative embodiments of the invention it should be noted that various changes and modifications could be made herein without departing from the scope of the invention as defined by the appended claims. The functions steps and or actions of the method claims in accordance with the embodiments of the invention described herein need not be performed in any particular order. Furthermore although elements of the invention may be described or claimed in the singular the plural is contemplated unless limitation to the singular is explicitly stated.

