---

title: Disassociating and freeing managed connections based on usage patterns
abstract: A method, system and computer program product for disassociating and freeing managed connection objects. Managed connections are dissociated from their connection handles based on their usage patterns, determined by various connection parameters, which more effectively reduces the idle time of the managed connections. The managed connections whose cost of disassociating and reassociating is less than the cost of keeping the managed connections idle are targeted and released to the free pool of managed connections via the dissociation from its connection handles.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08626928&OS=08626928&RS=08626928
owner: International Business Machines Corporation
number: 08626928
owner_city: Armonk
owner_country: US
publication_date: 20101122
---
The present invention relates to the J2EE Connector Architecture JCA and more particularly to disassociating and freeing managed connection objects to a pool of available managed connection objects based on usage patterns.

The Java 2 Platform Enterprise Edition J2EE is a software standard for developing multitier enterprise applications. The J2EE architecture has a client tier middle tier and back end tier. The client tier supports a variety of client types and the middle tier supports client services and business logic through web and Enterprise Java Beans EJB containers in the middle tier. The back end tier includes the Enterprise Information Systems EIS in the EIS tier and many standard Application Programming Interfaces APIs for accessing databases. An Enterprise Information System is generally any kind of computing system that offers high quality of service deals with large volumes of data and capable of supporting some large organization an enterprise . One of skill in the art can accordingly alter the objects and components resident on the several tiers. Containers are standardized runtime environments that provide services to components on the platform. All containers provide runtime support for responding to client requests and returning results to clients. The containers also provide APIs to support user session management.

Resident within the J2EE architecture is a resource adapter that plays a central role in the integration and connectivity between an EIS and an application server software framework dedicated to the efficient execution of procedures for supporting the construction of applications and serves as the point of contact between application components application servers and enterprise information systems. A resource adapter and other components must communicate with one another based on a standard referred to as the J2EE Connector Architecture JCA . To enable seamless integration with an application server the resource adapter abides by system level contracts defined by the JCA. These contracts exist between the application server and the EIS and are implemented through the resource adapter. The contracts specify how a system external to the J2EE platform integrates with it by supporting basic functions handled by the J2EE container. There are three major contracts the connection management contract which allows applications to connect to an EIS and enables the application server to utilize pooling the transaction management contract which allows an application server to manage and perform transactional access across one to many EIS resource managers and the security contract which provides support for secure access to the EIS.

On a J2EE platform a ManagedConnection interface provides an application level connection handle from the EIS to the resource adapter s ManagedConnection instance. The ManagedConnection instance represents a physical connection to the underlying EIS. A connection handle to the ManagedConnection instance is created for the application that requests a physical connection represented by the ManagedConnection instance. This connection handle is used by the application code to refer to the underlying physical connection. The ManagedConnection instance is associated with the connection handle until the connection handle is closed and the associated transaction e.g. loading personalized data from a database is terminated.

In certain situations the transaction may take a considerable amount of time to complete. In such cases the ManagedConnection object is idle without being actively engaged in any sort of work.

Attempts have been made to reduce or eliminate these idle times by disassociating the ManagedConnection object from its connection handles when the processing is completed regardless of whether the transaction is completed or not. For example when a portal application acquires a connection to load all personalization data from a database the ManagedConnection object would be disassociated from its connection handles for this connection when the processing is completed. However the time it takes to process the data may be significantly greater than the time it takes to load the data thereby causing the ManagedConnection object to be idle for a significant period of time.

As a result there are cases where the connection resources such as the ManagedConnection object are being underutilized.

In one embodiment of the present invention a method for disassociating and freeing managed connection objects comprising determining an amount of time a managed connection has been idled. The method further comprises determining an average amount of time that the managed connection is in an idle state. Additionally the method comprises computing a standard deviation of a number of accesses to a physical connection represented by the managed connection over a time the managed connection has been idled. In addition the method comprises disassociating by a connection manager of an application server whose instructions are executed by a processor the managed connection from a connection handle in response to the amount of time the managed connection has been idled being less than or greater than the standard deviation from the average time the managed connection is in the idle state and in response to the amount of time the managed connection has been idled being greater than the average time the managed connection is in the idle state where the connection handle is used by an application to refer to the physical connection represented by the managed connection.

Other forms of the embodiment of the method described above are in a system and in a computer program product.

The foregoing has outlined rather generally the features and technical advantages of one or more embodiments of the present invention in order that the detailed description of the present invention that follows may be better understood. Additional features and advantages of the present invention will be described hereinafter which may form the subject of the claims of the present invention.

The present invention comprises a method system and computer program product for disassociating and freeing managed connection objects. In one embodiment of the present invention managed connections are dissociated from their connection handles based on their usage patterns determined by various connection parameters which more effectively reduces the idle time of the managed connections. The managed connections whose cost of disassociating and reassociating is less than the cost of keeping the managed connections idle are targeted and released to the free pool of managed connections via the dissociation from its connection handles.

In the following description numerous specific details are set forth to provide a thorough understanding of the present invention. However it will be apparent to those skilled in the art that the present invention may be practiced without such specific details. In other instances well known circuits have been shown in block diagram form in order not to obscure the present invention in unnecessary detail. For the most part details considering timing considerations and the like have been omitted inasmuch as such details are not necessary to obtain a complete understanding of the present invention and are within the skills of persons of ordinary skill in the relevant art.

Referring now to the Figures in detail illustrates an embodiment of a hardware configuration of a computer system which is representative of a hardware environment for practicing the present invention. Referring to computer system may have a processor coupled to various other components by system bus . An operating system may run on processor and provide control and coordinate the functions of the various components of . An application in accordance with the principles of the present invention may run in conjunction with operating system and provide calls to operating system where the calls implement the various functions or services to be performed by application . Application may include for example a user application that requests a physical connection represented by the managed connection object e.g. ManagedConnection instance defined in the J2EE platform . Application may also include the software components used for disassociating and freeing managed connection objects managed connects based on their usage patterns as discussed further below in association with A C and .

Referring again to read only memory ROM may be coupled to system bus and include a basic input output system BIOS that controls certain basic functions of computer device . Random access memory RAM and disk adapter may also be coupled to system bus . It should be noted that software components including operating system and application may be loaded into RAM which may be computer system s main memory for execution. Disk adapter may be an integrated drive electronics IDE adapter that communicates with a disk unit e.g. disk drive. It is noted that the applications of application as discussed further below in association with A C and may reside in disk unit or in application .

Computer system may further include a communications adapter coupled to bus . Communications adapter may interconnect bus with an outside network not shown thereby allowing computer system to communicate with other similar devices.

I O devices may also be connected to computer system via a user interface adapter and a display adapter . Keyboard mouse and speaker may all be interconnected to bus through user interface adapter . Data may be inputted to computer system through any of these devices. A display monitor may be connected to system bus by display adapter . In this manner a user is capable of inputting to computer system through keyboard or mouse and receiving output from computer system via display or speaker .

As will be appreciated by one skilled in the art aspects of the present invention may be embodied as a system method or computer program product. Accordingly aspects of the present invention may take the form of an entirely hardware embodiment an entirely software embodiment including firmware resident software micro code etc. or an embodiment combining software and hardware aspects that may all generally be referred to herein as a circuit module or system. Furthermore aspects of the present invention may take the form of a computer program product embodied in one or more computer readable medium s having computer readable program code embodied thereon.

Any combination of one or more computer readable medium s may be utilized. The computer readable medium may be a computer readable signal medium or a computer readable storage medium. A computer readable storage medium may be for example but not limited to an electronic magnetic optical electromagnetic infrared or semiconductor system apparatus or device or any suitable combination of the foregoing. More specific examples a non exhaustive list of the computer readable storage medium would include the following an electrical connection having one or more wires a portable computer diskette a hard disk a random access memory RAM a read only memory ROM an erasable programmable read only memory EPROM or flash memory a portable compact disc read only memory CD ROM an optical storage device a magnetic storage device or any suitable combination of the foregoing. In the context of this document a computer readable storage medium may be any tangible medium that can contain or store a program for use by or in connection with an instruction execution system apparatus or device.

A computer readable signal medium may include a propagated data signal with computer readable program code embodied therein for example in baseband or as part of a carrier wave. Such a propagated signal may take any of a variety of forms including but not limited to electro magnetic optical or any suitable combination thereof. A computer readable signal medium may be any computer readable medium that is not a computer readable storage medium and that can communicate propagate or transport a program for use by or in connection with an instruction execution system apparatus or device.

Program code embodied on a computer readable medium may be transmitted using any appropriate medium including but not limited to wireless wireline optical fiber cable RF etc. or any suitable combination of the foregoing.

Computer program code for carrying out operations for aspects of the present invention may be written in any combination of one or more programming languages including an object oriented programming language such as Java Smalltalk C or the like and conventional procedural programming languages such as the C programming language or similar programming languages. The program code may execute entirely on the user s computer partly on the user s computer as a stand alone software package partly on the user s computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario the remote computer may be connected to the user s computer through any type of network including a local area network LAN or a wide area network WAN or the connection may be made to an external computer for example through the Internet using an Internet Service Provider .

Aspects of the present invention are described below with reference to flowchart illustrations and or block diagrams of methods apparatus systems and computer program products according to embodiments of the present invention. It will be understood that each block of the flowchart illustrations and or block diagrams and combinations of blocks in the flowchart illustrations and or block diagrams can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer special purpose computer or other programmable data processing apparatus to product a machine such that the instructions which execute via the processor of the computer or other programmable data processing apparatus create means for implementing the function acts specified in the flowchart and or block diagram block or blocks.

These computer program instructions may also be stored in a computer readable medium that can direct a computer other programmable data processing apparatus or other devices to function in a particular manner such that the instructions stored in the computer readable medium produce an article of manufacture including instructions which implement the function act specified in the flowchart and or block diagram block or blocks.

The computer program instructions may also be loaded onto a computer other programmable data processing apparatus or other devices to cause a series of operational steps to be performed on the computer other programmable apparatus or other devices to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide processes for implementing the function acts specified in the flowchart and or block diagram block or blocks.

As stated in the Background section there are cases where the connection resources such as the managed connection object e.g. ManagedConnection instance defined on a J2EE platform are being underutilized. For example the managed connection object is being idled without being actively engaged in any sort of work.

The principles of the present invention provide a technique for dissociating and freeing the managed connections from their connection handles based on their usage patterns thereby more effectively reducing or eliminating these idle times as discussed below in connection with A C and . is a diagram of the software components used in the technique for disassociating and freeing managed connection objects managed connections based on their usage patterns. are a flowchart of a method for disassociating and freeing managed connection objects based on their usage patterns. is a graph illustrating an example of the normal distribution of the number of accesses to the physical connection represented by the managed connection over the time that the managed connection has been idled.

Referring to as stated above is a diagram of the software components used in the technique for disassociating and freeing managed connection objects based on their usage patterns in accordance with an embodiment of the present invention. In one embodiment these software components may reside in application .

The software components include an application server interacting with a resource adapter . In one embodiment application server is a software framework dedicated to the efficient execution of procedures for supporting the construction of applications. In one embodiment resource adapter plays a central role in the integration and connectivity between application server and an Enterprise Information System EIS not shown .

Resource adapter includes a managed connection objection managed connection within the J2EE architecture that represents a physical connection to the underlying EIS. Resource adapter further includes one or more connection handles such as connection handle which is created for a user application that requests a physical connection represented by managed connection .

Application server includes a connection manager configured to disassociate managed connection from its connection handles based on the usage of managed connection and freeing the disassociated managed connection to a pool of available managed connections connection pool . Once in the pool of managed connections the disassociated managed connection can be reused to represent another physical connection to the underlying EIS. In this manner managed connection may be used to represent another physical connection to the underlying EIS rather than being idled.

The process in connection manager disassociating managed connection from its connection handles thereby reducing or eliminating its idle time is discussed below in connection with . are a flowchart of a method for disassociating and freeing managed connection objects managed connections based on their usage patterns in accordance with an embodiment of the present. While the following discusses calculating various metrics e.g. meanIdleTime meanUseTime dissociate time reassociate time per managed connection these metrics may be calculated per connection pool.

Referring to in conjunction with in step connection manager determines the amount of time managed connection has currently been idled.

In step connection manager determines the average amount of time that managed connection is in the idle state.

In step connection manager computes the standard deviation from the normal distribution of accesses to a physical connection represented by managed connection over the time managed connection has been idled as illustrated in . Referring to is a graph of the number of accesses to a physical connection identified by versus the time managed connection has been idled idle time . Graph also illustrates the mean or average identified by mean of the number of accesses to a physical connection represented by managed connection over the time managed connection has been idled. Furthermore graph illustrates computing the standard deviation identified by SD from the mean value . In particular graph shows the locations where the number of connection accesses to a physical connection is one standard deviation from mean . The information from graph will be used in determining whether to disassociate managed connection from its connection handles as discussed below in connection with the remaining steps of method .

Returning to in conjunction with and in step connection manager determines if the amount of time that managed connection has been idled is less than or greater than one standard deviation points in graph from the average time point in graph managed connection is in the idle state.

If the amount of time that managed connection has been idled is less than or greater than one standard deviation points in graph from the average time point in graph managed connection is in the idle state then in step connection manager computes the parameter idleThreshold which estimates the cost of disassociating managed connection from its connection handles and reassociating it with another physical connection to the underlying EIS. By quantifying the cost of disassociating and reassociating managed connections those managed connections whose cost of disassociating and reassociating is less than the cost of keeping the managed connection idle should be targeted and released to the free pool via dissociation from its connection handles as discussed further below. In one embodiment the parameter idleThreshold is equation to the following equation idleThreshold 2 average dissociate time reassociate time EQ1 

where the average dissociate time is the average time it takes to dissociate a managed connection from its connection handles and the average reassociate time is the average time it takes to reassociate the freed managed connection to another physical connection to the underlying EIS.

In step connection manager computes the parameter meanUseTime which is the average amount of time that managed connection is in use engaged in work .

In step connection manager computes the parameter bufferTime which corresponds to an amount of time that takes into consideration the variations in time in disassociating and reassociating managed connection . In one embodiment the parameter bufferTime is user selected.

Referring to in conjunction with in step connection manager determines if the following equation is satisfied meanIdleTime currentIdleTime 2 idleThreshold meanUseTime bufferTime EQ 2 

where meanIdleTime corresponds to the average amount of time that managed connection is in the idle state as discussed above in step currentIdleTime corresponds to the amount of time managed connection has been currently idled as discussed above in step .

Referring to if equation EQ2 is satisfied then in step connection manager disassociates managed connection from its connection handles and releases managed connection to a free pool i.e. a pool of managed connections available to be used to represent another physical connection to the underlying EIS .

Alternatively if equation EQ2 is not satisfied then in step connection manager determines if the amount of time that managed connection has been idled exceeds the average time that connection manager is in the idle state which is represented by the following equation currentIdleTime meanIdleTime EQ3 

If equation EQ3 is satisfied then in step connection manager disassociates managed connection from its connection handles and releases managed connection to a free pool i.e. a pool of managed connections available to be used to represent another physical connection to the underlying EIS .

Referring to step of if the amount of time that managed connection has been idled is not less than or greater than one standard deviation from the average time managed connection is in the idle state then in step of connection manager determines if the following equation is satisfied 2 idleThreshold meanUseTime bufferTime 

If equation EQ4 is satisfied then in step connection manager determines if the following equation is satisfied meanIdleTime currentIdleTime 2 idleThreshold meanUseTime bufferTime EQ5 

If equation EQ5 is satisfied then in step connection manager disassociates managed connection from its connection handles and releases managed connection to a free pool i.e. a pool of managed connections available to be used to represent another physical connection to the underlying EIS .

If however EQ5 is not satisfied then in step connection manager reduces the previous value of n by 0.1 and determines if equation EQ4 is satisfied in step .

In this manner managed connections are dissociated and released to a pool of managed connections based on their usage patterns determined by various connection parameters discussed above which more effectively reduces the idle time of managed connections . Managed connections whose cost of disassociating and reassociating is less than the cost of keeping the managed connection idle are targeted and released to the free pool via dissociation from its connection handles .

In some implementations method may include other and or additional steps that for clarity are not depicted. Further in some implementations method may be executed in a different order presented and that the order presented in the discussion of is illustrative. Additionally in some implementations certain steps in method may be executed in a substantially simultaneous manner or may be omitted.

Although the method system and computer program product are described in connection with several embodiments it is not intended to be limited to the specific forms set forth herein but on the contrary it is intended to cover such alternatives modifications and equivalents as can be reasonably included within the spirit and scope of the invention as defined by the appended claims.

