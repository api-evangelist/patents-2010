---

title: DAC circuit using summing junction delay compensation
abstract: Techniques are disclosed for improving the dynamic performance of digital-to-analog converters (DAC), by compensating for the unique delay characteristics of each bit in the DAC summing junction to equalize the delays. In one example case, a DAC device is provided that includes a plurality of current sources and a plurality of switches, each switch operatively coupled between a corresponding one of the current sources and a summing junction that is operatively coupled to an analog output. The device further includes a plurality of switch control lines configured to receive a digital input, each switch control line for controlling a corresponding one of the switches. The device further includes a plurality of compensation delay elements, each associated with a corresponding one of the switch control lines and providing a different delay value.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07965212&OS=07965212&RS=07965212
owner: BAE Systems Information and Electronic Systems Integration Inc.
number: 07965212
owner_city: Nashua
owner_country: US
publication_date: 20100212
---
The invention was made with United States Government support under contract DAAD17 02 C 0115 awarded by the Army and the United States Government has certain rights in this invention.

The disclosure relates to signal processing and more particularly to digital to analog signal conversion.

Direct digital synthesizers DDS include a phase accumulator a phase to amplitude converter and a digital to analog converter DAC . In high speed applications these functional blocks are generally clocked with pipeline registers internal to each block. Typical DAC circuits employed in DDS applications generally suffer from poor dynamic performance. These DAC circuit performance issues may further apply in numerous other high speed applications.

One embodiment of the present invention provides a digital to analog converter device. The device includes a plurality of current sources and a plurality of switches each switch operatively coupled between a corresponding one of the current sources and a summing junction that is operatively coupled to an analog output. The device further includes a plurality of switch control lines configured to receive a digital input each switch control line for controlling a corresponding one of the switches. The device further includes a plurality of compensation delay elements each associated with a corresponding one of the switch control lines and providing a different delay value. In one particular configuration the summing junction is associated with parasitic delay that causes a plurality of unequal delay paths between the digital input and the analog output and the compensation delay elements equalize those delay paths within a given tolerance. In another particular configuration all switching caused by the digital input impacts the output substantially simultaneously. In another particular configuration all switching caused by the digital input impacts the output within a window of 400 femtoseconds or less. In another particular configuration all switching caused by the digital input impacts the output within a window of 200 femtoseconds or less. In another particular configuration each of the compensation delay elements is implemented with a transmission line configured to provide a desired amount of delay. In one such case each of the transmission lines is one of a microstip meanderline or waveguide. In another particular configuration each of the compensation delay elements includes one or more logic gates configured to provide a desired amount of delay. In one such case each of the compensation delay elements further includes one or more multiplexers. In another particular configuration the device is included in a system on chip configuration.

A number of variations will be apparent in light of this disclosure. For instance another embodiment of the present invention provides a DAC device that includes a plurality of current sources and a plurality of switches each switch operatively coupled between a corresponding one of the current sources and a summing junction that is operatively coupled to an analog output. The device further includes a plurality of switch control lines configured to receive a digital input each switch control line for controlling a corresponding one of the switches. The device further includes a plurality of compensation delay elements each associated with a corresponding one of the switch control lines and providing a different delay value wherein each of the compensation delay elements is implemented with a transmission line configured to provide a desired amount of delay. The summing junction is associated with parasitic delay that causes a plurality of unequal delay paths between the digital input and the analog output and the compensation delay elements equalize those delay paths within a given tolerance. In one particular configuration all switching caused by the digital input impacts the output substantially simultaneously. In another particular configuration all switching caused by the digital input impacts the output within a window of 400 femtoseconds or less. In another particular configuration all switching caused by the digital input impacts the output within a window of 200 femtoseconds or less. In another particular configuration each of the transmission lines is a microstip.

Another embodiment of the present invention provides a DAC device that includes a plurality of current sources and a plurality of switches each switch operatively coupled between a corresponding one of the current sources and a summing junction that is operatively coupled to an analog output. The device further includes a plurality of switch control lines configured to receive a digital input each switch control line for controlling a corresponding one of the switches. The device further includes a plurality of compensation delay elements each associated with a corresponding one of the switch control lines and providing a different delay value wherein each of the compensation delay elements includes one or more logic gates configured to provide a desired amount of delay. The summing junction is associated with parasitic delay that causes a plurality of unequal delay paths between the digital input and the analog output and the compensation delay elements equalize those delay paths within a given tolerance. In one particular configuration all switching caused by the digital input impacts the output substantially simultaneously. In another particular configuration all switching caused by the digital input impacts the output within a window of 400 femtoseconds or less. In another particular configuration all switching caused by the digital input impacts the output within a window of 200 femtoseconds or less. In another particular configuration each of the compensation delay elements further includes one or more multiplexers.

The features and advantages described herein are not all inclusive and in particular many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims. Moreover it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and not to limit the scope of the inventive subject matter.

Techniques are disclosed for improving the dynamic performance of digital to analog converters DAC by compensating for the unique delay characteristics of each bit in the DAC summing junction to equalize the delays. Such parasitic wiring delay causes degradation of spurious free dynamic range SFDR which is a metric of dynamic DAC performance. The DAC may be implemented for example either as part of a direct digital synthesis DDS system or as a stand alone circuit having numerous applications. The techniques can be employed for instance in a system implemented in semiconductor materials system on chip or chip set or with discrete components on a printed circuit board. This delay compensation effectively accounts for variations in propagation delays due to process variations.

As previously explained typical DAC circuits employed in DDS applications generally suffer from poor dynamic performance. One subtle but non trivial problem is that high speed DAC summing junctions have delay from bit to bit due to wiring parasitics on the summing junction. Although the delay from the parasitics does not impact traditional static DAC metrics such as integrated non linearity and differential non linearity the delay can affect dynamic DAC performance metrics such as signal to noise ratio SNR and SFDR.

In more detail for optimal dynamic performance all of the DAC bit switches should ideally switch synchronously with the clock and impact the DAC output node at the same time or within a negligible tolerance of one another . However parasitic wiring delays cause the effective delay time of each input bit node to be different with respect to the DAC output node. This problem is demonstrated in which illustrates a schematic diagram of a typical DAC circuit.

This example DAC configuration includes a 4 bit input Bit Bit Bit and Bit and the corresponding current sources I I I and I and switches S S S and S with each switch S S S and Sconnected to a summing junction as commonly done. In operation each 4 bit digital signal at the DAC input is converted to an analog current at the summing junction and provided at the DAC output. Although a 4 bit resolution is shown the resolution can be decreased increased as needed by subtracting adding input bits and corresponding switched current sources . Such switched current source DAC configurations can drive a resistive load R directly and are particularly suitable for high speed applications.

Also shown in the schematic are various parasitic wiring delays and associated with the summing junction. Each wire delay is associated with one or more input bits. For example if Bit and Bit were switched simultaneously such that Sand Sare closed thereby activating current sources Iand I the effect of Bit on the DAC output would occur after the effect of Bit on the DAC output. Table 1 demonstrates the wire delays associated with each of the bits in one such example case.

As such and in accordance with an embodiment of the present invention the DAC performance can be improved based on for example dynamic SNR and or SFDR metrics of the DAC can be improved by compensating for the parasitic wiring delays and up to the current switches S S S and S of the DAC. This compensation can be provided for example using transmission lines on each bit switch control line or other suitable delay mechanisms that can be deployed to equalize the overall delay associated with each bit control line. In any case the compensation allows switches S S S and Sto impact the output node simultaneously or otherwise within an acceptable tolerance of one another such that all switching caused by the digital input impacts the output within a given time window .

As can be seen the example DAC circuit with delay compensation can be implemented in a similar fashion as the DAC circuit shown in except for the addition of the delay compensation elements and which shall be discussed in turn. The previous discussion with respect to typical DAC circuit components such as the 4 bit input Bit Bit Bit and Bit current sources I I I and I switches S S S and S and parasitic wiring delays and is equally applicable here.

As will be appreciated any number of input bits DAC resolution can be used in conjunction with the bit delay compensation scheme provided herein. The DAC configuration may vary as well. For instance in some embodiments the DAC circuit with delay compensation may be implemented as a binary weighted DAC e.g. R 2R ladder DAC or a thermometer coded DAC or a combination thereof. In general any DAC circuit configuration that is susceptible to poor dynamic performance due to unequal delay times of each input bit node with respect to the DAC output node can benefit from an embodiment of the present invention.

In accordance with an embodiment of the present invention switching the input bits with compensating time delays and in conjunction with the parasitic wiring delays and on the summing junction equalizes the total delay of any one input bit with respect to any other input bit and therefore results in all bit switches S S S and S impacting the output node simultaneously or within a negligible tolerance . For example if is set equal to 0 and is set to equal to then bit and bit will switch simultaneously at the output node thereby improving dynamic DAC performance relative to an uncompensated DAC having non equalized bit current switch control line inputs. Table 2 demonstrates the value for each of the compensation elements in accordance with one example embodiment.

With respect to bit switches S S S and S impacting the output node simultaneously it will be appreciated that exactly simultaneously is not necessary and a reasonable or otherwise negligible tolerance can be used. For instance given a DAC clock speed in the range of 10 GHz to 30 GHz the bit switches S S S and S will be considered to be impacting the output node simultaneously if they do so within 100 femtoseconds fs or less of one another. The tolerance for slower clock speeds may be greater e.g. 

The compensation elements and can be implemented for example as transmission lines such as microstrips meanderlines and or waveguides. Such transmission lines can be fabricated for instance during a back end of a semiconductor process. During the front end of the process components such as the transistors resistors etc are created. The back end is where metal interconnects and other metal layers or features such as the transmission lines or other such delay compensation elements can be created.

Any number of suitable semiconductor process technologies and material systems can be used in fabricating the DAC circuit with delay compensation. For example for higher speed applications e.g. in excess of 10 GHz the DAC can be implemented for instance in heterojunction bipolar transistor HBT and or high electron mobility transistor HEMT technology. However if such high speeds are not necessary e.g. less than 2 GHz then other technologies such as complementary metal oxide semiconductor CMOS technology can be utilized. Example materials from which the system can be implemented include III V material systems such as gallium arsenide GaAs or indium phosphide InP or other suitable semiconductor material systems.

In more detail parasitic includes the RC time constant of RC parasitic includes the RC time constant of RC and parasitic includes the RC time constant of RC. As will further be appreciated these RC time constants can vary from one DAC design to the next or even within the same design due to variations in the devices and metallization from circuit to circuit within a single wafer as well as variation between lots of wafers.

In one specific embodiment the transmission lines TX line TX line and TX line are implemented as microstrips. A specific example transmission line configuration is an aluminum microstrip line that is 2 um to 6 um e.g. 4 um tall 2 um to 8 um e.g. 5 um wide and 1 um to 7 um e.g. 4 um above an aluminum ground plane. A dielectric can be deployed between the ground plane and the transmission line such as polyimide or silicon dioxide or silicon nitride or benzocyclobutene or other suitable dielectric materials. Typical transmission line and ground plane materials include for example copper gold and aluminum.

In other embodiments and as previously explained the transmission lines TX line TX line and TX line can be implemented with other suitable transmission line types such as meanderlines or waveguides. Alternatively the compensation delay provided by the transmission lines TX line TX line and TX line in this example embodiment could be provided by one or more active devices such as unity gain buffer or other logic gate configuration. In general any device that provides a desired amount or unit of propagation delay can be used as a delay compensation element in accordance with an embodiment of the present invention.

In an integrated circuit application the transmission lines TX line TX line and TX line or other suitable compensation delay elements can be implemented in the back end process e.g. during formation of the DAC interconnect structure . Alternatively in an embodiment where the compensation delay element is a buffer or other active device those compensation delay elements can be provided in the front end of the process e.g. along with the current switches etc . A serial path of such active devices can be provided with each device providing a unit of delay contributing to the overall desired amount of compensation delay.

The length of each transmission line TX line TX line and TX line can be varied to achieve the desired compensation delay. The desired length can be determined for example using a calibration procedure carried out empirically and or through simulation. In one such case pseudo random binary sequence PRBS bit streams can be driven into each of the DAC input bits individually on each current switch to measure the relative delays from the input of each current switch to the overall DAC output. The differences in the delay times can be used to determine the lengths of the transmission lines needed to equalize the delays associated with the current switches. When all of the transmission lines are physically laid out in design the layout can be extracted and re simulated to determine if any additional adjustment refining is needed to ensure that the delays are equalized within a given tolerance e.g. 

As will be appreciated in light of this disclosure the delay compensation element type dimensions and materials can vary from one embodiment to the next and the claimed invention is not intended to be limited to any particular compensation delay element type configuration material system. For example for integrated DAC circuit applications using transmission lines for the compensation delay elements such as the example embodiment shown in the dimension of the compensation delay elements as well as the number of compensation delay elements will depend on factors such as the interconnect layout of the DAC circuit and the desired accuracy of the compensation delay to be provided. In some such applications the DAC may be implemented for example either as part of an overall system on chip where the compensation delay elements are configured to provide a complete on board compensation scheme for compensating for both on chip and off chip delays.

In other embodiments the compensation delay elements can be implemented using serial logic buffers that can be selectively coupled into the DAC bit switch path such as the example embodiments shown in and . In short an adjustable compensation delay element as shown in and can be used to replace each of the transmission line based delay elements shown in . Such programmable delay may be helpful for instance for DAC applications subjected to environmental changes e.g. temperature humidity etc or any other changes that may impact dynamic DAC performance after deployment of the DAC.

This configuration allows for the selection of discrete delay increments as provided by the buffers A G. In general each of the buffers A G is associated with a fixed propagation delay which can be exploited to delay the DAC current switch control input by a known amount. The buffers can be implemented with any suitable buffer technology and in one example case are implemented with unity gain buffers voltage followers . Other embodiments may utilize buffers having amplifying or attenuating capability if so desired. The multiplexers Mux Mux and Mux can be implemented for example with a conventional high speed multiplexer circuit design e.g. such as the SN54 74LS157 and are used to select the desired amount of delay.

In operation this example adjustable compensation delay element allows for selection of 0 to 6 buffer delays not counting buffer A the delay of which is constantly applied . Such an implementation can be used for instance to provide full parasitic delay compensation coverage for DAC circuits operating up to 30 GHz. Note however that higher operating frequencies can be used by scaling the number of buffers and multiplexers accordingly. Table 3 demonstrates the operation of the adjustable clock delay circuit.

As can be seen if the DSCS bit is logic 0 then the corresponding multiplexer switches the L input to the multiplexer output which is effectively a non delay feed through path i.e. no buffers on path . However if the DSCS bit is logic 1 then the corresponding multiplexer switches the H input to the multiplexer output which will provide a unit of delay for each buffer on that path. A switch control delay of 1 unit buffer A is provided for all DSCS. Note that for a delay of 4 units there are two possible buffer delay paths generally designated as or in Table 3 where buffers A B C D or A E F G respectively are switched into the delay path .

Just as with the embodiment of if the DSCS bit is logic 0 then the corresponding multiplexer switches the L input to the multiplexer output. However if the DSCS bit is logic 1 then the corresponding multiplexer switches the H input to the multiplexer output. Note that a switch control delay of 1 unit buffer A is provided for all DSCS. Further note the layout symmetry and duplicate conductor lengths for each of buffers B H and muxes such that the delay adjustment is predominantly provided by the buffers rather than the conductors coupling the buffers and muxes from the switch control input to the switch control output .

The LUT entries can be for example empirically developed by manually or automatically testing the given DAC circuit or system in which the DAC is deployed for proper operation over a range of DAC operating parameter sets and testing each available corresponding delay select control signal for each DAC operating parameter set to identify the best performing delay select control signal for a given parameter set. For instance and with reference to the example of Table 5 if the DAC clock is set to 40 GHz and the operating temperature of the environment in which the DAC is operating is in the range of 35 to 45 C. then a delay select control signal of 011 assuming a 3 bit DSCS is the one that provided optimal DAC dynamic performance for the known set of stimulus of all the available delay select control signals.

The processor can be implemented with any suitable processor technology such as a programmable microprocessor or a microcontroller programmed or otherwise configured to carry out the methodologies described herein. For example a microcontroller configured with a number of input output ports and a number of embedded routines for interrogating the current DAC operating parameter set and identifying a suitable DSCS. The input ports can each receive a signal indicative of a given operating parameter and an output port can provide the desired DSCS. The LUT can be stored in a memory on board or otherwise accessible by the microcontroller. The microcontroller may further include memory e.g. ROM or flash for storing the various routines as well as workspace e.g. random access memory for executing those routines. Any number of suitable processor configurations can be used.

Variations on the example embodiments shown in and will be apparent in light of this disclosure. For instance in another embodiment rather than using a look up table populated with empirically developed data the processor can be programmed to monitor for changes in the DAC operating parameter set and when such a change is detected the calibration mode can be entered where known stimulus clock temp etc are input to the DAC in the given environment of interest . During calibration mode the DAC output can be monitored in real time for accuracy as the available delay select control signals are sequentially cycled through. After all available delay select control signals are tested the one providing the DAC output closest in value to the desired DAC output value can be used for normal mode operation.

The foregoing description of the embodiments of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form disclosed. Many modifications and variations are possible in light of this disclosure. It is intended that the scope of the invention be limited not by this detailed description but rather by the claims appended hereto.

