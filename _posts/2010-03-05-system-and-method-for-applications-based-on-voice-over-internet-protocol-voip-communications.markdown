---

title: System and method for applications based on voice over internet protocol (VoIP) Communications
abstract: A system is provided comprising an application server and a media proxy. The application server comprises a first processor, a first memory, and a first application stored in the first memory that, when executed by the first processor, transmits a first digital media stream for mixing with a first voice over internet protocol (VoIP) stream. The media proxy is stored in a second memory and, when executed by a second processor, receives the first voice over internet protocol stream, mixes the first digital media stream with the first voice over internet protocol stream to produce a second voice over internet protocol stream, transmits the second voice over internet protocol stream, receives a third voice over internet protocol stream, produces a fourth internet protocol stream based on the third internet protocol stream, and transmits the fourth internet protocol stream.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08630283&OS=08630283&RS=08630283
owner: Sprint Communications Company L.P.
number: 08630283
owner_city: Overland Park
owner_country: US
publication_date: 20100305
---
Voice over Internet Protocol VoIP communication comprises encoding voice as digital data encapsulating this digital data into data packets and transporting these data packets over a data network. A voice over internet protocol phone VoIP phones promotes VoIP communication.

In an embodiment a system is disclosed. The system comprises an application server and a media proxy. The application server comprises a first processor a first memory and a first application stored in the first memory that when executed by the first processor transmits a first digital media stream for mixing with a first voice over internet protocol VoIP stream. The media proxy is stored in a second memory and when executed by a second processor receives the first voice over internet protocol stream mixes the first digital media stream with the first voice over internet protocol stream to produce a second voice over internet protocol stream transmits the second voice over internet protocol stream receives a third voice over internet protocol stream produces a fourth internet protocol stream based on the third internet protocol stream and transmits the fourth internet protocol stream.

In an embodiment a method is disclosed. The method comprises establishing a voice over internet protocol VoIP call from a first voice over internet protocol phone to a second voice over internet protocol phone and after establishing the voice over internet protocol call transmitting a pre configured voice over internet protocol application trigger signal from the first voice over internet protocol phone. The method further comprises transmitting an audio content by a voice over internet protocol application in response to the first voice over internet protocol phone transmitting the trigger signal and mixing the audio content into a first voice over internet protocol stream transmitted to the first voice over internet protocol phone by a media proxy application.

In an embodiment a method is disclosed. The method comprises transmitting a subscription information for a voice over internet protocol application service by a voice over internet protocol phone the subscription information comprising an identification of a trigger to associate with the service and receiving the subscription information by an activation server. The method further comprises transmitting by the activation server at least some of the subscription information to a voice over internet protocol application server operable to provide the service. The method further comprises transmitting to a home subscription server HSS the trigger identification and a session initiation protocol SIP routing information by the application server wherein the session initiation protocol routing information that the home subscription server can use to route a session initiation protocol message to the application server when the voice over internet protocol phone sends a session initiation protocol message containing the trigger to the home subscription server. The method promotes provisioning at least in part the voice over internet protocol application service.

These and other features will be more clearly understood from the following detailed description taken in conjunction with the accompanying drawings and claims.

It should be understood at the outset that although illustrative implementations of one or more embodiments are illustrated below the disclosed systems and methods may be implemented using any number of techniques whether currently known or in existence. The disclosure should in no way be limited to the illustrative implementations drawings and techniques illustrated below but may be modified within the scope of the appended claims along with their full scope of equivalents.

The present disclosure teaches a system and methods for providing voice over internet protocol VoIP applications. VoIP applications may provide optional or supplemental services to standard VoIP communications for example to a VoIP call between two parties. For example in an embodiment when a user of a first VoIP phone is engaged in a conversation with a user of a second VoIP phone the user of the first VoIP phone may trigger activation of a background mood music VoIP application that inserts a selected audio into the VoIP stream transported to the first VoIP phone and into the VoIP stream transported to the second VoIP phone so that both users may hear a pleasant and soothing music theme as a non disruptive background to their conversation. In some contexts a VoIP application may be referred to as a VoIPLet.

The present disclosure teaches a method for subscribing to and or provisioning a VoIP application service. The user of a VoIP phone sends a subscription message to an activation server identifying the desired subscription VoIP application service and a desired trigger signal that the VoIP phone will send to invoke the VoIP application service. The activation server sends information about the desired trigger signal and an identity of the first VoIP phone to a VoIP application server that provides the subject VoIP application service. The VoIP application server sends information to a home subscription server HSS identifying the trigger signal defining how to route a session initiation protocol SIP message to the VoIP application server to invoke the VoIP application service and optional other information related to traffic flow templates maintained by the home subscription server. Before sending the information to the VoIP application server the activation server optionally may first work with a billing server associated with an account of a user of the first VoIP phone to arrange payment for the VoIP application service. The VoIP application service may be provisioned for one time use or for a pre defined number of uses. The VoIP application service may be subscribed on a pre paid basis where the VoIP application service is provided until an account balance is exhausted. Alternatively the VoIP application service may be subscribed on a post paid basis where fees for VoIP application service are accumulated and periodically billed to an account of the user of the first VoIP phone. Other subscription payment arrangements may also be used.

The present disclosure teaches several alternative architectures for delivering VoIP application service. In an embodiment a media proxy is introduced between the first VoIP phone and the second VoIP phone through which the VoIP stream from the first VoIP phone passes during transport to the second VoIP phone and through which the VoIP stream from the second VoIP phone passes during transport to the first VoIP phone. The media proxy provides one or more sets of auxiliary ports at locations and or addresses that may be inferred from the base port locations and or addresses of the fundamental VoIP phone call. One or more VoIP application servers may deliver VoIP application service through the sets of auxiliary ports. For example a VoIP application server may insert an audio for one way insertion into the VoIP stream directed to the first VoIP phone or may insert an audio for two way insertion into both the VoIP stream directed to the first VoIP phone and the VoIP stream directed to the second VoIP phone. The media proxy may combine or mix the audio from the VoIP application so that this audio is overlaid or superpositioned with the subject VoIP stream and or VoIP steams. In an alternative embodiment the described functions of the media proxy may be distributed out to one or more of the VoIP phones and the VoIP application server. For example the combining mixing and or superpositioning of audio from the VoIP application server and the VoIP stream may be performed within the first VoIP phone within the second VoIP phone and or within the VoIP application server.

Turning now to a communication system for providing VoIP application services to VoIP calls is described. In an embodiment the system comprises a first VoIP phone having a first VoIP client and a second VoIP phone having a second VoIP client . During some operation modes of the system the first VoIP phone and the second VoIP phone may be connected in a VoIP call. The first VoIP phone may produce a first VoIP stream directed to the second VoIP phone represented by the arrow designated by the letter a. The second VoIP phone may produce a second VoIP stream directed to the first VoIP phone represented by the arrow designated by the letter b. Alternatively the first VoIP phone may be engaged in a VoIP call with another non VoIP phone via a media access gateway that mediates between the non VoIP phone for example a plain old telephone service POTS phone and the VoIP communication protocols. In an embodiment the system may further comprise an activation server a billing server an application server executing a VoIP application a home subscription server and a media proxy . In some embodiments however the system may have additional different or fewer elements. For example in an embodiment the system may not comprise the media proxy and the functions that would have been provided by the media proxy may be distributed to other parts of the system for example to one or more of the VoIP phones and or the application server .

The activation server the billing server the application server and the home subscription server may be implemented as computer systems. Computer systems are discussed in more detail hereinafter. In an embodiment the media proxy may be deployed as an application executing on a server that is a computer system. The first VoIP phone and or the second VoIP phone may be implemented as portable electronic devices for example a mobile phone a personal digital assistant a media player or other electronic device. An exemplary portable electronic device is discussed in more detail herein after. Alternatively the first VoIP phone and or second VoIP phone may be implemented as a device sharing much of the structure of a computer system.

While the system is illustrated with a limited number of components it is understood that the system may comprise many more components. For example it is understood that the system promotes any number of VoIP phones engaging in VoIP communication. As the application server begins to be heavily loaded by numbers of subscribers using the VoIP application service provided by the VoIP application additional servers having the same structure of the application server may be stood up and brought into service. In general the architecture of system is readily scalable to any number of VoIP application subscribers by standing up and bringing into service additional activation servers additional application servers additional home subscription servers and additional media proxies as needed.

While the components of the system are illustrated in as directly coupled to each other it is understood that many if not all of the communication links are provided by indirect coupling through a network. Turning now to the system is illustrated with system components communicating via a network . The network may comprise public networks private networks and a combination thereof. At least a portion of the network may comprise a mobile communication network. At least a portion of the network may comprise the Internet and or an internet protocol multimedia system IMS core network. The first VoIP phone may communicate with the network via a base transceiver station wherein the base transceiver station provides a wireless communication link to the first VoIP phone . Alternatively the first VoIP phone may receive a wireless communication link from a femto cell or from a wireless access node to access the network . The second VoIP phone may be coupled to the network by a network connection for example a data connection. A plain old telephone service POTS phone may receive VoIP service via a media gateway that mediates between the POTS interface of the POTS phone and the VoIP communication protocols. The various components of the system communicate with each other via the network .

The network may comprise a large number of devices providing the functionality of the network such as switching devices routers IMS function platforms and others. While some components of the system are illustrated in as outside and coupled to the network what nodes and or components of system are deemed to be inside versus outside the network is largely an arbitrary decision based on what one may be attempting to describe. In the present disclosure the home subscription server for example might well have been abstracted as within the cloud representing the network but it helps to clarify the architecture and operating principles of the system to illustrate and describe it separately from the network .

Returning now to the illustrated communication links may comprise any of a variety of different communication links including session initiation protocol SIP communication links real time protocol RTP communication links signaling links VoIP links and other kinds of communication links. At least some of the communication links may be provided in part over wireless communication links as described above with reference to .

In an embodiment the application server may provide a VoIP application service associated with the VoIP application . For example the VoIP application server may provide a concierge service to one or both of the VoIP phones based on executing a concierge application the VoIP application . For more details about the concierge service see U.S. patent application Ser. No. 12 698 513 filed Feb. 2 2010 entitled Concierge for Portable Electronic Device by Jeremy R. Breau et al. which is hereby incorporated herein by reference for all purposes. It is contemplated that the application server the provisioning methods the communication methods and the architecture of the system taught by the present disclosure may support a wide variety of different VoIP applications. In some contexts a VoIP application may be referred to as a VoIPLet. The application server and the VoIP application are able to provide the subject VoIP application service to a plurality of users concurrently not just the VoIP phones . For example the application server may be able to provide the VoIP application service associated with the VoIP application to 5 concurrent VoIP calls 50 concurrent VoIP calls 500 concurrent VoIP calls or some other number of concurrent VoIP calls. The VoIP application for example may instantiate a separate thread or process to provide the subject VoIP application service to each of the concurrent VoIP calls.

A brief summary of a few contemplated VoIP application services are discussed further below but it is understood that a wide variety of VoIP application services are expected to be suitable for service delivery using the system and related methods. In an embodiment two or more different VoIP applications may execute on the one VoIP Server . Alternatively different VoIP applications may be deployed on different VoIP Servers .

The application server may further comprise a speech parser and a media player . The speech parser may analyze speech to identify commands to translate speech to text to translate text to speech to identify contextual queues present in a conversation between the user of the VoIP phones and other like actions. The media player may play snippets of audio for insertion into one or more VoIP streams and or transcode audio content from a first format to a second format.

In an embodiment the application server may comprise an IMS SIP stack a RTP stack a diameter interface and an HTTP stack . The internet protocol multimedia system IMS session initiation protocol SIP stack promotes the application server communicating with an IMS core network and conducting session initiation protocol communications. The real time protocol RTP stack promotes the application server receiving and or transmitting real time protocol messages. The diameter interface promotes the application server accessing various communication authentication and authorization services for example from a diameter server not shown . The hypertext transport protocol HTTP stack promotes the application server communicating using hyper text transport protocol with other devices for example with a content server . The content server may be implemented as a computer system.

Turning now to a message sequence for provisioning a VoIP application service for invocation by the first VoIP phone is described. The message sequence may be used by the first VoIP phone and or the first VoIP client to subscribe to receive a particular VoIP application service. The first VoIP client may send a message to the activation server to subscribe to or otherwise obtain the VoIP application service provided by the VoIP application . The message may be contained in a session initiation protocol SIP message or in another kind of message format. The message which may be referred to as a subscription message contains information identifying the VoIP application service and a trigger signal that the first VoIP client can send to the home subscription server to invoke the subject VoIP application service.

The activation server may send a message to the billing server and or a billing and reconciliation server to arrange appropriate payment for the application server providing the subject VoIP application service to the first VoIP phone . This message may be referred to as a verify account message. For example the activation server may access an application programming interface API of the billing server to add periodic post paid billing to a communication services account of a user of the first VoIP phone for providing the VoIP application service to the first VoIP phone . Alternatively the activation server may access the API of the billing server to establish a pre paid mechanism for providing the VoIP application service for the first VoIP phone . For example an account balance of a pre paid account of a user of the first VoIP phone may be decremented each time the VoIP application service is invoked while funds remain in the subject pre paid account. Alternatively the activation server may access the API of the billing server to arrange a one time invocation of the VoIP application service by the first VoIP phone . In this later alternative the first VoIP phone may need to activate the VoIP application service via the activation server for every single invocation of the subject VoIP application service.

When appropriate payment arrangements have been completed the billing server may return a message to the activation server . This may be referred to as a verify message. If the billing server indicates that the payment arrangements were completed successfully the activation server sends a message for example a session initiation protocol message to the application server conveying the identification of the subscribed VoIP application service and the trigger signal. This may be referred to as a subscribe information message. The message may also comprise information about transmitting VoIP application service activation events to the billing server to bill for providing the subject VoIP application service.

In response to receiving message the application server sends a message for example a session initiation protocol message to the home subscription server identifying routing information that the home subscription server is to use to route a VoIP application service invocation command to the application server in the event the first VoIP phone sends a message containing the trigger signal to the home subscription server . The message may be referred to as a set up message. In an embodiment the application server may send information defining a traffic flow template that defines how the home subscription server can route a trigger signal to the application server based on filtering a session initiation protocol message from the first VoIP phone . It is understood that alternative VoIP application service subscription set up and or provisioning messaging sequences are also contemplated by the present disclosure.

Turning now to a message sequence diagram is described. When the first VoIP phone sends a message which may be referred to as an origination message to initiate a VoIP call to the second VoIP phone the home subscription server may dynamically set up the media proxy to bridge the VoIP streams passing between the two VoIP phones . For example the home subscription server may send a message to a server that invokes an instance of the media proxy . The message may be referred to as a set up call message. The VoIP call is then established to be bridged through the media proxy . By arranging that the VoIP call routes through the media proxy the system may dynamically deliver VoIP application service from the application server to one or both of the first VoIP phone and or the second VoIP phone via the media proxy without any interruptions of the established VoIP call. If neither of the VoIP phones has subscribed to any VoIP application services the home subscription server may not arrange for the VoIP call to route through the media proxy and the VoIP call may be completed in a peer to peer operation mode.

While the VoIP call is active the first VoIP phone may transmit the trigger signal to the home subscription server for example the user of the first VoIP phone may activate a special key code or select a soft key to invoke sending a session initiation protocol message containing the trigger signal to the home subscription server . For example the first VoIP client sends a message to the home subscription server . The message may be referred to as a trigger message. In one case for example the trigger signal may be transmitted by the first VoIP phone in response to the user of the first VoIP phone entering a 9 key code. When the home subscription server receives the message containing the trigger signal the home subscription server sends a message to the application server commanding the activation server to provide the subject VoIP application service to the first VoIP phone via the media proxy . The message may be referred to as an application initiate message.

Depending on the functionality provided by the subject VoIP application service the application server sends a message and or a data stream to media proxy . The message may be referred to as a service message. In response to receiving the message the media proxy sends the message to the first VoIP client . For example the message may comprise an audio transcription of an email directed to a user of the VoIP phone that is flagged with a high importance value. The media proxy may mix the audio message with a first VoIP stream received from the second VoIP phone to create a second VoIP stream that the media proxy transmitted to the first VoIP phone . The first VoIP phone may present the second VoIP stream and the user of the first VoIP phone may hear the voice message being spoken by the user of the second VoIP phone with the audio transcription of the email superimposed over the voice message. Depending on the functionality provided by the subject VoIP application service the media proxy may send a message based on the message to the second VoIP client . Both the message and the message may be referred to likewise as service messages.

A variety of VoIP application services are contemplated by the present disclosure. It is understood that the system and associated methods may suitably be employed to subscribe to to provision to invoke and to deliver these VoIP application services and other VoIP application services to VoIP phones and the POTS phone . A concierge application may provide a variety of assistances to the user of the first VoIP phone and optionally to the user of the second VoIP phone or the POTS phone . For example the concierge application may monitor the VoIP stream transmitted by the first VoIP phone to detect a concierge activation word string for example concierge on. When the concierge application detects the activation word string the concierge application monitors the VoIP stream transmitted by the first VoIP phone to determine a context of the VoIP call and provide useful information pursuant to the context. For example if the context of the VoIP call is a discussion of plans to go see a movie the concierge application may identify a movie schedule of one or two movies that correlate with a preference profile of the user of the first VoIP phone known to the concierge application and transmit a voice message about the movie schedules to the first VoIP client and optionally to the second VoIP client . To enable the concierge application the media proxy may send the VoIP stream generated by the first VoIP phone represented as stream a in FIG. and the VoIP stream generated by the second VoIP phone represented as stream b in FIG. to the application server .

Turning again to in an embodiment the application server may transmit VoIP stream e VoIP stream f and VoIP stream g to the media proxy . The media proxy understands that VoIP stream e is to be mixed only with the VoIP stream b originated by the second VoIP client and transmitted to the first VoIP client which may be referred to as one way insertion. The media proxy understands that the VoIP stream f is to be mixed only with the VoIP stream a originated by the first VoIP client and transmitted to the second VoIP client which likewise may be referred to as one way insertion. The media proxy understands that the VoIP stream g is to be mixed both with the VoIP stream b originated by the second VoIP client and transmitted to the first VoIP client and to be mixed with the VoIP stream a originated by the first VoIP client and transmitted to the second VoIP client which may be referred to as two way insertion.

The mixing of the multiple VoIP streams for example the VoIP e stream originated by the application server with the VoIP b stream originated by the second VoIP client may be accomplished by any process known to those of skill in the art. In an embodiment the VoIP e stream may be transformed into a first analog signal the VoIP b stream may be transformed into a second analog signal the first and second analog signals may be superimposed to produce a third analog signal possibly after applying an appropriate weighting and or amplification to the first and second analog signals and the third analog signal may be digitized to form the VoIP stream delivered to the first VoIP client . Alternatively the VoIP e stream and the VoIP b stream may be combined in the digital domain for example by adding bytes encoding time sampled amplitudes of audio signals. As is known to those of skill in the art a process referred to as companding is sometimes used in digitizing voice for communication transmission and any companding processes applied in generating the VoIP streams may be taken into account during combining and or mixing the VoIP streams. For more details about the concierge service see U.S. patent application Ser. No. 12 698 513 filed Feb. 2 2010 entitled Concierge for Portable Electronic Device by Jeremy R. Breau et al. which was incorporated by reference above.

A memo VoIP application service may be provided using the system . For example the first VoIP phone may activate the memo VoIP application service by entering a key code and then speak commands into the first VoIP phone that are transmitted to the media proxy and thence to the application server on the VoIP stream a. The memo VoIP application service may respond to commands to record a spoken memo translate the memo to text store the text memo and remind the user of the first VoIP phone at a time commanded by the user by sending an email sending a text message or by another mechanism. It is possible that the memo VoIP application service may be invoked by the first VoIP phone even when the first VoIP phone is not engaged in an on going VoIP call.

A sound board VoIP application service may be provided using the system . A plurality of audio snippets and or sound bites may be stored and played back by the application server on command by the first VoIP phone . For example on the event that the user of the second VoIP phone says something involving a long and or convoluted supporting argument the user of the first VoIP phone may invoke the playing of an audio snippet reciting that s just jibber jabber in a deep gruff voice. As another example if the user of the second VoIP phone is describing a promising new job opportunity the first VoIP phone may invoke the playing of an audio snippet of a stereotypical cash register cha Ching The selected audio snippet could be transmitted by the application server to the media proxy to be inserted into the VoIP stream transmitted by the media proxy to the first VoIP phone and to the VoIP stream transmitted by the media proxy to the second VoIP phone in two way insertion. Alternatively the selected audio snippet could be inserted into the VoIP stream transmitted by the media proxy to only the second VoIP phone in one way insertion. It is contemplated that a virtually endless list of audio snippets could be configured for use with such a sound board VoIP application the only real limitations of which may be how many different key codes the user of the first VoIP phone can remember. Alternatively a sound board client application may be installed on the first VoIP phone that provides a voice based interface that the user of the first VoIP phone may use to speak aural cues for invoking different audio snippets.

A background music VoIP application service may be provided using the system . A plurality of audios may be stored and played back by the application server on command by the first VoIP phone as a background for a VoIP call between the first VoIP phone and the second VoIP phone . The user of the first VoIP phone may select a soothing and or romantic themed audio to play as a background of a VoIP call to a girlfriend of boyfriend. The user of the first VoIP phone may select a piece of classical music conveying gravitas to play as a background of a VoIP call to his boss to report from the field. The background music could be transmitted by the application server to the media proxy to be inserted into the VoIP stream transmitted by the media proxy to the first VoIP phone and to the VoIP stream transmitted by the media proxy to the second VoIP phone in two way insertion. Alternatively the background music could be inserted into the VoIP stream transmitted by the media proxy to only the first VoIP phone or to the second VoIP phone in one way insertion.

A number of other VoIP application services are contemplated. The system is thought to be suitable for provisioning and delivering any of these VoIP application services. It is contemplated that the provisioning and VoIP application service delivery framework of the system may encourage the growth of a large number of VoIP applications developed by independent third party developers.

Turning now to a port map of the media proxy is described. When the home subscriber server sets up the media proxy for example when the home subscriber server commands a server to initiate an instance of the media proxy the media proxy may be configured to provide transmit and receive ports to each of the first VoIP phone and the second VoIP phone . For example a first VoIP port may comprise a first transmit VoIP port to transmit a VoIP stream for example any of VoIP stream b e g to the first VoIP phone and a first receive VoIP port to receive a VoIP stream for example VoIP stream a from the first VoIP phone . A second VoIP port may comprise a second transmit VoIP port to transmit a VoIP stream for example any of VoIP stream a f g to the second VoIP phone and a second receive VoIP port to receive a VoIP stream for example VoIP stream b from the second VoIP phone .

The media proxy may be configured to provide a plurality of application ports which may be referred to in some contexts as auxiliary ports for example a first application port a second application port and a third application port . While three application ports are illustrated in it is understood that fewer or more application ports may be provided. Each of the application ports may comprise a plurality of application receive VoIP ports and application transmit VoIP ports. For example the first application port may comprise a first application receive VoIP port to receive the VoIP a stream originated by the first VoIP phone and a second application receive VoIP port to receive the VoIP b stream originated by the second VoIP phone . The first application port may further comprise a first application transmit VoIP port to transmit the VoIP e stream for one way insertion into the VoIP b stream originated by the second VoIP phone a second application transmit VoIP port to transmit the VoIP g stream for two way insertion into the VoIP a stream originated by the first VoIP phone and the VoIP b stream originated by the second VoIP phone and a third application transmit VoIP port to transmit the VoIP f stream for one way insertion into the VoIP a stream originated by the first VoIP phone .

The plurality of application ports may be initiated but maintained in a dormant state by the media proxy until a VoIP application connects to the application port . In some contexts an application port in a dormant state may be said to be in a daemonized state. The application ports promote the dynamic activation and delivery of a variety of VoIP application services through the media proxy . The addresses of the application ports can be inferred from the address of the first VoIP port and or the address of the second VoIP port . Thus a VoIP application wishing to dynamically connect to an application port need only know the address of one of the first VoIP port and the address of the second VoIP port to determine the addresses of the application ports and select one of these ports to attach to.

Turning now to an embodiment of a mapping among the VoIP ports and the application port including mixing operations is described. The mapping among the VoIP ports and the remaining application ports may be substantially similar to that illustrated in . The VoIP stream received at first VoIP receive port for example VoIP a stream is transmitted to the first application VoIP receive port . Additionally the VoIP stream received at the first VoIP receive port is mixed with any VoIP stream received from either of the second application VoIP transmit port for example VoIP f stream and the third VoIP transmit port for example VoIP g stream. As illustrated in the VoIP stream received from the second application VoIP transmit port and the VoIP stream received from the third VoIP transmit port are mixed together and this mixed VoIP stream is mixed with the VoIP stream received at the first VoIP receive port but in another embodiment the mixing may be performed in a single step. The combined VoIP streams VoIP a stream VoIP f stream and VoIP g stream are transmitted to the second transmit VoIP port for transmitting to the second VoIP phone .

The VoIP stream received at second VoIP receive port for example VoIP stream b is transmitted to the second application VoIP receive port . Additionally the VoIP stream received at the second VoIP receive port is mixed with any VoIP stream received from either of the first application VoIP transmit port for example VoIP e stream and the second VoIP transmit port for example VoIP g stream. As illustrated in the VoIP stream received from the first application VoIP transmit port and the VoIP stream received from the second application VoIP transmit port are mixed together and this mixed VoIP stream is mixed with the VoIP stream received at the second VoIP receive port but in another embodiment the mixing may be performed in a single step. The combined VoIP streams VoIP b stream VoIP e stream and VoIP g stream are transmitted to the first transmit VoIP port for transmitting to the first VoIP phone . As discussed further above the mixing and or combining of the various VoIP streams may be accomplished by any of a variety of methods known to those of ordinary skill in the art.

Turning now to an alternative implementation of the mixing and or combining functions described above with reference to the media proxy is described. In the embodiment of the mixing functions are performed within one or more of the first VoIP phone the second VoIP phone and the application server . The inputs and outputs of the application server in an embodiment may be composed based on From Txsignal From Txsignal To Rxsignal To Rxand Rxsignal and To Rxsignal . The transmission of VoIP streams between the VoIP phones is from a transmit port of one VoIP phone to a corresponding receive port of the other VoIP phone. When the application server provides a VoIP stream for either one way insertion or two way insertion the application server generates a suitable VoIP stream and sends to one of the VoIP phones for one way insertion or to both phones for two way insertion. Each of the VoIP phones mix any insertion VoIP stream from the application server into the VoIP stream received from the other VoIP phone. One of ordinary skill in the art will appreciate that other alternative configurations of mixing operations conform with the teachings of the present disclosure. For example the first VoIP phone could be designed to perform all mixing functions essentially absorb into itself the mixing functions described in detail with reference to . Alternatively the application server may only support one way insertion the first VoIP phone may provide the mixing function illustrated in the application server can have a single transmit port for providing one way insertion VoIP stream to the first VoIP phone while the second VoIP phone provides no mixing function. When the application server only supports one way insertion the first VoIP phone may mix the input from the application server for example the To Rxsignal with the Txsignal that it transmits to the second VoIP phone . In this case the first VoIP phone would effectively integrate some or all of the role of the media proxy described above. In an embodiment the first VoIP phone may selectively mix the input from the application server for example the To Rxsignal with the Txsignal that it transmits to the second VoIP phone for example based on a user input to the first VoIP phone . All of these alternative configurations for providing VoIP mixing functions are contemplated by the present disclosure.

Turning now to a method is described. At block a VoIP call is established from the first VoIP phone to the second VoIP phone or to the POTS phone via the media gateway . The home subscription server may arrange for the VoIP call to be routed through the media proxy for example an instance of the media proxy executing on a server as described more fully above. At block after the VoIP call is established the first VoIP phone transmits a pre configured VoIP application trigger signal. For example a user of the first VoIP phone activates a key code that has been pre configured to send a session initiation protocol message comprising a trigger signal to the home subscription server and the first VoIP client and or the first VoIP phone transmits the subject session initiation protocol message containing the trigger signal to the home subscription server .

At block the VoIP application transmits an audio content in response to the first VoIP phone transmitting the subject session initiation protocol message containing the trigger signal to the home subscription server . For example in response to receiving the session initiation protocol message containing the trigger signal from the first VoIP phone the home subscription server transmits a session initiation protocol message to the application server commanding the activation of the VoIP application service for the first VoIP client . When the VoIP application is brought into service for use of the first VoIP client for example when an instance of the VoIP application associated with the first VoIP client is instantiated the VoIP application transmits an audio message to the first VoIP client for example one of the audio messages and or audio snippets described above.

At block the audio message and or audio content is mixed into a first VoIP stream transmitted to the first VoIP phone by the media proxy for example the media proxy mixes the VoIP e stream with the VoIP b stream transmitted to the media proxy by the second VoIP phone or the POTS phone via the media gateway and transmits the mixed VoIP e and VoIP b streams to the first VoIP phone . Alternatively the audio message may be mixed into a first VoIP stream transmitted to the first VoIP phone and into a second VoIP stream transmitted to the second VoIP phone or the POTS phone via the media gateway by the media proxy .

Turning now to a method is described. At block subscription information for a VoIP application service is transmitted by a VoIP phone for example the first VoIP phone to the activation server . The subscription information may comprise an identification of the subject VoIP application service and an identification of a trigger signal to be associated with the VoIP application service for example a trigger signal to be used to trigger the home subscription server to invoke the subject VoIP application service on behalf of the first VoIP phone . At block the subscription information transmitted by the VoIP phone is received by the activation server .

At block the activation server transmits at least some of the subscription information to the VoIP application server . The VoIP application server is understood to be configured to execute the VoIP application that provides the VoIP application service that the VoIP phone has identified it wishes to subscribe to. Because the system may support a plurality of VoIP application services executed by VoIP applications installed on a plurality of different application servers the activation server may comprise a mapping between VoIP application services and the application servers that support the corresponding VoIP applications . Alternatively the activation server may access a database that stores the mapping between VoIP application services and the application servers that support the corresponding VoIP applications . In an embodiment the activation server may also transmit an identity of the VoIP phone that is subscribing to the subject VoIP application service to the application server . In an embodiment the activation server may also transmit billing information to the application server that promotes the application server sending billing information to the billing server or other device so the user of the VoIP phone receiving the VoIP application service may be billed appropriately.

At block the application server transmits to the home subscription server the trigger identification and session initiation protocol routing information that the home subscriber server may use to route a session initiation protocol message to the application server when the VoIP phone sends a session initiation protocol message containing the trigger signal to the home subscription server invoking the subject VoIP application service. The application server may transmit additional information to the home subscription server such as one or more traffic flow templates. A traffic flow template may define where who and by what method to send a session initiation protocol packet as well as other options for sending the session initiation protocol message based on the contents of the session initiation protocol packet for example based on fields in a header of the session initiation protocol packet.

The method may be referred to as a method for subscribing to and or provisioning a VoIP application service. It is contemplated that the method may be employed to provision and or to activate a subscription to a wide variety of VoIP application services. It is contemplated that in the near future a wide variety of VoIP application services may be developed by independent third party developers as deployment of the IMS network continues and as VoIP communication becomes more common. It is hoped that the robust generally applicable subscription and or provisioning method provided by method will play a role encouraging the adoption of the VoIP application service paradigm by the public.

Turning now to a handset is described. The handset may be used to embody the one or more of the VoIP phones but the VoIP phones may be embodied in other forms than that illustrated in . Though illustrated as a mobile phone the handset may take various other forms including a portable electronic device a wireless handset a pager a personal digital assistant PDA a gaming device an inventory control device a media player a digital camera a digital calculator a portable computer a tablet computer a laptop computer and or other. In some embodiments of the present disclosure the handset may support specialized activities such as gaming inventory control job control and or task management functions and so on.

The handset includes a display and a touch sensitive surface and or keys for input by a user. The handset may present options for the user to select controls for the user to actuate and or cursors or other indicators for the user to direct. The handset may further accept data entry from the user including numbers to dial or various parameter values for configuring the operation of the handset. The handset may further execute one or more software or firmware applications in response to user commands. These applications may configure the handset to perform various customized functions in response to user interaction. Additionally the handset may be programmed and or configured over the air for example from a wireless base station a wireless access point or a peer handset . The handset may execute a web browser application which enables the display to show a web page. The handset may execute the VoIP client to subscribe to invoke and receive a VoIP application service.

Turning now to a block diagram of the handset is described. While a variety of known components of handsets are depicted in an embodiment a subset of the listed components and or additional components not listed may be included in the handset . The handset includes a digital signal processor DSP and a memory . As shown the handset may further include an antenna and front end unit a radio frequency RF transceiver an analog baseband processing unit a microphone an earpiece speaker a headset port an input output interface a removable memory card a universal serial bus USB port an infrared port a vibrator a keypad a touch screen liquid crystal display LCD with a touch sensitive surface a touch screen LCD controller a charge coupled device CCD camera a camera controller and a global positioning system GPS sensor . In an embodiment the handset may include another kind of display that does not provide a touch sensitive screen. In an embodiment the DSP may communicate directly with the memory without passing through the input output interface .

The DSP or some other form of controller or central processing unit operates to control the various components of the handset in accordance with embedded software or firmware stored in memory or stored in memory contained within the DSP itself. In addition to the embedded software or firmware the DSP may execute other applications stored in the memory or made available via information carrier media such as portable data storage media like the removable memory card or via wired or wireless network communications. The application software may comprise a compiled set of machine readable instructions that configure the DSP to provide the desired functionality or the application software may be high level software instructions to be processed by an interpreter or compiler to indirectly configure the DSP .

The antenna and front end unit may be provided to convert between wireless signals and electrical signals enabling the handset to send and receive information from a radio access network RAN or some other available wireless communications network or from a peer handset . In an embodiment the antenna and front end unit may include multiple antennas to support beam forming and or multiple input multiple output MIMO operations. As is known to those skilled in the art MIMO operations may provide spatial diversity which can be used to overcome difficult channel conditions and or increase channel throughput. The antenna and front end unit may include antenna tuning and or impedance matching components RF power amplifiers and or low noise amplifiers.

The RF transceiver provides frequency shifting converting received RF signals to baseband and converting baseband transmit signals to RF. In some descriptions a radio transceiver or RF transceiver may be understood to include other signal processing functionality such as modulation demodulation coding decoding interleaving deinterleaving spreading despreading inverse fast Fourier transforming IFFT fast Fourier transforming FFT cyclic prefix appending removal and other signal processing functions. For the purposes of clarity the description here separates the description of this signal processing from the RF and or radio stage and conceptually allocates that signal processing to the analog baseband processing unit and or the DSP or other central processing unit. In some embodiments the RF transceiver portions of the antenna and front end and the analog baseband processing unit may be combined in one or more processing units and or application specific integrated circuits ASICs .

The analog baseband processing unit may provide various analog processing of inputs and outputs for example analog processing of inputs from the microphone and the headset port and outputs to the earpiece speaker and the headset port . To that end the analog baseband processing unit may have ports for connecting to the built in microphone and the earpiece speaker that enable the handset to be used as a mobile phone. The analog baseband processing unit may further include a port for connecting to a headset or other hands free microphone and speaker configuration. The analog baseband processing unit may provide digital to analog conversion in one signal direction and analog to digital conversion in the opposing signal direction. In some embodiments at least some of the functionality of the analog baseband processing unit may be provided by digital processing components for example by the DSP or by other central processing units.

The DSP may perform modulation demodulation coding decoding interleaving deinterleaving spreading despreading inverse fast Fourier transforming IFFT fast Fourier transforming FFT cyclic prefix appending removal and other signal processing functions associated with wireless communications. In an embodiment for example in a code division multiple access CDMA technology application for a transmitter function the DSP may perform modulation coding interleaving and spreading and for a receiver function the DSP may perform despreading deinterleaving decoding and demodulation. In another embodiment for example in an orthogonal frequency division multiplex access OFDMA technology application for the transmitter function the DSP may perform modulation coding interleaving inverse fast Fourier transforming and cyclic prefix appending and for a receiver function the DSP may perform cyclic prefix removal fast Fourier transforming deinterleaving decoding and demodulation. In other wireless technology applications yet other signal processing functions and combinations of signal processing functions may be performed by the DSP .

The DSP may communicate with a wireless network via the analog baseband processing unit . In some embodiments the communication may provide Internet connectivity enabling a user to gain access to content on the Internet and to send and receive e mail or text messages. The input output interface interconnects the DSP and various memories and interfaces. The memory and the removable memory card may provide software and data to configure the operation of the DSP . Among the interfaces may be the USB port and the infrared port . The USB port may enable the handset to function as a peripheral device to exchange information with a personal computer or other computer system. The infrared port and other optional ports such as a Bluetooth interface or an IEEE 802.11 compliant wireless interface may enable the handset to communicate wirelessly with other nearby handsets and or wireless base stations.

The input output interface may further connect the DSP to the vibrator that when triggered causes the handset to vibrate. The vibrator may serve as a mechanism for silently alerting the user to any of various events such as an incoming call a new text message and an appointment reminder.

The keypad couples to the DSP via the interface to provide one mechanism for the user to make selections enter information and otherwise provide input to the handset . Another input mechanism may be the touch screen LCD which may also display text and or graphics to the user. The touch screen LCD controller couples the DSP to the touch screen LCD .

The CCD camera enables the handset to take digital pictures. The DSP communicates with the CCD camera via the camera controller . The GPS sensor is coupled to the DSP to decode global positioning system signals thereby enabling the handset to determine its position. In another embodiment a camera operating according to a technology other than charge coupled device cameras may be employed. Various other peripherals may also be included to provide additional functions e.g. radio and television reception.

Turning now to a software environment that may be implemented by the DSP is described. The DSP executes operating system software that provides a platform from which the rest of the software operates. The operating system software may provide a variety of drivers for the handset hardware with standardized interfaces that are accessible to application software. The operating system software may be coupled to and interact with application management services AMS that transfer control between applications running on the handset . Also shown in are a web browser application a media player application JAVA applets and the VoIP client . The web browser application configures the handset to operate as a web browser allowing a user to enter information into forms and select links to retrieve and view web pages. The media player application configures the handset to retrieve and play audio or audiovisual media. The JAVA applets configure the handset to provide games utilities and other functionality. The VoIP client has already been discussed above. The VoIP client generally may provide an interface and underlying functionality for subscribing to invoking and receiving a VoIP application service.

Turning now to a computer system suitable for implementing one or more embodiments disclosed herein is described. For example a computer system similar to the computer system may suitably be employed to implement one or more of the activation server the billing server the application server the home subscription server and the content server . In an embodiment a computer system similar to the computer system may suitably be employed to implement a server on which the media proxy executes. Additionally some embodiments of the VoIP phones may be suitably implemented as a computer system similar to the computer system . The computer system includes a processor which may be referred to as a central processor unit or CPU that is in communication with memory devices including secondary storage read only memory ROM random access memory RAM input output I O devices and network connectivity devices . The processor may be implemented as one or more CPU chips. A wide variety of known semiconductor devices may be employed to implement the processor including but not limited to microprocessors digital signal processors DSPs application specific integrated circuits ASICs complex programmable logic devices CPLDs microcontrollers and others semiconductor devices.

It is understood that by programming and or loading executable instructions onto the computer system at least one of the CPU the RAM and the ROM are changed transforming the computer system in part into a particular machine or apparatus having the novel functionality taught by the present disclosure. It is fundamental to the electrical engineering and software engineering arts that functionality that can be implemented by loading executable software into a computer can be converted to a hardware implementation by well known design rules. Decisions between implementing a concept in software versus hardware typically hinge on considerations of stability of the design and numbers of units to be produced rather than any issues involved in translating from the software domain to the hardware domain. Generally a design that is still subject to frequent change may be preferred to be implemented in software because re spinning a hardware implementation is more expensive than re spinning a software design. Generally a design that is stable that will be produced in large volume may be preferred to be implemented in hardware for example in an application specific integrated circuit ASIC because for large production runs the hardware implementation may be less expensive than the software implementation. Often a design may be developed and tested in a software form and later transformed by well known design rules to an equivalent hardware implementation in an application specific integrated circuit that hardwires the instructions of the software. In the same manner as a machine controlled by a new ASIC is a particular machine or apparatus likewise a computer that has been programmed and or loaded with executable instructions may be viewed as a particular machine or apparatus.

The secondary storage is typically comprised of one or more disk drives or tape drives and is used for non volatile storage of data and as an over flow data storage device if RAM is not large enough to hold all working data. Secondary storage may be used to store programs which are loaded into RAM when such programs are selected for execution. The ROM is used to store instructions and perhaps data which are read during program execution. ROM is a non volatile memory device which typically has a small memory capacity relative to the larger memory capacity of secondary storage . The RAM is used to store volatile data and perhaps to store instructions. Access to both ROM and RAM is typically faster than to secondary storage .

I O devices may include printers video monitors liquid crystal displays LCDs touch screen displays keyboards keypads switches dials mice track balls voice recognizers card readers paper tape readers or other well known input devices.

The network connectivity devices may take the form of modems modem banks Ethernet cards universal serial bus USB interface cards serial interfaces token ring cards fiber distributed data interface FDDI cards wireless local area network WLAN cards radio transceiver cards such as code division multiple access CDMA global system for mobile communications GSM long term evolution LTE worldwide interoperability for microwave access WiMAX and or other air interface protocol radio transceiver cards and other well known network devices. These network connectivity devices may enable the processor to communicate with an Internet or one or more intranets. With such a network connection it is contemplated that the processor might receive information from the network or might output information to the network in the course of performing the above described method steps. Such information which is often represented as a sequence of instructions to be executed using processor may be received from and outputted to the network for example in the form of a computer data signal embodied in a carrier wave.

Such information which may include data or instructions to be executed using processor for example may be received from and outputted to the network for example in the form of a computer data baseband signal or signal embodied in a carrier wave. The baseband signal or signal embodied in the carrier wave generated by the network connectivity devices may propagate in or on the surface of electrical conductors in coaxial cables in waveguides in an optical conduit for example an optical fiber or in the air or free space. The information contained in the baseband signal or signal embedded in the carrier wave may be ordered according to different sequences as may be desirable for either processing or generating the information or transmitting or receiving the information. The baseband signal or signal embedded in the carrier wave or other types of signals currently used or hereafter developed may be generated according to several methods well known to one skilled in the art.

The processor executes instructions codes computer programs scripts which it accesses from hard disk floppy disk optical disk these various disk based systems may all be considered secondary storage ROM RAM or the network connectivity devices . While only one processor is shown multiple processors may be present. Thus while instructions may be discussed as executed by a processor the instructions may be executed simultaneously serially or otherwise executed by one or multiple processors.

In an embodiment the computer system may comprise two or more computers in communication with each other that collaborate to perform a task. For example but not by way of limitation an application may be partitioned in such a way as to permit concurrent and or parallel processing of the instructions of the application. Alternatively the data processed by the application may be partitioned in such a way as to permit concurrent and or parallel processing of different portions of a data set by the two or more computers. In an embodiment virtualization software may be employed by the computer system to provide the functionality of a number of servers that is not directly bound to the number of computers in the computer system . For example virtualization software may provide twenty virtual servers on four physical computers. In an embodiment the functionality disclosed above may be provided by executing the application and or applications in a cloud computing environment. Cloud computing may comprise providing computing services via a network connection using dynamically scalable computing resources. Cloud computing may be supported at least in part by virtualization software. A cloud computing environment may be established by an enterprise and or may be hired on an as needed basis from a third party provider. Some cloud computing environments may comprise cloud computing resources owned and operated by the enterprise as well as cloud computing resources hired and or leased from a third party provider.

In an embodiment some or all of the functionality disclosed above may be provided as a computer program product. The computer program product may comprise one or more computer readable storage medium having computer usable program code embodied therein implementing the functionality disclosed above. The computer program product may comprise data data structures files executable instructions and other information. The computer program product may be embodied in removable computer storage media and or non removable computer storage media. The removable computer readable storage medium may comprise without limitation a paper tape a magnetic tape magnetic disk an optical disk a solid state memory chip for example analog magnetic tape compact disk read only memory CD ROM disks floppy disks jump drives digital cards multimedia cards and others. The computer program product may be suitable for loading by the computer system at least portions of the contents of the computer program product to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system . The processor may process the executable instructions and or data in part by directly accessing the computer program product for example by reading from a CD ROM disk inserted into a disk drive peripheral of the computer system . The computer program product may comprise instructions that promote the loading and or copying of data data structures files and or executable instructions to the secondary storage to the ROM to the RAM and or to other non volatile memory and volatile memory of the computer system .

While several embodiments have been provided in the present disclosure it should be understood that the disclosed systems and methods may be embodied in many other specific forms without departing from the spirit or scope of the present disclosure. The present examples are to be considered as illustrative and not restrictive and the intention is not to be limited to the details given herein. For example the various elements or components may be combined or integrated in another system or certain features may be omitted or not implemented.

Also techniques systems subsystems and methods described and illustrated in the various embodiments as discrete or separate may be combined or integrated with other systems modules techniques or methods without departing from the scope of the present disclosure. Other items shown or discussed as directly coupled or communicating with each other may be indirectly coupled or communicating through some interface device or intermediate component whether electrically mechanically or otherwise. Other examples of changes substitutions and alterations are ascertainable by one skilled in the art and could be made without departing from the spirit and scope disclosed herein.

