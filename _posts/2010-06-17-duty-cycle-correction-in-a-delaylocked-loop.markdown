---

title: Duty cycle correction in a delay-locked loop
abstract: Circuits, methods, and apparatus that provide duty-cycle error correction for clock and other periodic signals. One example provides a duty-cycle correction that can be used to improve the duty cycle of a clock signal that is received by, or generated by, a delay-locked loop. This example receives an input clock signal and uses a variable delay element to construct an improved duty-cycle output clock signal. The duty cycle of the output clock is examined to determine if the delay element is providing excess or insufficient delay. The delay of the delay element is then adjusted. To improve response times, a successive approximation technique is used to determine the most significant bits of a count that adjusts the delay through the delay element. To improve accuracy, a linear technique is used to adjust the least significant bits of the count.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08471617&OS=08471617&RS=08471617
owner: Hynix Semiconductor Inc.
number: 08471617
owner_city: Icheon-si
owner_country: KR
publication_date: 20100617
---
Closed loop clock circuits such as phase locked and delay locked loops are useful in many applications including clock and data recovery data retiming clock regeneration and other functions. Delay locked loops are particularly useful in high speed systems such as high speed memory systems.

Delay locked loops can generate clock signals or they can receive clocks signals. For example a delay locked loop in a first circuit may generate and provide a clock signal to a delay locked loop in a second circuit. These delay locked loops can clean up clock signals by removing jitter and spurious noise components. They can also retime signals to improve the performance of data transfer systems.

The duty cycle of these clock signals may become corrupted. For example driver pull up and pull down capabilities may be mismatched. That is a driver may pull a voltage on a bus line low faster than the driver can pull it high. This in turn causes skew between clock rising and falling edges. Also coupling from other signals may speed up one edge or slow another edge again causing skew between clock edges. Trace capacitance may slow rising and falling edges of a clock signal received by an input buffer or other circuit. If the switch point of the receiving circuit is not centered the recovered clock signal may have duty cycle errors.

These duty cycle errors add to any jitter component in the clock signal. As such edges of the clock signal may not be centered on received data. Accordingly these clock duty cycle errors may degrade data transmission and increase data transfer error rates.

Closed loop clock circuits by themselves typically cannot improve a clock signal duty cycle. While they are capable of removing transitory jitter they are not capable of removing static errors in a duty cycle distortion. Accordingly additional circuitry may be used.

Thus what is needed are circuits methods and apparatus that provide duty cycle error correction for clock and other periodic signals received by or generated by closed loop clock circuits such as phase locked and delay locked loops.

Accordingly embodiments of the present invention provide circuits methods and apparatus that provide duty cycle error correction for clocks and other periodic signals received by or generated by closed loop clock circuits. One embodiment of the present invention provides a duty cycle correction that can be used to improve the duty cycle of a clock signal that is received by or generated by a delay locked loop.

This embodiment of the present invention receives an input clock signal and uses a variable delay element to construct an improved duty cycle output clock signal. The duty cycle of the output clock is examined to determine if the delay element is providing excess or insufficient delay. The delay of the delay element is appropriately adjusted.

In a specific embodiment of the present invention the delay is adjusted using a combination of techniques. To improve response times a successive approximation technique is used to determine the most significant bits of a count that is used to adjust the delay through the variable delay element. To improve accuracy a linear technique is used to adjust the least significant bits of the count.

In this specific embodiment of the present invention the count may be set during a power on or initialization time. As operating conditions such as temperature and voltage vary the count may need to be adjusted. However it is difficult to secure enough time for a full recalibration of the count. For this reason one or two of the lower bits of the count may be adjusted at various times. In this case successive approximation and linear circuitry may be restarted during chip operations. During a restart the clock signal may be disturbed. Accordingly the trigger for these restarts may be the issuance of commands such as READ or REFRESH. During a read data is read from a memory and the clock is not needed. Similarly during a refresh cycle variations in the clock duty cycle may be acceptable. At these times since the clock signal is not needed or errors are acceptable the clock signal may be readjusted by a restart without negatively effecting device performance. During such a restart either or both of the successive approximation and linear circuits may be restarted.

In one embodiment of the present invention an input clock signal is received by a fixed delay line and a variable delay line. In various embodiments of the present invention the delay through the variable delay line may be shorter than equal to or longer than the delay through the fixed delay line. A latching circuit then combines the output of the fixed delay line and the variable delay line and constructs an output clock signal having an improved duty cycle. The output clock signal may be integrated. The output of the integrator may be received by a successive approximation logic circuit and a linear logic circuit which generate a count that adjusts the delay through the variable delay line.

Various embodiments of the present invention may incorporate one or more of these and the other features described herein. A better understanding of the nature and advantages of the present invention may be gained by reference to the following detailed description and the accompanying drawings.

In this memory subsystem device stores data in and retrieves data from a number of memories . Device includes memory interface that couples through data lines to memories . Memory interface provides clock address and control signals to the memories on lines . Lines are terminated by termination . The clock signals provided on lines may be single ended or differential signals. In various embodiments of the present invention they may be unidirectional or bidirectional signals.

In this example clock signals are provided by memory interface to the memories . The clock lines follow a flyby route that is they are routed sequentially from one memory to the next. The clock lines are terminated by termination . Termination may include resistors or other terminating components.

Again this circuitry is a memory subsystem where communications take place between device and memories . Device may be a processor graphics processor or other type of circuit. Memories may be dynamic random access memories or other types of memory devices. Interface and memories may be compatible with standards such as DDR3 or other standard or proprietary memory specifications.

Other types of electronic systems and circuits may be improved by the incorporation of embodiments of the present invention. Again this memory subsystem employs a flyby routing technique for the clock lines. In other embodiments of the present invention other circuit topologies such as star routing may be used.

Again in this flyby topology the clock is received by each memory sequentially. Memories that are closer to termination receive the clock signal last while memories further away from termination receive the clock signal earlier. For this reason duty cycle performance may be worse at the memories closest to termination . In order to improve performance memory interface and memories may incorporate embodiments of the present invention. An example is shown in the following figure.

In one system improved by an embodiment of the present invention in device a system clock on line is retimed by delay locked loop and provided on line . The clock signal on line is received by delay locked loop in memory and provided to the memory core on the memory clock lines . In this way device can retime the system clock signal provided on line using delay locked loop . Similarly memory can retime the clock signal received on line using delay locked loop . This in turn provides improved accuracy and data transfers between device and memory .

In other systems that are improved by embodiments of the present invention either or both of the delay locked loops and can be replaced by phase locked loops clock generators or drivers or other closed or open loop clock circuits. In one such system delay locked loop is replaced by a phase locked loop. In this system a system clock received on line is retimed by a phase locked loop and received on line by delay locked loop . In another such system a system clock received on line is driven by a clock diver and received on line by delay locked loop .

In still other embodiments of the present invention a separate delay locked loop phase locked loop or clock driver or generator may provide a clock signal on line . This clock signal may be retimed or driven by delay locked loops phase locked loops or clock drivers in device and memory .

Again periodic or clock signal received by or generated by the delay locked loops and may have corrupted or distorted duty cycles. Again this may be due to driver mismatch signal coupling excess line capacitance or other phenomena. Accordingly embodiments of the present invention provide methods circuits and apparatus that can improve the duty cycles of one or more of these signals. An example of such a circuit is shown the following figure.

The input clock on line is received by fixed delay and variable delay . The fixed delay provides a delayed clock on line to latch . Variable delay provides a variable delayed clock on line to latch . The fixed and variable delay elements may be formed using current starved inverters or other circuit techniques. In various embodiments of the present invention variable delay may provide a delay that is shorter than equal to or longer than fixed delay . In other embodiments of the present invention the delay provided by variable delay may be shorter than the delay provided by fixed delay or the delay provided by variable delay may be longer than the delay provided by fixed delay .

Latch uses edges of the fixed delay clock on line and the variable delay clock on line to generate a clock output signal on line . The clock output signal on line may be provided as an output clock from a delay locked loop it may be provided as an input to the delay locked loop or it may be used in other ways. The clock output on line is split by phase splitter into split clocks on lines . In one embodiment of the present invention phase splitter is a number of inverters providing two versions of the clock output signal on line where the two split clocks are 180 out of phase.

Integrator receives the split clocks on line and integrates them. Accordingly if the duty cycle of the split clocks on line is such that the signal is high the output of the integrator also tends to be high.

The output of the integrator generates a decision signal on line and provides it to successive approximation logic and linear logic . Successive approximation logic and linear logic are clocked by a logic clock signal on line . The frequency of the logic clock signal on line may be much less than the frequency of the input clock on line . In this way several cycles of the input clock signal on line may be integrated before being used by the successive approximation logic circuit and linear logic circuit .

Successive approximation logic circuit generates a successive approximation count on line and provides it to the variable delay . Linear logic circuit generates a linear count and provides it on line to the variable delay .

In an embodiment of the present invention successive approximation logic is used to generate the most significant bids of the count provided to variable delay . In this embodiment linear logic is used to provide the least significant bids of the count to delay .

Using successive approximation logic to generate the most significant bits allows the variable delay be set relatively close to a final value in a very rapid manner. However successive approximation techniques tend to be inaccurate. Accordingly more accurate linear logic is used to generate the least significant bits of the count provided to the variable delay . In this way successive approximation logic is used to improve speed while linear logic is used to improve accuracy.

The count may be generated during a calibration routine run during a power on initialization period or other such time. Again as the temperature and supply voltage for the device changes the desired count may changes. Accordingly the count may be updated during appropriate periods. Since the duty cycle may be disrupted during such a restart the count may be updated during a time where the clock is not needed or when errors in duty cycle may be acceptable. Such a time may occur when a READ or a RESTART command is issued.

Accordingly a control logic circuit is provided. Control logic circuit receives a restart in signal on line . The restart in signal on line may be triggered by the issuance of a READ or RESTART command or a power on or initialization command or event. Control logic may provide a restart out signal on line to either or both the successive approximation or linear logic . For example during a power on or initialization control logic may provide a restart out signal to the successive approximation and linear logic to begin the initial calibration routine. During operation a command may be sent to either or both successive approximation and linear logic to instruct the circuits to restart and update the count to compensate for temperature and voltage variations.

Again in this example a variable delay is used in generating a clock signal having improved duty cycle. The clock signal having improved duty cycle is integrated and the result is used to generate a count to control the variable delay. Again the count is generated using a combination of successive approximation and linear techniques to improve both the speed and accuracy of the loop. These activities are shown in the following figures.

In phase splitter splits the clock signal into two signals that have opposing polarities. That is phase splitter splits the clock signal into two signals separated by 180 degrees. Integrator integrates the split clock signal. When the duty cycle is greater than 50 percent a high decision is output on line while when the duty cycle is less than 50 percent the decision output on line is low though in other embodiments of the present invention other polarities for the decision signal on line may be used.

In the successive approximation logic receives the decision and generates a successive approximation count. Once the successive approximation logic has completed its task the linear logic receives the decision and generates a linear count. The successive approximation and linear counts are then used to vary the delay through the variable delay .

In a specific embodiment of the present invention the above calibration routine takes approximately 512 clock cycles to complete. Accordingly a full calibration typically only takes place during power on and initialization times. However device operating conditions such as temperature and voltage may change over time. These changes may cause the duty cycle of the output clock signal to drift.

Accordingly embodiments of the present invention provide adjustments to the count provided to the variable delay line. Since these adjustments may disturb the clock signal they may occur when it is known that the output clock signal is not needed or when errors in the duty cycle are acceptable. This may occur upon the issuance of commands such as a READ or REFRESH command. For example where an embodiment of the present invention is incorporated in a memory device the clock signal may not be needed when data is read from the memory device. In various embodiments of the present invention either or both the successive approximation or linear logic may be restarted under these conditions. In a specific embodiment of the present invention when data is read from the memory one or two least significant bits provided by linear logic circuit may be recalibrated. If data is read from memory long enough for at least a bit to be recalibrated the recalibrated bit is used otherwise it is discarded.

Accordingly a control logic circuit is included. Control logic circuit receives a restart in signal on line . This signal may be triggered by a command such as a READ REFRESH or other signal. Control logic circuit may provide a restart out signal on line . This signal may be provided to either or both the successive approximation logic and the linear logic .

In the above figures a variable delay is used in constructing an output clock. The output clock is analyzed to determine whether its duty cycle is greater than or less than 50 percent. This information is used by successive approximation logic and linear logic to generate a count signal to control the variable delay. A method employing these concepts according to an embodiment of the present invention is shown in the following figure.

Again the fixed delay element and the variable delay element may be formed using current starved inverters or other circuit techniques. The variable delay may provide a delay that is shorter than equal to or longer than the delay provided by the fixed delay. An example of a fixed delay and a variable delay are shown in the following figure.

Again latch circuits may be used to construct a clock signal having an improved duty cycle. An example of the operation of one such circuit is shown in the following figure.

A clock output can be constructed using rising edges of the variable delayed clock and falling edges of the fixed delayed clock as shown. Specifically rising edges of variable delayed clock are used as indicated by arrows A and C. Rising edges of the fixed delayed clock are used as is indicated by arrow B. In this way a clock out signal having improved duty cycle is constructed. In other embodiments of the present invention other edges of the delayed clock signals can be used. As can be seen the duty cycle of the clock out signal is 50 percent when the delay of the variable delayed clock is accurately set. That is inaccuracies in the delay of the variable delay clock lead to inaccuracies in the duty cycle of the clock out signal .

Again this clock signal may be split and integrated. An example of this integration is shown in the following figure.

The lower bank of registers receive a pulse signal on line and a clock signal on line . The pulse signal may be a single pulse that is provided during power on or initialization conditions when the loop is calibrated. Again the frequency of the clock signal on line may be much lower than the frequency of the input clock signal. The pulse signal is received on line and ripples through registers . The pulse signal on line clocks registers in succession as pulse ripples through registers . As each of the registers are clocked the level of the decision signal on line is stored in the corresponding register. The outputs of the registers provide a successive approximation count on lines . In this example four bits of a successive approximation register count are provided on lines though in other embodiments of the present invention other numbers of bits may be provided.

Again embodiments of the present invention employ successive approximation techniques to generate the most significant bits of a count that controls a delay through a variable delay element. An example of this is shown in the following figure.

The above description of embodiments of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form described and many modifications and variations are possible in light of the teaching above. The embodiments were chosen and described in order to best explain the principles of the invention and its practical applications to thereby enable others skilled in the art to best utilize the invention in various embodiments and with various modifications as are suited to the particular use contemplated. Thus it will be appreciated that the invention is intended to cover all modifications and equivalents within the scope of the following claims.

