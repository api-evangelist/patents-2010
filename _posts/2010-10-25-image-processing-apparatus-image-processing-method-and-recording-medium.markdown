---

title: Image processing apparatus, image processing method, and recording medium
abstract: Therefore, a user can easily select an output target area in a web page.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09389811&OS=09389811&RS=09389811
owner: Canon Kabushiki Kaisha
number: 09389811
owner_city: Tokyo
owner_country: JP
publication_date: 20101025
---
This application is a Continuation of International Application No. PCT JP2010 060994 filed Jun. 28 2010 which claims the benefit of Japanese Patent Application No. 2009 155310 filed Jun. 30 2009 both of which are hereby incorporated by reference herein in their entirety.

The present invention relates to an image processing apparatus that determines and outputs an output target area in a web page.

A technique for accessing a server on the Internet and displaying web pages on a display device has recently been known. Those web pages include hierarchical elements such as text and images and are displayed based on structured documents written in markup language structured language . Examples of the markup language include HTML Hyper Text Markup Language and XHTML Extensible Hyper Text Markup Language . When a web page is displayed software called a browser corresponding to the markup language analyzes a structured document and therefore the web page can be displayed on a display.

Further when such a web page is printed in addition to a method for printing an entire web page that is being displayed on a display using a browser a method for printing a portion of the web page is available. For example PTL 1 describes a method in which a user selects a portion of a web page that is being displayed by using a pointing device such as a mouse and prints the selected portion.

In the method described in PTL 1 above however the user needs to select an output target each time a web page is displayed. For example even if similar output target areas in a plurality of web pages are selected the user needs to perform the operation of selecting a portion of each web page.

Accordingly the present invention provides an image processing apparatus that allows a user to easily select an output target area in a web page.

The present invention provides an image processing apparatus including a display control unit configured to cause a display device to display information indicating a pattern for determining an output target area in a web page a determining unit configured to determine an output target area in a web page that is being displayed on the display device using a browser in accordance with a pattern corresponding to information instructed by a user within the information displayed by the display control unit and an output unit configured to output an image corresponding to the output target area in the web page determined by the determining unit in a manner distinguishable from images corresponding to another area in the web page.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.

A preferred embodiment of the present invention will be described in detail with reference to the accompanying drawings. It is to be noted that the following embodiment is not intended to limit the present invention as defined in the claims and in addition all combinations of features described in the embodiment may not necessarily be essential to the means of solution provided by the present invention.

A communication interface is an interface for performing data communication with the printer such as a USB SCSI or wireless interface or a network interface for performing data communication with the WWW servers via the Internet . A display device includes a CRT or liquid crystal display and a graphic controller and displays a graphical user interface GUI . A mouse and a keyboard are input devices with which a user gives various instructions to the PC . A system bus allows data exchange between the CPU and the RAM the ROM the hard disk and the like.

In a browser is an application for displaying a web page and performs display control so that web pages on the WWW servers are downloaded into the hard disk of the PC and are displayed on the display device . Web pages are displayed based on structured document files written in HTML XHTML or the like and those structured document files are configured such that elements forming structured documents such as text and images are written using tags. A separate file called a Cascading Style Sheet hereinafter abbreviated as CSS for specifying the display style of the elements is further specified within the structured documents. The browser analyzes the structured document files and displays the results on the display device .

In a print target selection module is plug in software called from the browser . When a user issues an instruction to clip an image area targeted for print before performing printing creation of a print preview editing or the like on the browser the print target selection module is executed.

In the print target selection module a document analysis unit analyzes a structured document in a corresponding web page that is being displayed using the browser and also analyzes elements included in the structured document. A candidate frame display unit acquires a clipping candidate frame file indicating the position of the print target area in the web page from a storage unit described below and performs display control to display a clipping candidate frame on the display device in a selectable manner. In the display of a clipping candidate frame several candidate frames are prepared and are displayed in a list in a thumbnail display form. The clipping candidate frame file is information indicating an area pattern to be clipped from the web page and is stored in the storage unit in advance the details of which are described below.

A print target display unit performs display control to present a print target area in the web page based on the clipping pattern indicated by a selected candidate from among the clipping candidates displayed on the candidate frame display unit . Specifically first when a user selects a desired candidate by operating the mouse or the like an instruction is input in accordance with the operation. Then based on the analysis result obtained by the document analysis unit an element having a configuration similar to that of the pattern of the selected candidate frame is detected from among the elements included in the structured document and is determined as a print target. Further processing is performed so that an element that is not a print target on the display screen is hatched to facilitate easy distinction of the print target area. The details of the hatching processing are described below. However the display method is not limited thereto and any other display that allows distinction of a print target area such as making an out of print target area semi translucent may be used.

A print target adjustment unit adjusts the size or position of the print target area displayed on the print target display unit in accordance with an instruction input from the mouse or the keyboard . That is the user can perform operations such as movement enlargement and reduction by operating the mouse as necessary and can update a web page area specified as a print target by the print target display unit . Then when a print target set button described below is pressed and a user instruction is input an image in the area displayed by the print target display unit is determined as a print target. A registration unit uses the determined print target area as a new clipping candidate frame and creates a thumbnail image indicating the pattern of the print target area in the web page. A list display unit displays a list in which the thumbnail image created by the registration unit is added to the clipping candidate frames displayed by the candidate frame display unit .

When a cutting candidate frame registration button described below is further pressed and an instruction is input the registration unit performs storage control for storing a clipping candidate frame file indicating the position of the determined print target area as a new clipping candidate frame in the storage unit . The storage unit is a storage area for storing clipping candidate frames and is provided in the ROM or the hard disk .

Further when the user inputs a user instruction by performing an operation for starting printing a print processing unit causes a printer driver to execute drawing processing via an OS in accordance with information about the arrangement of print layout elements. The OS provides an API Application Programming Interface for allowing the print target selection module to exchange print setting data from the printer driver or an API for performing drawing processing. Further the OS includes various control software such as a spooler system for managing print jobs and a port monitor for outputting a printer command to a port the details of which are omitted. The printer driver generates print data in accordance with the drawing processing executed by the print processing unit converts the generated print data into a printer command and then transmits the printer command to the printer via the OS . Then the printer prints an image on a sheet in accordance with the received printer command.

Further even before a user selects a clipping candidate frame any of clipping candidate frames displayed in a list in the area may be reflected in a web page displayed in the area and displayed with hatching. In this case based on the result of analysis of the structured document by the document analysis unit an element is detected from among a plurality of elements included in the web page so that the print target area displayed in the area is close to a clipping candidate frame displayed in the list and an area corresponding to the detected element is displayed with hatching. As illustrated in while a clipping candidate frame file represents linear boundaries if elements near the boundaries in the web page are individually detected areas to be actually hatched are not always displayed with lines.

A process for detecting an element which is performed by the print target display unit will be described using . First in a web page that is being displayed in the area position information about each element included in the web page is detected. The position information may be information written in a tag corresponding to an element included in a structured document such as an HTML document or may be information written in CSS.

Then the detected position information is compared with position information in the web page about boundaries that are made active inactive as the print target indicated by a clipping candidate frame file to determine whether or not the element is included in the print target. As a result of the comparison if an element near the boundaries indicated by the clipping candidate frame file is detected whether or not the element is included in the print target may be determined in accordance with a predetermined standard. For example if the boundaries of the clipping candidate frame overlap an element whether or not the element is the print target may be determined in accordance with the distance between the border of the clipping candidate frame and the border of the element or all the elements overlapping the boundaries of the clipping candidate frame may be determined as the print target.

While here an element included in a structured document file corresponding to a web page is directly searched for and an area is extracted any other method for example creating an intermediate file such as EMF corresponding to the web page and extracting an element from the intermediate file may be used. That is any method that allows position information within a web page to be obtained may be used.

Further position information about a print target area which is indicated by a clipping candidate file is for example coordinate information indicating coordinates in a web page. Then in order to select a print target area in the web page the coordinates indicated by the coordinate information included in the clipping candidate file are converted in accordance with the size of the web page that is being displayed using the browser to calculate the coordinates of an area that is a print target candidate in the web page. Then the coordinates are compared with the coordinates at which elements are located in the web page to detect an element that is a print target.

Next the operation of selecting and adjusting a print target area and registering a clipping candidate frame according to this exemplary embodiment will be described using . is a display transition diagram until a clipping candidate frame is registered and is a flowchart illustrating a processing procedure performed until a clipping candidate frame is registered.

When the browser displays a web page an icon for starting the print target selection module serving as plug in software for the browser is displayed together with the web page . In this state when a user inputs an instruction for selecting the icon by operating the mouse or the like a process in the flowchart illustrated in is started.

In the flowchart illustrated in first in S the candidate frame display unit displays clipping candidate frames stored in the storage unit in advance in a list. In this state the user can select a clipping candidate frame for example a clipping candidate frame by performing an operation using the mouse or the like. In S it is checked whether or not an instruction for selecting a clipping candidate frame which is given by the user has been input.

If the instruction has been input the process proceeds to S in which the print target display unit performs display to present a print target area in the web page that is being displayed in a manner reflecting the selection frame selected from within the list of clipping candidates. For example as indicated by a web page an area that is not a print target is hatched. The processing of S for reflecting the clipping candidate frame in the web page is executed by the print target display unit described above and an element at the position corresponding to the candidate frame selected by the user is determined as a print target element. Therefore a print target area is determined.

In this state the user can perform adjustment of the print area such as movement enlargement and reduction by operating the mouse or the like. Then in S if an instruction for adjusting the print area has been input the print target adjustment unit adjusts the print target area in accordance with the instruction. In this case for example an arrow indicated by may be displayed in accordance with a reduction of the print target area.

In this manner a user can adjust the area that the user wishes to print within a web page and can further determine a print target area by pressing the print target set button . In S it is checked whether or not an instruction for determining the print target area has been input. If the instruction has been input in S a clipped image indicating the details of a determined print target area is created and displayed. In one clipped image is displayed by way of example. However a clipped image may be added repeatedly each time a print target area is determined and a list of clipped images may be displayed.

Then in S the registration unit uses the determined print target area as a new candidate and creates a thumbnail image indicating the area. Then in S the list display unit uses the thumbnail image created in S as a new clipping candidate frame and adds the thumbnail image to the clipping candidate frames already displayed in a list for display. Further as illustrated in in this case the hatched display indicating the print target area in the web page is canceled.

Further the user can store the created candidate frame in the storage unit by pressing the cutting candidate frame registration button and making an instruction to register a candidate frame. Thus in S it is checked whether or not an instruction for registering a candidate frame has been input. If the instruction has been input in S information indicating the candidate frame is stored in the storage unit .

The user can perform printing by pressing a print button illustrated in which is omitted herein because the above processing procedure describes a process for registering a clipping candidate frame. That is if a print instruction is input by pressing the print button in S or S in the displayed print target area is printed by using the process of the print processing unit . Further in S a print instruction can be made by selecting the clipped image although the print target area in the web page is not presented.

Accordingly the user can determine an area as a print target by selecting it from displayed clipping candidates thus facilitating easier determination of a desired print area. Moreover the user can adjust a print target area and can further register a clipping candidate frame corresponding to the print target area.

Here adjustment is performed on a print target area corresponding to a clipping candidate frame selected by a user by way of example. However the adjustment of a print target area is not limited thereto. For example adjustment may be performed in a state where the entire web page is set as a print target area or may be performed in a state where a predetermined print target area in a web page is selected. The registration of a clipping candidate frame is not limited to that of a print target area that is adjusted after the user selects a clipping candidate frame and a clipping candidate frame corresponding to the print target area adjusted by the user may be registered.

Next the processing of S in the flowchart illustrated in in which clipping candidate frames are displayed in a list in the area illustrated in will be described. Specifically a case where the display order is changed in accordance with the web page that is being displayed using the browser will be described.

In the clipping candidate frame pattern table illustrated in a display order item indicates for example the previous display order of the clipping candidate frames and the candidate frame display unit changes the display order in accordance with the web page that is being displayed using the browser . An ID is an ID for specifying a clipping candidate frame file for displaying a clipping candidate frame stored in the storage unit .

Further a clipping candidate frame file indicates the file name of a clipping candidate frame file. An associated web address indicates the address of a web page that is displayed when the corresponding clipping candidate frame file is created that is location information on a network about the structured document corresponding to the web page. In the associated web address the black star represents a clipping pattern that is registered by default and indicates that the address of the corresponding web page does not exist.

In order to register a new clipping candidate frame in the pattern table a new ID is added and a clipping candidate frame is created as a file and is added to the pattern table in correspondence with the ID . At the same time the address of the web page that is being displayed during the registration is written in the associated web address .

The clipping candidate frames displayed in the area illustrated in are displayed in the order based on the clipping candidate frame table. For example if the display order item illustrated in is used the thumbnail images of the clipping candidate frames are read from the storage unit in sequence from the Top portion in accordance with the clipping candidate frame file .

However if the address of the web page displayed using the browser is included in the associated web address in the clipping candidate frame pattern table the ID of the clipping candidate frame file corresponding to the address is moved to the Top. Thus the clipping candidate frame corresponding to the web page that is being displayed can be displayed at an upper position in the display order. That is when a web page with the same address is printed the area that the user wishes to print in the web page may not possibly change and therefore the clipping candidate frame previously created is displayed with high priority.

If a plurality of candidate frames have been displayed for similar addresses a candidate frame to be displayed with high priority for this address may be determined in accordance with the number of previous selections. Alternatively a more newly selected candidate frame may be set as a candidate frame to be displayed with high priority for the address.

Furthermore if the display order of clipped images is changed in the above manner the pattern table may be updated in accordance with the display order. This is because of the following reasons A web page to be printed next may possibly be a web page of a similar type even if the web addresses do not match and web pages of similar types may possibly have similar configurations. Therefore the print target area that the user wishes to print may possibly be similar to that in the previously displayed web page. In addition even if the web address of the web page does not completely match that of the previously displayed web page if it is determined that the configurations of the web pages are similar such as in a case where portions of the web addresses match the clipping candidate frame corresponding to the address may be displayed at an upper position in the display order. Alternatively the display order may be determined by analyzing the configuration of a displayed web page and comparing the web page with the stored clipping candidate frame files. Furthermore the number of previous selections of clipping candidate frames may be stored in a table and the display order may be determined in accordance with the number of selections.

The above process allows a user to preferentially select a desired clipping candidate frame among clipping candidate frames displayed in a list thus facilitating easier selection of a print target area.

According to this exemplary embodiment therefore a user selectively displays candidate frames indicating candidates of an area that is a print target in a web page and an output target area from the web page is selected in accordance with a candidate frame selected by the user. Thus the user can select a desired output target area without selecting an output target area for each web page.

In this exemplary embodiment an element located in a web page is extracted in accordance with a clipping candidate frame selected by a user and an area corresponding to the extracted element is determined as an output target area. However for example if image data such as bitmap or an intermediate file such as EMF described above is crated based on a web page it is possible to extract an area corresponding to a portion of the element located in the web page. Therefore an area corresponding to a clipping candidate frame selected by a user may be clipped from the image data or intermediate file corresponding to the web page.

Furthermore the adjustment of the size or position of an area selected in accordance with a candidate frame allows a user to roughly specify an area as an output target by selecting a candidate frame and then to further adjust an output target area.

Furthermore a new candidate frame can be registered based on an area of a web page specified by a user. Thus for example when a similar web page is output a user can determine an output target area so as to reflect the previously specified output target area.

In the foregoing exemplary embodiment description has been given of a case where a web page displayed based on a structured document is printed. However the present invention is not limited thereto and is designed to set a candidate frame of a print target area for various applications.

In the foregoing description furthermore an area extracted as an output target from a web page is displayed so that a user can distinguish the extracted area from other areas and the output target area is printed. However besides this an area extracted as an output target from a web page may be printed without being displayed. Alternatively an entire web page may be printed in such a manner that an area extracted from the web page can be distinguished from other areas.

Furthermore an image in an output target area extracted from a web page may not only be printed but also be output in other forms such as being displayed on a display device or transmitted to an external device. In the foregoing exemplary embodiment furthermore description has been given of a case where the extraction of a print target area in a web page is implemented by cutting an image in a print target area. However besides this an image corresponding to a web page may be stored and mask processing for replacing pixel values of an area other than the print target area with predetermined pixel values may be performed. In the exemplary embodiment a method based on the mask processing is also included as an image extraction process.

In the foregoing exemplary embodiment furthermore description has been given of a case where the processing is performed by the PC . However the present invention is not limited thereto and the processing may be performed in a printer. In this case a control unit provided in the printer serves as an image processing apparatus according to the claimed invention to execute processing and a printing unit in the printer serves as an external printing device to which the image processing apparatus outputs an image.

Furthermore the present invention may also be implemented by executing the following processing A software program implementing the functions of the foregoing embodiment is supplied to a system or an apparatus via a network or various storage media and a computer or a CPU an MPU or the like of the system or the apparatus reads and executes the program. The present invention may also be implemented by a plurality of processors such as CPUs or MPUs by executing processing in cooperation with one another.

The present invention is not to be limited to the foregoing embodiment and a variety of changes and modifications can be made without departing from the spirit and scope of the present invention. Therefore the appended claims which follow are provided to clearly define the scope of the present invention.

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

