---

title: Method and system for switching in a virtualized platform
abstract: A local manager in a local networking domain may configure a plurality of logical switches by combining switching functions available in network devices and/or network switches in the local networking domain. The configuration may utilize vertical and/or horizontal combinations of the switching functions. The switching functions may comprise network switch-based switching functions, and/or hypervisor-level switching functions and/or network adapter-level switching functions available in network devices which may be configured as virtualized platforms. The local manager may provide interfacing services to enable exposing configured logical switches. The interfacing services may comprise an internal interface, which may be utilized, via the local manager, to control the switching functions corresponding to logical switches and/or to route messages sent to and/or from the logical switches. The interfacing services may also comprise an external interface, which may be used by external entities, such as remote management entities, to manage and/or interact with configured logical switches.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09031081&OS=09031081&RS=09031081
owner: Broadcom Corporation
number: 09031081
owner_city: Irvine
owner_country: US
publication_date: 20100809
---
This patent application makes reference to claims priority to and claims benefit from U.S. Provisional Application Ser. No. 61 232 637 filed on Aug. 10 2009 and U.S. Provisional Application Ser. No. 61 360 222 filed on Jun. 30 2010. This application also makes reference to 

Certain embodiments of the invention relate to networking. More specifically certain embodiments of the invention relate to a method and system for switching in a virtualized platform.

An electronic communication network is a collection of two or more computing nodes which are communicatively coupled via a transmission medium and utilized for transmitting information. Most networks adhere to the layered approach provided by the open systems interconnect OSI reference model. The OSI reference provides a seven 7 layer approach which includes an application layer Layer 7 a presentation layer layer 6 a session layer Layer 5 a transport layer Layer 4 a network layer Layer 3 a data link layer Layer 2 and a physical layer Layer 1 . Layer 7 through layer 5 inclusive may comprise upper layer protocols while layer 4 through layer 1 may comprise lower layer protocols. Some networks may utilize only a subset of the 7 OSI layers. For example the TCP IP model or Internet Reference model generally utilizes a 5 layer model which comprises an application layer Layer 7 a transport layer Layer 4 a network layer Layer 3 a data link layer Layer 2 and a physical layer Layer 1 . These five layers can be broken down into a fairly specific set of responsibilities or services which they provide.

As electronic communication networks become increasingly popular ways of exchanging data of various types sizes for a variety of applications and business and consumers alike want faster and faster network access on more and more devices. Furthermore malicious traffic and or other security threats also increase with the increased reliance on electronic information. Consequently communicating the ever increasing amounts of data and number of devices in a network presents many challenges to network and system designers and administrators.

Virtualization is one area that system designers and administrators have looked to for improving networks. In this regard in non virtualized systems a single machine such as a server or a client for example may be utilized to concurrently support multiple server operations or services. For example a single server may be utilized for providing access to business applications while also operating as an email server a database server and or an exchange server. The server may generally support the various server operations by utilizing a single operating system OS . The server operations via the single OS make use of server processing resources such as the central processing unit CPU memory network interface card NIC peripheral sound card and or graphics card for example. In many instances the server resources may not be efficiently utilized because the demand for server operations generally vary based on the type of service provided and or user needs. Consolidating server services into a single physical machine may result in an improvement in server efficiency. However consolidation also removes the level of protection that is provided when the operations are maintained separately. For example when the operations are consolidated a crash or failure in a database server may also result in the loss of email services exchange services and or application services.

Virtualization however may improve server efficiency. Virtualization may comprise utilizing multiple operating systems running concurrently on the server so that each operating system supports a different server operation or application or service for example. The multiple operating systems may be referred to as guest operating systems GOSs or child partitions. This approach maintains the level of protection provided when server operations are not consolidated under a single operating system while also enabling the optimization of the usage of the processing resources available to the server. The use of multiple guest operating systems may be referred to as OS virtualization because each GOS perceives to have full access to the server s hardware resources. In this regard a GOS is unaware of the presence of any other GOS running on the server. In order to implement OS virtualization a software layer may be utilized to arbitrate access to the server s hardware resources. This software layer may be referred to as a hypervisor or virtual machine VM monitor for example. The hypervisor may enable the multiple GOSs to access the hardware resources in a time sharing manner. This software layer may be assisted by a trusted GOS TGOS which may also be referred to as a parent partition or Virtual Machine Kernel VMK for instance. Although virtualization is useful in many contexts it does not address many of the challenges faced by system designers and network administrators and in fact presents many new challenges.

Further limitations and disadvantages of conventional and traditional approaches will become apparent to one of skill in the art through comparison of such systems with some aspects of the present invention as set forth in the remainder of the present application with reference to the drawings.

A system and or method is provided for switching in a virtualized platform substantially as shown in and or described in connection with at least one of the figures as set forth more completely in the claims.

These and other advantages aspects and novel features of the present invention as well as details of an illustrated embodiment thereof will be more fully understood from the following description and drawings.

Certain embodiments of the invention may be found in a method and system for switching in a virtualized platform. In various embodiments of the invention a local manager in a local networking domain may configure control and or manage a plurality of logical switches which may be configured by combining switching functions in network devices and or network switches available in the local networking domain. The network switches may comprise one or more blade switches and or top of rack ToR switches. The switching functions may comprise network switch based switching functions that may be provided by the network switches in the local networking domain and or hypervisor based switching functions and or network adapter based switching functions available in the network devices in the local networking domain when the network devices are configured as virtualized platforms for example. Hypervisor based switching functions may comprise a Virtual Switch vSwitch functions Virtual Ethernet Bridging VEB functions Virtual Ethernet Port Aggregation VEPA functions VNTag functions and or any other Network Interface Virtualizer NIV functions. Network adapter based switching functions may comprise embedded Switch eSwitch functions Virtual Ethernet Bridging VEB functions Virtual Ethernet Port Aggregation VEPA functions VNTag functions and or any other NIV functions. The configuration of the logical switches may be based on vertical and or horizontal combinations of the switching functions. Vertical combinations may comprise combining at least a hypervisor based switching function and a network adapter switching function in a single logical switch. Horizontal combinations may comprise combining hypervisor based switching functions combining network adapter switching functions and or combining network switch based switching functions in a single logical switch.

The local manager may also provide interfacing services to enable exposing of configured logical switches to management entities external to the local networking domain for example. The interfacing services may comprise an internal interface which may be utilized via the local manager to configure the constituent switching functions and or to forward receive messages to from the logical switches. The interfacing services may also comprise a uniform external interface which may enable external entities such as remote management entities for example to manage and or interact with the configured logical switches.

The local networking domain may comprise plurality of devices and or entities which may be inter connected directly and or via other devices and or entities within the local networking domain and or may be administered and or managed by a single entity such as the local manager .

Each of the network devices . . . may comprise suitable logic circuitry interfaces and or code that may be operable to perform various tasks and or execute applications based on for example preloaded instructions and or user input. Exemplary network devices may comprise a server a personal computer PC a laptop a smart phone and or handheld mobile device. Each of the network devices . . . may communicate data and or messages during performance of tasks and or execution of applications. In this regard the network devices . . . may transmit and or receive data via the network switching system within and or external to the local networking domain . The network devices . . . may utilize network links for communicating with the network switching system . In this regard the network links used by network devices . . . may comprise Ethernet links such as 10 Gigabit Ethernet 10 GbE links.

The network switching system may comprise suitable logic circuitry interfaces and or code for performing switching and routing of information within and or external to the local networking domain . The network switching system may comprise for example a plurality of switches. For example the network switching system may comprise one or more blade switches and a top of rack ToR switch . The switching system may enable exchange of data among the network devices . . . . The network switching system may also provide external routing of data communicated by the network devices . . . to and or from the network and or the SAN for example. Switching operations may be performed by one or more networking layers based on for example the Open Systems Interconnection OSI Model. For example the network switching system may be operable to perform L2 L3 L4 VLAN and or any other higher and or additional protocol layer based switching. In an exemplary aspect of the invention the network switching system may also provide internal routing within the local networking domain to enable and or support data and or messages communication internally within the local networking domain among the network devices . . . for example.

The local manager may comprise suitable logic circuitry interfaces and or code that may be operable to manage and or control operations of one or more devices and or entities with which it is associated. The local manager may be utilized to configure and or manage one or more devices of the local networking domain such as the network devices and or the network switching system . In this regard the local manager may configure control and or manage for example data communication and or switching operations in and or external to the local networking domain . While the local manager is shown as a separate component within the local networking domain the invention need not be so limited. For example the functionality and or operations described herein with regard to the local manager may be performed by other components of the local networking domain such as one or more of the blade switches and or the ToR switch .

The local manager may also be operable to support management of associated devices by one or more external and or dedicated network management entities e.g. used by remote administrators by for example exposing one or more application programming interface APIs to the network management entities for interacting with devices and or entities in the local networking domain that are associated with the local manager . In this regard the local manager may be operable to translate between the API and one or more network interfaces. For example the local manager may be operable to receive a command or request over a network interface and may de packetize convert reformat and or otherwise process the command or request to generate a corresponding command or request on one or more APIs to one or more devices. The local manager may also expose an internal API iAPI which may be utilized within the local networking domain generally in the same fashion for management related interactions with and or among devices associated with the local manager within the local networking domain .

The network may comprise a system of interconnected networks and or devices which may enable exchange of data and or messages among a plurality of nodes based on one or more networking standards including for example Internet Protocols IP . The network may comprise a plurality of broadband capable subnetworks which may comprise for example satellite networks cable networks DVB networks the Internet and or other local or wide area network. These subnetworks may collectively enable conveying data via Ethernet packets for example to plurality of end users. In this regard physical connectivity within and or to or from the network may be provided via copper wires fiber optic cables wireless interfaces and or other standards based interfaces. The SAN may comprise one or more remote storage resources. In this regard the SAN may comprise network of storage devices which may be remotely accessed and or utilized for storage by network devices such the network devices wherein the storage devices of the SAN may be presented as locally attached storage resources to operating systems OS and or virtual machines VMs running in the network devices. The network devices . . . may obtain external networking connectivity via the network switching system for example to access the network and or the SAN .

In operation the local networking domain may provide various services to support applications and or processes running and or executing in the network devices . . . . In this regard the local networking domain may enable communicating data and or messages from and or to the network devices . . . within the local networking domain and or external to it. Switching operations may be performed in the local networking domain to facilitate these data communications from and or to the network devices . For example the network switching system may route and or forward packets from and or to the network devices . In this regard the packets may be received from and or send to the network devices via one or more the blade switches . Furthermore packets received from and or destined for external entities accessed via the network for example may be routed via the ToR switch .

In an exemplary aspect of the invention switching may also be provided internally within at least some of the network devices in addition to network switch based switching functions which may be provided via the blade switches and or the ToR switch . In this regard hardware and or software components of the network devices may be configured to provide data switching and or routing within the network devices . For example the network device may comprise a network interface controller NIC to provide network access capabilities. Furthermore in instances where the network device is implemented as a virtualized platform comprising a plurality of virtual machines VMs the network device may comprise a hypervisor which may comprise a software partition that enables interactions between at least some of the VMs running in the network device and resources e.g. the NIC available in the network device . Accordingly NICs and or hypervisors may be configured to support switching and or routing within the network device between at least a portion of the VMs running therein. In this regard the NIC may be configured and or may comprise sub components for providing NIC based switching. In this regard NIC based switches may implement eSwitch Virtual Ethernet Bridging VEB Virtual Ethernet Port Aggregation VEPA VNtag and or any other NIV protocol based switching. The hypervisor may also be configured and or may comprise sub components for providing hypervisor based switching. In this regard the hypervisor may comprise virtual switch vSwitch functionality.

In various exemplary embodiments of the invention a plurality of logical switches may be configured in the local networking domain by the local manager for example using various switching functions available in the local networking domain . In this regard the switching functions may comprise hypervisor based switching functions NIC based switching functions and or network switch based switching functions. Furthermore the local manager may be utilized to abstract the details of each of the configured logical switches to aggregate the capabilities of constituent switching functions for each logical switch and or present the configured logical switches as singular entities to for example management entities which may interact with configure and or utilize these switches. The API and or the iAPI may be configured and or utilized for example to provide uniform internal and or external switching related interface services among the configured logical switches configured in the local networking domain and or between the configured logical switches and other entities within or external to the local networking domain .

The logical switches may be configured using for example vertical and or horizontal combinations of switching functions that may exist in one or more of the network devices and or in one or more of the blade switches or the ToR switch . In this regard vertical combination may refer to combinations comprising switching functions operating at different levels such as hypervisor based NIC based or network switch based switching function. Horizontal combination may refer to combinations comprising switching functions operating at the same level such as hypervisor based NIC base or network switch based switching function but in different machines such as hypervisor based or NIC based switching functions in different network devices or network switch based switching functions operating in for example different blade switches .

In an exemplary vertical combination for example network switch based switching function may be combined with both a hypervisor based switching function and a NIC based switching function and all three functions may be exposed by the local manager as a singular logical switch. In this regard a network switch such as the blade switch and or the ToR switch may be utilized control operations of the NIC based switching function and the hypervisor based switch. In another exemplary vertical combination only the hypervisor based switching function and the NIC based switching function may combined and they may be controlled and exposed as a single switch that is different from the network switch based switching function that may run below it.

In an exemplary horizontal combination all the hypervisor based switching functions and the NIC based switching functions in at least some of the network devices may be combined and exposed to network administrators for example as a single logical switch. Furthermore the network switch based switching functions corresponding to and or servicing those network devices may also be combined and exposed as another logical switch. In another exemplary horizontal combination all the hypervisor based switching functions and all the NIC based switching functions in at least some of the network devices and all the network switch based switching functions corresponding to and or servicing those network devices may be combined and exposed as a single logical switch. In yet another exemplary horizontal combination all the NIC based switching functions in at least some of the network devices and all the network switch based switching functions corresponding to and or servicing those network devices may be combined and exposed as a single logical switch and all the hypervisor based switching functions in those devices may be combined into and exposed as another logical switch.

The network device may correspond to one or more of the network devices . . . of . The network device may comprise the host processor the host memory the system bus the I O subsystem and or the network access subsystem . In this regard the host processor may provide overall control and or management of the operations of the network device the I O subsystem may enable user interactions with the network device and the network access subsystem may enable communication of data and or messages from and or to the network device when executing various tasks and or applications. The network device may also comprise other hardware resources not shown such as a graphics card and or a peripheral sound card for example.

The host processor may comprise suitable logic circuitry interfaces and or code that may be operable to process data and or control and or manage operations of the network device and or tasks and or applications performed therein. In this regard the host processor may be operable to configure and or control operations of various components and or subsystems of the network device by utilizing for example one or more control signals. The host processor may also control data transfers within the network device . The host processor may enable execution of applications programs and or code which may be stored in the host memory for example. The host memory may comprise suitable logic circuitry interfaces and or code that enable permanent and or non permanent storage and or fetching of data code and or other information used in the network device . In this regard the host memory may comprise different memory technologies including for example read only memory ROM random access memory RAM and or Flash memory. The host memory may store for example configuration data which may comprise parameters and or code comprising software and or firmware but the configuration data need not be limited in this regard.

The system bus may comprise suitable logic circuitry interfaces and or code that may enable exchange of data and or messages between various components and or systems in the network device . In this regard the system bus may comprise parallel or serial and or internal or external based bus technologies and or any combinations thereof. Exemplary system bus interfaces may comprise Inter Integrated Circuit IC Universal Serial Bus USB Advanced Technology Attachment ATA Small Computer System Interface SCSI Peripheral Component Interconnect PCI and or Peripheral Component Interconnect Express PCI e based interfaces.

The I O subsystem may comprise suitable logic circuitry interfaces and or code that may enable inputting and or outputting data and or messages to support user interactions with the network device to receive user input and or provide user output. For example the I O subsystem may facilitate interactions with the network device via one or more I O devices such as a monitor a mouse and or keyboard.

The network access subsystem may comprise suitable logic circuitry interfaces and or code that may be operable to communicate data and or messages from and or to the network device . The network access subsystem may comprise for example a network interface controller or chip NIC . The network access subsystem may comprise for example the networking processor the networking memory and or the plurality of ports . The networking processor may comprise suitable logic circuitry interfaces and or code for controlling and or managing operations of the network access subsystem . The networking memory may comprise suitable logic circuitry interfaces and or code for dedicated local storage and or buffering of data within the network access subsystem . In this regard the networking memory may comprise one or more ROM and or RAM memory devices. Each of the plurality of ports may comprise suitable logic circuitry interfaces and or code for providing network interfacing functionality in the network access subsystem based on one or more networking standards and or protocols. The plurality of ports may comprise for example 10 GbE ports. The network access subsystem may support and or perform for example physical PHY layer related access via the plurality of ports and or processing therefor. The network access subsystem may also perform at least some switching such as layer 2 L2 based switching for example during transmission and or reception of data packets. The switching supported by the network access subsystem however need not be limited to L2 and may comprise L2 L3 L4 VLAN and or other protocol layer. In an exemplary aspect of the invention the network access subsystem may support inter VM switching within the network device . In this regard the network access subsystem may be configured to support switching operations based on for example eSwitch VEB VEPA VNtag and or other NIV protocols.

In operation the network device may be integrated into a local networking domain such as the local networking domain of . The network device may be utilized therein to execute applications and or processes via the host processor for example. Some of the applications and or processes executed by the network device may be triggered by and or may require user input and or output which may be received and or provided via the I O subsystem for example. During its operations in the local networking domain the network device may transmit and or receive data and or messages via the network access subsystem for example. Data and or messages communicated by the network device may be transmitted and or received for example via network links which may be utilized through one or more of plurality of ports . The data and or messages may routed and or switched via the network switching system of the local networking domain using one or more of blade switches and or the ToR switch for example to enable exchanging of data and or message between the network device and devices or entities within or external to the local networking domain .

In an exemplary aspect of the invention the network device may be configured as a virtual platform. In this regard the host processor may be utilized for example to run a plurality of VMs. Furthermore a hypervisor HV may be run and or used via the host processor for example to support operations of the VMs. In this regard the hypervisor may be used to enable at least some of the VMs to interact with some of the physical resources in the network device such as the network access subsystem . Furthermore the hypervisor may also support inter VM switching within the network device . In this regard vSwitch based switching may be provided for example to enable routing of messages and or data between at least some of the VMs that may run in the network device .

In various embodiments of the invention logical switches may be configured by combining switching functions available in the network device and or external devices such as the network switches in the network switching system . In this regard these logical switches may comprise hypervisor based switching functions and or NIC based switching functions which may be available within the network device and or network switch based switching functions which may be available via the network switching system for example. These logical switches may also comprise switching functions available in other network devices which may also be configured as virtual platforms.

Each of the plurality of virtual machines VMs may comprise a software implementation that may execute and or perform programs applications and or processes which may typically be executed and or performed by physical machines such as a computer. In this regard each of the plurality of VMs may function as separate operating system OS . Accordingly each of the plurality of VMs may enable running and or execution of various operations or services independently in the network device . Exemplary applications may comprise software applications email server operations database server operations and or content server operations.

The hypervisor HV may comprise suitable logic code interfaces and or circuitry that may be utilized in a virtualized environment to support one or more virtual machines VMs that may run concurrently on a single physical platform. In this regard the hypervisor may correspond to and or be implemented by various physical and or virtual components and or subsystems within the network device . The hypervisor may operate as a software layer that may run directly on top of resources in the network device such as the NIC to enable virtualization of the hardware and or physical resources of the network device . In an exemplary aspect of the invention the hypervisor may also comprise a dedicated hypervisor based HV based switching function such as a virtual switch vSwitch which may be operable to provide inter VM connectivity and or external connectivity to at VMs. In this regard the HV based switching function may provide switching services to VMs such as VMs and which may not be capable of being directly coupled to hardware resources in the network device such as the NIC . Accordingly the HV based switching function may be operable to route and or forward messages and or data between VMs and and or between each of these VMs and the NIC .

The NIC may comprise suitable logic circuitry interfaces and or code which may be operable to provide network access and or data communication originating from and or destined for other components in the network device substantially as described with regard to the network access subsystem in for example . In this regard the NIC may transmit and receive data in adherence with one or more networking standards. With reference to the OSI model the NIC may implement physical layer functions data link layer functions and in some instances functions associated with OSI layer 3 and higher OSI layers. Similarly with reference to the TCP IP model the NIC may be operable to implement network interface layer functions Internet layer functions and in some instances transport layer functions and application layer functions. The NIC may for example communicate in adherence with one or more Ethernet standards defined in IEEE 802.3. In this regard the NIC may enable transmission and or reception of data in the form of Ethernet or other types of packets.

In an exemplary aspect of the invention the NIC may support virtualization of the network device . In this regard the NIC may be configurable and or may comprise components and or function that support operations of the plurality of VMs in the network device . For example the NIC may comprise a physical function PF and or one or more virtual functions VF which may be operable to support direct and or indirect interactions with the plurality of VMs . The NIC may also comprise a NIC based switching function . The NIC based switching function may comprise suitable logic circuitry interfaces and or code operable to provide and or support switching between VMs running within the network device based on one or more standards protocols such as VEB VEPA VNTag and or other NIV protocols. In this regard certain standards protocols such as VEB for example may enable inter VM communication without the aid of an external network switch whereas other standards protocols such as VEPA for example may only enable providing inter VM communication via a specialized external network switch.

In operation the network device may be configured as a virtual platform. In this regard the network device may enable running of the plurality of VMs via for example the host processor . The network device may also run the hypervisor to enable interactions between the VMs and resources in the network device such as the NIC . In an exemplary aspect of the invention switching services may be provided in and or to the network device . In this regard internal switching functions such as the HV based switching function and or the NIC based switching function for example and or external switching function such as the network switch based NS based switching function which may be provided via one or more network switches in the network switching system for example may be utilized to route and or forward messages and or data between the VMs and or between the VMs and other entities residing with the local networking domain or external to it which may be accessed via the network and or the SAN .

In various embodiments of the invention logical switches may be configured by combining switching functions available in the network device and or external devices such as the network switches in the network switching system . In this regard the logical switches may comprise the HV based switching function and or NIC based switching function which may be combined with corresponding switching functions in other similarly configured network devices and or NS based switching functions which may be available via the network switching system .

In the scenario depicted in the local manager may configure the logical switch by combining the HV based switching function the NIC based switching function and the NS based switching function . In this regard the local manager may communicate with the hypervisor the NIC and one or more network switches in the network switching system such as the ToR switch and or one or more blade switches via the iAPI to facilitate the creation of the logical switch . The local manager may utilize communication via the iAPI for capability exploration reporting statistics and errors obtaining and or assigning configuration e.g. MAC addresses VLAN tags and or switching modes and or obtaining and or assigning VM related switching servicing related information e.g. VM handing off mirroring and or VM HV interaction related parameters such as VF or PF assignment . This may enable the local manager to coordinate operations of these devices and or components such to ensure that data may be routed and or forwarded via the HV based switching function the NIC based switching function and the NS based switching function consistently properly and or seamlessly. The local manager may provide for example routing parameters to these components to ensure that the data sent from and or targeted for serviced virtual machines VMs in the network device traverses these components based on for example preconfigured paths bandwidths speeds quality and or switching mode.

Accordingly the local manager may expose the combined operations of the HV based switching function the NIC based switching function and the NS based switching function as switching servicing corresponding to singular entity the logical switch . In this regard the local manager may enable external entities such as remote management consoles for example to interact with the logical switch via the API . The remote management consoles may communicate with the logical switch as if it was a single network switch. These external management interactions may pertain to platform migrations capabilities inquiries and or adjustments and status indications. The local manager may receive management messages destined for the logical switch and may process these messages to determine appropriate actions that may be taken to perform any requests included therein. In this regard the local manager may determine necessary modifications and or updates to configuration management and or control of hypervisor and or the HV based switching function therein the NIC and or the NIC based switching function therein and or the NS based function and or network switches providing that function. These changes may be performed using internal management messages that may communicated via the iAPI .

In the scenario depicted in the local manager may configure the logical switches and using vertical combinations based on the HV based switching function the NIC based switching function and the NS based switching function . In this regard the local manager may combine the HV based switching function and the NIC based switching function to create the logical switch and may configure the logical switch based on the NS based switching function . Configuration of the logical switches and may be performed in similar manner as with configuring the logical switch substantially as described with regard to the scenario depicted in . The logical switches and need not however be configured identically. Rather dissimilar feature sets control and or switching parameters may be used and or applied to the logical switches and as if they were different physical switches. The local manager may also configure manage and or control interactions between the logical switches and during switching operations and or servicing. In this regard the local manager may configure the logical switches and to interact in similar fashion as two physical switches may be interact during traffic routing and or forwarding operations in a network.

The network devices and may comprise NICs and respectively each of which may similar to the NIC of the network device substantially as described with regard to for example . In this regard each of the NICs and may provide network access functionality in the network devices and respectively. In instances where the network devices and are configured as virtualized platforms the network devices and may comprise hypervisors HVs and respectively each of which may similar to the HV of the network device substantially as described with regard to for example . In this regard the HVs and may support interactions between virtual machines VMs running in the network devices and respectively and resources in the network devices and respectively such as the NICs and

Each of the network devices and may be supported by the network switch based NS based switching function such as the NS based switching functions and respectively each of which may be similar to the NS based switching function substantially as described with regard to for example. In this regard each of the NS based switching functions and may be provided by one or more network switches in the network switching system such as the blade switches and or the ToR switch .

In an exemplary aspect of the invention the network devices and may also comprise virtualization related internal switching functions for routing and or forwarding data and or message communicated from and or to VMs or applications therein . In this regard the network devices and may comprise hypervisor based HV based switching functions and each of which may be similar to the HV based switching function substantially as described with regard to for example. The network devices and may comprise NIC based switching functions and each of which may be similar to the NIC based switching function substantially as described with regard to for example.

In various embodiments of the invention logical switches may be configured based on horizontal combinations of switching functions corresponding to the network devices and . In the scenario depicted in for example logical switches and may be configured using the local manager for example based on horizontal combinations of at least some of the switching functions corresponding to the network devices and . In this regard the local manager may configure the logical switch and by combining the HV based switching functions and to create the logical switch and by combining the NS based switching functions and to create the logical switch . Configuring and or managing the logical switches and by the local manager may be performed in substantially similar manner as with the logical switch as described with regard to for example.

In this regard the local manager may communicate with via the iAPI for example the HVs and to provide the HV based switching functions and and or with one or more network switches providing NS based switching functions and to facilitate configuration of the logical switches and . The local manager may utilize communication via the iAPI for capability exploration reporting statistics and errors obtaining and or assigning configuration e.g. MAC addresses VLAN tags and or switching modes and or obtaining and or assigning VM related switching servicing related information e.g. VM HV interaction related parameters such as VF or PF assignment . This may enable the local manager to coordinate and or combine operations of these devices and or components during traffic forwarding and or routing corresponding to switching operations that are to be performed by the logical switches and . Accordingly the local manager may expose the logical switches and as if they were singular entities which may be managed for example using the same interface that may be used to manage and or interact with physical switches. In this regard the local manager may enable external entities such as remote management consoles for example to interact with the logical switches and via the API . The logical switches and need not be configured identically. Rather dissimilar feature sets control and or switching parameters may be used to setup and or configure the logical switches and to function as if they were different physical switches. The local manager may also configure manage and or control interactions between the logical switches and during switching operations and or servicing. In this regard the local manager may configure the logical switches and to interact in similar fashion as two physical switches may interact during traffic routing and or forwarding operations in a network.

In the scenario depicted in the local manager may configure the logical switch based on horizontal combination using the network devices and and the NS based switching functions and . In this regard the logical switch may be configured by combining HV based switching functions and the NIC based switching functions and and the NS based switching functions and . The local manager may configure via the iAPI the HVs and the NICs and and or the network switches providing the NS based switching functions and . This may enable the local manager to coordinate operations of the HV based switching functions and the NIC based switching functions and and the NS based switching functions and to enable exposing and or presenting it a singular switching entity. Accordingly external management entities may interact with and manage the logical switch as if it was a single switch. In this regard the local manager may provide a single point of management interfacing to the logical switch via the API and the iAPI for example.

In the scenario depicted in the local manager may configure the logical switches and based on horizontal combinations using the network devices and and the NS based switching functions and . In this regard the logical switch may be configured by combining the HV based switching functions and with the NIC based switching functions and into a singular switching entity. The logical switch may be configured by combining the NS based switching functions and . For example the local manager may configure the logical switches and by configuring via the iAPI for example the HVs and the NICs and and or the network switches providing the NS based switching functions and . This may enable the local manager to coordinate operations of the HV based switching functions and with the NIC based switching functions and with regard to the logical switch and coordinate operations of the NS based switching functions and with regard to the logical switch . The logical switches and need not be configured identically. Rather dissimilar feature sets control and or switching parameters may be used to configure and or setup the logical switches and . The local manager may also configure manage and or control interactions between the logical switches and during switching operations and or servicing. In this regard the local manager may configure the logical switches and to interact in similar fashion as two different physical switches may be interact during traffic routing and or forwarding operations in a network. Accordingly the local manager may be able to expose and or present each of the logical switches and as a singular switching entity. Furthermore the local manager may enable external management entities to interact with and or manage the logical switches and to function as if they were singular physical switches. In this regard the local manager may provide a single point of management interfacing to the logical switches and via the API and the iAPI for example.

In the scenario depicted in the local manager may configure the logical switches and based on horizontal combinations using the network devices and and the NS based switching functions and . In this regard the logical switch may be configured by combining the HV based switching functions and into a singular switching entity. The logical switch may be configured by combining the NIC based switching functions and with the NS based switching functions and into a second singular switching entity. For example the local manager may configure the logical switches and by configuring via the iAPI for example the HVs and the NICs and and or the network switches providing the NS based switching functions and . This may enable the local manager to coordinate operations of the HV based switching functions and with regard to the logical switch and coordinate operations of the NIC based switching functions and with the NS based switching functions and with regard to the logical switch . The logical switches and need not be configured identically. Rather dissimilar feature sets control and or switching parameters may be used to setup and or configure the logical switches and . The local manager may also configure manage and or control p between the logical switches and during switching operations and or servicing. In this regard the local manager may configure the logical switches and to function in a similar fashion as two different physical switches may be interact during traffic routing and or forwarding operations in a network. Accordingly the local manager may be able to expose and or present each of the logical switches and as a singular switching entity. Furthermore the local manager may enable external management entities to interact with and or manage the logical switches and as if they were singular physical switches. In this regard the local manager may provide a single point of management interfacing to the logical switches and via the API and the iAPI for example.

In step switching functions in a local networking domain may be discovered. For example the local manager may discover the various switching functions provided by the network devices and or networks switches in the network switching system such as the ToR switch and or the blade switches for example. In this regard the switching functions discovered may comprise network switch based NS based switching functions such as the NS based switching functions and NIC based switching functions such as the NIC based switching functions and and or hypervisor based HV based switching functions such as the HV based switching functions and

In step capabilities of discovered switching functions may be determined. In this regard the local manager may communicate with discovered switching functions via the iAPI for example to determine the switching functions capabilities load and or limitations. In this regard the local manager may determine for each discovered switching function type and or level e.g. L2 L3 and or L4 of switching supported therein available bandwidth during switching operations number and or type of ports physical or virtual available therein and or any limitations such as type of devices and or entities that maybe serviced thereby. For example vSwitch function may be limited insofar as that they may only service VMs. In step a plurality of logical switches may be configured by combining at least some of the discovered switching functions. In this regard the local manager may utilize vertical and or horizontal combinations substantially as described with regard to for example B and or A D. Doing this may enable the local manager to combine operations of at least some of the discovered switching functions such that these combined switching functions may be exposed and or managed as one or more singular switching entities. In step interfacing services available in the local networking domain may be configured based on the configured logical switches. In this regard the local manager may configure and or modify the iAPI and or the API to enable external entities such as remote management entities for example to interact with the configured logical switches as though they were singular switching entities i.e. as if they where singular physical switches . This may require for example processing received and or transmitted management traffic via the API in the local manager to and or from corresponding internal messages used when interacting with the constituent switching functions in the configured logical switches.

Various embodiments of the invention may comprise a method and system for switching in a virtualized platform. The local manager may configure a plurality of logical switches in the local networking domain by combining switching functions available in network devices and or network switches in the local networking domain . The local manager may run in and or execute via one or more of the network devices and or the network switches in the local networking domain . The network switches may comprise one or more blade switches and or top of rack ToR switches . The switching functions may comprise NS based switching functions and or HV based switching functions or NIC based switching functions available in network devices which may be configured as virtualized platforms. Hypervisor based switching functions may comprise a vSwitch functions. Network adapter based switching functions may comprise eSwitch functions Virtual Ethernet Bridging VEB functions Virtual Ethernet Port Aggregation VEPA functions NIV function and or VNTag functions. The configuration may utilize vertical and or horizontal combinations of the switching functions. Vertical combinations may comprise combining at least a HV based switching function and a network adapter switching function in a single logical switch. Horizontal combinations may comprise combining HV based switching functions combining network adapter switching functions and or combining NS based switching functions in a single logical switch. The local manager may also provide interfacing services to enable exposing configured logical switches. The interfacing services may comprise iAPI which may provide a uniform internal switching related interface and which may be utilized via the local manager to configure the constituent switching functions and or to forward receive messages to from the logical switches. The interfacing services may also comprise the API which may be provide a uniform external switching related interface and which may be utilized to enable external entities such as remote management entities for example to manage and or interact with the configured logical switches.

Other embodiments of the invention may provide a non transitory computer readable medium and or storage medium and or a non transitory machine readable medium and or storage medium having stored thereon a machine code and or a computer program having at least one code section executable by a machine and or a computer thereby causing the machine and or computer to perform the steps as described herein for switching in a virtualized platform.

Accordingly the present invention may be realized in hardware software or a combination of hardware and software. The present invention may be realized in a centralized fashion in at least one computer system or in a distributed fashion where different elements are spread across several interconnected computer systems. Any kind of computer system or other apparatus adapted for carrying out the methods described herein is suited. A typical combination of hardware and software may be a general purpose computer system with a computer program that when being loaded and executed controls the computer system such that it carries out the methods described herein.

The present invention may also be embedded in a computer program product which comprises all the features enabling the implementation of the methods described herein and which when loaded in a computer system is able to carry out these methods. Computer program in the present context means any expression in any language code or notation of a set of instructions intended to cause a system having an information processing capability to perform a particular function either directly or after either or both of the following a conversion to another language code or notation b reproduction in a different material form.

While the present invention has been described with reference to certain embodiments it will be understood by those skilled in the art that various changes may be made and equivalents may be substituted without departing from the scope of the present invention. In addition many modifications may be made to adapt a particular situation or material to the teachings of the present invention without departing from its scope. Therefore it is intended that the present invention not be limited to the particular embodiment disclosed but that the present invention will include all embodiments falling within the scope of the appended claims.

