---

title: Computing system providing normal security and high security services
abstract: A computing system and method providing normal security services and high security services are disclosed. The computing system includes hardware resources, a processor core and an access right checker. The hardware resources are grouped into resource security levels. The processor, switching between a normal security and a high security state, assigns a user access right to a request. In comparison with the normal security state, user access right assigned in the high security state further allows the request to use the hardware resources of a higher resource security level. According to the assigned user access right and the resource security levels of required hardware resources of the request, the access right checker determines whether the request has the authority to use the hardware resources, and thereby, the access right checker executes the request or responds the issued request with an exception.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08407783&OS=08407783&RS=08407783
owner: Mediatek Inc.
number: 08407783
owner_city: Hsin-Chu
owner_country: TW
publication_date: 20100617
---
The present invention relates to computing systems providing normal security services and high security services with efficient resource utilization.

In many consumer electronics such as mobile phones PDAs digital cameras digital media and music players handheld game consoles and computer peripherals such as hard drives and routers two isolated operating environments are required for maintaining system security.

Normal security services such as making a phone call and playing java games may operate in a normal security environment. However when high security services such as online credit card payments are requested the normal security environment may not satisfy security requirements of e banking services. Instead a high security environment isolated from the normal security environment is required to handle such high security services in order to prevent information theft.

Trustzone hardware architecture developed by ARM provides normal security services and high security services using a single physical processor core. Because only one processor core is required in the Trustzone hardware architecture silicon size manufacturing costs and power consumption of the Trustzone hardware are considerably lower when compared with solutions using two dedicated processor cores. To isolate sensitive data from the malicious software disguised in a normal security environment the single processor core of the Trustzone technique switches between a normal security state and a high security state to provide a normal security environment and a high security environment in a time sliced fashion and the hardware resources are design dedicated to the normal security environment or the high security environment.

However the design of dedicated hardware resources results in low resource utilization. Resources such as file system memory registers and engine dedicated to the high security environment are seldom used as the probability of switching to the high security state is typically low. To increase the utilization of these dedicated resources the processor may frequently switch between the two security states. For example services involve sensitive data or require dedicated hardware resources in a high security environment will be performed in the high security environment. Frequent switching of security states occurs. Latency and power consumption caused by switching of security environments are considerable.

Thus a way to simultaneously reduce switching of security environments and increase utilization of hardware resources is called for.

A computing system and method providing normal security services and high security services are provided.

An exemplary embodiment of the computing system comprises hardware resources a processor core and an access right checker. The hardware resources are grouped into a plurality of resource security levels. The processor switching between a normal security state and a high security state assigns a user access right to a request. In comparison with the normal security state user access right assigned in the high security state further allows the request to use the hardware resources of a higher resource security level. According to the assigned user access right and the resource security levels of required hardware resources of the request the access right checker determines whether the request has the authority to use the hardware resources. When determining that the request has the authority to use the hardware resources the access right checker allows the request to be executed. When determining that the request does not have the authority to use the hardware resources the access right checker responds the request with an exception.

An exemplary embodiment of the disclosed method comprises the following steps. The method first provides hardware resources which are grouped into a plurality of resource security levels. Then a user access right is assigned to a request. The processor core is switched between a normal security state and a high security state and in comparison with the normal security state user access right assigned in the high security state further allows the issued request to use the hardware resources of a higher resource security level. A determination is made based on the assigned user access right and the resource security levels of required hardware resources of the issued request as to whether the request has the authority to use the hardware resources. When the request is determined to have the authority to use the hardware resources the request is executed. When the request is determined to not have the authority to use the hardware resources the request is responds with an exception.

A detailed description is given in the following embodiments with reference to the accompanying drawings.

The following description is of the best contemplated mode of carrying out the invention. This description is made for the purpose of illustrating the general principles of the invention and should not be taken in a limiting sense. The scope of the invention is best determined by reference to the appended claims.

First a definition of Resource Security Level abbreviated to RSL is introduced. In the computing system disclosed in the invention the hardware resources including the memory registers and hardware datapaths and so on are divided into a plurality of groups according to resource security levels thereof. As shown in four resource security levels Strictly Privilege Privilege Limited and Public from highest security level to lowest security level are used to classify the hardware resources. Each group contains hardware resources of a corresponding security level.

For example when the computing system is in the Whole Protected level and the processor core is in the normal security state user access right assigned to each request issued from software codes covers the scope . Thus only the hardware resources with the Public resource security level are available to the issued request. If the processor core is switched to the high security state and the protection level of the computing system is not changed maintained at the Whole Protected level user access right assigned to the issued request covers the scope rather than the scope to allow the issued request to further gain access to the hardware resources of a higher resource security level scope includes any available hardware resources belonged to the Public resource security level as well as the Limited and Privilege resource security levels .

Comparing the scopes and defining the user access right the hardware resources of the Public resource security level are shared between the normal security environment and the high security environment while the hardware resources of Limited and Privilege resource security levels are limited to the high security environment. Thus sensitive data contained in the Limited and Privilege hardware resources are protected from malicious software of the normal security environment and the Public hardware resources containing no sensitive data are efficiently shared by the normal and high security environments. The disclosed hardware resource sharing embodiments increase utilization of hardware resources.

The concept introduced in also considerably reduces the redundant switching of security environments. For example when required hardware resources of a request all belong to the Public resource security level no matter what security state the processor core is in no switching of security environments is required because the required hardware resources are available in both the normal security and high security environments. Thus the frequency for switching of security environments can be reduced and time latency and power consumption caused by frequent switching of security environments are eliminated.

This paragraph discusses the protection level introduced in . A manufacturer may use a multi purpose product to produce services of different security levels for example using the same hardware architecture to produce gaming mobile phone call or e commerce services of different security levels . The introduced protection level is configured according to the security level requirement of the product and it also affects the scope of user access right. In there are three options for the protection level setting from the highest security level to the lowest security level they are Whole Protected Partial Protected and No Protected levels. The greater the protection level is the less the hardware resources can be accessed. For example when the processor core is in the normal security state the UAR scope for the No Protected level is greater than UAR scope for the Partial Protected level and the UAR scope for the Partial Protected level is greater than the UAR scope of the Whole Protected level. Note that different protection levels may have the same scopes of UAR in some specific cases. As shown in when the processor core is in the high security state the UAR scope for the No Protected level is greater than the UAR scope for the Partial Protected level while the UAR scope for the Partial Protected level equals to the UAR scope of the Whole Protected level.

Note that classification of the resource security levels and the protection levels and determination of the UAR scopes shown in are not intended to limit the scope of the invention. The amount of the resource security levels and protection levels and the options for UAR may be different from those shown in .

In an embodiment the protection level of a computing system is extremely sensitive and should be stored in a register named protection level register of the Strictly Privilege resource security level. To avoid falsification the setting of the protection level register may be limited during a security booting procedure of the computing system while the processor core is in the high security state. In other embodiments the value stored in the protection level register may be changed in the run time. shows a change rule of the protection level. The disclosed protection level register is allowed to be changed from a higher security level to a lower security level only when the processor core is in the high security state but is allowed to be changed from a lower security level to a higher security no matter what security state the processor core is in. Referring to to downgrade the protection level from the Whole Protected level to the Partial Protected or to the No Protected level or from the Partial Protected level to the No Protected level the processor core has to be in the high security state to execute corresponding high security applications APs . Oppositely to upgrade the protection level from the No Protected level to the Partial Protected level or to the Whole Protected level or from the Partial Protected level to the Whole Protected level the processor core is not limited to be in the normal or high security environment. The protection level upgrade can be achieved by either normal security APs or high security APs.

Note that when the protection level is changed the initially isolated hardware resources may be released to be available to the issued request so that the sensitive data contained in the released hardware resources may be exposed. Thus context management techniques are disclosed which store and restore context of released or isolated hardware resources when the protection level stored in the protection level register is changed. The released hardware resources were initially forbidden from the issued request before the protection level was switched to a lower security level and the isolated hardware resources were initially available to the issued request before the protection level was switched to a higher security level. Note that in some embodiments the protection level of a product is configured at manufactory and cannot be changed in boot time or run time.

In the computing system one single physical processor core is provided to switch between a normal security state and a high security state to form two isolated environments for normal security services and high security services respectively. Normal security applications APs normal security application programming interface API and firmware of normal security datapath are used to provide normal security services when the processor core is in the normal security state . In addition high security client APs high security client API and firmware of high security client datapath performed when the processor core is in the normal security state operate as a security environment switching interface. The instructions are provided for switching the security state of the processor core . The high security applications APs high security application programming interface API and firmware of high security datapath are provided for high security services and are performed when the processor core is in the high security state . The aforementioned software and firmware design allows the single processor core to switch between the normal security state and the high security state in a time sliced fashion.

Furthermore in the firmware design of the processor core no matter what security state the processor core is in each of the issued requests is assigned a scope of user access right UAR . The assigned UAR may be dependent on the current security state of the processor core or in some embodiments the protection level of the computing system stored in the protection level register may be further taken into consideration in determining the scope of the UAR. The determination of the UAR is disclosed in .

The UAR assigned to the issued request indicates available components of the hardware resources . The access right checker receives the issued request and the assigned UAR determines the required hardware resources of the issued request and determines whether the received request has the authority to use the hardware resources in accordance with the assigned UAR and the required hardware resources of the issued request. When the assigned UAR covers the resource security levels of all of the required hardware resources of the issued request the access right checker determines that the issued request has the authority to use the hardware resources and allows the issued request to be executed. When the assigned UAR does not cover the resource security levels of all of the required hardware resources of the issued request the access right checker determines that the issued request has no authority to use the hardware resources and responds to the issued request with an exception.

A context management module is introduced for aforementioned context store and restore triggered by a change of the protection level.

While the invention has been described by way of example and in terms of the preferred embodiments it is to be understood that the invention is not limited to the disclosed embodiments. To the contrary it is intended to cover various modifications and similar arrangements as would be apparent to those skilled in the art . Therefore the scope of the appended claims should be accorded the broadest interpretation so as to encompass all such modifications and similar arrangements.

