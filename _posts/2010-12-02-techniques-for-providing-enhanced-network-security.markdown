---

title: Techniques for providing enhanced network security
abstract: Exemplary network infrastructures and methods employing a Security Gateway utilize client authentication for use of a secure connection between an application client and an application server of a protected network. Once a secure connection has been set up, a Security Gateway can start a timer for establishing a period within which a password and username are to be received from the application client before traffic is allowed to exit the Security Gateway. If a username and password are provided while the timer is running, the Security Gateway can contact a single sign on (SSO) server to check whether the username and password are correct. If the username and password are valid, the Security Gateway can start relaying traffic externally to the application server. If an invalid username and password are provided or the timer times out before receipt of a username and password, the secure connection can be terminated.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08943570&OS=08943570&RS=08943570
owner: Cellco Partnership
number: 08943570
owner_city: Basking Ridge
owner_country: US
publication_date: 20101202
---
Use of the Internet has become commonplace and an everyday occurrence to significant portions of the World s population. Such use of the Internet often includes secured access utilizing security features for example Secure Socket Layer SSL or Hypertext Transfer Protocol Secured HTTPS connections. Mobile stations have developed so as to also afford users the ability to access the Internet. In addition the communications that such devices offer via wireless mobile communications network enable users to talk and exchange various types of messages for business and personal reasons and to access information all from or while traveling through any location where a network provides service.

SSL is a protocol that uses a cryptographic system employing two keys to encrypt data a public key known to everyone and a private or secret key known only to the recipient of the message. Transport Layer Security TLS protocol is a successor to SSL. Hypertext Transfer Protocol Secure HTTPS is a combination of the Hypertext Transfer Protocol with the SSL TLS protocol to provide encrypted communication and secure identification of a network web server. HTTPS connections are often used for payment transactions on the World Wide Web and for sensitive transactions in corporate information systems.

A virtual private network VPN supplies network connectivity over a possibly long physical distance. VPN technologies include various security mechanisms to protect the virtual private connections. In this respect a VPN is a form of Wide Area Network WAN . VPNs enable file sharing video conferencing and similar network services. A key feature of a VPN is its ability to work over private networks as well as public networks like the Internet. Using a method called tunneling a VPN can use the same hardware infrastructure as existing Internet or intranet links.

Normally SSL connections or HTTPS connections just authenticate the identity of the server the client is establishing a session to. For example when a web browser tries to securely connect to a bank s server the browser checks that the certificate provided by the server is authentic and certifies that the web server belongs to the bank. SSL also provides a means to authenticate the client by certificates or pre shared keys but those means are rarely used. Client side authentication is only used when the server wants to give access to only authentic clients for example through a network side SSL gateway.

Authenticating the client means that one has to undertake the task of distributing certificates to all devices over a secure out of channel means to distribute keys to all these devices. In addition as the client side authentication is rarely used new devices like Smartphones and new operating systems like Android do not have built in support for client side certificate management and operations.

Network security equipment enables end customers devices to establish secure connections to the network for example through VPN or SSL gateways. While setting up these secure connections mutual authentication is required. Mutual authentication implies that the customer device authenticates that it is talking to the true and valid operator s network and the network authenticates that it is establishing a secure tunnel with a true and valid end device e.g. a mobile station with authentic client applications. Authenticating a network is typically straight forward as the network element can have a public certificate that generates trust. Authenticating devices on the other hand is more complicated as it involves distributing unique keys or certificates to multiple devices.

The teachings herein provide improved methods network infrastructures and equipment e.g. network elements such as server computers and or programming for the network elements to provide techniques and mechanisms for enhanced network security in which a Security Gateway relies on an application related authentication to authenticate a client application before allowing free flow of traffic to a protected network during a secure session. This approach for example facilitates client side authentication by leveraging application authentication after the setup of a secure session.

For example in one aspect the detailed description and drawings disclose a network infrastructure for providing access to a protected network with enhanced security. The infrastructure may include a Domain Name System DNS server configured to respond to a DNS request for an application server in the protected network from an application client with an IP address of a Security Gateway connected to the protected network. The infrastructure may include a Single Sign On SSO server within the protected network. The SSO server is configured to receive a username and a password and as an authentication check check the username and password against a list of valid usernames and passwords for the client to access that particular application. The SSO server produces an authentication check result for the username and password e.g. indicating whether or not the username and password are valid. A Security Gateway can be included that is configured to provide an interface between the protected network and one or more application clients e.g. application clients resident on one or more mobile stations. The Security Gateway may further be configured to a provide access for the application client to the Security Gateway for a limited time for authentication of the application client b receive a user name and password from the application client c in response provide the username and password to the SSO server in the protected network for an authentication check and d provide appropriate access between the client application and the application server as a result of the authentication check result.

Another aspect of the detailed description and drawings relates to a method of providing an application client access to a protected network with enhanced security. Upon receipt of a request for an application server IP address from an application client a DNS server provides a DNS response with an IP address of a Security Gateway. The Security Gateway is configured to provide an interface between the protected network and one or more application clients e.g. application clients that are resident on one or more mobile stations. The method may also involve providing access for the application client to the Security Gateway for a limited time for authentication of the application client. A username and password are received from the application client at the Security Gateway and the username and password are provided from the Security Gateway to a Single Sign On SSO server in the protected network for authentication of the client application. The SSO server performs an authentication check on the username and password and produces an authentication check result e.g. indicating whether or not the username and password are valid. The method may also involve providing appropriate access between the client application and the application server in response to the authentication check result.

Additional advantages and novel features will be set forth in part in the description which follows and in part will become apparent to those skilled in the art upon examination of the following and the accompanying drawings or may be learned by production or operation of the examples. The advantages of the present teachings may be realized and attained by practice or use of various aspects of the methodologies instrumentalities and combinations set forth in the detailed examples discussed below.

In the following detailed description numerous specific details are set forth by way of examples in order to provide a thorough understanding of the relevant teachings. However it should be apparent to those skilled in the art that the present teachings may be practiced without such details. In other instances well known methods procedures components and or circuitry have been described at a relatively high level without detail in order to avoid unnecessarily obscuring aspects of the present teachings.

Functionality systems and methods for facilitating security enhancement for the establishment of secured connections such as virtual private networks and client side authentication are shown and described.

In general terms examples of the present disclosure can facilitate client side authentication by leveraging application authentication after the setup of a secure session based on server authentication and or use of a pre shared key. A Security Gateway can require client authentication for use of a secure connection between an application client and an application server located in an operator s private or protected network. Once a secure connection has been setup the Security Gateway can start a timer for establishing a period within which one or more further conditions are to be met before traffic from the application client is allowed to exit the Security Gateway for communication with the application server. The Security Gateway can be enhanced by the addition of an HTTP processing agent e.g. a web server or the like. While the timer is running the Security Gateway can anticipate an HTTPS connection e.g. a post including application authentication such as a username and password which can be used to authenticate the application client. If such a connection does not come before the timer expires the Security Gateway can terminate the secure connection. Further action can then be taken such as black listing that particular client. If an HTTP connection with a username and password is provided while the timer is running the SSL gateway can contact a single sign on SSO server to check whether the username password combination is correct. If the username and password are valid the Security Gateway can start relaying traffic e.g. IP packets externally to the application server in the protected network. If an invalid username and password are provided the secure connection can be terminated. An advantage of such a scheme is that by combining the capabilities of a server certificate based connection and application level username password authentication the Security Gateway can create a mutually authenticated secure connection in an efficient manner.

For example a company may desire to deploy such a Security Gateway for establishing a SSL link for secure access to its corporate network so that all corporate application servers like HR payroll etc. would be available via access to the corporate network of the company. The company would want to ensure that this access is available only to authentic employees. One way to do that using an example of the present disclosure would be that after the employee s computer establishes a SSL session the employee s computer would send the employee s email ID and password within e.g. one second via HTTPS to the SSL Security Gateway. The Security Gateway could verify the email credentials from the email server or another database and then keep the SSL connection open on success or close it on failure.

Reference now is made in detail to the examples illustrated in the accompanying drawings and discussed below.

An example of a network with enhanced network security functionality is shown . Network includes one or more application clients e.g. resident on a mobile station one is shown for simplicity configured for operation with an operator s protected network. The mobile device or station can be an advanced device e.g. a Blackberry RIM Android Palm LiMo Java or Linux device or the like. While application client is indicated as being resident on a mobile station application clients may of course be resident in stationary functionality such as personal computers and the like. The operator s network can include a DNS database or server a single sign on SSO server and also one or more application servers one is shown . The user of the application client can utilize the Internet to access the operator s network by way of a Security Gateway . The Security Gateway can have an Internet Side and a Protected Side for establishing a secure connection e.g. SSL connection or virtual private network VPN connection allowing the application client on the mobile station to securely access elements e.g. application server in the operator s protected network .

In call flow includes an application client such as operating on a user s mobile station sending a DNS query to a DNS server e.g. used with an email application in the mobile station operator s network as described at . The Security Gateway includes an Internet side and a secured or protected side for accessing the operator s network. In exemplary embodiments the Security Gateway can include or be implemented as a virtual server including IP addresses and ports that correspond to the application server in the operator s network . The ports can include one or more ports e.g. parent ports that are contacted by an application client e.g. on mobile station for purposes of authentication. One or more additional ports e.g. child ports can be used for traffic between the application client and the application server once authentication has occurred. The DNS server can respond with an IP address of the virtual server on the Internet side of the Security Gateway as described at e.g. for establishing a SSL or VPN connection. The application client can then make a HTTPS post to the virtual server as described at .

For enhanced security the HTTPS post can include an application username and password previously used on the mobile station to authenticate the mobile station user for client side authentication. Such a username and password may be referred to as a SSO username and password. In addition a child session string e.g. a 24 character string may be included in the body of the HTTP post. The virtual server on the Internet side of the Security Gateway can provide the SSO username and password to the SSO Server for authentication as described at . The SSO server can perform an authentication check of the SSO username and password and produce an authentication check result e.g. indicating whether the SSO username and password are valid or not. In the event that the SSO check indicates that the SSO username and password are valid the virtual server can send a corresponding reply e.g. a message to the application client as described at .

Continuing with the description of call flow application traffic data packets can flow to and from the client application on mobile station once use of the Security Gateway has been authenticated. The application client can provide a HTTP post to the virtual server e.g. representing the email server prior to sending IMAP including username and child session string as part of an internal check as described at and . The Security Gateway does not pass this HTTP post to the email server but uses this information to do an internal check and correlate that this IMAP session is being originated by the same client that was successfully authenticated earlier and can provide a response e.g. a message to the application client as described at . The Security Gateway can then allow the incoming IMAP traffic from the client to pass through to the server as shown in and . To continue the authenticated transfer of IMAP traffic through the Security Gateway the client preferably periodically provides HTTP posts to the virtual server representing the email server with the username and child session string to renew the session as described at . The time period for such renewal HTTP posts can be selected as desired e.g. every 15 minutes. These HTTP POSTs will be consumed by the Security Gateway and are not required to be forwarded to the email server though a response e.g. a message can be provided by the Security Gateway to the application client as described at .

For call flow in a DNS query from an application client e.g. implemented on a mobile station is received by a DNS server in an operator s network as described at . In response the DNS server provides a response with an IP address of the Security Gateway e.g. the Internet Side as described at . The application client may possess a pre shared security key such as one supplied by the network operator of the network. A VPN tunnel may be established in response to the application client providing the pre shared key to the Internet side of the Security Gateway as further described at . Upon establishing the VPN tunnel a timer can be started specifying a time within which a HTTPS post including a SSO username and password from the application client are expected as described at . During this time all packets can be prevented from passing through the Security Gateway to the application server . The application client may make a HTTPS post with a previously used username and password as a SSO username and password to the Security Gateway as further described at . The Security Gateway can provide the SSO username and password to a SSO server in the network for authentication of the application client as described at . The SSO server can perform an authentication check of the SSO username and password and produce an authentication check result e.g. indicating whether the SSO username and password are valid or not. In response to an authentication that the SSO username and password are valid a response may be sent from the Security Gateway to the application client e.g. indicating that the SSO username and password have been authenticated as described at . At this point traffic indicated by All Packets may be permitted to go through the VPN to and from the application server as described at .

As described above network infrastructures and methods include use of a Security Gateway to facilitate enhancement of network security. Such Security Gateways can be implemented in different configurations. For example instances of a Security Gateway can be implemented as a single homed single port Security Gateway configured with one virtual IP address and one port. A Security Gateway can be implemented as a single homed multiple port Security Gateway configured with one virtual IP address and multiple ports. Instances of a Security Gateway can be implemented as a multiple homed single port Security Gateway configured with multiple virtual IP addresses and one port. Further a Security Gateway can be implemented as a multiple homed multiple port Security Gateway configured with multiple virtual IP addresses and multiple ports.

As shown by the above discussion functions relating to enhancing network security may be implemented on one or more programmable network elements such as server computers configured for implementing a secure or protected infrastructure or platform utilizing and or implementing a Security Gateway as shown by way of example in . The software functionalities involve programming including executable code as well as associated stored data e.g. files used for code recognition. The programming code is executable by the processor microprocessor or the like that functions as the control element of the particular network element e.g. server computer. In operation the code is stored within the memory of the network element for loading and execution by the processor. At other times however the executable code may be stored at other locations and or transported for loading into the network element. Execution of such code by the processor of the network element enables the network element to implement methodology for facilitating enhanced network security in essentially the manner performed in the examples discussed and illustrated herein.

Hence aspects of the methods of providing enhanced network security outlined above may be embodied in programming. Program aspects of the technology may be thought of as products or articles of manufacture typically in the form of executable code and or associated data that is carried on or embodied in a type of machine readable medium. Storage type media include any or all of the non transitory tangible memory of the computers processors mobile stations or the like or associated modules thereof such as various semiconductor memories tape drives disk drives and the like which may provide non transitory storage at any time for the software programming. All or portions of the software may at times be communicated through the Internet or various other telecommunication networks. Such communications for example may enable loading of the software from a computer or processor into a network element e.g. server computer to add or update the functionality to that device. Thus another type of media that may bear the software elements includes optical electrical and electromagnetic waves such as used across physical interfaces between local devices through wired and optical landline networks and over various air links. The physical elements that carry such waves such as wired or wireless links optical links or the like also may be considered as media bearing the software. As used herein storage media relates to tangible non transitory media for storing programming and or data and unless restricted to such storage media terms such as computer or machine readable medium refer to any medium that participates in providing instructions to a processor for execution.

Such a machine readable medium may take many forms including but not limited to a tangible storage medium a carrier wave medium or physical transmission medium. Non volatile storage media include for example optical or magnetic disks such as any of the storage devices in the network elements illustrated in the drawings. Volatile storage media include dynamic memory such as main memory of such a computer platform. Tangible transmission media include coaxial cables copper wire and fiber optics including the wires that comprise a bus within a computer system. Carrier wave transmission media can take the form of electric or electromagnetic signals or acoustic or light waves such as those generated during radio frequency RF and infrared IR data communications. Common forms of computer readable media therefore include for example a floppy disk a flexible disk hard disk magnetic tape any other magnetic medium a CD ROM DVD or DVD ROM any other optical medium punch cards paper tape any other physical storage medium with patterns of holes a RAM a ROM a PROM and EPROM a Flash EPROM any other memory chip or cartridge a carrier wave transporting data or instructions cables or links transporting such a carrier wave or any other medium from which a computer can read programming code and or data. Many of these forms of computer readable media may be involved in carrying one or more sequences of one or more instructions to a processor for execution.

While the foregoing has described what are considered to be the best mode and or other examples it is understood that various modifications may be made therein and that the subject matter disclosed herein may be implemented in various forms and examples and that the teachings may be applied in numerous applications only some of which have been described herein. It is intended by the following claims to claim any and all applications modifications and variations that fall within the true scope of the present teachings.

The description above has used a large number of acronyms to refer to various services messages and system components. Although generally known use of several of these acronyms is not strictly standardized in the art. For the convenience of the reader the following list correlates terms to acronyms as used in the detailed description above.

