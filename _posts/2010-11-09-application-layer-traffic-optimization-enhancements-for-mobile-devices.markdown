---

title: Application layer traffic optimization enhancements for mobile devices
abstract: In general, techniques are described for enhancing the Application-Layer Traffic Optimization (ALTO) service to supplement network topological grouping with location-based groupings to account for endpoint mobility. For example, as described herein, an ALTO server maintains physical location information for a network of one or more endpoints that provides a service. A PID generator of the ALTO server aggregates the endpoints into a set of one or more PIDs based at least on the physical location information for the endpoints, wherein each PID is associated with a subset of the endpoints. The ALTO server generates network and cost maps for the ALTO service that include PID entries to identify a respective subset of the endpoints associated with each of the set of PIDs and cost entries that incorporate cost that reflect physical distances among endpoints.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08751613&OS=08751613&RS=08751613
owner: Juniper Networks, Inc.
number: 08751613
owner_city: Sunnyvale
owner_country: US
publication_date: 20101109
---
This application claims the benefit of U.S. Provisional Application No. 61 349 467 filed May 28 2010 the entire content of which is incorporated herein by reference.

The invention relates to computer networks and more specifically to improving content delivery to mobile devices.

Peer to peer P2P applications exchange large amounts of data and generate significant amounts of network traffic. P2P applications leverage multiple copies of data content populated to multiple different network nodes to allow a requesting agent to obtain portions of the data content from one or more of many possible data sources. Such P2P distributed applications improve application performance and scalability and are frequently used for file sharing real time communication and on demand media streaming.

Many P2P applications operate by implementing an application layer overlay network over the communication network. The overlay network is a logical network of participating network nodes peers directly interconnected via overlay links that are each abstractions of one or underlying transport links of the communication network. The overlay network include data structures that index one or more network devices or resources that store and source specific data content such as files or file portions. A peer seeking particular data content queries the data structures to obtain a list of identities of network devices that source the file. The peer here operating as a client randomly selects one of the devices from the list from which to request and receive the data content via the overlay network.

Client software for P2P applications often select resources naively that is without incorporating network topology information or related details. Rather clients rely on heuristics to approximate such information. As a result network data traffic exchanged using these applications may congest network links cross service provider network boundaries multiple times and generally transit the communication network in a manner that is suboptimal from a user standpoint and undesirable from the point of view of the service provider. For instance while two peers may be members of the same service provider network an overlay link connecting the peers may nevertheless traverse multiple network boundaries which unnecessarily increases the inter peer transit costs to the service provider. Furthermore although distributed applications capitalize on excess bandwidth at the data sources to improve throughput and reduce latencies for end users while also reducing the burden of content providers to provision application servers the ability to cheaply distribute data content comes at the expense of service providers which bear the cost of inefficiently transporting network data.

Recently an Application Layer Traffic Optimization ALTO service has been proposed in which an ALTO protocol is used to provide guidance to P2P applications regarding selection of a resource from which to obtain data content. In one example a service provider provisions an ALTO server for a service provider network with network topology and topology link cost information. P2P clients send ALTO requests to the ALTO server to obtain a network map and a corresponding cost map. The network map specifies a subset of network topological groupings defined by the ALTO server for the network. A cost map for the network map defines provider preferences respecting inter group routing costs for connections among the various groups of the network map. As a result service providers provisioning the ALTO server may direct P2P clients to select resources according to service provider preferences which may include optimizing throughput and or user experience for instance reducing costs to the service provider or promoting other provider objectives. The ALTO service and ALTO protocol is described in further detail in J. Seedorf et al. RFC 5693 Application Layer Traffic Optimization ALTO Problem Statement Network Working Group the Internet Engineering Task Force draft October 2009 and R. Alimi et al. ALTO Protocol draft ietf alto protocol 06.txt ALTO Working Group the Internet Engineering Task Force draft October 2010 each of which is incorporated herein by reference in its entirety.

In general techniques for enhancing the ALTO service to supplement network topological grouping with location based groupings to account for device mobility are described. Roaming mobile devices frustrate simple topological based routing by attaching to mobile service provider network gateways that may not necessarily serve the permanent network addresses of the roaming devices. That is such gateways may not advertise themselves as a next hop for routing destinations that encompass the network addresses of various roaming devices attached to the gateways. Techniques such as Mobile Internet Protocol IP enable location independent routing of network layer packets by for instance assigning a temporary routable network address to a roaming device and routing packets to the roaming device on the basis of the temporary address.

The conventional ALTO service as an application layer endpoint based service that groups network devices by their respective network addresses in accordance with a network topology does not incorporate NAT and other information used by a mobile service provider network to enable continued end to end routing. As a result roaming mobile devices similarly frustrate a goal of the ALTO service i.e. to provide reliable information regarding the topology of the underlying network to endpoint applications to improve peer server selection. An ALTO service may thus cause a mobile device application to select a peer server that while optimal with respect to a network topological location of the mobile device may in fact be sub optimal when the mobile device is roaming and has consequently decoupled its physical location from its network topological location. As another example an ALTO service may aggregate geographically distributed servers that are nevertheless members of for instance the same subnet. In such instances the ALTO service may fail to distinguish geographically distributed servers that due to dissimilar distances provide dissimilar service performance for a particular client.

In one example techniques are described in which an ALTO service for a network receives geographical location information from mobile devices. The ALTO server generates a network map for a network by incorporating the received geographical location information to affect the grouping of mobile devices within network maps. Specifically the ALTO server generates a network map by organizing groups or PIDs of mobile devices according to the geographical proximity of the mobile devices to one another in addition to or instead of network topology based grouping. In other words the ALTO server assigns mobile devices to a network map PID based not only on the network addresses of the mobile devices but based also on the physical locations of the mobile devices. The ALTO server may generate a cost map for the network map that includes inter PID path costs calculated using the geographic distances between PIDs of the network map.

In one embodiment the invention is directed to a method comprising aggregating with an application layer traffic optimization ALTO server that stores physical location information for a network of one or more endpoints that provides a service the endpoints into a set of one or more PIDs based at least on the physical location information wherein each PID is associated with a subset of the endpoints. The method further comprises generating a first ALTO network map that includes PID entries to identify a respective subset of the endpoints associated with each of the set of PIDs.

In another embodiment the invention is directed to an application layer traffic optimization ALTO server comprising an endpoint locations module to store physical location information for a network of one or more endpoints that provides a service. The ALTO server further comprises a PID generator to aggregate the endpoints into a set of one or more PIDs based at least on the physical location information wherein each PID is associated with a subset of the endpoints. The ALTO server further comprises a network map module to generate a first ALTO network map that includes PID entries to identify a respective subset of the endpoints associated with each of the set of PIDs.

In another embodiment the invention is directed to a non transitory computer readable medium containing instructions. The instructions cause a programmable processor to aggregate with an application layer traffic optimization ALTO server that stores physical location information for a network of one or more endpoints that provides a service the endpoints into a set of one or more PIDs based at least on the physical location information wherein each PID is associated with a subset of the endpoints. The instructions further cause a programmable processor to generate a first ALTO network map that includes PID entries to identify a respective subset of the endpoints associated with each of the set of PIDs.

The described techniques may provide one or more advantages. For example incorporating location information into an ALTO service may enable an ALTO client to select a serving node for an application that reduces a distance between the serving node and a mobile device that is requesting the application content. Because distance between a network source and network destination strongly correlates to transport latency reducing such distance using the location based selection techniques herein described may reduce the transport latency of content delivery from the source to the destination. In addition in a content delivery network CDN accounting for physical locations of mobile devices when selecting a serving CDN cache for a requesting mobile device may reduce peering and transport costs. As a still further example the techniques may enable a client peer of a P2P network to select a serving peer of the network that does not share a cell with the client peer rather than a shared cell. The peers may therefore split the required radio bandwidth for a P2P transaction between two different cells. The techniques may thus extend the benefits of the ALTO service to the mobile arena.

The details of one or more embodiments of the invention are set forth in the accompanying drawings and the description below. Other features objects and advantages of the invention will be apparent from the description and drawings and from the claims.

Cellular network includes gateway devices A B gateway devices serving nodes A B serving nodes base stations A B base stations and a mobile device . While shown for ease of illustration purposes as including only two gateway devices two serving devices and one mobile device cellular network may comprise a plurality of gateway devices and a plurality of serving devices that service a plurality of mobile devices.

In general cellular network may implement any commonly defined cellular network architecture including those defined by standards bodies such as a Global System for Mobile communication GSM Association a 3Generation Partnership Project 3GPP a 3Generation Partnership Project 2 3GGP 2 an Internet Engineering Task Force IETF and a Worldwide Interoperability for Microwave Access WiMAX forum.

For example cellular network may implement one or more of a GSM architecture a General Packet Radio Service GPRS architecture a Universal Mobile Telecommunications System UMTS architecture and an evolution of UMTS referred to as Long Term Evolution LTE each of which are standardized by 3GGP. Cellular network may alternatively or in conjunction with one of the above implement a code division multiple access 2000 CDMA2000 architecture. Cellular network may again as an alternative or in conjunction with one or more of the above implement a WiMAX architecture defined by the WiMAX forum.

Cellular network may consist of a core packet switched network that includes gateway devices and serving devices coupled to one or more radio access networks RANs that each include one or more of base stations as well as other RAN components such as Radio Network Controllers RNCs not shown . The core network and RANs that constitute cellular network may communicate over a backhaul network that includes land based transmission lines frequently leased by a service provider of cellular network to transport mobile data and control traffic between radio access network base stations and the core networks. The backhaul network also includes network devices such as aggregation devices and routers. Cellular network executes various protocols to exchange data and control information among gateway devices serving devices and base stations over a number of wired and or wireless links that interconnect these devices. Base stations communicatively couple to mobile device over a wireless link.

Depending on the standard cellular network facilitates access to CDN by implementing a mobile data protocol. For example within the GSM architecture cellular network may implement a general packet radio service GPRS protocol such as a GPRS tunneling protocol GTP to facilitate access to CDN . In this exemplary instance gateway devices may each represent a gateway GPRS support node GGSN serving devices may each represent a serving GPRS support node SGSN and base stations may each represent a Node B.

As another example cellular network may implement CDMA2000. Gateway devices and serving devices may each in this example represent a packet data servicing node PDSN that is responsible for managing sessions between cellular network and mobile devices attached to cellular network such as mobile device . As still further examples cellular network may implement an LTE mobile data protocol. Gateway devices and serving devices may represent in this example packet data network PDN gateways and serving gateways respectively.

While described herein with respect to one or more particular architectures for ease of illustration purposes cellular network may implement any architecture both those set forth by any standards body and those proprietarily owned. Moreover the techniques may apply to any mobile data protocol supported by these architectures. The techniques therefore should not be limited to cellular architecture referenced herein and the mobile data protocols supported by these architectures. Gateway devices and serving devices may therefore each represent an abstraction of devices found within any one of the above cellular network architectures. Some embodiments of network system may include multiple cellular networks that provide network access to mobile device when attached to a respective such cellular network.

Cellular network couples to CDN a network of interconnected devices that cooperate to distribute content to clients using one or more services. Such content may include for instance streaming media files data files software domain name system information documents database query results among others. Accordingly examples of services offered by CDN may include hyper text transfer protocol HTTP HTTP based adaptive streaming Real Time Streaming Protocol RTSP streaming other media streaming advertising file transfer protocol FTP and others. CDN comprises CDN cache nodes A B CDN nodes that store replicated content and serve that content to requesting devices using for example a transmission control protocol TCP or user datagram protocol UDP session operating over intermediate devices of CDN not shown for simplicity that interconnect CDN nodes and other networks such as cellular network . Each of CDN nodes may include one or more data servers web servers application servers databases computer clusters mainframe computers and any other type of server computing element and or database that may be employed by a content service provider to facilitate the delivery of content from the cache to mobile device via cellular network .

A content provider administers CDN nodes to optimize content delivery using load balancing techniques caching request routing and or content services. CDN nodes may mirror content though any of CDN nodes may provide different services and data content than that provider by the other CDN nodes. In some embodiments CDN is also a service provider network or other access network. While application of the techniques is described herein with respect to selecting a serving node of a content delivery network the techniques are applicable to other network types such as P2P networks. Accordingly CDN may in some embodiments represent the Internet or any other packet based publicly accessible computer network that transports content sourced by nodes for delivery to mobile device .

Respective gateways connect to respective CDN nodes via respective communication links A B that deliver content from CDN to cellular network . The term communication link as used herein comprises any form of transport medium wired or wireless and can include intermediate nodes such as network devices. For example communication links may each comprise a respective autonomous system border boundary router not shown or provider edge router that executes the border gateway protocol BGP to advertise to the other routers or peers network destinations to which the router offers connectivity.

Mobile device hosts one or more applications that connect to CDN via cellular network to request and download application related content. Mobile device is a subscriber device and may comprise for example a mobile or smart phone Personal Digital Assistants PDAs and another type of device cable of connecting to cellular network via a wireless connection to one of base stations .

Content delivery network comprises request router to receive content requests from mobile device select and locate one of CDN nodes that is capable of servicing the request and redirecting the requesting host to the identified CDN node. Request router may be for example a DNS or other type of server a proxying device a P2P peer a P2P application specific tracker or a firewall or other security device. In some instances request router implements DNS server load balancing SLB . In some instances request router is a content aware content request router that maps particular content or content types to each of CDN nodes that store and source the particular content or content types. In such instances request router selects one of CDN nodes to service a request according to content or content type availability. In some instances request router is a service aware service request router that maps services to each of CDN nodes that provide the service irrespective of whether the CDN node presently stores content for the service. In such instances request router selects one of CDN nodes to service a request according to service capabilities. If a selected one of CDN nodes that provides the service does not store the content the CDN node requests and receives the content from a centralized server not shown or from another one of CDN nodes .

In some embodiments request router is an HTTP redirector. That is request router receives HTTP requests for content from HTTP clients and redirects the request to a selected one of CDN nodes by returning to the requesting device an HTTP response having status code and including a network address of the selected CDN node. In some embodiments mobile device CDN nodes and request router are P2P peers connected in an overlay network to exchange location information and content using a P2P application. In such P2P embodiments request router may be a centralized server for the P2P application that indexes content to peers and provides location information in place of a peer.

To influence the selection of a particular CDN node to service a particular request received from a network device CDN additionally employs an Application Layer Traffic Optimization ALTO service that is provided by CDN ALTO server of CDN . In general the ALTO service enables CDN to influence the selection process to further content provider objectives which may include improving user experience by selecting the most geographically proximate one of CDN nodes to a requesting host reducing transmission costs to the content provider load balancing service level discrimination accounting for bandwidth constraints and other objectives. Further details regarding the use of an ALTO service in CDNs may be found in R. Penno et al. ALTO and Content Delivery Networks draft penno alto cdn 00 Network Working Group the Internet Engineering Task Force draft June 2010 which is incorporated herein by reference in its entirety.

CDN ALTO server generates and stores a network map and cost map for CDN . As described in detail below with respect to a network map contains network location identifiers or PIDs that each represents one or more network devices in a network. In general a PID as the term is used herein may represent a single device or device component a collection of devices such as a network subnet an SP network or some other grouping. The network map stored by CDN ALTO server includes PIDs that represent at least CDN nodes . As described in detail below with respect to a cost map contains cost entries for pairs of PIDs represented in the network map and an associated value that represents a cost to traverse a network path between the members of the PID pair. The value can be ordinal i.e. ranked or numerical e.g. actual . CDN ALTO server may generate the network maps and cost map by obtaining physical locations for CDN nodes of CDN and then applying policies to the physical locations to aggregate the CDN nodes into PIDs and calculate costs per a specified criteria such as transmission cost or node priority for traversing a network path between members of PID pairs. In some embodiments a CDN administrator or a third party provisions CDN ALTO server with a network map and cost map. CDN ALTO server may comprise for example a high end server or other service device a content indexer for a P2P application or a service card insertable into a network device such as a router or switch. CDN ALTO server may operate as an element of a service plane of a router to provide ALTO services in accordance with the techniques of this disclosure.

Cellular network also implements an ALTO service using ALTO server which stores generates and maintains a network map and cost map for cellular network . The network map maintained by ALTO server includes PIDs that represent at least mobile device and gateways . In some embodiments ALTO server represents each of gateways in the network map for cellular network with a unique PID that represents no additional network devices. ALTO server may specify a PID type for PIDs representing gateways and or a PID type e.g. mobile host for mobile device . Further example details regarding specifying a PID type for PIDs can be found in Medved et al. U.S. patent application Ser. No. 12 861 671 entitled APPLICATION LAYER TRAFFIC OPTIMIZATION SERVICE ENDPOINT TYPE ATTRIBUTE filed Aug. 23 2010 the entire contents of which are incorporated herein by reference.

In accordance with the techniques of this disclosure ALTO server generates network and cost maps for cellular network based at least on a physical location of mobile device . That is ALTO server generates the ALTO service maps according to a physical location of mobile device as known to ALTO server at the time of generation. Initially mobile device attaches to cellular network at base station A. Mobile device sends information regarding its physical location to ALTO server in a location update message. Such information may comprise longitude latitude coordinates for mobile device an identifier for base station A an identifier for serving node A that serves base station A or other location correlated information. Location information may also include cell bandwidth utilization that may affect transport performance from to mobile device . Upon receiving the location update message ALTO server aggregates mobile device and any other devices not shown that are proximate to mobile device into a PID of a network map for cellular network . As specified in the cost map for cellular network this PID may have a lower cost to a PID that includes gateway A than to a PID that includes gateway B.

Mobile device then attaches to cellular network at base station B after movement to a location signified in as mobile device . Mobile device as illustrated is thus a representation of mobile device moved to a different location. Mobile device sends directly or indirectly ALTO server another location update message to cause ALTO server to aggregate mobile device into a different PID of the network map for cellular network based at least on the new physical location of mobile device after movement . As specified in the cost map for cellular network this new PID for mobile device may have a lower cost to a PID that includes gateway B than to a PID that includes gateway A. In some instances movement of mobile device causes ALTO server to update a cost map for cellular network based at least on the new physical location of mobile device in addition to or instead of modifying the network map for cellular network .

As a result in contradistinction to topology only based or static configuration ALTO techniques mobile device is dynamically aggregated into a PID for an ALTO network map for cellular network based on a location of the mobile device rather than a network address subnet of the mobile device. Because a physical location for mobile device may affect latency and other performance metrics for application data transport from CDN nodes using the ALTO network map and cost maps for cellular network may improve application performance by improving selection using an ALTO service of a CDN node with which to serve content to mobile device which may attach to different base stations while in motion in the serving area of cellular network .

CDN ALTO server improves selection of a CDN node in the CDN domain for mobile device in the cellular network domain by providing an ALTO service. In accordance with these techniques CDN ALTO server comprises ALTO client that uses an ALTO protocol to request and receive from ALTO server of cellular network the network map and cost map for cellular network . CDN ALTO server then combines the respective network and cost maps for the respective networks into master network and cost maps for use in CDN node selection by request router . CDN ALTO server provides these maps to ALTO clients such as CDN ALTO client of request router to improve CDN nodes selection by request router . Further example details regarding applying ALTO services within multiple administrative domains can be found in Penno et al. U.S. patent application Ser. No. 12 861 645 entitled APPLICATION LAYER TRAFFIC OPTIMIZATION SERVICE SPANNING MULTIPLE NETWORKS filed Aug. 23 2010 the entire contents of which are incorporated herein by reference. In some embodiments CDN ALTO server generates a master cost map and a master network map in accordance with an assigned PID type. For example CDN ALTO server may generate a master cost map that includes inter PID costs for PID pairs having members drawn from different PID types.

CDN ALTO client requests and receives from CDN ALTO server the master network and cost maps. In some instances CDN ALTO server sends respective network maps for CDN and cellular network to CDN ALTO client . Mobile device sends content request to request router . Request router queries the master cost map to select the lowest cost node from among CDN nodes for mobile device and returns a network address for the selected CDN node for the content request in content response . Request router uses the master network map to map the source IP address of mobile device to a PID in the master cost map. In some embodiments may use the network map for cellular network to map the source IP address of mobile device to a PID in the master cost map. Request router then uses the master cost map to select the lowest cost CDN node for the mapped PID. In accordance with the techniques described request router selects CDN node B as being more proximate to mobile device after movement based on location information provided by mobile device to ALTO server in a location update message.

Mobile device establishes communication session e.g. a TCP session with CDN node B to obtain the requested content. In one instance a user operating an Internet browser application types a Uniform Resource Identifier URI in the address bar causing the application to send an in this example HTTP request that includes the URI to request router . Request router maps the URI to CDN nodes that are HTTP servers and store the content for the URI e.g. a web page selects CDN B of the mapped nodes using the master cost map then returns an HTTP response that includes the network address for the selected node to the browser application running on mobile device . The browser application may then send a second HTTP request to the selected CDN node B via communication session to obtain the sought after content.

In another example a browser application operating on mobile device issues a content request to request router operating as a DNS server to resolve the domain. In this example request router returns a network address for a selected node to the browser application of mobile device which then uses the resolved network address to request content in transactions for the service session.

Incorporating location information into an ALTO service may thus enable request router to select one of CDN nodes for an application operating on mobile device in a manner that reduces a distance between the selected CDN node and mobile device versus unselected CDN nodes. Because distance between a network source and network destination strongly correlates to transport latency reducing such distance using the location based selection techniques herein described may reduce the transport latency of content delivery from the source to the destination. In addition because CDN may be operated by a content provider and span multiple delivery networks accounting for physical locations of mobile devices when selecting one of CDN nodes for mobile device may reduce peering and transport costs. The described techniques may thus extend the benefits of the ALTO service to mobile devices.

ALTO client of request router requests and receives from ALTO server a network map and cost map for the distributed application in complete maps upload message . ALTO client in a P2P network may be an application tracker that obtains the maps from ALTO server and integrates the maps into a peer database.

Host comprises application that constitutes a portion of the distributed application discussed above. For example application may be a peer of a P2P application or a client of a client server application. Application may be an Internet browser. Host may represent mobile device of . Host includes a global positioning system GPS receiver that receives signals from the GPS that host uses to generate latitude and longitude coordinates that identify a location of host on the Earth. These coordinates are referred to hereinafter as a physical location of host . In some embodiments host uses an alternative measure for a physical location. For example host may provide a user interface that allows a user to enter a physical location as for example a city and state or a street address. As another example host may use an identifier for the base station with which the host exchanges wireless signals as a physical location value. Various base stations of a cellular network cover different locations and thus a base station identifier correlates to a physical location for mobile devices served by the base station identifier. As still further examples host may send a Wi Fi connection location identifier or GSM localization information or other time difference of arrival TDOA information as a physical location for the host.

Application obtains the physical location from host and provides to ALTO server a location update that includes the physical location. Because the physical location may change with any movement of host over Earth s surface application may provide location update periodically for instance or in response to large movements e.g. greater than 10 miles or prior to or coincident with making a content request to an application server. In this way application may avoid burdening network resources with frequent updates. In some embodiments application may embed location update in the content request thus providing location information to ALTO server only when ALTO server is to resolve the request for host to a particular content node. In addition content node may provide location update to ALTO server when for example content node is a mobile peer of host . When content node is a CDN node for instance an administrator may configure ALTO with a location for the content node.

ALTO server receives location update and uses the information contained therein to if appropriate modify a network map and cost map for the distributed application for a network that includes host to incorporate the physical location of host into the maps in accordance with the techniques herein described. ALTO server may comprise policies for creating network and cost maps using the physical location of network nodes. As used herein a policy specifies an action that is to be taken upon occurrence of a condition.

For example if physical location information in location update indicates host is currently in closer proximity to hosts of a second network map PID in which host is not currently a member than to hosts of first network map PID in which host is currently a member ALTO server may modify the network map to transfer host to the second PID. As another example ALTO server may organize PIDs according to BST identifiers for the hosts such that ALTO server groups hosts that are served by the same BST or groups hosts that are served by one of a group of base station controlled by the same controller such as a base station controller BSC or radio network controller RNC . In this example ALTO server may include a database of base station or other radio access network records that describe base station routing serving and or physical locations.

In addition ALTO server may modify the cost map to account for changes in the host physical location. For example ALTO server may increase an inter PID cost for PID pairs that include a PID to which host to account for additional bandwidth that may be allocated to serve content requests issued from application .

In the illustrated example ALTO server issues incremental map updates to ALTO client upon changes to the network and or cost maps or when requested by the ALTO client. ALTO server determines a difference between a previous network map and cost map and the network map and cost map that ALTO server generated as a result of receiving location update . In addition ALTO server generates instructions to enable ALTO client to modify the network map and cost map received by ALTO client in complete maps upload message to reflect the changes to the application topology. ALTO server then sends these instructions to ALTO client in update message . Upon receiving update message ALTO client modifies location database comprising the network map and cost map for application using the instructions contained in the update message . In some embodiments ALTO server foregoes incremental map updates in favor of additional complete maps upload messages to synchronize changes to the network and cost maps. Further example details regarding incremental ALTO service map updates can be found in Raghunath et al. U.S. patent application Ser. No. 12 861 681 entitled APPLICATION LAYER TRAFFIC OPTIMIZATION SERVICE MAP UPDATES filed Aug. 23 2010 the entire contents of which are incorporated herein by reference.

Upon updating ALTO server with a physical location of host using location update application of host sends content request to request router . Lookup module of request router responds by querying the network and cost maps for the distributed application as updated by ALTO client after receiving update message directing request router to update the ALTO service maps to account for the new physical location of host . Lookup module selects the lowest cost node e.g. content node from which to source the requested content and returns a network address for the selected node to application in content response . In some embodiments lookup module is an HTTP server. Content response may include an HTTP redirect message such as an HTTP redirect message. Location update may also improve application operation when application operates as a P2P server by enabling request router to select host as an optimum content serving node for a requesting P2P client.

In some embodiments ALTO server implements an endpoint cost service. In such embodiments ALTO client provides a list of one or more endpoints such as content node and an identifier for host to ALTO server . ALTO server uses network and cost maps generated in accordance with the location based techniques herein described to determine an optimal endpoint in the list of endpoints received for host . ALTO server returns the optimal endpoint to ALTO client for relay to application of host . In some embodiments of ALTO server that implement an endpoint cost service ALTO server returns a list of the endpoints in a rank ordering according to cost or a list of the endpoints with associated costs for each endpoint.

The location based ALTO map service techniques described above may enhance application performance by enabling selection of a serving node for an application based at least upon proximity between the requesting client and the candidate serving nodes.

In some embodiments network may comprise a mobile service provider network or content access network. For example network may implement one or more of a GSM architecture a General Packet Radio Service GPRS architecture a Universal Mobile Telecommunications System UMTS architecture and an evolution of UMTS referred to as Long Term Evolution LTE each of which are standardized by 3GGP. Network may alternatively or in conjunction with one of the above implement a code division multiple access 2000 CDMA2000 architecture. Network may again as an alternative or in conjunction with one or more of the above implement a WiMAX architecture defined by the WiMAX forum. In such embodiments content servers may be embedded in network by coupling via a communication link to a serving node e.g. an Serving GPRS Support Node a gateway node e.g. a Gateway GPRS Support Node or an intermediate transport node within network .

An ALTO server receives location information for endpoints including mobile devices and content servers for an application that exchanges data using network . In addition ALTO server stores location information for content servers . An administrator may for example configure ALTO server with such location information. ALTO server may represent an embodiment of ALTO server of or ALTO server of . In some embodiments content servers and mobile devices may represent application peers in a P2P network. In some embodiments content server and mobile devices represent servers and clients respectively executing a client server application.

ALTO server uses the location information received for the endpoints to aggregate the endpoints including mobile devices and content servers into PIDs based at least on proximities of the endpoints to one another. In other words ALTO server groups endpoints that are close to one another into the same PID. A threshold for endpoint proximity is typically specified according to an administrator defined threshold. As illustrated ALTO server groups mobile devices A C into a first PID and mobile device D into a second PID at an initial state. Mobile device C typically by operation of a user moves into proximity to mobile device D with movement . Mobile device C sends ALTO server a location update message that includes information describing the new physical location of mobile device C.

Because mobile device C is now proximate to D ALTO server modifies the PIDs to transfer mobile device C to the second PID. ALTO server uses the modified PIDs to generate network and cost maps for an ALTO service. ALTO client of request router requests and receives the ALTO service maps i.e. the generated network and cost maps from ALTO server . When mobile devices request services such as a content file request router selects the lowest cost one of content servers for the requesting mobile device using the ALTO service maps. In this manner ALTO server provides an ALTO service that may enable request router to improve a performance of applications based on locations of application endpoints.

In some embodiments of network system mobile devices implement a peer to peer P2P network to exchange content in addition to or instead of receiving content from content servers . In such embodiments each of mobile devices includes an ALTO client to request and receive network and cost maps generated in accordance with the location based techniques described herein. A particular one of mobile devices seeking content uses the received network and cost maps as described above to determine the lowest cost PID that includes one mobile devices from which to obtain requested content. As another example ALTO server may implement an endpoint cost service that ALTO clients of mobile devices may use to determine a rank ordering of mobile devices to serve content. In a P2P implementation mobile devices or a centralized server may provide a resource discovery service to determine the mobile devices available to serve the requested content. One of mobile devices may provide a list of mobile devices available to the serve the requested content to ALTO server implementing an endpoint cost service and receive from the ALTO server the list in a rank for or a list of the provided mobile devices with associated costs.

Network map of comprises a set of network location identifiers PIDs A B PIDs each identified by a respective one of network location identifier values A C. Each of PIDs constitutes an indirect and network agnostic aggregation mechanism to represent for instance one or more individual endpoints one or more subnets metropolitan areas points of presence PoPs one or more autonomous systems or any combination thereof. For instance PID B represents an endpoint having IP address 192.6.8.47 and has the network location identifier value PID 1. Aggregation of network endpoints into PIDs provides scalability and privacy by decoupling network endpoints from their identifiers in the ALTO context. In particular aggregation reduces the size of costs maps by reducing the size of the network and masks the network topology underlying a particular PID representing e.g. an autonomous system . In some instances network map includes additional PIDs to represent serving nodes of a CDN.

An ALTO server aggregates PIDs of network in accordance with one or more policies that are conditioned at least on geographical proximities among one or more of endpoints . That the ALTO server receives physical location information for the endpoints and based at least on this physical location information organizes the endpoints into PIDs . As described above in some embodiments the ALTO server aggregates PIDs according to base station identifiers for respective serving base stations for the endpoints . In the illustrated network map of endpoints A D may represent corresponding mobile devices A D of .

Upon receiving new physical location information for endpoint C the ALTO server reorganizes PIDs to transfer endpoint C from PID A to PID B to generate network map of . In the modified network map of endpoint C may represent mobile device C of . In the modified network map while endpoints A C have a 192.0.2.0 24 network address prefix that is not shared by endpoint D the ALTO server organized PID B to include both endpoint C and C to incorporate at least in part endpoint location based aggregation in network map generation. Modifying network map in this manner with the ALTO server may improve a service node selection behavior of ALTO clients by selecting service nodes based on physical distance to a requesting client instead of or in addition to routing distance.

For ease of illustration network maps and of are shown in a simplified representation. Instances of a more detailed network map is illustrated and discussed below with respect to .

In the illustrated example cost map indicates PID 1 including endpoints A B is has a lower downstream transit cost from content node A in PID 20 than from content node B in PID 21 . The lower downstream transit cost may indicate PID 1 is more proximate to PID 20 than to PID 21. When request router of receives a content request from endpoint B for instance the request router queries cost map for the lowest cost PID connected to PID 0. Cost map denotes this PID as PID 20 having total cost to PID 0. Request router uses network map to select one of the endpoints in PID 20 in this instance content node A and returns an IP address for content node A to endpoint B.

In some embodiments such as a P2P implementation cost map includes costs between PIDs that include mobile devices . For example in such embodiments cost map includes an entry for a pair to indicate a cost between respective mobile devices of PID 0 and PID 1 to influence serving peer selection.

In accordance with the techniques of this disclosure ALTO server policies also specify aggregating mobile devices according to a physical location topology. For a physical location topology ALTO server aggregates mobile devices A B into PID 0 represented by set A because these devices are located proximate to one another where proximate is defined by an aggregation policy. ALTO server aggregates mobile devices C D into PID 1 represented by set B.

To generate a network map for use in an ALTO service ALTO server may intersect the two sets representing the network and physical location topologies respectively to create an intersection topology as illustrated in Euler diagram . ALTO server generates intersection PIDs from mobile devices that constitute the various intersections of the two sets . An intersection PID is a group of endpoints e.g. mobile devices that constitute the intersection of two or more sets of endpoints where each of the sets is a PID group aggregated for a different topology dimension. In the illustrated example intersection PID 10 comprises mobile devices A B intersection PID 11 comprises mobile device C and intersection PID 12 comprises mobile devices D. ALTO server may then generate the network map for the ALTO service using the topology represented by the intersection PIDs. In this way ALTO server incorporates both topologies into the ALTO service to account for multi dimensional factors in this case network and physical location that affect application performance.

In various embodiments Euler diagram may represent and ALTO server may generate intersection PIDs for multiple different topologies. For example ALTO server may create one or more topologies that represent various combinations of physical location routing distance network location administrative entity serving node capability base station identifier cell identifier and mobile device capability dimensions for example. Using cell identifier or base station identifier topologies may for example allow the ALTO server to prioritize for a given client a server in a cell that is not shared with the client. In addition while illustrated and described for explanatory purposes as comprising separate aggregation steps for individual topology PIDs and intersection PIDs ALTO server may generate intersection PIDs according to a policy that combines conditions from among multiple topological dimensions.

Preliminary cost map is an exemplary cost map for preliminary network map of expanded to include PIDs for content nodes . That is preliminary cost map is an adjacency matrix that is expanded into a table of cost entries for PID pairs that include both a PID that includes a mobile device and a PID that includes a serving node. As ALTO server generates preliminary network map based on network topology of the mobile devices and serving nodes ALTO server generates preliminary cost map having cost values that provide an estimated total cost to traverse a network path between mobile device PIDs and serving node PIDs. In some embodiments cost maps and include entries for each PID pair in a network map rather than merely host serving node pairs. Such expansion may be appropriate for example in a P2P application where each peer may be both a client and a server.

Cost map includes intersection PIDs of network map of . Cost map is an adjacency matrix that is expanded into a table of cost entries for PID pairs that include both an intersection PID and a PID that includes a serving node. ALTO server generates cost map by summing the adjacency matrices of preliminary cost maps . Specifically for each intersection PID ALTO server adds a first cost for the first topology with a second cost for the second topology. For example PID 11 is an intersection of PID 1 of the physical location topology and PID 2 of the network topology. To generate a cost value for cost map for the pair for example ALTO server thus adds cost values for the pair of cost map and the pair of cost map . In some instances ALTO server includes policies that assign various weights to the different topologies. Rather than simply sum cost values of preliminary maps ALTO server policies may assign a larger weight to physical location topology edge values and thus signify a greater cost significance to physical location than other topology types.

Cost map thus provides for ALTO server and request router a total cost to traverse a path between any of mobile devices and any of content nodes where the total cost accounts for multiple cost factors including physical distance and network routing distance. Other instances of cost map like network map may incorporate additional factors including network location administrative entities serving node capabilities base station identifiers and mobile device capability for example.

Map modules of ALTO server generate network map and cost map based at least on physical locations of one or more endpoints of a network served by ALTO server . In addition in the illustrated embodiment ALTO server comprises topology information base a data structure that includes information regarding network topology transmission costs for various network links and other information that may be used by map modules to generate ALTO based maps. Network map module uses topology information base to generate network map and cost map module uses topology information base to generate cost map . Routing daemon executes routing protocols to provision topology information base with route information. In addition administrator may connect to user interface UI to upload tables or other data structures that include topology information to topology information base . In some embodiments map modules generate network map and cost map in a manner that does not account for network topology or other information stored by network information base . That is in such embodiments ALTO server does not include routing protocols or network information base and instead bases network map and cost map generation on a physical location topology rather than a network topology.

User interface may be a command line interface CLI a graphical user interface GUI a remote procedure call RPC or some other method to enable administrator to configure topology information base provisioning policies of ALTO server and in some instances endpoint locations . Administrator may be a network operator of e.g. a service provider network or a software agent executing e.g. on a network management device. For endpoints that do not have location update functionality including non mobile endpoints such as CDN nodes administrator configures entries for the endpoints with associated locations in endpoint locations . Administrator provisions ALTO server with provisioning policies a set of policies that cause network map module to generate network map and cost map module to generate cost map in accordance with administrator preferences relating to physical locations transmission costs load balancing service discrimination PID grouping or other preference areas.

Endpoint interface receives location update from mobile device and uses the information contained therein to if appropriate modify a network map and cost map for the distributed application for a network that includes mobile device to incorporate a physical location for the mobile device into the maps in accordance with the techniques herein described. Mobile device may represent an embodiment of one of mobile devices of or mobile devices of . Endpoint interface may comprise for example a simple network management protocol SNMP agent that connects to mobile device or to a centralized network management server to request location update . Endpoint interface may expose an application programming interface API which may comprise a Web service or an Extensible Messaging and Presence Protocol XMPP based API for use by mobile device to provide location update . Endpoint interface may poll mobile device for location update .

Endpoint locations of ALTO server is a data structure comprised of entries that map endpoints such as mobile device other mobile devices or other nodes of a network served by ALTO server to a respective physical location. Each entry of endpoint locations includes an identifier for each endpoint and one or more values to represent the physical location of the endpoint. An endpoint identifier may include for instance a network address MAC address International Mobile Equipment Identity IMEI International Mobile Subscriber Identity IMSI URL or some combination thereof. Physical location values for an endpoint may include for example geographical locations in the form of longitude latitude coordinates a base station or mobile network component identifier a geographic address e.g. city state and or street address a Wi Fi connection location identifier and GSM localization information or other time difference of arrival TDOA information. Endpoint locations may comprise a table database linked list or other associative data structure.

When endpoint interface receives location update from mobile device endpoint interface updates an existing entry for mobile device with the location values included therein. If an entry for mobile device is not present in endpoint locations endpoint interface creates a new entry using the identifier and physical location of the endpoint included in location update .

In accordance with the techniques of this disclosure provisioning policies includes policies for creating network and cost maps based at least on a physical location of mobile devices e.g. mobile device in a network served by ALTO server . For example provisioning policies may include one or more policy rules to cause network map module to aggregate one or more mobile devices located within a specified threshold distance from one another into a network map PID. As another example provisioning policies may include one or more policy rules to cause network map module to aggregate one or more mobile devices served by a particular base station identified within the policy rules into a network map PID. Provisioning policies may include other PID aggregation related policy rules to perform aggregation based on for example the other physical location identifiers listed above.

Provisioning policies may also affect operation of cost map module to generate cost map . For example one or more policy rules of provisioning policies may specify attaching a cost to a PID pair of network map that is calculated based at least on a physical distance between respective devices of the PID pair. In some instances provisioning policies may include one or more rules that specify costs between particular devices. For example a policy rule may specify a cost between a particular base station identified in the rule and a particular content node identified in the rule. In this example for a PID that includes mobile devices served by the particular base station identified in the rule cost map module may set in cost map the inter PID cost from that PID to a PID that includes the particular content node identified in the rule to the cost specified in the rule. In this way ALTO server may leverage known transport cost factors of a network such as bandwidth limitations communication link leasing costs peering costs and latency to improve behavior of applications operating on mobile devices.

As described above with respect to in some embodiments map modules may generate network map and cost map in accordance with multiple topologies to account for multi dimensional factors such as network and physical location which affect an application performance. In such embodiments provisioning policies may include one or more policy rules that specify a manner in which cost map module is to calculate a combined cost map using the individual cost maps for the different topologies. Provisioning policies may weight individual cost maps differently in a cost formula that cost map module uses to combine multiple topologies. For example administrator may determine a significance of physical location distances exceeds a significance of network topology distance by some factor. Administrator may thus set a coefficient for physical location distance variables in a cost formula to the factor and another quantity based at least on the factor to increase a significance of the physical location topology costs.

Client interface exposes an ALTO server interface to enable ALTO clients such as client to request and receive network and cost maps for an application for the network. Client interface sends a copy of network map and cost map to client in complete maps upload message . Client interface may execute one or more protocols to obtain network addresses of ALTO clients in the network and the client interface maintains these network addresses so as to push incremental updates of the maps e.g. incremental update to the clients. Further example details regarding incremental ALTO service map updates can be found in Raghunath et al. referenced above. In this manner ALTO clients obtain network and cost maps from ALTO server that reflect a current physical location topology for a network that includes mobile devices.

In some embodiments of ALTO server client interface implements an endpoint cost service. When client interface receives from client a list of endpoints represented in network map client interface returns an ordinally ranked list of the endpoints or the costs specified by cost map between the endpoints and client or between the endpoints and another specified source node.

In some embodiments client represents a P2P device participating in a P2P application. For example client may represent an ALTO client operating within mobile device . In such examples client receives network map and cost map or utilizes the endpoint cost service in the manner described above.

Provisioning policies includes one or more policy rules to specify aggregating endpoints into PIDs based at least on a physical location distance among endpoints in accordance with the techniques described herein. Proximity calculator of network map module uses device coordinates to determine physical location distances between various devices in device list using a longitude latitude distance calculation and based on these distances generates a matrix of distances among the devices. The matrix may represent any data structure that is able to specify distances among the devices. PID generator in accordance with provisioning policies aggregates devices in device list into PIDs using distances among the mobile devices in the matrix calculated by proximity calculator . PID generator may in some instances generate a PID for each endpoint in the served network including devices not generally considered mobile.

Network map module constitutes the aggregated PIDs into network map . Network map module generates ALTO network map in a manner that accounts for a physical location of mobile devices in a network served by ALTO server . Upon receiving network map from ALTO server ALTO clients may thus improve performance of application by enabling selection of content servers for a content requesting mobile device based at least on a physical location of the mobile device.

Cost map module queries endpoint locations and provisioning policies to generate cost map using the location based techniques herein described. Provisioning policies may additionally include one or more policies to specify formulas parameters and other values that affect costs calculated based at least on a physical distance among endpoints and among PIDs that represent endpoints. Proximity calculator of cost map module uses device coordinates to determine physical location distances between various devices in device list using a longitude latitude distance calculation and based on these distances generates a matrix of distances among the devices. The matrix may represent any data structure that is able to specify distances among the devices. Cost calculator applies provisioning policies to the calculated matrix and network map to determine costs among PIDs specified in the network map and generate cost map that includes cost map entries for the PID pairs.

Network map module uses the aggregated PIDs to generate network map and cost map module specifies costs for inter PID links in accordance with provisioning policies to generate cost map . Client interface outputs network map and cost map or incremental updates thereof to client .

The techniques described in this disclosure may be implemented at least in part in hardware software firmware or any combination thereof on the device management system and the managed devices. For example various aspects of the described techniques may be implemented as encoded program code executed by one or more processors including one or more microprocessors digital signal processors DSPs application specific integrated circuits ASICs field programmable gate arrays FPGAs or any other equivalent integrated or discrete logic circuitry as well as any combinations of such components. The term processor or processing circuitry may generally refer to any of the foregoing logic circuitry alone or in combination with other logic circuitry or any other equivalent circuitry. A control unit comprising hardware may also perform one or more of the techniques of this disclosure.

Such hardware software and firmware may be implemented within the same device or within separate devices to support the various operations and functions described in this disclosure. In addition any of the described units modules or components may be implemented together or separately as discrete but interoperable logic devices. Depiction of different features as modules or units is intended to highlight different functional aspects and does not necessarily imply that such modules or units must be realized by separate hardware or software components. Rather functionality associated with one or more modules or units may be performed by separate hardware or software components or integrated within common or separate hardware or software components.

The techniques described in this disclosure may also be embodied or encoded in a computer readable medium such as a computer readable storage medium or a non transitory computer readable medium containing instructions. Instructions embedded or encoded in a computer readable medium may cause a programmable processor or other processor to perform the method e.g. when the instructions are executed. Computer readable storage media may include random access memory RAM read only memory ROM programmable read only memory PROM erasable programmable read only memory EPROM electronically erasable programmable read only memory EEPROM flash memory a hard disk a CD ROM a floppy disk a cassette magnetic media optical media or other computer readable storage media. It should be understood that the terms computer readable storage media and non transitory computer readable media refer to physical storage media and not signals or carrier waves although the term computer readable media may include transient media such as signals in addition to physical storage media.

Various embodiments of the invention have been described. These and other embodiments are within the scope of the following claims.

