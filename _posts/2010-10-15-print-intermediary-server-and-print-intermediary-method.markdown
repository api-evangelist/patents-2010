---

title: Print intermediary server and print intermediary method
abstract: A print intermediary server capable of communicating with a web application server and a printing apparatus via the Internet manages information of one or more printing apparatuses, searches information of a printing apparatus requested by the web application server out of the information of one or more printing apparatuses to generate a response to the web application server, associates information indicating a storage location of print data whose printing has been requested by the web application server and information indicating a printing apparatus which has been requested to perform printing, stores the associated information as a print job, extracts, in response to a print job request from the printing apparatus, a print job associated with the printing apparatus which has made the print job request out of the stored print jobs, and generates a print job response to be transmitted to the printing apparatus.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08482778&OS=08482778&RS=08482778
owner: Canon Kabushiki Kaisha
number: 08482778
owner_city: Tokyo
owner_country: JP
publication_date: 20101015
---
The present invention relates to a print intermediary server useful for mediating a printing instruction.

In recent years web application has become popular. A web application is an application that is provided by a web application server and accessed via a web browser of a client PC. When the web application is used installation of applications in the client PC becomes unnecessary. The web application includes an application used for generating a document editing the document and storing the generated document in a storage of a web application server.

Conventionally certain procedures have been necessary in printing a document which has been generated using such an application by a printing apparatus. First a user generates and edits a document using a web application and stores the document in a web application server. Then via a web browser of a printing apparatus the user downloads the document from the web application server to a storage of the printing apparatus. Lastly by using an operation unit of the printing apparatus the user instructs the printing apparatus to print the document stored in the storage. This type of printing performed according to the above described procedures is called PULL type printing. This is because the download of the document originates from the printing apparatus when the printing is performed.

On the other hand there is a demand for seamless operation using web application from the generation of a document to the printing of the document by a printing apparatus. This type of printing is called PUSH type printing. This is because a printing instruction is externally given to the printing apparatus. However since the printing apparatus is protected by a firewall for security reasons it does not accept the printing instruction according to the PUSH type printing given by the web application server via the Internet. Thus methods for realizing the PUSH type printing via the Internet are being discussed.

Among such methods there is a printing method according to which the printing apparatus sends a message to a web application server at regular intervals asking whether a print job exists. If a print job exists the printing apparatus downloads the print data and performs printing e.g. Japanese Patent Application Laid Open No. 2003 022165 . This print method is called printing using polling.

However according to the print method using polling if a printing instruction is given by various web application servers the printing apparatus needs to perform polling of a plurality of web application servers. If the printing apparatus performs polling of a plurality of web application servers the load of the network of the printing apparatus increases. Further setting of the web application servers necessary in the polling will be complicated.

According to an aspect of the present invention a print intermediary server capable of communicating with a web application server and a printing apparatus via the Internet includes a management unit configured to manage information of one or more printing apparatuses a response unit configured to search information of a printing apparatus requested by the web application server out of the information of one or more printing apparatuses managed by the management unit and to generate a response to the web application server a storage unit configured to associate information indicating a storage location of print data whose printing has been requested by the web application server and information indicating a printing apparatus which has been requested to perform printing and to store the associated information as a print job and a generation unit configured to extract in response to a print job request from the printing apparatus a print job associated with the printing apparatus which has made the print job request out of the print jobs stored in the storage unit and to generate a print job response to be transmitted to the printing apparatus.

According to an exemplary embodiment of the present invention since the print intermediary server manages printing instructions transmitted from the web application server the printing apparatus does not need to access many servers in making the inquiry regarding printing. Thus the load of the printing apparatus capable of the PUSH type printing can be reduced. Further complicated setting used for the polling will be unnecessary.

Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.

Various exemplary embodiments features and aspects of the invention will be described in detail below with reference to the drawings.

The printing apparatus is a multifunction peripheral MFP that can input output and transmit receive an image and perform various types of image processing. The printing apparatus includes the printer being an image output device a control unit and an operation unit being a user interface. The printer and the operation unit are connected to the control unit . The control unit controls the printer and the operation unit . The control unit is connected to the Internet .

The host computer includes the browser . The host computer can receive services from the web application server via HTTP hypertext transfer protocol . The host computer is for example a personal computer PC a personal digital assistant PDA or a cellular phone. The host computer is connected to the Internet .

A firewall is provided to limit access to the printing apparatus from an external apparatus via the Internet for security reasons. Thus the print intermediary server can communicate with the web application server via the Internet and also communicate with the printing apparatus via the Internet through the firewall.

In a central processing unit CPU executes an operating system OS or an application program stored in a program read only memory ROM of a ROM or stored in an external memory and loaded into a random access memory RAM . Processing of the flowcharts described below is executed by the CPU . The RAM functions as a main memory and a work area of the CPU . A keyboard controller controls key input by a user using a keyboard or a pointing device not shown . A display controller controls display of a display . An external memory controller controls access to data stored in the external memory e.g. a hard disk HD or a flexible disk FD that stores various types of data. A network controller is connected to the Internet and executes control processing of communication with other apparatuses connected to the Internet .

Next the configuration of the printing apparatus will be described with reference to . is a block diagram illustrating detailed configuration of the printing apparatus illustrated in .

As illustrated in the printing apparatus includes the control unit which controls the overall operation of the apparatus. The control unit controls the printer being an image output device. The control unit is connected to a LAN or a public line and receives transmits image information or device information via the LAN or the public line. The control unit includes a CPU .

The CPU is connected to a RAM a ROM a HDD hard disk device an image bus I F an operation unit I F and a network I F via a system bus . The RAM serves as a work area for the CPU . Further the RAM serves as an image memory used for temporarily storing image data. The ROM is a boot ROM. A boot program of the system is stored in the ROM . System software and image data is stored in the HDD . The operation unit I F is an interface which is used when data is input in or output from the operation unit . For example it is used when image data to be displayed on the operation unit is input in the operation unit or when information input by the user using the operation unit is transmitted to the CPU . The network I F is connected to the Internet via the firewall and used for transmitting receiving information to and from the Internet .

The image bus I F is a bus bridge that connects the system bus and an image bus which transfers image data at a high speed and converts a data structure. A raster image processor RIP a device I F and a printer image processing unit are connected to the image bus . The RIP rasterizes the page description language PDL code received from the network into a bitmapped image. The device I F connects the printer and the control unit and performs synchronous asynchronous conversion of the image data. The printer image processing unit performs correction and resolution conversion of the image data to be output.

Next software configurations of the print intermediary server the web application server the printing apparatus and the host computer will be described with reference to .

The print intermediary server includes a web service provider unit a print job response generation unit a printing apparatus list response generation unit a print job table management unit a printing apparatus table management unit a redirect response generation unit and a logical URI generation unit . These modules exist as program files stored in the external memory of the print intermediary server . An OS or a module using the above described module loads a program file into the RAM and then the CPU executes the program file.

The web service provider unit gives a web service response to a web service request sent from the web application server or the printing apparatus . The print job response generation unit generates a print job response in response to a print job request sent from the printing apparatus . The printing apparatus list response generation unit generates a printing apparatus list response to a printing apparatus list request sent from the web application server .

The print job table management unit manages a print job table a print job table with web authentication and a print job table with printing apparatus authentication. These tables are used for registering print jobs sent from the web application server . The printing apparatus table management unit manages printing apparatus information sent from the printing apparatus according to a printing apparatus registration request.

The redirect response generation unit generates a redirect response including a print data URI in response to a print job request sent from the printing apparatus . The logical URI generation unit generates a logical URI which is a print data URI with an additional web user ID and a web user password.

The web application server includes a web server unit an application server unit a data management unit a web service requester unit and an authentication unit . These modules exist as program files stored in the external memory of the web application server . An OS or a module using the above described module loads a program file into the RAM and then the CPU executes the program file. The web server unit accepts an HTTP request sent from the browser of the host computer via the Internet and returns an HTTP response to the request to the host computer .

The application server unit is called by the web server unit according to the HTTP request and executes processing. According to the result of the processing the application server unit returns a dynamically generated HTML to the web server unit . Further the application server unit causes the web service requester unit to transmit a web service request to an external service for example the print intermediary server via the Internet .

The data management unit performs management of data that needs to be maintained. The web service requester unit transmits a web service request to the web service provider unit of the print intermediary server and receives a response. When the authentication unit receives a web user ID and a web user password it returns an authentication result.

The printing apparatus includes a user interface UI a web client a control application programming interface API a job manager a print manager a PDL manager and an authentication manager . These modules exist as program files stored in the HDD of the printing apparatus . An OS or a module using the above described module loads a program file into the RAM and then the CPU executes the program file.

When the user performs various operations and makes setting of the printing apparatus the UI of the printing apparatus mediates between the apparatus and the user operation. According to an operation of an operator the UI transfers information that has been input to the modules described below and requests the modules to process the information or sets data. The web client transmits a print job request to the print intermediary server . The control API provides a module such as the web client with an interface for example used for communication with a module such as the job manager described below. According to the control API independency of the modules is enhanced and the function of each module is more diversely used.

The job manager interprets various types of processing instructed by each of the above described modules via the control API and gives instructions to the modules described below. Further the job manager centralizes management of hardware processing executed by the printing apparatus . The print manager manages controls the print processing instructed by the job manager .

The PDL manager performs PDL conversion of document data instructed by the job manager . The authentication manager authenticates the user that uses the printing apparatus . The authentication manager manages a printing apparatus user ID and a printing apparatus user password. On receiving a printing apparatus user ID and a printing apparatus user password from the web client the authentication manager determines whether a printing apparatus user ID and a printing apparatus user password that match the received ID and password exist in the ID and the password managed by the authentication manager .

A printing apparatus information management unit manages a printing apparatus ID of the printing apparatus location information of the printing apparatus and printing capability information of the printing apparatus such as color monochromatic printing and two sided one sided printing.

The host computer includes the browser . The browser exists as a program file stored in the external memory of the host computer . An OS or a module using the above described module loads a program file into the RAM and then the CPU executes the program file. The browser is displayed on the display and receives an instruction from the user using the keyboard or a pointing device not shown . Further the browser is connected to the web application server using HTTP via the Internet and receives a service.

Next a printing apparatus table managed by the printing apparatus table management unit of the print intermediary server will be described with reference to .

The printing apparatus table is a data table that contains the printing apparatus ID of the printing apparatus the location information of the printing apparatus the capability information of the printing apparatus such as color monochromatic printing and two sided one sided printing and a printing apparatus key of the printing apparatus . The installation location information of the printing apparatus and the capability information of the printing apparatus contained in the printing apparatus table are used as search information when the user selects a desired printing apparatus using the web application provided by the web application server . When the printing apparatus sends a print job request to the print intermediary server it uses the printing apparatus key as a proof of authenticity. The printing apparatus key is a character string arbitrarily specified by the user.

Next the print job table managed by the print job table management unit of the print intermediary server will be described with reference to . The print job table is generated by the web service provider unit of the print intermediary server calling the print job table management unit with respect to a print request sent from the web application server . The printing apparatus ID is an ID selected by the user on the host computer . The print data URI indicates a storage location of the print data on the web application server .

Next the print job table with web authentication managed by the print job table management unit of the print intermediary server will be described with reference to FIG. B. Since the printing apparatus ID and the print data URI of the print job table are similar to those of the print job table their descriptions are not repeated. A web user ID and a web user password are used when the web application server is accessed. By using the above described ID and password the printing apparatus can acquire the print data on the web application server .

Next the print job table with printing apparatus authentication managed by the print job table management unit of the print intermediary server will be described with reference to . Since the printing apparatus ID and the print data URI are similar to those of the print job table their descriptions are not repeated. A printing apparatus user ID is used when a user executes a printing operation using the printing apparatus . A printing apparatus user password is used when a user accesses the web application server . By using the above described ID and password only the user who is managed by the printing apparatus can execute the printing operation.

Next the first exemplary embodiment of the present invention will be described in three parts a first a second and a third processing flow. In the first processing flow the user registers the information of the printing apparatus in the print intermediary server using the operation unit of the printing apparatus . The registered information is used when the user selects a printing apparatus to be used for printing from the web application server . Next in the second processing flow the web application server acquires a list of printing apparatuses from the print intermediary server and then transmits a request that instructs a printing apparatus to perform printing to the print intermediary server .

In the second processing flow the web application server can register a print request with respect to the desired printing apparatus in the print intermediary server . In the third processing flow the print intermediary server generates a print job response in response to the print job request sent from the printing apparatus and transmits the generated print job response to the printing apparatus . The second processing flow is not in synchronization with the third processing flow. The print job request according to which the third processing flow is started is sent out by the printing apparatus at a predetermined interval. The processing flow will be described in detail below.

Now the first processing flow according to the present embodiment will be described with reference to and the flowchart in . According to the first processing flow the information of the printing apparatus is registered in the print intermediary server . The first processing flow is executed only once when the printing apparatus is set so that the print intermediary server can be used.

Next data of the printing apparatus table managed by the printing apparatus table management unit according to the present embodiment will be described with reference to .

The row of data indicates that a printing apparatus having XYZ 008 as the printing apparatus ID JAPAN as the country TOKYO as the region color as the color monochromatic printing two sided as the two sided one sided printing and XXXXXXXX as the printing apparatus key is registered in the printing apparatus table of the print intermediary server .

The row of data indicates that a printing apparatus having ABC 019 as the printing apparatus ID USA as the country New York as the region BW as the color monochromatic printing two sided as the two sided one sided printing and YYYYYYYY as the printing apparatus key is registered in the printing apparatus table of the print intermediary server .

The row of data indicates that a printing apparatus having PQR 020 as the printing apparatus ID JAPAN as the country KYOTO as the region color as the color monochromatic printing one sided as the two sided one sided printing and ZZZZZZZZ as the printing apparatus key is registered in the printing apparatus table of the print intermediary server .

According to the first flow the above described information can be registered in the printing apparatus table . Further the above described information can be used as search information when the user selects the printing apparatus using the application on the web application server . Further each item of the printing apparatus table of the present embodiment is not limited to the above described example and more information of the printing apparatus can be contained in the table.

In step S in the user enters a printing apparatus key into the printing apparatus key input screen see displayed on the UI of the printing apparatus using the operation unit . The form the area configuration and the control regarding the user interface illustrated in are not limited and the user interface can be in any form so long as it can realize the necessary functions.

In step S the user selects an OK button . In step S the web client of the printing apparatus sends a printing apparatus registration request to the print intermediary server . The printing apparatus registration request includes the printing apparatus ID location information of the printing apparatus capability information of the printing apparatus and the printing apparatus key. The printing apparatus registration request is transmitted according to for example SOAP simple object access protocol .

In step S the web service provider unit of the print intermediary server receives the printing apparatus registration request transmitted from the web client of the printing apparatus . In step S the web service provider unit of the print intermediary server calls the printing apparatus table management unit . The printing apparatus table management unit acquires information of the printing apparatus from the printing apparatus registration request sent from the printing apparatus and registers the acquired information in the printing apparatus table .

In step S the web service provider unit of the print intermediary server sends a printing apparatus registration notification to the web client of the printing apparatus . In step S the web client of the printing apparatus receives the printing apparatus registration notification from the web service provider unit of the print intermediary server . As described above the information of the printing apparatus is registered in the print intermediary server according to the first flow.

Next the second processing flow will be described with reference to the flowchart in and the print job table in . According to the second flow the web application server acquires the list of the printing apparatuses from the print intermediary server and transmits a request for printing for the printing apparatus to the print intermediary server . The second processing flow is started by the web application server when a document is generated by the user using the web application server and a print execution instruction is also given by the user on the browser .

Next data contained in the print job table managed by the print job table management unit according to the present embodiment will be described with reference to .

The row of data indicates that a print job having XYZ 008 as the printing apparatus ID and test print document1.pdf as the print data URI is registered in the print job table . The row of data indicates that a print job having ABC 019 as the printing apparatus ID and sample print doc1.pdf as the print data URI is registered in the print job table . The row of data indicates that a print job having ABC 019 as the printing apparatus ID and sample print doc2.pdf as the print data URI is registered in the print job table . Further the above described information is used when the print intermediary server generates a response to the print job request sent from the printing apparatus .

The flowchart in is started by the web application server when a document is generated by the user using the web application server and a print execution instruction is also given by the user on the browser .

In step S the web service requester unit of the web application server transmits a printing apparatus search request to the web service provider unit of the print intermediary server .

In step S the web service provider unit of the print intermediary server receives the printing apparatus search request sent from the web service requester unit of the web application server . The installation location and the capability information e.g. color monochromatic two sided one sided of the printing apparatus are designated according to the printing apparatus search request sent from the web service requester unit . The web application server uses the print intermediary server for example as a web service.

In step S the web service provider unit of the print intermediary server calls the printing apparatus list response generation unit . The printing apparatus list response generation unit searches for the attribute designated by the web application server in the printing apparatus table and extracts a printing apparatus that matches the search condition.

In step S the printing apparatus list response generation unit of the print intermediary server returns a printing apparatus search response to the web service provider unit . The web service provider unit transmits the printing apparatus search response to the web application server . The printing apparatus search response is a list of IDs of the printing apparatus .

In step S the web service requester unit of the web application server receives the printing apparatus search response transmitted from the print intermediary server . In step S the web server unit of the web application server displays the printing apparatus search result in the browser of the host computer .

In step S the web application server waits until the user selects a desired printing apparatus in the browser of the host computer . When a printing apparatus is selected by the user the processing proceeds to step S. In step S the web service requester unit of the web application server transmits a print request to the web service provider unit of the print intermediary server . The print request includes information such as a printing apparatus ID which is an ID of a printing apparatus that is to perform printing and print data URI that indicates a storage location of the print data. The communication of the print request is performed for example by SOAP.

In step S the web service provider unit of the print intermediary server receives the print request from the web service requester unit of the web application server . In step S the web service provider unit of the print intermediary server calls the print job table management unit . Then the print job table management unit stores information of the print request as a print job in the print job table .

In step S the print intermediary server transmits a print request storage notification to the web application server . In step S the web application server receives the print request storage notification transmitted from the print intermediary server .

As described above in the second flow the web application server acquires the list of the printing apparatuses from the print intermediary server and a request for printing for the printing apparatus is transmitted to the print intermediary server .

Next the third processing flow will be described with reference to the flowchart in . In the third processing flow the print intermediary server generates a print job response in response to the print job request sent from the printing apparatus and transmits the generated print job response to the printing apparatus . The third processing flow is repeated at a predetermined interval and is started when the power of the printing apparatus is turned on.

In step S the printing apparatus repeats the processing performed in steps S to S. In step S the web client of the printing apparatus transmits the print job request to the print intermediary server . The print job request includes information such as a printing apparatus ID and a printing apparatus key.

In step S the print intermediary server receives the print job request transmitted from the web client of the printing apparatus . In step S the web service provider unit of the print intermediary server calls the printing apparatus table management unit . The printing apparatus table management unit refers to the printing apparatus table .

In step S the printing apparatus table management unit of the print intermediary server determines whether a combination of the printing apparatus ID and the printing apparatus key included in the print job request exists in the printing apparatus table . If a printing apparatus that satisfies the search condition exists YES in step S then the processing proceeds to step S. If such a printing apparatus does not exist NO in step S then the processing proceeds to step S.

In step S the print job table management unit of the print intermediary server refers to the print job table and searches for a print job that matches the printing apparatus ID included in the print job request. In step S the print job table management unit of the print intermediary server determines whether a print job that matches the printing apparatus ID included in the print job request exists as a result of the search in step S. If a print job that corresponds to the printing apparatus ID exists YES in step S then the processing proceeds to step S. If such a print job does not exist NO in step S then the processing proceeds to step S.

In step S the print job response generation unit of the print intermediary server generates a print job response. The print job response includes the print data URI. On the other hand in step S the print intermediary server generates a blank response. The blank response does not include the print data URI.

In step S the print intermediary server transmits the print job response generated in step S or S in response to the print job request transmitted from the printing apparatus . The communication of the print job response is performed for example by SOAP. In step S the web client of the printing apparatus receives the print job response transmitted from the web service provider unit of the print intermediary server .

In step S the printing apparatus determines whether a print data URI is included in the print job response. Whether a print data URI is included in the response is determined for example by acquiring information in the XML of the SOAP communication. If a print data URI is included in the print job response YES in step S then the processing proceeds to step S. If the print data URI is not included NO in step S then the processing proceeds to step S. In step S the web client of the printing apparatus reads the print data URI from the print job and then requests the web server unit of the web application server to download the print data from the print data URI.

In step S the web client of the printing apparatus receives the print data. The request for downloading the print data is performed according to for example an HTTP protocol Get request with respect to the print data URI.

In step S the print manager of the printing apparatus prints the downloaded document using for example PDF direct print. As illustrated in the PDF direct print is a function which allows direct printing of a PDF document without using a printer driver. The printing apparatus is not necessarily capable of PDF direct print. For example after the control API of the printing apparatus converts the document into a print format which can be printed by the PDL manager the document can be printed using the RIP .

In step S the processing returns to step S. As describe above according to the third processing flow in response to a print job request sent from the printing apparatus if a print job for the printing apparatus exists in the print job table the print intermediary server generates a print job response and responds to the printing apparatus.

As described above according to the first the second and the third processing flow of the first exemplary embodiment the print intermediary server collectively manages the PUSH type printing instruction sent from the web application server to the printing apparatus so that the desired document can be printed. Thus the printing apparatus can determine one print intermediary server as a device for polling. Accordingly the load of the printing apparatus can be reduced. Further complicated setting necessary in setting polling devices will be unnecessary.

Next processing by the printing apparatus for downloading print data from the web application server after authentication is completed according to a second exemplary embodiment of the present invention will be described with reference to the flowcharts in . In the following description only the configurations different from those of the first exemplary embodiment will be described.

Data of the print job table with web authentication managed by the print job table management unit according to the present embodiment will be described with reference to . The printing apparatus ID and the print data URI are similar to those described in the first exemplary embodiment. The row of data indicates that a print job having ABC as the web user ID and xxxxxxx as the web user password is registered in the print job table with web authentication. The row of data indicates that a print job having XYZ as the web user ID and xxxxxxx as the web user password is registered in the print job table with web authentication. The row of data indicates that a print job having XYZ as the web user ID and xxxxxxx as the web user password is registered in the print job table with web authentication. The above described information can be registered in the print job table with web authentication according to the processing flow described below.

Since the processes in steps S to S and steps S to S in are similar to those of the first exemplary embodiment their descriptions are not repeated.

In step S the web service requester unit of the web application server calls the authentication unit and acquires a web user ID and a web user password. Then the web service requester unit transmits a print request with web authentication to the web service provider unit of the print intermediary server . The print request with web authentication includes a printing apparatus ID a print data URI a web user ID and a web user password. The communication of the print request with web authentication is performed for example by SOAP.

In step S the web service provider unit of the print intermediary server receives the print request with web authentication from the web service requester unit of the web application server . In step S the web service requester unit of the print intermediary server calls the print job table management unit . The print job table management unit stores the information of the print request with web authentication in the print job table with web authentication.

Since the processes in steps S to S steps S to S and steps S to S in are similar to those of the first exemplary embodiment their descriptions are not repeated.

In step S the print job response generation unit of the print intermediary server calls the print job table management unit . The print job table management unit acquires information of the print job from the print job table with web authentication and sends the information to the print job response generation unit . Then the print job response generation unit generates a print job response with web authentication. The print job response includes a print data URI a web user ID and a web user password.

In step S the web client of the printing apparatus reads the print data URI the web user ID and the web user password from the print job. Next the web client transmits a request for downloading the print data from the print data URI using the web user ID and the web user password.

As described above if the download processing is performed according to the flowcharts in authentication with respect to the downloading of the print data by the printing apparatus can be performed using the web application server . Thus only the printing apparatus that has received the printing instruction from the web application server can download the print data.

Next processing by the printing apparatus for acquiring a print job from the print intermediary server and performing printing if the user that has transmitted the print job is the user of the printing apparatus will be described according to a third exemplary embodiment of the present invention. The present embodiment will be described with reference to the flowcharts in and also . In the following description only the configurations different from those of the first exemplary embodiment will be described.

First data of the print job table with printing apparatus authentication managed by the print job table management unit according to the present embodiment will be described with reference to . The printing apparatus ID and the print data URI are similar to those described in the first exemplary embodiment. The row of data indicates that a print job having AAA as the printing apparatus user ID and xxxxxxx as the printing apparatus user password is registered in the print job table with printing apparatus authentication.

The row of data indicates that a print job having BBB as the printing apparatus user ID and xxxxxxx as the printing apparatus user password is registered in the print job table with printing apparatus authentication. The row of data indicates that a print job having CCC as the printing apparatus user ID and xxxxxxx as the printing apparatus user password is registered in the print job table with printing apparatus authentication. The above described information can be registered in the print job table with printing apparatus authentication according to the processing flow illustrated in .

Since the processes performed in steps S to S in are similar to those performed in steps S to S in their descriptions are not repeated.

In step S the web server unit of the web application server displays a printing apparatus authentication information input screen illustrated in in the browser of the host computer and waits for the user to enter information. The printing apparatus authentication information includes a printing apparatus user ID and a printing apparatus user password managed by the authentication manager of the printing apparatus . When the user enters the printing apparatus user ID and the printing apparatus user password and further selects the OK button the processing proceeds to step S.

In step S the web service requester unit of the web application server transmits a print request with printing apparatus authentication to the web service provider unit of the print intermediary server . The print request with printing apparatus authentication includes a printing apparatus ID a print data URI a printing apparatus user ID and a printing apparatus password. The communication of the print request with printing apparatus authentication is performed for example by SOAP.

In step S the web service provider unit of the print intermediary server receives the print request sent from the web service requester unit of the web application server . In step S the web service provider unit of the print intermediary server calls the print job table management unit . The print job table management unit stores information of the print request with printing apparatus authentication in the print job table with printing apparatus authentication.

In step S the print intermediary server transmits a print request storage notification to the web application server . In step S the web application server receives the print request storage notification from the print intermediary server .

Next the processing flow illustrated in will be described. Since the processes performed in steps S to S in are similar to those performed in steps S to S in their descriptions are not repeated.

Further since the processes performed in steps S to S and steps S to S are similar to those performed in steps S to S and steps S to S in their descriptions are not repeated.

In step S the print job response generation unit of the print intermediary server generates a print job response with printing apparatus authentication. The print job response with printing apparatus authentication includes a print data URI a printing apparatus user ID and a printing apparatus user password. In step S the print intermediary server generates a blank response. The blank response does not include a print data URI.

In step S the print intermediary server transmits the print job response generated in step S or S in response to the print job request transmitted from the printing apparatus . The communication of the print job response is performed for example by SOAP. In step S the web client of the printing apparatus receives the print job response transmitted from the web service provider unit of the print intermediary server .

In step S the printing apparatus determines whether a print data URI is included in the print job response. Whether a print data URI is included in the response is determined for example by acquiring information in the XML of the SOAP communication. If a print data URI is included in the print job response YES in step S then the processing proceeds to step S. If the print data URI is not included NO in step S then the processing proceeds to step S.

In step S the web client of the printing apparatus reads the printing apparatus user ID and the printing apparatus user password from the print job response. Next the web client calls the authentication manager and performs the authentication. The authentication manager determines whether a combination of the printing apparatus user ID and the printing apparatus user password exists and returns the result to the web client . If a combination of the printing apparatus user ID and the printing apparatus user password exists YES in step S then the processing proceeds to step S. If such a combination does not exist NO in step S then the processing proceeds to step S.

In step S the web client of the printing apparatus reads the print data URI from the print job and then requests the web server unit of the web application server to download the print data from the print data URI. In step S the web client of the printing apparatus downloads the print data from the print data URI with respect to the web server unit of the web application server . The request for downloading the print data is performed according to for example an HTTP protocol Get request with respect to the print data URI.

In step S the print manager of the printing apparatus prints the downloaded document using for example PDF direct print. As illustrated in the PDF direct print is a function which allows direct printing of a PDF document without using a printer driver. The printing apparatus is not necessarily capable of PDF direct print and after the control API of the printing apparatus converts the document into a print format which can be printed by the PDL manager the document can be printed using the RIP .

As described above if processing is performed according to the flowcharts in authentication that allows printing of the printing apparatus can be acquired. Thus only the printing according to the printing instruction given by a user managed by the authentication manager is executed.

Next processing by the print intermediary server for transmitting a redirect response concerning print data URI to the printing apparatus as a print job response will be described with reference to the flowchart in according to a fourth exemplary embodiment of the present invention. In the present embodiment redirect means HTTP redirect.

The HTTP redirect is a function used for notifying the web client to acquire a resource from a URI different from the designated URI if the web client requests a resource from the web service provider unit . The web client interprets the notification of the redirect transmitted from the web service provider unit and the request is redirected to the target URI. In the following description only the configurations different from those of the first exemplary embodiment will be described.

Since the processes performed in steps S to S in are similar to those performed in steps S to S in their descriptions are not repeated.

In step S the redirect response generation unit of the print intermediary server generates a redirect response. A print data URI stored in the data management unit of the web application server is designated as the redirect URI.

On the other hand in step S the print intermediary server generates a blank response. The blank response does not include the print data URI. In step S the print intermediary server transmits the print job response generated in step S or S in response to the print job request transmitted from the printing apparatus . The HTTP for example is used for the communication of the print job response.

In step S the web client of the printing apparatus receives the print job response transmitted from the web service provider unit of the print intermediary server . In step S the web client of the printing apparatus determines whether the print job response is a redirect response according to the response given by the print intermediary server . If the response is a redirect response YES in step S the processing proceeds to step S. If the response is a blank response NO in step S the processing proceeds to step S.

The determination in step S is performed by the web client based on the HTTP redirect response given by the print intermediary server . Since the processes performed in steps S to S are similar to those performed in steps S to S in their descriptions are not repeated.

As described above if the processing is performed according to the flowchart in the printing apparatus can download print data according to a redirect response given by the print intermediary server . Thus the printing apparatus can automatically execute the download processing of print data.

Next a case where a redirect response including redirect of a URI to a URI generated by the print intermediary server is given by the print intermediary server to the printing apparatus as a print job response according to a fifth exemplary embodiment of the present invention will be described with reference to the flowchart illustrated in . By adding a web user ID and a web user password regarding the web application server to a print data URI the print intermediary server can generate a redirect URI. In the following description only the configurations different from those of the first exemplary embodiment will be described. Since the registration process of a print job with web authentication in the print job table with web authentication of the print intermediary server is similar to the process described in the second exemplary embodiment 2 the description is not repeated.

Since the processes performed in steps S to S S to S and S to S in are similar to those performed in steps S to S S to S and S to S in their descriptions are not repeated.

In step S the redirect response generation unit of the print intermediary server calls the logical URI generation unit . The logical URI generation unit calls the print job table management unit . The print job table management unit acquires information of the print job from the print job table with web authentication and sends the acquired information to the logical URI generation unit . The logical URI generation unit generates a logical URI by adding a web user ID and a web user password to the print data URI. The logical URI for the row of data in will be generated as for example http test print document1.pdf ABC xxxxxxxx . The logical URI generation unit sends the generated logical URI to the redirect response generation unit . Then the redirect response generation unit generates a redirect response for a logical URI.

In step S the web client of the printing apparatus determines whether the print job response given by the print intermediary server is a redirect response. If the print job response is a redirect response YES in step S the processing proceeds to step S. If the print job response is a blank response NO in step S then the processing proceeds to step S. The processing in step S is determined by the web client according to the HTTP redirect response given by the print intermediary server .

In step S the web client of the printing apparatus requests downloading of the print data from the logical URI. The web application server acquires the web user ID and the web user password from the logical URI. The user ID and the web user password are authenticated by the authentication unit .

In step S the web client of the printing apparatus downloads the print data from the print data URI with respect to the web server unit of the web application server . The download request of the print data is for example a Get request of the HTTP protocol with respect to the print data URI.

As described above if processing is performed according to the flowchart in the printing apparatus can download print data according to the redirect response from the print intermediary server . Further the web application server can provide authentication when print data is downloaded from the printing apparatus . Thus only the printing apparatus that has received a printing instruction from the web application server can download the print data.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiment s and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiment s . For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device e.g. computer readable medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications equivalent structures and functions.

This application claims priority from Japanese Patent Application No. 2009 240867 filed Oct. 19 2009 which is hereby incorporated by reference herein in its entirety.

