---

title: System and method for managing postal accounting data using transient data collectors
abstract: Methods and systems using a single centralized database to manage postal accounting data are provided. The central database may interface with remote postal meters by way of one or more transient data collectors, which cache data from associated meters and transmit the data to the central database. The data collectors also validate postage accounts to the associated meters. The use of local transient data collectors allows for a single centralized database to be used without requiring data replication among databases local to each computer that manages postal meters.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09183590&OS=09183590&RS=09183590
owner: Neopost Technologies
number: 09183590
owner_city: Bagneux
owner_country: FR
publication_date: 20100720
---
Mail metering systems often use one or more postage meters connected to a computer system such as a personal computer. Most generally the meters frank mail pieces provided by a user by applying an indicia representing postage funds stored in a postal security device. In some systems the postal security device may be implemented in or incorporate a local general or special purpose computer. During operation of the meter data is transferred between the meter and the computer. The data typically includes account information such as the various financial accounts or department labels into which postage amounts are allocated as they are used by the meter and transaction amounts such as the amount of postage applied in each transaction. Account administration such as the specific assignment of transactions into accounts may be performed at the attached computer or directly at the meter.

For the cases where account assignment occurs at the meter it is important that the meter is provided access only to validated postage accounts. To accomplish this the computer validates one or more accounts that the user is allowed to choose at the meter and provides only validated account information to the meter. In a configuration where multiple computers are used each computer typically maintains a separate local database of account information. Each local database may be synchronized with and or data replicated from other local databases or a remote database such as a central database that is managed by the owner or provider of the meters or another central database. For example multiple databases at each computer may be connected to an intranet which allows one or more remote administrator computers to access consolidate and report upon the data that exists in the remote database or each of the individual local databases. The central database at an administrator computer also may communicate and or synchronize with a remote data center. A system that uses multiple computers each having a local database that stores account information for one or more postal meters may be referred to as a distributed environment.

Methods and systems using a single centralized database to manage postal accounting data are provided. The central database may interface with remote postal meters by way of one or more transient data collectors which cache data from associated meters and transmit the data to the central database. The data collectors also validate postage accounts to the associated meters. The use of local transient data collectors allows for a single centralized database to be used without requiring data replication among databases local to each computer that manages postal meters.

In an embodiment a system for managing postal account data may include a single postal account database storing authoritative account data for a plurality of postal accounts the authoritative account data defining an available postage budget for each of the postal accounts an application server in communication with the single postal account database and a plurality of remote computer systems in communication with the application server where each remote computer system may include a plurality of postal meters a processor in communication with the plurality of postal meters and a transient data collector to cache transaction data generated by the plurality of postal meters temporarily where the transient data collector is configured to receive a list of one or more valid postal accounts from the application server to validate each postal meter for use with at least one valid postal account received from the application server and to provide the transaction data received from the postal meter to the application server and where the application server is configured to receive cached transaction data from the transient data collector and to update the single postal account database based upon the received transaction data.

In an embodiment a method for managing postal account data may include executing a transient data collector on a local computer in communication with a postal meter retrieving by the transient data collector a list of one or more valid accounts and associated postage budgets from a remote application server the remote application server storing authoritative account data for a plurality of postal accounts receiving by the transient data collector a plurality of franking transactions performed by the postal meter caching the plurality of franking transactions at the transient data collector sending the plurality of franking transactions to the remote application server removing the cached plurality of franking transactions from the transient data collector s cache subsequent to sending the plurality of franking transactions to the remote application server and receiving by the transient data collector an updated postage budget for each valid account associated with one of the plurality of franking transactions sent to the remote application server the updated postage budget reflecting a change due to at least one of the plurality of franking transactions. The step of sending the plurality of franking transactions to the remote application server may include sending a first batch of franking transactions to the remote application server via a first transaction thread and the method may further include in response to completion of processing a second batch of franking transactions while the first transaction thread is active initiating a second transaction thread and sending the second batch of franking transactions to the remote application server via the second transaction thread. The steps of sending the first batch of franking transactions and sending the second batch of franking transactions may be performed concurrently. The first transaction thread may correspond to a first postal meter of the plurality of postal meters and the second transaction thread may correspond to a second postal meter of the plurality of postal meters. In some embodiments the method may further include receiving a request to verify that a postage account is valid from the postal meter and providing from the transient data collector to the postal meter an indication that the postage account is valid. In some embodiments the indication that the postage account is valid is provided to the postal meter within about 10 ms and or not more than about 30 ms of receiving the request.

In an embodiment a method of communicating between a postal meter and a remote application server may include removing stored data from a transient data collector cache the cache being stored in a computer readable medium in a computer system in communication with a postal meter and a remote application server validating an account in use at the postal meter with the remote application server requesting a current postage balance for the account from the application server receiving a budget amount for the account from the application server opening a persistent connection to the application server from the transient data collector receiving transaction data at the transient data collector from the postal meter and providing the transaction data to the application server from the transient data collector. The method may further include receiving a response indicating that the account is valid from the remote application server within about 10 ms of requesting confirmation that the account is valid and or receiving a response indicating that the account is valid from the remote application server within not more than about 30 ms of requesting confirmation that the account is valid. The remote application server may store authoritative postage balance information for the account. A confirmation may be received from the remote application server that a current postage balance for the account is successfully updated based upon the transaction data provided to the remote application server. The confirmation may be received over the persistent connection.

It has been found that collection of postage meter transaction data via accounting software running on local computers often requires significant undesirable data transfer overhead. For example in some distributed environment configurations the local databases may be synchronized and replicated in real time over an intranet resulting in significant processing and communication overhead. Further data authority in postal accounting systems is critical and distributed environment configurations may result in a loss of data integrity if an intranet fails or experiences significant latency while meters are processing postage transactions the data stored on each local database may become desynchronized. This and other similar issues inherent in distributed systems may lead to potentially significant accounting errors.

An example system using a distributed environment to manage postage transactions shown in . One or more local computers may be in communication with and manage one or more postage meters . Each local computer may have a local database respectively that stores account information for the meters managed by the computer. The computers and meters may be connected via a local network such as an intranet. An administration computer may aggregate account information from the local computers . The administration computer also may send and receive aggregate account information over a large area network such as the Internet to for example a remote data center .

In embodiments of the present invention the local database s may be replaced by a single centralized database such as at a remote data center thereby reducing the overhead and configuration required at each local computer. Prior to the present invention distributed environments were not suitable for such centralization due to the need for immediate access by the meter to current and validated account information. For example merely replacing multiple local databases in a distributed environment with a single central database would not provide sufficiently immediate data due to the lag and latency inherent in any distributed network communications. This effect would be especially pronounced if the centralized database was located at a remote data center as is attainable using embodiments of the present invention.

As a specific example latencies over the Internet typically are on the order of 30 100 ms or more. When processing mail through a meter only a few milliseconds are typically available for the franking process so the meter needs relatively immediate access to data that indicates whether a particular account designated for use with a franking transaction is valid. Other features also may be particularly sensitive to latency such as budget monitoring and weight validation relative to maximum weights allowed for mail classes and or accounting categories. It is believed that if meters in a distributed configuration were required to communicate directly with a remote data center to synchronize separate local databases the resulting latency would render the system unusable.

In embodiments of the invention a transient data collector is used at each local computer to communicate with the meters managed by the local computer and convey data to and from a centralized database that may be located at a remote data center. For example the transient data collector may communicate with an application server at the data center via an exposed API.

The transient data collector may be implemented as a small software or hardware module or a combination of hardware and software at the local computer. A transient data collector may include relatively little internal logic. For example the transient data collector may merely cache data received from one or more meters and provide the cached data to a central data center. Similarly the transient data collector may receive account information from the remote data center and provide it to local meters with little or no latency at a speed sufficient to allow the meters to accurately and timely perform franking transactions.

In operation transient data collectors may cache postal or transaction data generated by postal meters and respectively managed by the computers at which the transient data collectors are installed. For example transient data collectors may provide transaction data to the API via a network such as an intranet or the Internet. In an embodiment when franking transactions are performed at a meter the transactions are allocated into validated accounts as indicated at the meter and transferred from the meter to a transient data collector. For each transaction the transaction data may be transferred in a separate thread between the collector and the application server. Depending upon the meter s processing speed the number of mailing machines in operation between the corresponding PC and the collector and network transmission latency time multiple transaction threads may be opened between the collector and the application server as needed.

The postal data cached at the transient data collectors preferably is stored only temporarily and typically is quickly transferred to the application server so that the single database may be kept up to date. For example the transient data collectors may typically store the data for not more than 100 ms before the data has been transferred to the application server . Typically the data is then deleted from the transient data collector and or overwritten with new data received from one or more meters .

Upon receiving cached postal data such as transaction data from a transient data collector the application server may update the database . For example account data in the database may be updated to reflect postage used by the meters . The account data stored in the database may be referred to as authoritative because it represents the true accurate postage account balance or budget for the accounts stored in the database when it is up to date i.e. when there are no outstanding franking transactions that have not been reconciled with the database . In contrast transient data collectors may store temporary or transient account data that is subject to change as meters in communication with the transient data collectors perform franking transactions.

A transient data collector also may provide information about valid accounts to an associated meter . In an embodiment an application server may provide account data such as a list of valid postal accounts from which the associated meters may draw postage funds to a transient data collector for use by one or more associated meters . The account data may be provided via an API . Each collector may cache this information for the purpose of quickly answering requests from individual meters to validate accounts and check remaining budget amounts. For example prior to or during a franking transaction a meter may request validation of an account that is indicated for use in applying postage to a mail piece. The transient data collector may validate or refuse an account for use based upon account data received from the application server . The validation may be provided relatively quickly typically within less than about 30 ms of when validation is requested by the meter and preferably not more than about 10 ms. This response time is much lower than would be expected from a configuration in which a meter is configured to communicate directly with the central database to verify account data for each account.

In an embodiment local storage may provide recovery in the event of a network service interruption such as a disruption to the network . For example the transactions may be stored in a first in first out spool such as a disk queue at the local computer . Further each stored transaction conducted by a meter may be unique and may be identified by data such as a meter serial number a time date stamp a customer identification a unique identifier generated from a combination of one or more of these items or another unique identifier. The unique identifiers can be used to prevent duplication of transaction processing in the event of a service interruption. For example during a restoration process the system may track unique identifiers of transactions that have been restored to the system and if a duplicate is identified the second occurrence may not be processed. Such a unique identifier may be referred to as a unique reliability identifier herein because these transactions may therefore be trusted by and integrated into the database upon restoration of network services. Accordingly during normal operation of the network transient data stored by a data collector may be routinely deleted or overwritten by new transaction data during operation of a meter in communication with the collector . Furthermore in response to a network service interruption that prevents real time account validation a meter may include an offline mode to collect transactions in an unspecified account that may be subsequently reconciled after restoration of network service. In some embodiments operation of a meter may be blocked in response to a network service interruption that prevents the ability to validate accounts.

In an embodiment a transient data collector may use a long polling technique when communicating with an application server. To do so the collector may open a single persistent connection to the application server . That is the connection is not closed between sequential transmissions to or from the collector but rather is maintained in an open or active state. The persistent connection may be used to transfer the valid account data to the data collector and the transaction data to the application server as previously described. Additional connections also referred to as transaction threads which may or may not also be persistent may be opened if additional transaction data becomes available while the collector is transmitting or receiving data using the initial persistent connection or previously initiated presently active transaction threads.

In an embodiment the data collector may receive from the application server and or provide to a meter a list of valid accounts for the meter . The meter or a user at the meter may then be presented with a list of valid accounts from which to choose for each franking transaction or series of franking transactions.

In an embodiment the administrator computer may access the database via a web server . Thus the administrator computer need not be on the same intranet or other network as the meters and associated computers and data collectors though in some embodiments the administrator computer may access or be on an intranet or other network with the meters . The central database thus may be accessed manipulated and or reported upon by any Internet connected computer via the web server .

The data collector may then communicate with the application server at for example via an HTTP GET request to log in with the collector s credentials such as a username password and or unique identifier at . The application server may return a relative ID or a failure message to the collector at . The collector may send a request at for current accounts for its location or enterprise identifier or username. However accounts also could be identified to the specific computer meter or collector in which case the collector may send a unique machine number or other appropriate identifier. At the application server may send a list of account data such as account name identifier number active status etc. At the collector may send a request for a budget for each valid account used by an associated meter . The application server may return for example a time range over which the budgets are valid budget amounts or an indication that the budget is unlimited if the account is configured for tracking over a time period or other information. The collector may then open a long poll connection or other connection at as previously described to receive account changes or activity from the administrator computer via the application server as well as to provide account changes or activity to the central database .

Notably transient data collectors according to embodiments of the invention need not store state information from associated meters . Rather the transient data collector merely caches and or passes information to the central database that is a single consolidation and collection point. Other configurations such as where data is consolidated and synchronized upon a poll request from a central server generally would lead to undesirable excessive communication overhead and a need for additional device configuration.

In an embodiment the system may include specialized techniques to implement conventional postal accounting functionality such as account addition modification deletion etc. For example the application server may send a message with new account information to the transient data collector . The collector may then save new account information in a cache or other storage mechanism. Similar operations may be performed to remove an account change a user name or other access data update a budget period or amount etc.

At the application server may return account data such as account names identifications and statuses to the collector . The collector may request a budget for each relevant account at and receive budget information from the application server at . The budget information may include for example the amount and time range over which the account name or identification is valid.

At the collector may initiate a long poll i.e. a persistent connection with the application server to allow for exchange of account data. The application server also may provide budget changes updated account information or other data at using the same persistent connection. At the collector may again provide data to the application server over the persistent connection using a request similar to the request used at .

An embodiment of the invention may be embodied in the form of computer implemented processes and apparatuses for practicing those processes. Embodiments also may be embodied in the form of a computer program product having computer program code containing instructions embodied in tangible media such as floppy diskettes CD ROMs hard drives USB universal serial bus drives or any other machine readable storage medium wherein when the computer program code is loaded into and executed by a computer the computer becomes an apparatus for practicing the invention. Embodiments of the invention also may be embodied in the form of computer program code for example whether stored in a storage medium loaded into and or executed by a computer or transmitted over some transmission medium such as over electrical wiring or cabling through fiber optics or via electromagnetic radiation wherein when the computer program code is loaded into and executed by a computer the computer becomes an apparatus for practicing the invention. When implemented on a general purpose microprocessor the computer program code segments configure the microprocessor to create specific logic circuits. In some configurations a set of computer readable instructions stored on a computer readable storage medium may be implemented by a general purpose processor which may transform the general purpose processor or a device containing the general purpose processor into a special purpose device configured to implement or carry out the instructions.

Examples provided herein are merely illustrative and are not meant to be an exhaustive list of all possible embodiments applications or modifications of the invention. Thus various modifications and variations of the described methods and systems of the invention will be apparent to those skilled in the art without departing from the scope and spirit of the invention. Although the invention has been described in connection with specific embodiments it should be understood that the invention as claimed should not be unduly limited to such specific embodiments. Indeed various modifications of the described modes for carrying out the invention which are obvious to those skilled in the relevant arts or fields are intended to be within the scope of the appended claims.

The disclosures of all references and publications cited above are expressly incorporated by reference in their entireties to the same extent as if each were incorporated by reference individually.

