---

title: Low overhead circuit and method for predicting timing errors
abstract: A data processing circuitry includes a data input, a data output and a processing path arranged between the data input and the data output. The circuitry includes a plurality of retention circuits arranged in parallel with the processing path. At least one potential error detecting circuit including a potential error detecting path for transmitting the data signal pending at an input of one of a plurality of synchronization circuits to one of the retention circuits where the potential error detecting path includes delay circuitry for delaying the data. Also included is comparison circuitry for comparing a value of the data signal captured by one of the synchronization circuits with a value of the data signal captured by a corresponding one of the retention circuits. A comparison circuitry is configured to signal a potential error in response to detecting a difference in the captured data values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08407540&OS=08407540&RS=08407540
owner: ARM Limited
number: 08407540
owner_city: Cambridge
owner_country: GP
publication_date: 20100615
---
This application claims priority to U.S. Provisional Application No. 61 223 121 filed Jul. 6 2009 the entire contents of which are hereby incorporated by reference.

The field of the invention relates to a circuit and method for predicting where timing errors may occur.

With the progressive scaling down of semiconductor such as CMOS device sizes these devices are now nearing their physical and reliability limits. This has resulted in designs that were manufactured correctly wearing out and becoming unreliable over time due to mechanisms such as negative bias temperature instability or NBT1 and gate oxide breakdown.

The aging effects on these devices can cause a design that functions correctly initially to develop timing errors over time.

This problem has been addressed in some designs by increasing margins in the design based on the worst degradation that it is predicted devices might suffer during the lifetime of the device. However this approach leads to a decrease in the performance of the design and therefore is not appropriate for high performance devices.

This problem has been addressed in a Razor design described by Ernst et al. in Razor a low power pipeline based on circuit level timing speculation by sampling the data with a delayed clock and where errors are detected implementing a recovery phase to correct them. A drawback of this approach is that it only detects errors after they have taken place and it then requires a recovery phase and thus there are significant performance overheads once an error has occurred.

A further way of addressing the problem is described in Agarwal et al. in Circuit failure prediction and its application to transistor aging . In this technique a flip flop design is used which can predict the timing errors before they happen. An inverted delayed clock is used to sample the data and generate an error signal if a transition is detected in a window before the transition happens. A drawback in this technique is the significant cost in area in implementing the delayed clock and stability checker.

It would be desirable to be able to detect timing errors in a system before they happen without unduly increasing the area of the design.

A first aspect of the present invention provides a data processing circuitry for processing data said data processing circuitry comprising a data input a data output and at least one processing path arranged between said data input and said data output said at least one processing path comprising a plurality of synchronisation circuits for capturing and transmitting said data in response to a clock signal and a plurality of combinational circuits arranged between said synchronisation circuits for processing said data said data processing circuitry further comprising a plurality of retention circuits for storing data in a low power mode said plurality of retention circuits being arranged in parallel with said at least one processing path and at least one potential error detecting circuit for determining during processing of said data if said data signal pending at an input to one of said plurality of synchronisation circuits is stable during a predetermined time prior to capture of said data and for signalling a potential error if said data input is determined to be unstable during said predetermined time said at least one potential error detecting circuit comprising a potential error detecting path for transmitting said data signal pending at said input of said one of said plurality of synchronisation circuits to one of said retention circuits said potential error detecting path comprising delay circuitry for delaying said data signal such that said data signal arrives at said retention circuit said predetermined time after it arrives at said synchronisation circuit comparison circuitry for comparing a value of said data signal captured by said one of said synchronisation circuits with a value of said data signal captured by a corresponding one of said retention circuits said comparison circuitry being configured to signal a potential error in response to detecting a difference in said captured data values.

The present invention recognises that in many low power circuits there are retention circuits arranged in various places throughout the circuit for retaining data values when the circuit switches to low power mode. This enables the circuit to be partially powered down when it is not active without losing data. It also recognises that although these retention circuits are required in low power mode during normal operational mode they are not active. The present invention uses these available but non active retention circuits to store a delayed version of the data signal during operational mode and then compares this delayed version of the signal with the non delayed version of the signal to determine if the signal has transitioned during the delay time period. When this delay time period is immediately prior to capture of the data signal by a synchronisation element then the signal transitioning in this time window indicates that the circuitry is close to failing as if it transitioned slightly later it would not be captured. If the circuitry contains devices that deteriorate with age such a transition detection might imply that the circuitry will fail soon unless some action such as increasing the operational voltage or decreasing the operational clocking frequency is implemented.

By reusing the retention circuits in this way a potential timing error can be detected just by the addition of delay and comparison circuitry. Thus errors can be predicted and measures taken to avoid them actually occurring without large circuit overheads.

In some embodiments said data processing circuitry further comprises a control signal input for receiving a low power mode enable signal said plurality of retention circuits each being configured in response to said low power enable signal being asserted to capture a data value currently captured by a corresponding one of said synchronisation circuits and to retain said data value during said low power mode.

Although the retention circuit can have a number of forms in some embodiments they are arranged to capture a data value captured by a corresponding synchronisation circuit in response to a low power enable signal.

In some embodiments said data processing circuitry further comprises a plurality of switching circuits arranged between said plurality of retention circuits and a corresponding plurality of synchronisation circuits said plurality of switching circuits being responsive to said low power mode enable signal being asserted to connect said retention circuits to said corresponding synchronisation circuits and being responsive to said low power mode enable signal not being asserted to isolate said retention circuits from said corresponding synchronisation circuits.

The retention circuits may be connected to the synchronisation circuit via switching circuits that are responsive to the low power mode enable signal to either connect the retention circuit to the synchronisation circuits so that the value stored in the synchronisation circuit can be stored in the retention circuit or to isolate them from them so that the retention circuits do not receive values from the synchronisation circuits. This arrangement means that during normal operational mode the retention circuits do not usually receive the values stored in the synchronisation circuits and thus can be used for other purposes.

In some embodiments said data processing circuitry further comprises a control signal input for receiving a timing error detection mode enable signal said timing error detection mode enable signal being asserted indicating a mode of operation is to be entered in which potential timing errors are detected switching circuitry arranged on said potential error detecting path said switching circuitry being responsive to said timing error detection mode enable signal being asserted to connect said retention circuit to said input of said synchronisation circuit and being responsive to said timing error detection mode enable signal not being asserted to isolate said retention circuit from said input of said synchronisation circuit.

Where the retention circuits are also used for timing error detection then switching circuitry can be arranged on the potential error detecting path to connect the retention circuit to the input of the synchronisation circuit in the error detection mode and to isolate them from this path when they are not in this mode. In this way the retention circuits can be connected to the synchronisation circuits in low power mode to store the values that they hold and be connected to their inputs in error detection mode to receive the input signal via delaying circuitry. Thus the retention circuit can have a dual use depending on the mode of operation of the processing circuitry and the area efficiency of the design is increased.

In some embodiments said plurality of synchronisation circuits comprise latches responsive to one phase of said clock cycle to receive and transmit input data and to an opposite phase of said clock cycle to capture said input data and output said captured data neighbouring latches being responsive to opposite clock phases to receive and transmit said data.

Although the synchronisation circuits can have a number of forms in some embodiments they comprise latches. Embodiments of the present invention are appropriate to latch based designs and can be used to detect timing errors using the retention circuitry that is present for the low power mode of operation.

In some embodiments said plurality of synchronisation circuits comprise latches arranged as master slave flip flops such that received data is output in response to one of said edges of said clock signal said retention circuit being configured to receive data captured by said slave latch in response to said low power mode enable signal being asserted and being configured to capture a data signal at an input to said master latch delayed by said delay circuitry in response to said low power enable signal not being asserted.

In other embodiments at least some of said plurality of synchronisation circuits comprise retention flip flops said retention flip flops each comprising one of said plurality of retention circuits.

Master slave flip flops may have the form of retention flip flops wherein there is a retention latch within the flip flop that is configured to retain the value stored in the flip flop in response to a low power mode enable signal. If this is the form of the synchronisation circuits then in embodiments of the present invention the retention latches within the flip flop may be used to retain the delayed signal during operational mode in order to detect potential timing errors. It may be that not all of the master slave flip flops have this capability as it may be known that potential timing errors are only likely to occur at particular points on critical paths in the circuit. Thus it may be that only some of the flip flops have the additional delaying and comparing circuitry added to them to detect potential errors.

It should be noted that in some designs all the synchronisation circuits within the circuitry are retention flip flops as it may be simpler to design a system using the same kind of synchronisation circuits throughout. In such a case in some embodiments all of them may be used to detect potential timing errors while in others only some of them may be so designed.

In other embodiments some of the synchronisation circuits are retention flip flops while others are not. Some designs might recognise that in low power mode only some of the values stored in the synchronisation circuits need to be retained and thus only these synchronisation circuits are implemented as retention flip flops. Retention flip flops have a larger area than master slave flip flops without the retention latch thus reducing their number saves on area. Once again only some of these retention flip flops may be used to detect potential timing errors.

In some embodiments said comparison circuitry is gated by said error detection mode enable signal and said clock such that in response to at least one of said error detection mode enable signal not being asserted and said clock not having a value that triggers capture of said data no potential error signal is output.

In order to control output of the predicted error signal the comparison circuitry may be gated by the error detection mode enable signal so that a predicted error signal is only output during potential error detection mode and by the clock. Values stored in a synchronisation circuit and the retention circuit change at different times as one of them is the delayed value. The important thing is that the value is the same at the point in the clock cycle that the synchronisation element captures the data value. Thus the output of the comparison circuitry can also be gated by this clock signal so that only when it has the value that triggers capture of the data in the synchronisation circuit is a signal output from the potential error detection circuit. This inhibits any glitches in the signal generating a false error signal.

In some embodiments said data processing circuitry further comprises control circuitry responsive to at least one of said potential error detecting circuits signalling a potential error to raise an operating voltage of at least a portion of said data processing circuitry.

When a potential error has been detected this signals that the processing circuitry is operating close to a failure limit and if the devices are deteriorating with time then it may soon fail. Thus in some embodiments the data processing circuitry has control circuitry that is responsive to this signal to raise an operating voltage of the data processing circuitry and thereby increase the performance of the circuitry and help to prevent an error. In many embodiments the voltage of the whole data processing circuitry is increased in response to a detected potential error. In other embodiments it may be only the portion of the data processing circuitry where the potential error is detected that has its voltage level increased. Although in the latter case the power consumption of the circuitry is improved it may be that providing different voltage levels in this way is overly complicated and the power savings do not merit the increase in complexity of the circuit.

In some embodiments said control circuitry comprises circuitry for combining an output from a plurality of said potential error detecting circuits and is configured to generate a global error signal in response to any of said plurality of potential error detecting circuits detecting an error said control circuitry being responsive to said global error signal to raise said operating voltage.

There may be many potential error detecting circuits arranged throughout the data processing circuitry all generating particular output signals. It may therefore be convenient to combine at least some of them to generate a global error signal that is used as in input to the control circuitry.

In other embodiments said data processing circuitry further comprises control circuitry responsive to at least one of said potential error detecting circuitry signalling a potential error to lower a clocking frequency of at least a portion of said data processing circuitry.

In some embodiments the control circuitry may lower the clocking frequency of the data processing circuitry rather than increasing the operating voltage. It should be noted that raising the operational voltage will increase the performance of the devices and therefore make devices operate faster and within the desired clocking limits. Alternatively if it is not desirable to increase the operating voltage the clocking frequency can be decreased so that devices that were only just operating within the set limits can now operate more easily within them.

In some embodiments said data processing circuitry comprises a plurality of potential error detecting circuits said plurality of potential error detecting circuits being configured to detect a stability of said data signal at an input to a plurality of synchronisation circuits arranged on critical timing paths within said data processing circuitry.

A plurality of potential error detecting circuits may be arranged to detect the stability of the data signal at an input to synchronisation circuits arranged on critical timing paths within the data processing circuitry. Timing errors will generally happen on the critical timing paths and thus if the critical timing paths are known it is advantageous to provide potential error detecting circuits at these places as it is here that the processing circuitry will fail first.

In some embodiments each of said plurality of potential error detecting circuits comprise delay circuitry configured to delay said data signal by a predetermined time said predetermined time being selected for each of said plurality of potential error detecting circuits in dependence upon robustness and performance criteria and upon how close said critical timing path being monitored by said potential error detecting circuit is to a set up time.

The delay circuitry provides the predetermined time by which the data signal is delayed and thus determines how close to the system failing errors are detected at. Thus if a large time window is used then instabilities occurring at quite some time from the capture point are detected and if the parameters of the system are adjusted to take any instabilities out of these timing windows then the system will be very robust to any errors occurring. If however the time window is smaller then the performance of the system will be increased as the clock will not be slowed or the voltage raised until the system is nearer to failing and thus the system will have a better performance.

Another point that can determine the desired delay of the delay circuitry is the critical path that is being detected. If the critical path is one where the timing along it is close to the design set up time then the error window should be larger than for critical paths that are not close to the design set up time. This is because the critical paths close to the design set up time are those where failure will probably occur first and thus it is very important to detect any late transitions occurring on these paths.

A second aspect of the present invention provides a synchronisation circuit comprising a data input a data output and at least one latch located on a processing path between said data input and said data output for capturing a data value input at said data input prior to output at said data output said synchronisation circuit further comprising a retention latch arranged in parallel with said processing path and coupled to said at least one latch for storing a data value captured by said at least one latch in a low power mode and at least one potential error detecting circuit for determining during processing of said data if said data signal pending at an input to said at least one latch is stable during a predetermined time prior to capture of said data and for signalling a potential error if said data input is determined to be unstable during said predetermined time said at least one potential error detecting circuit comprising a potential error detecting path for transmitting said data signal pending at said input of said at least one latch to said retention latch said potential error detecting path comprising delay circuitry for delaying said data signal such that said data signal arrives at said retention latch said predetermined time after it arrives at said at least one latch comparison circuitry for comparing a value of said data signal captured by said at least one latch with a value of said data signal captured by said retention latch said comparison circuitry being configured to signal a potential error in response to detecting a difference in said captured data values.

Where a synchronisation circuit also has a retention function such that it has at least one latch on a processing path and a retention latch arranged to store a data value during a low power mode it has been recognised that this circuit could be amended to perform error prediction using the retention latch for this purpose. The retention latch is used in low power mode to retain the current data value and as is not generally used in operational mode. Thus by simply adding delay and comparison circuitry a synchronisation circuit that can be used to both transmit and retain data in processing mode and predict potential timing errors and can be used in low power mode to retain data is produced.

A third aspect of the present invention provides a method of detecting potential timing errors within data processing circuitry said method comprising receiving a data signal at an input and transmitting said data signal via at least one processing path to an output said at least one processing path comprising a plurality of synchronisation circuits for capturing and transmitting said data in response to a clock signal and a plurality of combinational circuits arranged between said synchronisation circuits for processing said data at least some of said synchronisation circuits having a retention circuit arranged in parallel for storing data in a low power mode transmitting said data signal pending at an input of one of said synchronisation circuit to a retention circuit via delay circuitry for delaying said data signal such that said data signal arrives at said retention circuit said predetermined time after it arrives at said one of said synchronisation circuits comparing a value of said data signal captured by said synchronisation circuit with a value of said data signal captured by said retention circuit signalling a potential error in response to detecting a difference in said captured data values.

A fourth aspect of the present invention provides data processing means for processing data said data processing means comprising a data input means for receiving input data a data output means for outputting data and at least one processing path arranged between said data input means and said data output means said at least one processing path comprising a plurality of synchronisation means for capturing and transmitting said data in response to a clock signal and a plurality of combinational means arranged between said synchronisation means for processing said data said data processing means further comprising a plurality of retention means for storing data in a low power mode said plurality of retention means being arranged in parallel with said at least one processing path and at least one potential error detecting means for determining during processing of said data if said data signal pending at an input to one of said plurality of synchronisation means is stable during a predetermined time prior to capture of said data and for signalling a potential error if said data input is determined to be unstable during said predetermined time said at least one potential error detecting means comprising a potential error detecting path for transmitting said data signal pending at said input of said one of said plurality of synchronisation means to one of said retention means said potential error detecting path comprising delay means for delaying said data signal such that said data signal arrives at said retention means said predetermined time after it arrives at said synchronisation means comparison means for comparing a value of said data signal captured by said one of said synchronisation means with a value of said data signal captured by a corresponding one of said retention means said comparison means being configured to signal a potential error in response to detecting a difference in said captured data values.

The above and other objects features and advantages of this invention will be apparent from the following detailed description of illustrative embodiments which is to be read in connection with the accompanying drawings.

When the retention control signal RET is not asserted then the flip flop operates in operational mode and data received at the input D is clocked into master latch and then through to slave latch and is output at output Q.

This flip flop differs from conventional retention flip flops by the addition of an error prediction capability. This involves the additional components and . Components and provide a path for data input to the flip flop to pass through to the retention latch . This path has a delay element for generating a predetermined delay and two tristate inverters which act as switching devices to isolate the retention latch from the data input or to connect it to it. Tristate inverter is controlled by the clock signal which acts to control the timing of the device in a similar way to the tristate inverters and on the processing path while tristate inverter is controlled by an error prediction enable signal TE. Tristate inverter acts to isolate the retention latch from the processing path D to Q when error prediction capability is not required. Similarly in low power mode these elements are powered down and thus in this mode too the retention latch is isolated from the processing path.

The delay element is selected so that the delay to the input signal is the required length. The required delay length depends on the robustness and performance criteria of the circuit and also on the location of the flip flop element within the circuit. If it is on a critical timing path that is close to the set up time of the circuit then any transition that is close to the clocking edge needs to be detected as an error may well occur with time when ageing of the components will reduce their performance further. Thus in such a case the delay circuitry should provide a reasonably sized delay such that any transitions that are within this time period before the clocking edge can be detected and action taken to prevent them becoming errors.

If the elements are on a less critical path then the delay circuitry can be designed to generate a smaller delay as it is only transitions that are very close to the edge that need to be detected. Alternatively if it is very important that the design is robust then these delay elements should also generate a longer delay while if performance is more important than robustness they should be smaller. In general a longer delay element will detect more transitions that are further from the point of capture and thus will generate predicted error signals earlier and will reduce performance earlier but will generate a more robust circuit.

A predicted error is generated if the data retained in the retention latch is different to the data retained in the master latch . This occurs if there is a transition in the data within the predetermined time dictated by the size of the delay element. This potential error is detected by using exclusive NOR gate that signals a potential error when the value stored in the slave latch and that stored in the retention latch are different. This signal is output via AND gate . AND gate is there to gate the error signal so that it is only output in error prediction mode that is when the error prediction mode enable signal TE is asserted and also it is clocked at the output to ensure that glitches in the error signal that may arise if there are differences in the values stored in latches and before the clocking signal transitions are prevented from being output. This will be discussed later with reference to the timing diagrams of .

In this embodiment there are two control inputs and that are configured to receive the low power mode enable LP signal and the error predict enable signal PE respectively. These signals are used to control the switches that connect the retention circuit to the synchronisation circuits . Thus in response to the low power enable signal LP being asserted switch is closed and the data stored in latch is transferred to retention latch . In response to the low power enable signal LP not being asserted switch is opened and the retention latch is isolated from the latch .

In response to error predict enable signal PE being asserted then switch is closed and the signal input to latch passes through delay elements and is captured by retention latch . The value captured by retention latch is then compared with the value captured by latch and if there is a difference an error signal is output.

In this embodiment the error signals that are output are combined using OR gate and are input to clock frequency control circuitry which controls the clocking frequency of the processing circuitry . Thus if it is detected that there is a transition towards the end of the clock cycle in any one of the latches then clock frequency control circuitry slows down the clocking frequency of processing circuitry thereby providing a safety margin so that the transition does not occur after the end of the capture cycle for the latch. Thus if the circuitry slows down due to aging effects it will still be within the required limits and no errors will be generated.

The method includes the step of transmitting a data signal pending at an input of a synchronisation circuit to a retention circuit via delay circuitry. The value of the data signal captured by the synchronisation circuit is then compared with a value of the data signal captured by the retention circuit. A potential error is signalled in response to detecting a difference in these captured values. This error signal indicates that the data signal has transitioned late in the clock cycle and thus if no steps are taken an error may occur later if the devices of the circuit degrade.

Although illustrative embodiments of the invention have been described in detail herein with reference to the accompanying drawings it is to be understood that the invention is not limited to those precise embodiments and that various changes and modifications can be effected therein by one skilled in the art without departing from the scope and spirit of the invention as defined by the appended claims. For example various combinations of the features of the following dependent claims could be made with the features of the independent claims without departing from the scope of the present invention.

