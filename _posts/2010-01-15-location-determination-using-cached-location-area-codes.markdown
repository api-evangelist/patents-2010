---

title: Location determination using cached location area codes
abstract: Methods, program products, and systems for location determination using cached location area codes are described. A server computer can receive location information from location-aware mobile devices (e.g., GPS-enabled devices) located in a location area of a cellular communications network. The server computer can also receive from the mobile device the location area code associated with the location area in which the mobile devices are located. The server computer can estimate a coarse geographic location of the location area, as well as a number of cells encompassed by the location area using the received information. The server computer can store the estimated geographic locations associated with sufficiently large location areas (e.g., location areas having more than a certain number of cells). The server computer can provide the stored geographic locations to second mobile devices that are not GPS-enabled for estimating current locations of the second mobile devices.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08655371&OS=08655371&RS=08655371
owner: Apple Inc.
number: 08655371
owner_city: Cupertino
owner_country: US
publication_date: 20100115
---
A cellular communications network can include a radio network made up of a number of fixed location transceivers also known as base stations or cell towers. Each cell tower can serve a geographic area or a cell. Cells of the cellular communications network can be grouped into location areas. For example in a cellular network based on Global System for Mobile communications GSM technology a location area can correspond to a group of cells sharing a Base Station Controller BSC . Tens or hundreds of cells can share a single BSC which can handle allocation of radio channels receive measurements from mobile devices in the cells and control handovers from cell to cell. The actual geographic area covered by a cell or a location area can vary for example between urban and rural areas and from one cellular service provider to another. A unique number or location area code LAC can be assigned to each location area to identify the location area.

Multiple mobile devices e.g. cellular phones can connect to each cell tower. If a mobile device is wirelessly connected to a cell tower the mobile device knows the cell tower to which the mobile device is currently connected by an identifier of the cell tower e.g. a cell identifier . The mobile device can also know a current LAC designating a current location area in which the mobile device is located. If the mobile device moves between cells or location areas the cell identifier and current LAC can be updated automatically for the mobile device. The mobile device can update the current location area code without having to maintain an active wireless connection to a cell tower.

Methods program products and systems for location determination using cached location area codes are described. A server computer can receive location information from location aware mobile devices e.g. GPS enabled devices located in a location area of a cellular communications network. The server computer can also receive from the mobile device the location area code associated with the location area in which the mobile devices are located. The server computer can estimate a coarse geographic location of the location area as well as a number of cells encompassed by the location area using the received information. The server computer can store the estimated geographic locations associated with sufficiently large location areas e.g. location areas having more than a certain number of cells . The server computer can provide the stored geographic locations to second mobile devices that are not GPS enabled for estimating current locations of the second mobile devices.

Techniques of location determination using cached location area codes can be implemented to achieve the following advantages. A coarse location can be associated with a location area when the actual geography of the location area is unknown. The coarse location of the location area can be used to estimate a current location of a mobile device when the mobile device is in the location area. The estimate can be carrier independent. The estimate can provide location information for mobile devices not equipped with GPS features.

The cached location area codes and associated coarse locations can have a small memory footprint and can be stored on mobile devices. A mobile device that can periodically receive LAC updates from the network can quickly determine a coarse estimate of a current geographic location of the mobile devices. The determination calculation can include a simple memory lookup and therefore can be resource efficient. For example the calculation can also lead to less power consumption which can help avoid frequent charging of the mobile device battery and therefore enhance a user s experience using the mobile device. The mobile device can improve the coarse estimate upon request.

For GPS enabled mobile devices estimating a coarse location using the geographic area associated with a LAC can be advantageous when for example GPS signals are weak e.g. inside buildings . On a GPS enabled mobile device the geographic area associated with a LAC can be used to provide an almost instantaneous location estimate of the mobile device. For example when the mobile device is turned on and before the mobile device determines a location based on the GPS signals an estimated location based on a location area in which the mobile device is located can be displayed.

The coarse location estimate can be improved on an as needed basis. If a user of the mobile device requires more accurate location than the coarse location associated with a LAC the mobile device can determine a current location based on available wireless e.g. WiFi connections even if the mobile device is not equipped with GPS features or when GPS signals are weak.

The details of one or more implementations of location determination using cached LACs are set forth in the accompanying drawings and the description below. Other features aspects and advantages of adaptive location determination will become apparent from the description the drawings and the claims.

The system can include server computer connected to network . Network can be a data communications network e.g. a packet switching network or a hybrid of data and voice network. Through network server computer can communicate with various devices that are connected to network including mobile devices and .

Mobile devices and can be location aware mobile devices that can be connected to one or more cellular communications networks. The cellular communications networks can each include one or more location areas. The system can determine a coarse location to be associated with each location area using current locations of mobile devices and . The current locations of mobile devices and can be determined using various technologies implemented on mobile devices and . For example mobile device can determine a current location of mobile device using Global Positioning System GPS signals received though a GPS receiver that is built in or coupled to mobile device

Each of mobile devices and can be served by a cell tower of the cellular communication network. For example mobile devices can be served by cell towers respectively mobile device can be served by cell tower and mobile devices and can be served by cell towers and respectively. In some implementations a BSC can determine which mobile device can be served by which tower based on channel availability and geographic locations.

Cells and can be grouped into one or more location areas e.g. based on one or more BSC that control cell towers and of the cells . For example cells can be grouped into a first location area cell can belong to a second location area that includes a single cell and cells and can be grouped into a third location area. Each cellular service provider can define location areas specific to the service provider. For example some location areas can be groups of one or two cells while some location areas can include hundreds of cells. Each cell can cover a geographic area that can be for example several square kilometers. A location area can encompass a geographic area that is covered by the cells in the location area.

Each location area of the cellular communications network can be associated with a location area code LAC . The LAC can uniquely identify the location area. The LAC can be a string or a numeric value. For example in a Public Land Mobile Network a LAC can have a value range from 0 to 65 535. Location update procedure can allow a mobile device e.g. mobile device to inform the cellular communications network when mobile device moves from one location area e.g. the first location area that includes cells to another e.g. the second location area that includes cell . In some implementations a mobile device can be responsible for detecting and maintaining location area codes of the location where the mobile device is currently located. For example when mobile device finds that a current LAC is different from LAC of last update device can perform another update by sending to the network a location update request. In some implementations when mobile device moves from one location area to a next while not on a call a random location update can be performed. The random location update can also occur when signal fades.

Each cell tower e.g. cell tower can have a unique identifier cell ID associated with the cell tower. A mobile device e.g. mobile device located within a cell e.g. cell can acquire the cell ID of the cell tower e.g. cell tower that serves the cell. For example when mobile device initiates a data or voice communication through cell tower mobile device can identify the cell ID of cell tower

A program running on mobile device can acquire the current LAC and cell ID for mobile device . The program can cause mobile device to transmit the current LAC the current cell ID and the current location of mobile device to server computer through network . The program can be configured such that the transmissions occur at a certain time e.g. when a user finishes a phone conversation and hangs up mobile device or when the user terminates a data communication session .

In some implementations the transmissions from mobile devices and to server computer can be received through the cell towers. For example mobile device can transmit the current LAC of mobile device current cell ID e.g. cell ID of cell and current location of mobile device to server computer through cell tower and network . Cell tower can be connected to network though one or more gateways. In some implementations the transmissions from mobile devices to server computer can occur through wireless access points and of a wireless communications network which can be distinct from the cellular communications network. An exemplary wireless communications network can be a Wireless Local Area Network WLAN . For example mobile devices can store locations associated with the current LAC and current cell IDs in a cache memory device and transmit the stored locations LAC and cell IDs to server computer when access points or become available to mobile devices 

Upon receiving the information including LACs cell IDs and location coordinates from mobile devices and server computer can store the information in a temporary database. After a time period e.g. a day or a week where a statistically significant amount of data has been received server computer can select from the temporary database certain LACs whose location areas each includes a large enough number of cells. The selected LACs can be used in further computation. The number of cells in each location area can be calculated using a number of distinct cell IDs associated with a single LAC in the received information. Server computer can select those LACs that are associated with a number of distinct cell IDs when the number reaches a threshold e.g. 30 .

For each selected LAC server computer can calculate an estimated geographic area to be associated with the LAC based on the locations received from mobile devices and . In this specification the term LAC location will be used to refer to the estimated geographic area to be associated with a LAC. The LAC location can be a coarse location that corresponds to the location area represented by the LAC. The coarse location can be represented as a circle whose center can be defined by a latitude and a longitude and whose radius can correspond to an uncertainty radius. The uncertainty radius can represent a probability that a certain percentage of mobile devices e.g. 95 percent are located within the radius. The LAC location associated with a particular LAC does not necessarily match the geographic shape or location of the location area identified by the particular LAC. The LACs and corresponding LAC locations can be stored as location records in LAC location database .

For example location records can include three exemplary LACs. LAC can represent a location area that includes three cells cells . LAC can represent a location area that includes one cell cell . LAC can represent a location area that includes two cells cells . When the threshold for selecting location areas is set e.g. set to two coarse locations can be calculated for LACs that are associated with two or more cells. Therefore in a two cell threshold scenario the locations for LAC and LAC can be calculated whereas the location for LAC can be excluded from the calculation. The latitudes longitudes and uncertainty radius of LAC and LAC can be included in records .

Server computer can send records to one or more mobile devices e.g. mobile device . In some implementations records can be programmed into mobile device when mobile device is shipped to a user e.g. a cellular service subscriber . Programming records into mobile device can occur when mobile device leaves a manufacturer. Programming records into mobile device can also occur when mobile device is initialized e.g. at a retail store when mobile device is purchased . Programming records into mobile device can also occur dynamically e.g. when the subscriber downloads an application program into mobile device . Records once stored on mobile device can be updated periodically upon request or when necessary using various wireless or wired pull or push automatic or manual updating technologies through network and cell tower . Records stored on mobile device can be used to estimate a coarse current location of mobile device when mobile device knows a current LAC.

A cellular communications network can be a radio network that includes a number of cells. A cell can be an area served by one or more cell towers. In cell is served by cell tower . Mobile devices located within the cell can communicate with each other or with other devices e.g. data servers or landline phones inside or outside cell through cell tower that serves the cell. Cell can be an area defined by one or more geographic boundaries that are determined by for example communication ranges of cell tower and cell towers in neighboring cells. Mobile devices can enter cell when for example mobile device switches cell towers to which mobile device was connected to cell tower .

Each of mobile devices and other mobile devices represented in as a black triangle can be a location aware device that can determine a current location using various technologies e.g. GPS . Mobile device which is represented as a white triangle can be a non GPS enabled mobile device that is not equipped with hardware components that allow the mobile device to determine its current geographic location. X and Y axes of are shown to illustrate that locations of mobile devices can be determined on a two dimensional area defined by axes X and Y. For example X and Y axes can correspond to longitudes and latitudes respectively. For convenience location of cell tower is shown to coincide with point zero on the X and Y axes in . In some implementations an actual location e.g. latitude and longitude coordinates of cell tower is optional in the calculations.

When mobile devices communicate with cell tower mobile devices can transmit location information to the system through cell tower . The location information can be associated with a current LAC and an identifier of cell e.g. cell ID of cell . The system can use the location information transmitted from multiple mobile devices to determine an estimated geographic area that can be associated with the cell or the LAC. The estimated geographic area does not necessarily enclose a point where cell tower is actually located. Neither is it necessary for the estimated geographic area to correspond to the geometric location or shape of cell or the current location area although the estimated geographic area can be located within cell and the current location area. The estimated geographic area can correspond to an area where mobile devices including location aware devices and non GPS enabled device are likely to be located when the mobile devices are in cell and the current location area. The estimated geographic area can be used to determine a coarse location of mobile device .

The system that has received multiple locations transmitted from mobile device can determine the estimated geographic area using an iterative process e.g. by performing a multi pass analysis . In some implementations the system can initially calculate an average geographic location e.g. a centroid using a set that contains locations received from mobile devices that are located in cell that is served by cell tower . In some implementations the system can use a set that contains locations received from mobile devices that have the same LAC. In each pass of the multi pass analysis the system can calculate a new average geographic location based on the locations in the set calculate a distance between the average geographic location and each location in the set and exclude from the set one or more outliers. Outliers can be locations in the set that are located the farthest from the average geographic location. The system can repeat the multi pass analysis until an exit condition is satisfied e.g. after a certain number of passes have run or when other exist conditions are satisfied .

For example in various passes of the multi pass analysis the estimated geographic area can be circles and respectively. Centers of circles and can each correspond to an average geographic location of the locations in the set in a distinct stage e.g. a pass of the multi pass analysis . In each pass the set of locations can be reduced by excluding the outliers. A location can be excluded from the set if the distance between the location and an average geographic location exceeds a threshold.

In some implementations radii of circles and can each represent an estimated error margin of the geographic areas. The smaller the radius the more the precision of the estimated geographic location. Each of the radii of a circle and can be determined based on at least one calculated distance between the average geographic location and each location in the set. The error margin can correspond to a probability that a mobile device s current location is correctly estimated.

The multi pass analysis can result in a final average geographic location e.g. center of circle and a final estimated error margin e.g. radius of circle when the exit condition is satisfied. The final estimated error margin can be defined based on distances e.g. a longest distance between the final average geographic location and locations remaining in the set. Circle can be associated with cell and used for estimating locations of non GPS enabled mobile devices e.g. mobile device connected to cell tower .

Once locations of individual cells included in a location area is determined the LAC location can be similarly calculated by applying the iterative process on the estimated locations of the cells included in the location area. In some implementations the location representing the LAC can be directly calculated using the locations from mobile devices .

Distribution of mobile devices can reflect a snapshot of mobile devices at a particular time e.g. 8 30 am local time for a time zone in which cell is located or locations of mobile devices over a period of time e.g. six hours . In the former case each mobile device can be associated with a single location. In the latter case each mobile device can be associated with multiple locations e.g. when mobile device is moving . Mobile device that is associated with multiple locations can be represented by multiple locations in .

For example mobile device can be a location aware mobile telephone. If a person is using the location aware mobile telephone while moving e.g. walking driving etc. the mobile telephone can have a distinct location every minute. In some implementations the mobile telephone can transmit the location to the system periodically e.g. every minute through cell tower . In some implementations the mobile telephone can cache e.g. record the locations periodically e.g. every minute and transmit the cached locations when sufficient bandwidths exist such that the transmission does not interfere with performance of the mobile telephone e.g. when the person finishes talking and hangs up . Each distinct location can be represented as a distinct black triangle in . The data transmitted to the system do not need to include privacy information that may be linked to a user of mobile device. For example a user account name and telephone number need not be transmitted.

The system can determine an average geographic location of a set of locations received from mobile devices . The set of locations can include locations received from mobile devices at a particular time or during a particular time period. The average geographic location can be designated as center of area encompassed by circle . Center of circle need not coincide with the location of cell tower . A distance between the average geographic location and each location in the set can be calculated. Locations whose distances to the center exceed a threshold can be excluded from the set. Circle can have radius that is calculated based on the longest distance between the average geographic location and locations in a current set.

Area encompassed by circle can be smaller than the area encompassed by circle as determined in a prior pass when outlier locations are excluded. The smaller area can reflect an increased precision of the calculation. Center of circle does not necessarily coincide with center of circle . In some implementations radius of circle can correspond to a remaining location of mobile device that is farthest away from the center of circle . The radius can represent an error margin of the new estimated geographic location calculated in the current pass.

Once a geographic area is calculated for each individual cell of a location area the LAC location of the location area can be calculated based on the individual cells. Calculating the LAC location can include applying the multi pass algorithm to a set of locations associated with the cells including cell .

In axes X Y and Z can be used to indicate a three dimensional space. For example axes X Y and Z can represent longitude latitude and altitude respectively. For convenience location of cell tower is shown to coincide with point zero on the X Y and Z axes in . In some implementations an actual location e.g. latitude longitude and altitude coordinates of cell tower is optional in the calculations.

Each triangle of can represent a location of a device located in a three dimensional cell space . The locations can have projections e.g. projection on a plane in the three dimensional space. The plane can be defined at an arbitrary altitude e.g. the altitude of cell tower . Cell space can intersect with the plane at circle . Projection and intersection circle are shown to illustrate the locations of mobile devices . In some implementations determining the projections and intersections can be optional in the calculations.

A multi pass analysis can associate a geographic space with cell space of a cellular communications network based on a set of locations received from location aware mobile devices that are located in cell space . In a pass of the multi path analysis an average geographic location e.g. center of space can be determined by for example averaging the latitudes longitudes and altitudes coordinates of locations in the set. Distances between the average geographic location and locations in cell space can be calculated. Locations that are within cell space but are sufficiently far away from the average geographic location can be excluded from the set and from further computations. A radius of sphere can be determined by for example the farthest distance between remaining locations in the set and the average geographic location. Circle illustrates projection of the space encompassed by sphere on the plane.

The system can repeat the stages of calculating an average geographic location in a set calculating distances between the average geographic location and the locations in the set and excluding from the set locations based on the calculated distances. The repetition can continue until an exit condition is satisfied. A space having a center at the average geographic location and a radius that is based on a distance between the average geographic location and a remaining location in the set can be designated as a geographic space that can be associated with the cell space . For convenience the space enclosed by the sphere having a center at the average geographic location and a radius that is based on a distance between the average geographic location and a remaining location in the set will be referred to as a presence space in this specification. The presence space can indicate a space in which a mobile device e.g. mobile device is likely to be located when the mobile device is in cell space e.g. when the mobile device is served by cell tower .

Once locations of cells included in a location area is determined the location representing the LAC can be similarly calculated by applying the iterative process on the estimated locations of the cells included in the location area. In some implementations the location representing the LAC can be directly calculated using the locations from mobile devices .

The system can receive from a first set of mobile devices the following information at least one location area code LAC of a cellular communications network the LAC associated with a location area cell identifiers of the cellular communication network and a set geographic locations of the first set of mobile devices from one or more mobile devices . Each location can be represented by geographic coordinates e.g. latitude longitude and altitude . In various implementations the set of locations can correspond to a period of time e.g. 6 hours or from 6 am to 10 am of a time zone in which the location area is located .

In some implementations the period of time can be configured to reflect characteristics of specific usage patterns at various hours of a day. An area where mobile devices are most likely located in the location area can vary during the day indicating various usage patterns in specific hours. For example the period of time can correspond to commute time business hours night time etc. The characteristics of the time of the day can correspond to various usage patterns of mobile devices . For example during commute time mobile devices in the location area can be at or near a freeway during business hours the mobile devices in the location area can be at or near an office building at nighttime the mobile devices in the location area can spread out without a particular point of concentration. The system can calculate the LAC location based on locations received for example from 4 am to 10 am and recalculate the LAC location based on location received from 10 am to 4 pm etc. Locations received in each characteristic time period can be grouped into a set in the system. The locations can be stored in any data structure e.g. set list array data records in a relational database etc. on a storage device coupled to the system.

The system can calculate a size to be associated with the LAC. The size to be associated with the LAC can correspond to e.g. can measure a number of cells in the location area represented by the LAC. Calculating the size can include examining a number of distinct cell IDs associated with the LAC based on the information received from mobile devices .

The system can select a LAC based on the calculated size of the LAC. Selecting an LAC can include specifying a size threshold e.g. 30 cells and selecting the LAC whose size reaches or exceeds the threshold e.g. the LACs whose represented location areas include at least 30 cells . In some implementations selecting a LAC can include ranking the LACs based on the size of the LACs e.g. the LACs whose represented location areas include the most number of cells can rank the highest and selecting a number of LACs that are top ranked e.g. the top 50 000 LACs .

The system can associate each of the selected LACs with a LAC location. A LAC location may or may not coincide with the actual geographic area of the location area as defined by the cellular service provider. The LAC location may or may not coincide with the cells included in the location area. The actual geographic area of the location area and the cells can be unknown. The LAC location can include a geographic location determined by the set of geographic locations received from mobile devices . The LAC location can be stored on a storage device in association with the LAC. Further details on determining the LAC location will be described below with respect to .

The system can provide the selected LAC and the associated LAC location to a second mobile device e.g. mobile device for estimating a current location of the second mobile device. Providing the selected LAC and the associated LAC location to mobile device can include sending the selected LAC and the associated LAC location to mobile device wirelessly.

The system can calculate an average geographic location using the locations in the set of locations received from mobile devices . Calculating the average geographic location can include calculating an average of latitudes longitudes and altitudes of the locations in the set and designating a position at the calculated average latitude longitude and altitude as the average geographic location. In some implementations calculating the average geographic location can include designating a position at a median latitude median longitude and median altitude of the positions in the set as the average geographic location.

The system can calculate distances between the locations in the set and the average geographic location. In some implementations the system can calculate a linear distance between each of the locations in the set and the average geographic location in Euclidean space. In some implementations the system can calculate a geodesic distance between each of the locations in the set and the average geographic location taking curvature of the Earth into consideration.

The distances calculated in stage can be designated as a radius associated with a center. The center can be the average geographic location calculated in stage which can be a center of a circle. The radius of the circle can be determined based on at least one distance between a location in the set of locations and the average geographic location. In some implementations the radius can equal to the longest distance between the average geographic location and a location remaining in the set. In some implementations the radius can be a distance that when the circle is drawn using the radius and the average geographic location as a center the circle can enclose a percentage e.g. 80 percent of the locations remaining in the set. The radius can represent a margin of error beyond which an estimation of a location of a non GPS enabled mobile device is less likely to be statistically meaningful.

The system can exclude from the set at least one location based on a distance between the average location and the location. In some implementations the system can exclude locations whose distance to the average geographic location exceeds a threshold distance. In each pass of the multi pass analysis the system can increase a precision of the estimated average geographic location by excluding locations that appear to be away from a concentration of locations e.g. a cluster . A location that is away from a cluster of locations can be less useful in estimating the LAC location associated with the LAC and can be excluded. In various implementations the threshold distance can vary from one pass to a next pass. In some implementations the threshold distance can be a distance to the average geographic location within which a certain percentage e.g. 95 percent of locations in the set are located. In some implementations the threshold distance can be a set of distances corresponding to the passes e.g. 250 meters for the first pass 150 meters for the second pass etc. . The system can exclude at least one location from the set when the distance between the average geographic location and the location exceeds the threshold distance.

The system can repeat stages and of process until an exit condition is satisfied. The system can determine whether an exit condition is satisfied for terminating the repetition. In some implementations the exit condition can be satisfied when a number of repetitions reach a threshold number e.g. 10 times . The threshold number as well as the percentage of locations to exclude can be configurable to fine tune a balance between certainty e.g. a larger area in a LAC location can result in more confidence that a mobile device in the LAC is actually located in the location area represented by the LAC and precision e.g. a area in a LAC location can result in more accurate location of a mobile device . For example when the percentage is set to 95 percent and the number of passes is set to 10 the final pass can produce a circle that encompasses about 60 percent of all location data points.

In some implementations the exit condition of stage can be satisfied when the LAC location is sufficiently small. In LACs where mobile devices are highly concentrated a LAC location can be sufficiently small that further passes will not necessarily increase the precision. The repetition of stages and can terminate when the radius of the circle reaches below a threshold radius. The threshold radius can differ from location area to location area based on the distribution pattern of the locations in the set received e.g. number of location data points received density of the location data points and concentration areas in the cells .

The system can designate the geographic area as a circle having the average geographic location as a center and a radius based on at least one calculated distance. The geographic area can be associated with a LAC. The center can be represented in latitudes and longitudes. In some implementations where distances are calculated in three dimensional spaces the center can further be represented in an altitude.

Location engine can include data collection module that can receive data from various mobile devices through various access points e.g. access points or cell towers e.g. cell towers and . The data can include multiple data points that can indicate locations of one or more location aware mobile devices e.g. mobile devices as well as current LACs and current cell IDs of the mobile devices. In some implementations the data points can also include information on which time zone mobile devices are located. Data collection module can include data reception module which can receive data transmitted from mobile devices and data indexing module . Data indexing module can perform various processing on the received data points. For example data indexing module can sort latitudes longitudes and altitudes based on cell IDs. Data indexing module can also group data into sets based on time periods. For example a new set of received locations can be created for a configurable period of time e.g. six hours .

Sets of received locations of mobile devices as well as associating LACs and cell IDs can be stored in data point database . Data point database can store current and historical locations of various mobile devices . Data point database can include an ad hoc database relational database object oriented database. Data point database can be hosted locally or remotely in relation to location engine .

Location calculation module can be utilized to calculate an average geographic location in sets of data points in data points database calculate distances between the average geographic location and locations of various data points and exclude locations from the sets for further computation. Location calculation module can perform the calculations for a particular set e.g. a set of data points associated with a cell ID until an exit condition is reached for the particular set. Location calculation module can determine LAC locations for each LAC.

In some implementations location calculation module can calculate the sizes of location areas represented by the LACs using LAC size calculator . LAC size calculator can count the number of distinct cell IDs associated with each LAC and determine how many cells are included in each of the location areas. LAC size calculator can exclude those LACs whose sizes are below a threshold e.g. those LACs having fewer than 30 cells .

A LAC location can be defined by a center having the average latitude longitude and altitude coordinates of the set of locations. The LAC location can be further defined by a radius determined based on distances from locations in the set of locations to the center. The latitude longitude and altitude coordinates of centers for the LAC locations and the radii of the LAC locations can be stored in LAC location database . LAC location database can be updated periodically by location calculation module .

The data of LAC location database can be distributed to mobile devices using data distribution module . Data distribution module can send information of LAC locations e.g. center coordinates and radii that are associated with LACs to mobile devices e.g. non GPS enabled mobile device upon request through broadcasting or using various push technology without receiving requests from the mobile devices.

Mobile device can store or otherwise be connected to LAC location database . LAC location database can include a set of location area codes LACs of one or more cellular communications networks. Each LAC e.g. LAC can be associated with at least a predetermined number of cells of the cellular communications network. The LAC can be associated with a geographic area the geographic area including a first circle centered at a location and having a first radius representing an uncertainty of the location. The predetermined number of cells can represent a minimum number of cells e.g. 30 that are required of a LAC to be included in LAC location database . For example if a location area identified by the LAC LAC includes at least two cells LAC and LAC can be included in LAC location database in association with the geographic area. The strings LAC LAC or LAC are used in this specification for illustrative purposes. An actual LAC can be a hexadecimal value.

The geographic area stored in association with a LAC in LAC location database can be an estimate of the location area represented by the LAC. However the geographic area stored in association with a LAC need not map exactly to the shape size or center of the location area represented by the LAC. For example LAC in LAC location database can represent a location area that includes cells served by cell towers . The geographic area stored in association with LAC can be a circle whose center can be inside or outside the polygon formed by cells 

Mobile device when located in a cell e.g. cell that is included in the location area designated by a LAC e.g. LAC can receive the LAC. The LAC representing a location area in which mobile device is located will be referred to as a current LAC of mobile device . Mobile can acquire the current LAC according to various protocols of the cellular communication network to which mobile device is connected. For example the current LAC can be sent from a cell tower e.g. cell tower to which mobile device is connected.

Mobile device can perform a lookup in LAC location database using the LAC received from cell tower . For example if the current LAC of mobile device is LAC mobile device can identify the geographic area e.g. a circle that is associated with LAC from LAC location database .

Upon identifying the geographic area associated with the current LAC mobile device can display the geographic area on display device . Display device can include a map display which can display a stored digital map or a digital map received wirelessly. The geographic area can be displayed as circle overlaying on the map on display device . The center of circle can correspond to the longitude and latitude of the geographic area stored in association with the current LAC. The radius of circle can correspond to a radius of the geographic area scaled to a display size of the map.

Mobile device can be wirelessly connected to access point . Access point can be an access point of a WLAN e.g. a WiFi network . From access point mobile device can receive data that include locations of neighboring access points. Mobile device can store the received data on a storage device. The stored data can be updated periodically.

In the example shown mobile device is connected to access point . In addition mobile device is within communication ranges to access points and . Mobile devices can identify access points and under wireless communication protocols used in the WLAN e.g. IEEE 802.11a . Access points and can be identified by MAC addresses of the access points or other identifiers e.g. Bluetooth identifiers .

Mobile device can identify presence areas and that are associated with access points respectively. A presence area e.g. presence area can be an estimated area that is associated with an access point e.g. access point in which mobile devices connected to access point is likely to be located. Identifying presence areas can include retrieving information on the presence areas from a memory device coupled to mobile device . In some implementations mobile device can request from a server the presence areas by sending to the server identifiers e.g. media access control MAC addresses of access points 

Based on presence areas mobile device can execute an iterative process e.g. a multi pass analysis on the presence areas . The iterative process can produce geographic area which can be an estimate of the current geographic location of mobile device . Geographic area can be a geographic space when three dimensional location information is utilized. Mobile device can display the estimated current location on a display device e.g. on a map display . The estimated current location can be a location that can improve upon the coarse location determined by using LAC alone.

Mobile device can receive a set of location area codes LACs of a cellular communications network. Each LAC in the set can be associated with at least a predetermined number of cells of the cellular communications network. The LAC can further be associated with a geographic area e.g. a LAC location . The geographic area can be defined as a circle centered at a particular location and having a radius representing an uncertainty of the location.

Receiving the set of LACs can include storing the set of LACs in a read only memory ROM component of mobile device . The ROM component can be installed by a manufacturer. Receiving the set of LACs can also include downloading the set of LACs from a server computer e.g. by downloading to mobile device an application program from the server computer upon a request from mobile device . Receiving the set of LACs can also include automatically and wirelessly receiving the set of LACs being pushed by the server computer through a wireless access point or a cell tower.

The set of LACs received in stage can be selected based on various criteria. In some implementations location area size can be a selection criterion. Location area size can correspond to a predetermined number of cells encompassed in the location area. For example a LAC that corresponds to a location area that encompasses a certain number of cells e.g. 30 cells can be included. LACs not satisfying the criterion e.g. having fewer than a predetermined number of cells can be excluded. Another selection criterion can be a number of data points received from the LAC. A data point can correspond to a transmission of a location from a location aware mobile device to the server computer the location being associated with a LAC. The LAC can be included if the server computer has received a sufficient number of data points e.g. a statistically significant number such that a LAC location can be calculated .

Mobile device can determine a current LAC of mobile device based on a wirelessly received signal. Determining a current LAC can include querying a processor in mobile device that is dedicated to processing communication functions e.g. a baseband processor .

Mobile device can determine a current location of mobile device . Determining the current location can include performing a query into LAC location database using the current LAC. The query can retrieve a LAC location which can be used as a coarse estimate of the current location. The current location can include a circle for example that encompasses a city. Performing the coarse estimate can have the advantage of minimizing consumption of resources e.g. CPU cycles communication bandwidths and battery power of mobile device in determining a current location. Accuracy of the coarse estimate of the current location can optionally be improved by further calculations.

Mobile device can optionally display the current location of mobile device on a display device. The current location can be displayed as a first circle e.g. the circle of the LAC location which can be centered at a location point defined by a latitude and a longitude and having a radius that can represent an uncertainty of the location point.

Displaying the current location can optionally further include displaying a second circle replacing the first circle. The second circle can correspond to an improved estimate of the current location of mobile device which can be an improvement upon the coarse estimate based on current LAC. The second circle can have a radius that is less that the radius of the first circle reflecting the improved accuracy. The second circle can be determined by an adaptive location determination process which will be described in further detail below with respect to .

Mobile device can receive identifiers of access points e.g. access points of a wireless communication network e.g. a WLAN and a set of locations associated with the access points. The set of locations can correspond to presence areas or presence spaces associated with the access point. Each location can be represented by geographic coordinates e.g. latitude longitude and altitude . Each location can be associated with an identifier e.g. a MAC address of an access point . In various implementations the set of locations can be received from a server periodically or upon request.

Mobile device can calculate an average geographic location using the locations in the set. Calculating the average geographic location can include calculating an average of latitudes longitudes and altitudes of the locations in the set and designating a position at the calculated average latitude longitude and altitude as the average geographic location. In some implementations calculating the average geographic location can include designating a location at a median latitude median longitude and median altitude of the positions in the set as the average geographic location.

Mobile device can calculate distances between the locations in the set and the average geographic location. In some implementations the system can calculate a linear distance between each of the locations in the set and the average geographic location in Euclidean space. In some implementations the system can calculate a geodesic distance between each of the locations in the set and the average geographic location taking curvature of the earth into consideration.

The distances calculated in stage can be designated as a radius associated with a center. The center can be the average geographic location calculated in stage which can be a center of a circle e.g. circle surrounding geographic area . The radius of the circle can be determined based on at least one distance between a location in the set of locations and the average geographic location. In some implementations the radius can equal to the longest distance between the average geographic location and a location remaining in the set. In some implementations the radius can be a distance that when a circle is drawn using the radius and the average geographic location as a center the circle can enclose a percentage e.g. 80 percent of the locations remaining in the set. The radius can represent a margin of error beyond which an estimation of a location of a non GPS enabled mobile device is less likely to be statistically meaningful.

Mobile device can exclude from the set at least one location based on a distance between the average location and the location. In some implementations the system can exclude locations whose distance to the average geographic location exceeds a threshold distance. In each pass of the multi pass analysis the system can increase a precision of the estimated average geographic location by excluding locations that appear to be away from a concentration of locations e.g. a cluster . A location that is away from a cluster of locations can be less useful in estimating a current location of mobile device and can be excluded. In various implementations the threshold distance can vary from one pass to a next pass. In some implementations the threshold distance can be a distance to the average geographic location within which a certain percentage e.g. 95 percent of locations in the set are located. In some implementations the threshold distance can be a set of distances corresponding to the passes e.g. 50 meters for the first pass 30 meters for the second pass etc. . The system can exclude at least one location from the set when the distance between the average geographic location and the location exceeds the threshold distance.

Mobile device can repeat stages and of process until an exit condition is satisfied. The system can determine whether an exit condition is satisfied for terminating the repetition. In some implementations the exit condition can be satisfied when a number of repetitions reach a threshold number e.g. five times . The threshold number can relate to a number of locations in the originally received set. The threshold number as well as the percentage of locations to exclude can be configurable to fine tune a balance between certainty e.g. a larger presence area can result in more confidence that a mobile device in the cell is actually located in the presence area and precision e.g. a smaller presence area can result in more accurate location of a mobile device . For example when the percentage is set to 95 percent and the number of passes is set to 10 the final pass can produce a circle that encompasses about 60 percent of all location data points.

In some implementations the exit condition of stage can be satisfied when the presence area or presence space is sufficiently small. In areas where access points are highly concentrated an estimated current location can include an area sufficiently small that further passes will not necessarily increase the precision. The repetition of stages and can terminate when the radius of the circle reaches below a threshold radius. For example the threshold radius can be 8 10 meters. The threshold radius can be based on radii of presence areas . In some implementations if some radii of presence areas are sufficiently small the threshold radius can be small to reflect a confidence on the estimate.

Mobile device can designate the current location of mobile device using a circle having the average geographic location as a center and a radius based on at least one calculated distance. The center can be represented in latitudes and longitudes. In some implementations where distances are calculated in three dimensional spaces the center can further be represented in an altitude. In some implementations mobile device can further display the current location on a display device on a map user interface. Exemplary map user interfaces will be described below in reference to .

Location calculator can include LAC location database that can store a set of LACs and corresponding LAC locations. In some implementations the LACs and corresponding LAC locations stored in LAC location database can be updated periodically or upon request. LAC determination module can determine a current LAC of mobile device . In some implementations to determine the current LAC of mobile device LAC determination module can query a baseband processor of mobile device by calling an application programming interface API of the baseband processor. In some implementations LAC determination module can determine a current cell ID in addition to the current LAC.

Location query module can perform a query into LAC location database using the current LAC retrieved by LAC determination module . The query can map the current LAC into a LAC location in accordance to records in LAC location database . The LAC location can be presented to user interface for display. User interface can include a map display which can display a digital map and overlay the LAC location that has been mapped to the current LAC by location query module . Overlaying the LAC location on the map can include displaying the LAC location as a circle on the map.

Location update module can receive from one or more server computers location data on one or more access points of a wireless network. The data can include multiple identifiers of one or more access points e.g. access points as well as locations associated with the access points. In some implementations the identifiers of the access points can correspond to access points that are located within the LAC location that corresponds to the current LAC of mobile device . Location update module can receive the location data when a user of mobile device requests the data e.g. when a user requests an improvement of the coarse location estimate based on the LAC . Location update module can also receive the location data automatically. For example location update module can also receive the location data through an update when mobile device has identified a new current LAC e.g. by moving from one location area to another location area . In some implementations the data points received by location update module can include access points that are located within a current cell of mobile device .

Location database can store the location data of the access points within the current location area or the current cell. Location database can be updated by location update module and can be queried by location calculation module .

Location calculation module can include access point locator . Access point locator can include devices and software for determining available access points. Available access points can include access points with which mobile device can communicate. Depending on the geographic location of mobile device and the access points mobile device can be within communication range of multiple access points even though mobile device may be connected with only one particular access point. Mobile device can use the access points within communication range to perform location calculations to improve upon the coarse location determined based on the current LAC.

Location lookup module can query location database and identify a set of locations corresponding to the access points that are within communication range. Location calculation module can calculate an average geographic location in sets of locations identified from location database calculate distances between the average geographic location and locations of various locations and exclude locations from the sets for further computation. Location calculation module can perform the calculations for a particular set e.g. a set of locations identified by location lookup module until an exit condition is reached for the particular set. Location calculation module can determine a current location of mobile device .

The current location of mobile device as determined by location calculation module can be displayed on user interface . The current location can be an improvement of the coarse location determined by location query module . Improving the coarse location can be performed on an as needed basis. For example the operations performed by modules and can occur upon a user request or when the coarse location is displayed on user interface for a certain amount of time e.g. 10 seconds which can indicate that the user may have an interest in acquiring an improved current location.

Exemplary map with a geographic area can be displayed on mobile device . Mobile device when in a location area can acquire a current LAC. Mobile device can retrieve a LAC location corresponding to the current LAC by requesting from a server LAC location or query a LAC location database e.g. LAC location database stored on a storage device on mobile device . In some implementations mobile device can display the map on the touch sensitive display of mobile device . The map can be displayed when a user selects a maps object to view mapping and location based services. In some implementations objects such as the maps object can be selected by voice activation. A search bar and a bookmarks list object can be displayed at the top of the map . Below the bottom of the map one or more display objects can be displayed for example a search object a directions object a map view object and a current location object .

The search bar can be used to find an address or other location on the map. For example a user can enter their home address in the search bar and the region containing the address would be displayed on the map . The bookmarks list object can for example bring up a Bookmarks list that contains addresses that are frequently visited such as a user s home address. The Bookmarks list can also for example contain special bookmarks such as the current location e.g. the current location of mobile device .

Search object can be used to display search bar and other map related search menus. The directions object can for example bring up a menu interface that allows the user to enter a start and end location. The interface can then display information e.g. directions and travel time for a route from the start location to the end location . Map view object can bring up a menu that can allow the user to select display options for map . For example map can be changed from black and white to color the background of the map can be changed or the user can change the brightness of the map.

Current location object can allow the user to see geographic area on map indicating where device is currently located. Geographic area can correspond to a LAC location e.g. circle that can be used as a coarse estimate of the current location of mobile device . The LAC location can have a center that is an average geographic location of data points associated with a location area where mobile device is located. The LAC location can have a radius that can be determined based on a distance between the average geographic location and one or more locations associated with a current location area. The circle surrounding geographic area can be replaced by another circle with smaller radius when mobile device can improve the accuracy of a current location estimate. A special current location bookmark can be placed in the Bookmarks list when current location object is selected. If the special current location bookmark was previously set in the Bookmarks list the old bookmark information can for example be replaced with the new current location information. In some implementations the special current location bookmark is tied to the centroid of geographic area . That is the special current location bookmark can include the coordinates for the centroid of geographic area . Geographic area can be based on location data determined or estimated using location calculator as previously described in reference to . Geographic area can for example be depicted by a circle rectangle square hexagon or other enclosed region with crosshairs or some other distinctive element to differentiate geographic area from map .

In some implementations geographic area can indicate a region in which mobile device is determined or estimated to be located and the geographic area may not necessarily be centered on the actual current position of mobile device . In this example mobile device may be located off center within the geographic area. In another example geographic area can be centered on an estimated current position of mobile device e.g. the center of the LAC location .

Mobile device can for example center the map view on geographic area when the current location object is tapped or otherwise selected. In some implementations the zoom level of the map can be adjusted based on the accuracy or precision of the location data or the technology system or service that provided the location data. For example the map can be zoomed out when mobile device cannot receive GPS signals for lower accuracy and uses cell tower data to determine its location. The map can be zoomed in for higher accuracy if mobile device is capable of using GPS location data to determine its current location. In some implementations the zoom level can be based on the velocity of mobile device e.g. the map can be zoomed out at higher velocities and zoomed in when mobile device is not moving . A combination of accuracy or precision and velocity can also be used.

If all methods for retrieving location based data fail e.g. when mobile device is not within communication range of any cell tower or wireless access points and there are no other systems or services available for determining or estimating the current position of mobile device an error can be displayed to the user and no geographic area is displayed on map . The error can for example contain a message to the user informing them of the failure and the possible reason or reasons for the failure.

Current location object can be selected for example to activate the estimating and displaying of geographic area on map to get directions to or from the estimated current location i.e. the centroid of geographic area to send the estimated current location of mobile device to a friend e.g. such that the friend can go to the same location or to create a bookmark for the estimated current location.

In some implementations both voice and data communications can be established over wireless network and the access device . For example mobile device can place and receive phone calls e.g. using voice over Internet Protocol VoIP protocols send and receive e mail messages e.g. using Post Office Protocol 3 POP3 and retrieve electronic documents and or streams such as web pages photographs and videos over wireless network gateway and wide area network e.g. using Transmission Control Protocol Internet Protocol TCP IP or User Datagram Protocol UDP . Likewise in some implementations the mobile device can place and receive phone calls send and receive e mail messages and retrieve electronic documents over the access device and the wide area network . In some implementations mobile device or can be physically connected to the access device using one or more cables and the access device can be a personal computer. In this configuration mobile device or can be referred to as a tethered device.

Mobile devices and can also establish communications by other means. For example wireless device can communicate with other wireless devices e.g. other mobile devices or cell phones etc. over the wireless network . Likewise mobile devices and can establish peer to peer communications e.g. a personal area network by use of one or more communication subsystems such as the Bluetooth communication devices. Other communication protocols and topologies can also be implemented.

The mobile device or can for example communicate with one or more services and over the one or more wired and or wireless networks. For example one or more location tracking services can calculate LAC locations to be associated with each LAC determine how many cells are to be associated with each LAC and create a LAC location database. The LAC location database can be sent to mobile devices and . In some implementations location tracking services can also calculate locations to be associated with access points.

Messaging service can for example provide e mail and or other messaging services e.g. Short Message Service SMS . Messaging service can allow a current user of a mobile device e.g. device to communicate with a requester who requests location information of device . Device security service can for example provide functions for analyzing security events to determine security risk factor sending security commands to mobile devices and and processing security status information sent from mobile devices and

Location updating service can determine whether to send location information including LAC location database and locations of one or more access points to mobile devices and . Upon determination that the information is to be sent e.g. based on a request from mobile device or Location updating service can transmit the information to mobile devices and

Mobile device or can also access other data and content over the one or more wired and or wireless networks. For example content publishers such as news sites Rally Simple Syndication RSS feeds web sites blogs social networking sites developer networks etc. can be accessed by mobile device or . Such access can be provided by invocation of a web browsing function or application e.g. a browser in response to a user touching for example a Web object.

Sensors devices and subsystems can be coupled to peripherals interface to facilitate multiple functionalities. For example motion sensor light sensor and proximity sensor can be coupled to peripherals interface to facilitate orientation lighting and proximity functions of the mobile device. Location processor e.g. GPS receiver can be connected to peripherals interface to provide geopositioning. Electronic magnetometer e.g. an integrated circuit chip can also be connected to peripherals interface to provide data that can be used to determine the direction of magnetic North. Thus electronic magnetometer can be used as an electronic compass.

Camera subsystem and an optical sensor e.g. a charged coupled device CCD or a complementary metal oxide semiconductor CMOS optical sensor can be utilized to facilitate camera functions such as recording photographs and video clips.

Communication functions can be facilitated through one or more wireless communication subsystems which can include radio frequency receivers and transmitters and or optical e.g. infrared receivers and transmitters. The specific design and implementation of the communication subsystem can depend on the communication network s over which a mobile device is intended to operate. For example a mobile device can include communication subsystems designed to operate over a GSM network a GPRS network an EDGE network a Wi Fi or WiMax network and a Bluetooth network. In particular the wireless communication subsystems can include hosting protocols such that the mobile device can be configured as a base station for other wireless devices.

Audio subsystem can be coupled to a speaker and a microphone to facilitate voice enabled functions such as voice recognition voice replication digital recording and telephony functions.

I O subsystem can include touch screen controller and or other input controller s . Touch screen controller can be coupled to a touch screen or pad. Touch screen and touch screen controller can for example detect contact and movement or break thereof using any of a plurality of touch sensitivity technologies including but not limited to capacitive resistive infrared and surface acoustic wave technologies as well as other proximity sensor arrays or other elements for determining one or more points of contact with touch screen .

Other input controller s can be coupled to other input control devices such as one or more buttons rocker switches thumb wheel infrared port USB port and or a pointer device such as a stylus. The one or more buttons not shown can include an up down button for volume control of speaker and or microphone .

In one implementation a pressing of the button for a first duration may disengage a lock of the touch screen and a pressing of the button for a second duration that is longer than the first duration may turn power to mobile device on or off. The user may be able to customize a functionality of one or more of the buttons. The touch screen can for example also be used to implement virtual or soft buttons and or a keyboard.

In some implementations mobile device can present recorded audio and or video files such as MP3 AAC and MPEG files. In some implementations mobile device can include the functionality of an MP3 player such as an iPod . Mobile device may therefore include a pin connector that is compatible with the iPod. Other input output and control devices can also be used.

Memory interface can be coupled to memory . Memory can include high speed random access memory and or non volatile memory such as one or more magnetic disk storage devices one or more optical storage devices and or flash memory e.g. NAND NOR . Memory can store operating system such as Darwin RTXC LINUX UNIX OS X WINDOWS or an embedded operating system such as VxWorks. Operating system may include instructions for handling basic system services and for performing hardware dependent tasks. In some implementations operating system can include a kernel e.g. UNIX kernel .

Memory may also store communication instructions to facilitate communicating with one or more additional devices one or more computers and or one or more servers. Memory may include graphical user interface instructions to facilitate graphic user interface processing sensor processing instructions to facilitate sensor related processing and functions phone instructions to facilitate phone related processes and functions electronic messaging instructions to facilitate electronic messaging related processes and functions web browsing instructions to facilitate web browsing related processes and functions media processing instructions to facilitate media processing related processes and functions GPS Navigation instructions to facilitate GPS and navigation related processes and instructions camera instructions to facilitate camera related processes and functions magnetometer data and calibration instructions to facilitate magnetometer calibration. The memory may also store other software instructions not shown such as security instructions web video instructions to facilitate web video related processes and functions and or web shopping instructions to facilitate web shopping related processes and functions. In some implementations the media processing instructions are divided into audio processing instructions and video processing instructions to facilitate audio processing related processes and functions and video processing related processes and functions respectively. An activation record and International Mobile Equipment Identity IMEI or similar hardware identifier can also be stored in memory . Memory can include location instructions that can be used to transmit a current location to an access point and to determine an estimated current location based on location data associated with access points to which the mobile device is within a communication range.

Each of the above identified instructions and applications can correspond to a set of instructions for performing one or more functions described above. These instructions need not be implemented as separate software programs procedures or modules. Memory can include additional instructions or fewer instructions. Furthermore various functions of the mobile device may be implemented in hardware and or in software including in one or more signal processing and or application specific integrated circuits.

The term computer readable medium refers to any medium that participates in providing instructions to processor for execution including without limitation non volatile media e.g. optical or magnetic disks volatile media e.g. memory and transmission media. Transmission media includes without limitation coaxial cables copper wire and fiber optics.

Computer readable medium can further include operating system e.g. Mac OS server Windows NT server network communication module database interface data collection module data distribution module and location calculation module as described in reference to . Operating system can be multi user multiprocessing multitasking multithreading real time etc. Operating system performs basic tasks including but not limited to recognizing input from and providing output to devices keeping track and managing files and directories on computer readable mediums e.g. memory or a storage device controlling peripheral devices and managing traffic on the one or more communication channels . Network communications module includes various components for establishing and maintaining network connections e.g. software for implementing communication protocols such as TCP IP HTTP etc. . Database interface can include interfaces to one or more databases e.g. LAC location database on a file system. The databases can be organized under a hierarchical folder structure the folders mapping to directories in the file system. Data collection module can include components for collecting data from multiple mobile devices wirelessly connected to system . Data distribution module can perform various functions for transmitting location data e.g. location records in association with LACs of a cellular communications network to various computing devices including mobile devices. Location calculation module can include one or more components e.g. location engine for performing calculations on locations received from mobile devices.

Architecture can be included in any device capable of hosting a database application program. Architecture can be implemented in a parallel processing or peer to peer infrastructure or on a single device with one or more processors. Software can include multiple software components or can be a single body of code.

The described features can be implemented advantageously in one or more computer programs that are executable on a programmable system including at least one programmable processor coupled to receive data and instructions from and to transmit data and instructions to a data storage system at least one input device and at least one output device. A computer program is a set of instructions that can be used directly or indirectly in a computer to perform a certain activity or bring about a certain result. A computer program can be written in any form of programming language e.g. Objective C Java including compiled or interpreted languages and it can be deployed in any form including as a stand alone program or as a module component subroutine a browser based web application or other unit suitable for use in a computing environment.

Suitable processors for the execution of a program of instructions include by way of example both general and special purpose microprocessors and the sole processor or one of multiple processors or cores of any kind of computer. Generally a processor will receive instructions and data from a read only memory or a random access memory or both. The essential elements of a computer are a processor for executing instructions and one or more memories for storing instructions and data. Generally a computer will also include or be operatively coupled to communicate with one or more mass storage devices for storing data files such devices include magnetic disks such as internal hard disks and removable disks magneto optical disks and optical disks. Storage devices suitable for tangibly embodying computer program instructions and data include all forms of non volatile memory including by way of example semiconductor memory devices such as EPROM EEPROM and flash memory devices magnetic disks such as internal hard disks and removable disks magneto optical disks and CD ROM and DVD ROM disks. The processor and the memory can be supplemented by or incorporated in ASICs application specific integrated circuits .

To provide for interaction with a user the features can be implemented on a computer having a display device such as a CRT cathode ray tube or LCD liquid crystal display monitor for displaying information to the user and a keyboard and a pointing device such as a mouse or a trackball by which the user can provide input to the computer.

The features can be implemented in a computer system that includes a back end component such as a data server or that includes a middleware component such as an application server or an Internet server or that includes a front end component such as a client computer having a graphical user interface or an Internet browser or any combination of them. The components of the system can be connected by any form or medium of digital data communication such as a communication network. Examples of communication networks include e.g. a LAN a WAN and the computers and networks forming the Internet.

The computer system can include clients and servers. A client and server are generally remote from each other and typically interact through a network. The relationship of client and server arises by virtue of computer programs running on the respective computers and having a client server relationship to each other.

A number of implementations of the invention have been described. Nevertheless it will be understood that various modifications can be made without departing from the spirit and scope of the invention. For example the location aware devices are referred to as GPS enabled. Location aware mobile devices are not necessarily based on GPS technology. For example mobile devices that can determine a location using triangulation are location aware mobile devices and can be used in determining a LAC location. Cells are represented as hexagons in the figures. The actual shape of a cell can vary. Locations are described as circles. The term circle used in this specification can include any geometric shape e.g. an ellipsis a square a convex or concave polygon or a free style shape that is not perfectly circular but is closed or has an appearance of an enclosure. The radius of a geometric shape that is not perfectly circular can include an average distance between various points on the boundary of the geometric shape and a center of the geometric shape. Accordingly other implementations are within the scope of the following claims.

