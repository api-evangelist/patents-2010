---

title: Playback apparatus and method of controlling a playback apparatus
abstract: According to one embodiment, a playback apparatus includes a multimedia processor configured to allocate a first stream buffer area in a first memory for storing a encoded video data, and includes a decoder configured to decode the encoded video data, a main processor configured to execute a decoding program application for decoding the encoded video data, and to execute a switching program application configured to switch a destination where the decoding is executed between the multimedia processor and the decoding program application such that a picture group which is a unit for managing the encoded video data is not separately supplied to two destinations, in response to a switching request, wherein the decoding program application is configured to allocate a second stream buffer area in a second memory for storing the encoded video data and a decoding buffer area in the second memory for storing data related to decoding.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07957628&OS=07957628&RS=07957628
owner: Kabushiki Kaisha Toshiba
number: 07957628
owner_city: Tokyo
owner_country: JP
publication_date: 20100126
---
This application is based upon and claims the benefit of priority from Japanese Patent Application No. 2009 015702 filed Jan. 27 2009 the entire contents of which are incorporated herein by reference.

One embodiment of the invention relates to a playback apparatus which can switch execution non execution of super resolution conversion and to a method of controlling a playback apparatus.

Recently a high definition HD television with a full specification featuring a resolution of 1920 1080 pixels has come into wide use. However the availability of full HD specification content is limited. For this reason high pixel conversion is performed with respect to conventional DVD content having Secure Digital SD quality. In this way the user sees a television broadcast using the full HD specification television.

The following document discloses a notebook personal computer which converts using a super resolution technique as high pixel conversion.

Document Akira KUMAGAI et al. Super resolution Technique Realizing High quality Video Toshiba Review Toshiba Inc. Nov. 1 2008 Vol. 63 No. 11 pp. 50 53 

Some methods are given as the method of high pixel conversion. For example there exist a bi cubic convolution method and a bi linear interpolation method. According to a bi cubic method using a super resolution technique the load on a processor is higher than the bi linear method.

At present it is difficult to execute the bi cubic method in real time using a personal computer. Considering the foregoing circumstances the following proposal has been made. According to the proposal a high speed processor executes super resolution conversion using a bi cubic method independently from a processor executing an operating system and applications.

For example an independent high speed processor is connected to a bridge circuit via a serial bus conforming to the PCI Express standard. According to the PCI Express standard a bidirectional communication is performed. In the PCI Express standard a unidirectional effective data transmission rate is about 250 MB s. On the other hand a transmission rate required for transmitting full HD quality video data is about 187 MB s. Therefore there is not so time to transmit the full HD quality video data according to the PCI Express standard. For this reason preferably data supplied to the independent processor is reduced as much as possible.

Whether the user likes an image after super resolution conversion greatly depends on his taste. For this reason the user has demands for dynamically changing execution non execution of super resolution while playback a moving image.

Various embodiments according to the invention will be described hereinafter with reference to the accompanying drawings. In general according to one embodiment of the invention a playback apparatus comprises a first memory a multimedia processor configured to allocate a first stream buffer area in the first memory for storing a encoded video data and comprising a decoding circuit configured to decode the encoded video data and an arithmetic module configured to execute super resolution conversion to increase a resolution of the decoded video data an issuing module configured to issue a switching request to switch between execution and non execution of the super resolution conversion a second memory and a main processor configured to execute a decoding program application for decoding the encoded video data and to execute a switching program application configured to switch a destination where the decoding is executed between the multimedia processor and the decoding program application such that a picture group which is a unit for managing the encoded video data is not separately supplied to two destinations in response to the switching request issued from the issuing module wherein the decoding program application is configured to allocate a second stream buffer area in the second memory for storing the encoded video data and a decoding buffer area in the second memory for storing data related to decoding and wherein the switching program application is configured to switch the destination from the multimedia processor to the decoding program application in a state that the encoded video data is not stored in the first stream buffer area of the first memory and to switch the destination from the decoding program application to the multimedia processor in a state that the encoded video data is not stored in the second stream buffer area and the data related to decoding is not stored in the decoding buffer area.

One embodiment of the present invention will be hereinafter described with reference to the accompanying drawings.

The configuration of a playback apparatus according to one embodiment of the present invention will be described below with reference to . For example the playback apparatus of this embodiment is realized from a notebook type mobile personal computer functioning as an information processing apparatus.

The personal computer can record and playback video content data audiovisual content data such as broadcast program data and video data input from external devices. In other words the personal computer has a television TV function for viewing and recording broadcast program data broadcast according to a television broadcast signal. For example the foregoing TV function is realized by a TV application program previously installed in the personal computer . Further the TV function has the following functions. One is a function of recording video data input from external AV devices. The other is a function of playback recorded video data and recorded broadcast program data.

The display unit is attached to the computer body so that it is freely rotatable between the following opened and closed positions. One is an opened position of exposing the upper surface of the computer body . The other is a closed position of covering the upper surface of the computer body . The computer body has a thin box shape. The upper surface of the computer body is provided with a keyboard a power button for turning on off the power of the computer . Further the upper surface is provided with an input operation panel a touchpad speakers A and B.

The input operation panel is an input device which inputs the event corresponding to the pushed button. The input operation panel includes a plurality of buttons for starting each of several functions. The foregoing button group includes an operation button for controlling a TV function viewing recording playback recorded broadcast program data video data . The front side of the computer body is provided with a remote controller unit interface . The remote controller unit interface performs a communication with a remote controller unit for remote controlling the TV function of the computer . The remote controller unit interface comprises an infrared signal receiver.

For example the right side of the computer body is provided with a TV broadcast antenna terminal . Further the back side of the computer body is provided with an external display connection terminal conforming to the High Definition Multimedia Interface HDMI standard. The external display connection terminal is used for outputting video data moving image data included in video content data such as broadcast program data to an external display.

As shown in the computer includes a CPU main processor a north bridge a main memory a south bridge and a graphics processing unit GPU sub processor . Further the computer includes a video memory VRAM A a sound controller a BIOS ROM a LAN controller a hard disk drive HDD a DVD drive and a multimedia processor . Furthermore the computer includes a memory A a wireless LAN controller an IEEE 1394 controller an embedded controller keyboard controller IC EC KBC and a TV tuner .

The CPU is a processor for controlling the operation of the computer . The CPU executes an operating system OS loaded from the hard disk drive HDD into the main memory and various application programs such as a DVD application program . The DVD application program is software for playing back a DVD loaded in the DVD drive . Further the CPU executes a basic input output system BIOS stored in the BIOS ROM . The BIOS is a program for controlling hardware.

The north bridge is a bridge device which performs a connection between a local bus of the CPU and the south bridge . The north bridge has a built in memory controller for controlling an access to the main memory . Further the north bridge has a function of performing a communication with the GPU via a serial bus conforming to the PCI Express standard.

The GPU is a display controller which controls a LCD used as a display monitor of the computer . A display signal generated by the GPU is supplied to the LCD . Moreover the GPU can transmit a digital video signal to an external display device via an HDMI control circuit and an HDMI terminal .

The HDMI terminal is a connection terminal of the foregoing external display. The HDMI terminal can transmit a non compressed digital video signal and a digital audio signal to the external display device such as a television via a single cable. The HDMI control circuit is an interface for transmitting a digital video signal to an external display device called as an HDMI monitor via the HDMI terminal .

The south bridge controls various devices on a Low Pin Count LPC bus and various devices on a Peripheral Component Interconnect PCI bus. Further the south bridge has a built in Integrated Drive Electronics IDE controller for controlling the hard disk drive HDD and the DVD drive . Furthermore the south bridge has a function of performing a communication with the sound controller .

The south bridge is connected with a multimedia processor via a serial bus conforming to the PCI Express PCIe standard.

The memory A is used as a work memory for the multimedia processor . The multimedia processor is configured in such a manner that an MPEG 2 decoding circuit and four operation cores to are carried on one chip. In this case the MPEG 2 decoding circuit is provided in order to decode compressed and coded video data. Each of the operation cores to has high media processing performance and high power consumption against performance. When the DVD application program plays back a DVD the MPEG 2 decoding circuit decodes video data of the DVD. Four operation cores to execute interlace progressive conversion IP conversion with respect to video data having a resolution of 720 480 pixels decoded by the decoding circuit . The foregoing four operation cores to execute super resolution conversion. According to the super resolution conversion SD quality video data having a resolution of 720 480 pixels is converted to HD quality video data having a resolution of 1920 1080 pixels. A bi cubic method cubic convolutional interpolation CC method is used for the super resolution conversion by the multimedia processor . A large number of operations are required in order to execute super resolution conversion using the bi cubic method. According to this embodiment operation cores to of the multimedia processor which is a special processor different from the CPU are used as a backend processor. In this way super resolution conversion is executed by the multimedia processor . Therefore it is possible to execute super resolution conversion without increasing the load on the CPU .

The DVD application program has a decoding module executed by the CPU to decode video data. When decoding is executed using the decoding module of the DVD application program video data decoded for displaying video data on the LCD is converted as follows. Specifically SD quality video data having a resolution of 720 480 pixels is converted to HD quality video data having a resolution of 1920 1080 pixels using a high pixel conversion function of the GPU . According to the high pixel conversion function of the GPU processing is reduced the amount of calculation is small compared with the bi cubic method cubic convolutional interpolation CC method . However high pixel conversion is performed according to a bi linear method of degraded image quality.

In this case the GPU performs high pixel conversion using the bi linear method however this results from the following case. Namely the resolution of video data input to the GPU is different from the resolution to be output from the LCD and the HDMI terminal . If the resolution to be output is the same as the resolution input to the GPU the GPU does not execute the foregoing high pixel conversion.

The user can select how to execute decoding and high pixel conversion. Specifically decoding and high pixel conversion are performed using the multimedia processor . Or decoding and high pixel conversion are performed by combining the DVD application program and the GPU . In the following description the case of executing decoding and high pixel conversion by the multimedia processor is called an up convert by the multimedia processor .

The sound controller is a sound source device. The sound controller outputs a playback target audio data to speakers A and B or the HDMI control circuit .

The wireless LAN controller is a wireless communication device which performs a wireless communication conforming to the IEEE 802.11 standard for example. The IEEE 1394 controller performs a communication with external apparatuses via a serial bus conforming to the IEEE 1394 standard.

The embedded controller keyboard controller IC EC KBC is a one chip microcomputer configured in the following manner. Specifically an embedded controller for power management a keyboard controller for controlling a keyboard KB and a touchpad are integrated on one chip. The embedded controller keyboard controller IC EC KBC has a function of turning on off the power of the computer in accordance with the operation of the power button by the user. Further the embedded controller keyboard controller IC EC KBC has a function of performing a communication with the remote controller unit interface .

The TV tuner is a receiver which receives broadcast program data broadcast by a television TV broadcast signal. The TV tuner is connected to an antenna terminal . For example the TV tuner is realized as a digital TV tuner which is capable of receiving digital broadcast program data such as digital terrestrial TV broadcasting. Further the TV tuner has a function of capturing video data input from external devices.

The data structure defined in the DVD video system and its management information will be described below.

One navigation pack NV PCK is arranged to be position on the header of one VOBU. The navigation pack NV PCK is control data which is made a reference when data of the belonging VOBU is played back. The navigation pack NV PCK is composed of data search information DSI and a picture control information PCI .

The foregoing PCI shows start presentation time and end presentation time of the VOBU. The PCI shows non seamless angle information and has a VOBU address to be played back next to each angle when a played back video stream angle is switched. Further the PCI has highlight information and includes start presentation time of the highlight information end presentation time thereof button display position information.

The foregoing DSI has a system clock of NV PCK including DSI as general information a VOBU end address and a VOBU reference I picture end address. The DSI has a VOBU category an interleave unit i.e. unit segmented as a multi angle switch unit end address size and start address of the next interleave unit to be jumped video start and end addresses of the VOB as seamless playback information SML PBI . Further in the DSI the next interleave unit address and size are prepared by the number of angles as seamless angle information SML AGLI . In the DSI VOBU search information VOBU SRI is prepared as information used for the case of executing special playback such as frame forward and frame backward. The header address of several VOBUs before and after this VOBU is described. In the DSI audio and sub picture address to be synchronized at the corresponding VOBU position are described as synchronous information SYNC .

As described above the presentation time stamp PTS is described in each pack. Reproduction is performed in cooperation with the PTS and time information obtained from the system clock of the playback apparatus. In this way playback of video audio and sub picture is synchronized.

The video object unit VOBU includes group of pictures GOP so that they are not divided. The group of pictures GOP is composed of an I picture and a B picture. The continuous data is divided into a video pack. The foregoing GOP is a video data management minimum unit in MPEG 2. Reproduction is executed at the GOP unit for this reason if a part of the GOP is lack a decoder cannot correctly decode the GOP.

According to the DVD video specification a sequence header must be added before all GOP. The sequence header includes information on a video stream such as an aspect ratio a bit rate a picture resolution and a frame rate.

The present apparatus uses a different decoder in up convert and non up convert. Therefore in order to make a switch of up convert non up convert the decoder must be switched so that the GOP is divided. Therefore correction that is the decoder must be switched at the segment of neighboring GOP. For this reason if the user operates a switch of up convert non up convert the present apparatus detects the sequence header and then switches the decoder at the segment of neighboring GOP.

The play button is provided so that the user gives instructions to play back the content to the DVD application program . The stop button is provided so that the user gives instructions to stop playback to the DVD application program . The pause button is provided so that the user gives instructions to temporarily stop playback to the DVD application program . The fast forward button is provided so that the user gives instructions to perform fast forward playback to the DVD application program . The fast re window button is provided so that the user gives instructions to perform fast backward playback to the DVD application program . The forward slow playback button is provided so that the user gives instructions to perform forward slow playback to the DVD application program . The next chapter button is provided so that the user gives instructions to perform playback from the header of the next chapter to the DVD application program . The pre chapter button is provided so that the user gives instructions to perform playback from the header of the pre chapter to the DVD application program . The one touch replay button is provided so that the user gives instructions to perform playback before about 10 seconds from the present playback position to the DVD application program . The one touch skip button is provided so that the user gives instructions to perform playback after about 30 seconds from the present playback position to the DVD application program . The repeat button is provided so that the user gives instructions to perform repeat playback and cancel of the title to the DVD application program . The sound switch button is provided so that the user gives instructions to switch a playback language to the DVD application program . The title switch button is provided so that the user gives instructions to switch a title language to the DVD application program . The drive folder designation button is provided so that the user gives instructions to designate drive folder to the DVD application program . The angle switch button is provided so that the user gives instructions to switch an angle to the DVD application program . The eject button is provided so that the user gives instructions to eject an optical disk from the DVD drive to the DVD application program . The return button is provided so that the user gives instructions to perform a return operation to the DVD application program . The menu button is provided so that the user gives instructions to display a menu to the DVD application program . The top menu button is provided so that the user gives instructions to display a top menu to the DVD application program . The mute button is provided so that the user gives instructions to mute an output sound to the DVD application program . The chapter title search button is provided so that the user gives instructions to search a chapter or title to the DVD application program .

The user moves a pointer on the up convert switch button and thereafter presses the left button of a mouse and thereby a switch of up convert non up convert is performed. When the present apparatus is in an up convert state a character up convert is displayed on the up convert state display area . Conversely when the present apparatus is in a non up convert state the character up convert is not displayed on the up convert state display area .

The Microsoft Corporation has provided Direct Show before providing MediaFoundation. According to Direct Show there exists a concept of stopping playback of multimedia contents. A software application using Direct Show receives a command showing stoppage issued by Direct Show and thereby it is possible to know that playback of multimedia contents is stopped. However according to the MediaFoundation there exists no concept of stopping playback of multimedia contents. A software application using MediaFoundation cannot know the stoppage of multimedia contents.

According to the MediaFoundation a clear command is issued to a processor in order to clear the content of a cache of a work memory used by the processor which executes decoding when content playback is stopped. Therefore when the playback is stopped the content of the cache of the work memory is cleared. This means that the cache area of the work memory is checked and thereby it is determined whether or not playback is stopped.

DVD data played back by the DVD drive is supplied to a navigation manager . The navigation manager separates the DVD data into a video pack V PCK a sub picture pack SP PCK and an audio pack A PCK . The navigation manager transfers the audio pack A PCK to an audio decoder module . Further the navigation manager transfers the video pack V PCK and the sub picture pack SP PCK to a video decoder module .

The audio decoder module decompresses compressed sound information to convert it to non compressed audio data and thereafter transfers the audio data to an audio rate converter module . The audio rate converter module converts the audio data to a proper sampling rate and thereafter transfers it to an audio renderer . The audio renderer synthesizes the transferred audio data and audio data generated by other software running on the computer and then transfers the synthesized audio data to an audio driver . The audio driver controls the sound controller so that the audio data is output from speakers and B.

If line data is included the video decoder module transfers the line data to a line decoder module . The video decoder module decompresses a video pack V PCK and a sub picture pack SP PCK using an internal decoder module or the multimedia processor . When the multimedia processor decompresses the video pack V PCK interlace progressive conversion IP conversion and high pixel conversion are carried out with respect to the video data decompressed by the multimedia processor. The decompressed video data is supplied to an extension video renderer EVR . A mixer A of the extension video renderer executes mixing of video with sub picture and displays title. Video data mixed by the mixer A is subjected to high quality processing by a high quality engine B. The video data subjected to high quality processing is transferred to a display driver . The display driver controls the GPU so that a video image is displayed on the LCD .

A player shell user interface executes a processing related to display of the playback control panel . The player shell user interface gives notification of a command corresponding to a button operated by the user to MediaFoundation via a graph manager . The MediaFoundation controls the navigation manager the audio decoder module and the video decoder module in accordance with the given command.

As shown in the module is composed of a player shell user interface a navigation manager a video decoder module a multimedia processor an extension video renderer and a display driver .

A switch request issuance module of the player shell user interface issues a switch request to the video decoder module when the user operates the up convert switch button .

The video decoder module has a provision target switch module a CPU GPU decoding module and a multimedia processor decoding module MMP decoding module . The provision target switch module transfers a compressed video data supplied from the navigation manager to one of the CPU GPU decoding module and the MMP decoding module .

When detecting a switch request issued by the switch request issuance module the provision target switch module starts to transfer the compressed video data transferred to one of the CPU GPU decoding module and the MMP decoding module to the other of the same as above.

The CPU GPU decoding module is a software application executed by the CPU. The CPU GPU decoding module decompresses the transferred video data using a decode support function by the GPU to generate non compressed video data and thereafter transfers the generated video data to the extension video renderer .

The CPU GPU decoding module secures a stream buffer area and a decoding buffer area in a part of the main memory . The stream buffer area is temporarily stored with a stream of the video data supplied from the provision target switch module . The CPU GPU decoding module reads the video data stream stored in the stream buffer area to decode the read data. In decoding the module stores data related to decoding in the decoding buffer area.

The MMP decoding module transfers a stream of video data compressed in the MPEG 2 format to the multimedia processor . The multimedia processor temporarily stores the transferred stream in a stream buffer area of a memory A. Then the multimedia processor reads the video data stream stored in the stream buffer area. Thereafter the multimedia processor decodes the read data using the MPEG 2 decoding circuit to generate interlaced video data having a resolution of 720 480 or 720 576 pixels. Then the multimedia processor executes IP conversion and CC processing up convert using bi cubic method with respect to the decoded video data using operation cores to . In this way a video data having a resolution of 1920 1080 pixels and YUV focusing mat is generated. Then the multimedia processor returns the up converted video data to the MMP decoding module . The MMP decoding module transfers the returned video data to the extension video renderer .

As seen from the provision target switch module executes the following procedure after the user instructs a switch of up convert non up convert. Namely the module starts to transfer the video data at the segment of neighboring GOP to the other of the CPU GPU decoding module and the MMP decoding module . shows the case where the user instructs up convert to perform up convert playback from a state that playback is performed at non up convert SD quality. shows the case where the user instructs non up convert to perform playback at non up convert SD quality from a state that playback is performed at up convert HD quality.

The procedure executed by the provision target switch module will be described below with reference to a flowchart shown in .

The provision target switch module determines whether or not a switch request is received block S . If the switch request is received Yes in block S the module determines whether or not super resolution conversion is valid block S . If the module determines that the super resolution conversion is valid Yes in block S the module determines whether or not data is stored in a stream buffer area of the memory A block S .

If the provision target switch module determines that data is not stored in the stream buffer area No in block S the module gives instructions to release the multimedia processor to the MediaFoundation . Then the MediaFoundation releases the multimedia processor block S . After the foregoing release of the multimedia processor the module supplies a stream of video data to the CPU GPU decoding module block S .

In block S if the provision target switch module determines that data is stored in the stream buffer area Yes in block S the multimedia processor executes decoding and super resolution conversion. Therefore the provision target switch module detects a sequence header. If the sequence header is detected Yes in block S the provision target switch module stops the supply of video data stream to the MMP decoding module block S . Thereafter the module determines whether or not data is stored in the stream buffer area of the A block S . If no data is stored in the stream buffer area No in block S the module gives instructions to release the multimedia processor to the MediaFoundation . Then the MediaFoundation releases the multimedia processor block S . After the foregoing release of the multimedia processor the module supplies a stream of video data to the CPU GPU decoding module block S .

In block S if the module determines that super resolution conversion is not valid No in block S the module determines whether or not data is stored in a stream buffer area A and a decoding buffer area B of the memory block S . If it is determined that data is stored in the stream buffer area A and in the decoding buffer area B No in block S the supply is stopped for this reason the provision target switch module gives instructions to acquire the multimedia processor to the MediaFoundation . The MediaFoundation acquires the multimedia processor block S . The module provides a video data stream to the MMP decoding module block S .

In block S if it is determined that data is stored in the stream buffer area A and in the decoding buffer area B No in block S playback is performing. Therefore the provision target switch module detects a sequence header. If the sequence header is detected Yes in block S the module stops the supply of a video data stream to the CPU GPU decoding module block S . Then the module determines whether or not data is stored in the stream buffer area A and in the decoding buffer area B block S . If no data is stored in the stream buffer area No in block S the module gives instructions to acquire the multimedia processor to the MediaFoundation . The MediaFoundation acquires the multimedia processor block S . After the multimedia processor is acquired the module supplies a video data stream to the MMP decoding module block S .

The foregoing computer has the configuration such that the multimedia processor has a built in decoding circuit. Therefore the compressed video data is supplied to the multimedia processor and thereby it is possible to reduce data transmitted to the multimedia processor compared with the case where decoded video data is supplied to the multimedia processor .

In addition the sequence header is detected and thereby a transfer target of the compressed video data is switched. In this way it is possible to dynamically perform a switch of up convert non up convert.

The various modules of the systems described herein can be implemented as software applications hardware and or software modules or components on one or more computers such as servers. While the various modules are illustrated separately they may share some or all of the same underlying logic or code.

While certain embodiments of the inventions have been described these embodiments have been presented by way of example only and are not intended to limit the scope of the inventions. Indeed the novel methods and systems described herein may be embodied in a variety of other forms furthermore various omissions substitutions and changes in the form of the methods and systems described herein may be made without departing from the spirit of the inventions. The accompanying claims and their equivalents are intended to cover such forms or modifications as would fall within the scope and spirit of the inventions.

