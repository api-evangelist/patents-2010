---

title: Access restricted file and access restricted file creating
abstract: Disclosed are an access restricted file and an restricted file creating apparatus for creating the access restricted file concerned, which makes it possible for an information processing apparatus to request a management server to determine whether the access right is present or absent. The apparatus includes a creating section to create the access restricted file that includes data, an accessing operation for which is restricted, and confirming destination information that represents the management server that confirms a presence or absence of the access right in regard to the operation for accessing the data. On the other hand, the access restricted file includes a program, being executable by a CPU of the information processing apparatus provided with a communicating function, to cause the CPU to perform a processing for requesting the management server, represented by the confirming destination information, to confirm the presence or absence of the access right.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08893305&OS=08893305&RS=08893305
owner: Konica Minolta Business Technologies, Inc.
number: 08893305
owner_city: 
owner_country: JP
publication_date: 20100121
---
This application is based on Japanese Patent Application NO. 2009 018676 filed on Jan. 29 2009 with Japan Patent Office the entire content of which is hereby incorporated by reference.

The present invention relates to an access restricted file to which an access restriction is applied by employing a cryptographic method etc. and an access restricted file creating apparatus that creates the access restricted file concerned.

Generally speaking when certain important data is taken out to an external environment and or distributed over the external environment an access restriction processing employing a cryptographic method etc. is applied to the data concerned.

If the concerned data was simply encrypted on that occasion it becomes impossible to monitor and maintain the security of the data concerned in case that a key of cryptograph has been obtained by using a certain illegal method and the encrypted data has been decrypted by using the above obtained key of cryptograph. Further after the encrypted data provided with an access restriction has been distributed widely there would possibly occur such a case that the user or manager wishes to change the contents of restriction information such as heightening the security level of the concerned data changing the current password etc.

With respect to the print restriction of document data Tokkai 2005 309881 Japanese Patent Application Laid Open Publication sets forth a system for which the abovementioned problems and demands are taken into account. The disclosed system is so constituted that the management server controls the restriction information such as a key of cryptograph IDs Identification of a printer and a document allowed to be used for printing etc. while the printer which is instructed to conduct an operation for printing a document based on the encrypted document data transmits the document ID of the encrypted document data concerned and the printer ID of its own etc. to the management server so as to inquire an allowance or disallowance of the concerned printing operation and then only in the case of allowance the printer decrypts the encrypted document data by using the key of cryptograph owned by the management server so as to implement the printing operation based on the decrypted document data. According to the above disclosed system the access restriction can be achieved by employing the restriction information such as the printer ID the document ID etc. and in addition by changing the restriction information to be registered into the management server it is possible to change the conditions for determining the allowance or disallowance of the concerned printing operation.

According to the technology set forth in the Tokkai 2005 309881 when the user has taken out important encrypted data to a remote destination site of a business trip or the like the printer that can print an image based on the encrypted data is limited to only such a printer that is provided with a function for accessing the management server. For this reason unless the printer provided with such the function exists in the remote destination site it is impossible for the user to decrypt the encrypted data so as to print an image represented by the decrypted data even though it is possible to change the restriction information registered in the management server for instance the printer ID of the printer allowed to be used for printing .

To overcome the abovementioned drawbacks in conventional systems it is one of objects of the present invention to provide an access restricted file and an restricted file creating apparatus for creating the access restricted file concerned which makes it possible for the information processing apparatus to request the management server to determine whether the access right is present or absent.

Accordingly at least one of the objects of the present invention can be attained by any one of the access restricted files and the restricted file creating apparatuses described as follows.

Referring to the drawings the preferred embodiment of the present invention will be detailed in the following.

The image forming apparatus is such an apparatus that is generally called an MFP Multi Function Peripheral which is provided with a copy function for optically reading an image residing on a document to print its copy image onto a recording paper sheet a scanning function for creating a file into which the image data read from the document is stored and for transmitting the created file to an external terminal device a printing function for forming an image in regard to a print job received from the external terminal device being a personal computer or the like onto the recording paper sheet so as to output the printed paper sheet a facsimile function for transmitting and receiving the image data concerned etc. In this connection hereinafter the image forming apparatus is also referred to as the MFP.

Each of the image forming apparatuses is attached with an individual apparatus ID Identification . In the exemplary configuration shown in the apparatus ID of the image forming apparatus MFP1 is defined as A 20 001 the apparatus ID of the image forming apparatus MFP2 is defined as A 20 002 the apparatus ID of the image forming apparatus MFP3 is defined as A 30 001 and the apparatus ID of the image forming apparatus MFP4 is defined as A 30 002 . By using the above defined apparatus IDs it becomes possible for each of the image forming apparatuses to specify the MFP driver being currently available for the image forming apparatus concerned.

The image forming apparatus is further provided with functions as the restricted file creating apparatus that encrypts the image data stored in its own storage and or the data sent from the external terminal device such as the terminal device etc. and further creates a restricted file including such data that is formed by combining the above created encrypted data with information for restricting various kinds of processing to be implemented at the time when decrypting the above created encrypted data and or to be applied to the decrypted data such as an access start processing an access page shift page change processing a print processing a change processing a copy processing etc.

The restricted file is outputted from the image forming apparatus to the terminal device and utilized in the terminal device serving as an output destination site. In addition for instance the restricted file is stored into USB Universal Serial Bus storage which is to be carried into an external environment so as to use the restricted file in a certain external apparatus. Even if the restricted file is carried into the external environment the restricted file is provided with such a data structure that is available in an arbitral terminal device while maintaining its security aspect.

Concretely speaking the restricted file is provided with such a data structure that includes an encrypted data a header and a self decompression application program serving as self decompression type software. Confirming destination information for instance address information indicating a management server serving as a destination site that confirms an accessing right in regard to the operation for decrypting the encrypted data and the decrypted data is registered in the header . The system embodied in the present invention is so constituted that the image forming apparatus which has created the restricted file also serves as the management server that confirms the accessing right for the above created restricted file .

The self decompression application program included in the restricted file is such a program that implements its self decompression operation in response to a predetermined operation such as a double clicking etc. conducted for the restricted file in an arbitral information processing apparatus having a communication function so as to make the self decompression application program itself executable by the CPU. The self decompression application program after its self decompression operation is completed is executed to make the concerned information processing apparatus which is provided with the communication function and into which the self decompression application program is loaded implement the processing for requesting the operation for confirming the implementation right access right of various kinds of operations with respect to the operation for decrypting the encrypted data and the decrypted data to the management server indicated by the address information included in the header .

For instance the utilizing mode of the restricted file includes an operation P for outputting the restricted file created by applying the encryption processing to the image data in the image forming apparatus based on the request sent from the terminal device coupled to the first LAN and an operation P for taking out a USB Universal Serial Bus storage into which the above created file is stored in order to implement various kinds of operations with respect to the operation for decrypting the encrypted data and the decrypted data in the terminal device coupled to the second LAN . On that occasion when the restricted file is double clicked in the terminal device the self decompression application program after its self decompression operation is completed is executed to read out the confirming destination information for instance address information included in the header so as to make the terminal device request the management server indicated by the confirming destination information image forming apparatus to confirm a presence or absence of the access right P . At the time when confirming a presence of the access right the image forming apparatus transmits the key of cryptograph to the terminal device P . Receiving the key of cryptograph the terminal device employs the received key of cryptograph for decrypting the encrypted data to implement the printing operation based on the decrypted data etc. P .

The ROM stores various kinds of programs therein so that the CPU executes each of the programs so as to implement each of the functions provided in the image forming apparatus . The RAM stands for a Random Access Memory that serves as various kinds of versatile storages such as a working storage into which various kinds of data are temporarily stored when the CPU executes the current program an image data storage into which various kinds of image data are stored a communication buffer storage into which data in regard to the transmitting and receiving operations are temporarily stored etc.

The HDD serves as a nonvolatile mass storage device. The HDD stores a management table to register various kinds of data in regard to the functions as the management server therein. In addition a box serving as a memory area to be controlled for every user or every group is also created in the HDD . Image data etc. are stored into the box . An operation for accessing the box is restricted by employing a password etc.

The nonvolatile storage serves as a rewritable storage which retains currently stored contents even if the electric power supplied from the power source is turned OFF. When the restricted file is created by encrypting data the nonvolatile storage stores information file path information for locating the encryption objective data etc. therein. Other than the above the nonvolatile storage also stores various kinds of setting contents established in regard to the image forming apparatus user information user authentication information an apparatus ID system information address information of the image forming apparatus concerned such as an IP Internet Protocol address a URL Uniform Resource Locator as the management server etc. a name and version information of an application program MFP driver being necessary for implementing communications with the image forming apparatus concerned etc. therein.

The operating display section is constituted by a LCD Liquid Crystal Display a touch panel that is mounted over the LCD screen to detect a coordinate position at which the touch panel is depressed by a finger a touch pen or the like and various kinds of operating buttons such as a ten key a start button etc. so as to display various kinds of screens such as operating screens setting screens warning message screens etc. on the LCD screen and to accept various kinds of operations conducted by the user. For instance the user authenticating operation is achieved by accepting the user ID and the password inputted by the user from the operating display section and then by collating them with the user authentication information registered in advance. Other than the above it is also applicable that the system is so constituted that the user authenticating operation is implemented by communicating with a individual authenticating wireless card possessed by the user currently residing near the image forming apparatus so as to read out the user information from the wireless card concerned.

The facsimile communication section performs various kinds of operations for controlling the facsimile transmission and the facsimile reception such as a dialing operation a call accepting operation an operation for establishing a connection with telephone line etc.

The network communication section implements a function for communicating with the other image forming apparatus and or the terminal device through the network such as the LAN etc. so as to transmit and receive various kinds of data and information.

The image processing section is provided with functions for applying various kinds of image processing to image data such as a rasterizing operation for converting the print data received from the terminal device to image data bitmap data an image data compression expansion processing a data encryption decryption processing an image rotation processing etc.

The scanner section implements a function for optically reading an image residing on the document so as to acquire image data representing the image concerned. For instance the scanner section is constituted by a light source to emit a light beam to be scanned on the document a line image sensor to convert the light beam reflected from the document to electric signals for every scanning line in a width direction of the document a reading position shift mechanism to sequentially shift the reading position toward a longitudinal direction of the document in a unit of every scanning line an optical path including lenses mirrors etc. to introduce and focus the light beam reflected from the document onto the line image sensor an analogue to digital converter to convert the analogue image signals outputted by the line image sensor to the digital image data etc.

The printer section implements a function for printing the image represented by the digital image data onto the recording paper sheet. The printer section is constituted by various kinds of structural elements being necessary for an image forming process employing the electro photographic method such as a conveyance mechanism for conveying the recording paper sheet a photoreceptor drum a charging device a laser unit a developing device a transferring separation device a cleaning section a fixing device etc. Accordingly the printer section is configured as a laser printer so to speak. However it is needless to say that another printer employing any other image forming method is also applicable as well.

The ROM stores a boot program to be executed by the CPU and various kinds of fixed data therein. On the other hand the nonvolatile storage stores user information and a user ID of the user who use the terminal device concerned authenticating information of the user identifying information of the terminal device concerned terminal device ID an IP address etc. therein.

Further the HDD stores an OS Operating System program various kinds of application programs to be executed on the OS program a MFP Multi Function Peripheral driver etc. When executing any one of the MFP driver and the application programs the CPU reads out the concerned program from the HDD and develops it on the RAM so as to execute the concerned program developed on the RAM .

The operating section is constituted by a keyboard a mouse pointing device etc. so as to accept the user s operation for inputting documents the user s instruction for implementing the operation for designating or processing the data and or file serving as a printing object or an encrypting object. The display device is constituted by a LCD Liquid Crystal Display etc. so as to display various kinds of screens such as operating screens setting screens warning message screens etc. on the LCD screen based on the display data created by the MFP driver the application programs and the OS program . The network interface section receives and transmits various kinds of data from to the image forming apparatus the other terminal device etc. through the network such as the first LAN the second LAN etc.

When receiving the operation for activating the restricted file such as the double clicking operation etc. the terminal device activates the self decompression application program so as to conduct its self decompressing operation and then implements a controlling operation to make the CPU execute the self decompressed application program concerned. Further the CPU executes the application programs so as to conduct operations for accepting the instructions for accessing copying updating documents and or images etc. and to implement actions corresponding to the above operations. Based on the self decompressed application program concerned the CPU monitors the operations and the actions to be conducted on the basis of the application programs . Concretely speaking the CPU monitors the state that the accessing operation and various kinds of the other operations to be conducted with respect to the decrypted data acquired by decrypting the encrypted data stored in the restricted file are conducted through the application programs so as to perform a processing for inquiring a presence or absence of the access right in regard to the accessing operation and the other operations from the management server indicated by the confirming destination information included in the header to confirm it.

The apparatus ID is constituted by a first attribute indicating a company code a second attribute indicating a model code and a third attribute indicating a product code. For instance the apparatus ID of A 20 001 includes the first attribute of A the second attribute of 20 and the third attribute of 001 . However the scope of the data structure of the apparatus ID is not limited to the above.

Further in the present embodiment the application program information is defined as such information that indicates the MPF driver corresponding to the image forming apparatus which created the restricted file concerned. Still further the confirming destination information is defined as network address information of the image forming apparatus which created the restricted file concerned. For instance the URL or the IP address in conformity with the HTTP Hyper Text Transfer Protocol is registered as the confirming destination information.

Yet further the restricted file ID is such an identification information that is given to the restricted file concerned by the image forming apparatus .

The processing to be performed by executing the self decompressed application program acquired by self decompressing the self decompression application program includes 

When the terminal device transmits the command signal for requesting the image forming apparatus to implement processing for encrypting the data transmitted from the terminal device so as to create the restricted file the communication sequence to be conducted between the terminal device and the image forming apparatus includes the operations indicated as follow.

In this connection the Ack signal is defined as such a signal that is to be sent from the image forming apparatus to the terminal device so as to notify the terminal device of the fact that the image forming apparatus has received the command signal.

Next the operations to be performed for creating the restricted file will be detailed in the following.

The operations to be performed for creating the restricted file includes Case in which the data stored in the box etc. of the image forming apparatus is encrypted so as to create the restricted file and the above created restricted file is outputted to the terminal device or Case in which the terminal device transmits the encryption objective data to the image forming apparatus and the image forming apparatus encrypts the received data so as to create the restricted file and then the image forming apparatus sends the above created restricted file back to the terminal device . Each of Case and Case will be detailed in the following.

Based on the request of copy operation or the request of move operation sent from the terminal device the image forming apparatus performs such the operations that the data stored in the box etc. of the image forming apparatus is encrypted so as to create the restricted file including the encrypted data concerned and the above created restricted file is outputted to the terminal device serving as the sender of the request. Since the box data is included in the restricted file as the encrypted data the security of the box data is maintained even if it is brought into the external environment.

Successively when determining that the operation objective data is not important Step S No the CPU of the image forming apparatus reads out the concerned data from the box so as to transmits the above readout data to the terminal device serving as a requester of the concerned copy operation Step S and finalizes the processing END .

Still successively when determining that the operation objective data is important Step S Yes the CPU of the image forming apparatus further determines whether or not the concerned data has been already encrypted has been converted to the restricted file Step S . When determining that the concerned data has been already encrypted Step S Yes the CPU transmits the restricted file including the above encrypted data to the terminal device serving as a requester of the concerned copy operation Step S and finalizes the processing END .

When determining that the concerned data has not been encrypted Step S No the CPU of the image forming apparatus acquires the operation objective data and its file path information Step S so as to store the operation objective data and its file path information concerned into the nonvolatile storage Step S and then encrypts the operation objective data Step S .

Successively the CPU collects and acquires the information which is necessary to create the header of the restricted file Step S . For instance the user ID included in the request of copy operation is also employed as a user ID to be included in the header . Other than the user ID the CPU acquires various kinds of information including an apparatus ID application program information such as the name of the MFP driver the version information etc. and confirming destination information such as the address information including its IP address the URL by reading out them from the nonvolatile storage of its own.

Still successively based on the information collected and acquired in the above the CPU generates the header so as to create the restricted file including the header concerned the encrypted data generated in Step S and the self decompression application program predetermined Step S . In this connection since the self decompression application program is stored in advance in the HDD or the ROM the system if so constituted that the self decompression application program is included into the restricted file by copying it from the HDD or the ROM to the restricted file .

Yet successively the CPU of the image forming apparatus registers the management information in regard to the restricted file created in the above into the management table Step S . As shown in the user ID and the apparatus ID being same as those registered into the header of the restricted file the key of cryptograph for the encrypted data included in the restricted file and the condition information to be used for confirming the access right are registered into the management information while correlating them with the restricted file ID serving as the identification information for specifying the restricted file concerned.

The condition information includes various kinds of information such as identification information user ID for specifying the user whose access right is to be allowed allowed user identification information terminal device ID for specifying the information processing apparatus or the terminal device an access right of which is to be allowed allowed terminal device identification information name of operation or operation ID for specifying the operation an accessing operation of which is to be allowed allowed operation a term of allowing the accessing operation allowed term etc. It is applicable that the allowed user the allowed terminal device the allowed term etc are established for every one of the allowed operations. Further it is also applicable that the allowed term is designated by an absolute date such as a combination of year month day and time etc. or designated by for instance a relative term elapsing from a certain original time point such as 3 days from the initial accessing operation etc.

Returning to the flowchart shown in to continue the explanation of the processing procedure the CPU of the image forming apparatus stores the restricted file created in Step S according to the file path represented by the file path information stored in the nonvolatile storage in Step S Step S and then transmits the concerned restricted file to the terminal device serving as a requester of the concerned copy operation Step S and finalizes the processing END .

In this connection operations and a sequence to be conducted at the time when the concerned data is moved from the box to the terminal device are similar to those to be conducted at the time when the request of implementing the copy operation is received.

In Case the image forming apparatus and the terminal device perform such the operations that the terminal device transmits the encryption objective data to the image forming apparatus and the image forming apparatus encrypts the received data so as to create the restricted file and then the image forming apparatus sends the above created restricted file back to the terminal device . In Case the MFP driver is automatically booted up when the user inputs the instruction with respect to the printing operation by using the application programs installed in the terminal device so as to make it possible for the user to input various kinds of settings and implementation instructions in regard to the encrypting operation from the operation inputting screen provided by the MFP driver concerned.

Successively the user conducts an operation for designating the encryption objective data. When a property button is depressed the CPU makes the display device display a property screen shown in . The property screen is provided with tubs corresponding to various kinds of setting items and a security tub is currently selected in the property screen shown in . Accordingly by using the current screen selected by the security tub it is possible for the user to input various kinds of user s operations such as an operation for designating the encryption objective data an operation for establishing the allowable conditions conditional information an operation for instructing the implementation of the encrypting operation etc.

The file path and the file name are inputted into the objective data designation area . While status information in regard to the encryption objective data concerned is displayed in a status display area .

When the operation for designating the encryption objective data is completed the message displayed in the status display area changes from UNDESIGNATED to DESIGNATED . Further the statuses of an OK button and an allowable condition setting button are changed from the operation unacceptable status to the operation acceptable status. In this connection the status messages to be displayed within the status display area include DATA IS UNDESIGNATED DATA IS DESIGNATED TRANSMITTING DATA ENCRYPTING DATA RECEIVING RESTRICTED FILE RESTRICTED FILE IS STORED etc.

When the allowable condition setting button is depressed as shown in the CPU makes the display device display an operation allowable condition setting screen in a popup display mode. The operation allowable condition setting screen is provided with an allowable user setting area for establishing a user ID of the allowable user an allowable terminal device setting area for establishing a terminal device ID of the allowable terminal device an allowable term setting area for establishing the allowable term and checkboxes each of which corresponds to each of the allowability setting operations. Further the operation allowable condition setting screen is also provided with checkboxes each of which corresponds to each of the allowable conditions including the allowable user the allowable terminal device and the allowable term.

When a checkmark is inputted into any one of the checkboxes which respectively correspond to the allowable user the allowable terminal device and the allowable term the allowable condition attached with the checkmark is established as the condition for confirming the access right while the allowable condition without the checkmark is ignored. Further the operation attached with the checkmark inputted into any one of the checkboxes is regarded as the allowance objective operation while the other operation without the checkmark is not allowed even if the allowable conditions such as the allowable user etc. coincide with each other.

For instance in the operation allowable condition setting screen shown in since the checkmark is only inputted into the checkbox of ACCESSING and the checkbox of PRINTING as the while no checkmark is inputted into the checkbox of ALLOWABLE TERMINAL DEVICE but the checkmark is inputted into the checkbox of ALLOWABLE USER and the checkbox of ALLOWABLE TERM the conditions are established as any arbitral one of the terminal devices may be employed as the terminal device to be operated and the accessing operation page shifting operation is banned and the printing operation is allowed only to the user established in the allowable user setting area within the allowable operation term established in the allowable term setting area . In this connection it is applicable that the system is so constituted that the conditions such as the allowable user the allowable terminal device the allowable term etc. are settable for every one of the allowability setting operations. Further the scope of the allowable conditions and the allowability setting operations is not limited to the above exemplified embodiment and the scope of them may be established as needed.

Still successively receiving the operation for depressing the OK button from the property screen shown in the CPU implements a processing for encrypting the encryption objective data so as to create the restricted file . Concretely speaking the CPU of the terminal device stores the file path of the encryption objective data which is designated data before encrypted into the nonvolatile storage Step S and then transmits Command signal to the image forming apparatus corresponding to the specific MFP driver designated by the driver designation area hereinafter referred to as the designated MFP Step S . Command signal is employed as such a command signal that confirms an availability of communication between them.

Still successively receiving Command signal Step S shown in Yes the image forming apparatus creates Result signal that indicates the fact that the image forming apparatus concerned has received Command signal and transmits Result signal to the terminal device serving as the sender of Command signal concerned Step S .

When the terminal device cannot receive Result signal even after a predetermined time has elapsed since Command signal transmitted to the image forming apparatus Step S shown in Yes the terminal device determines the current status as error and finalizes the concerned processing END . When the terminal device receives Result signal before a predetermined time has elapsed since Command signal transmitted to the image forming apparatus Step S No and Step S Yes the terminal device creates Command signal serving as a encryption request Step S and transmits Command signal to the designated MFP Step S . Command signal includes the encryption objective data various kinds of conditions established through the operation allowable condition setting screen the terminal device ID of the terminal device concerned the user ID of the user who instructed the encrypting operation etc.

Still successively receiving Command signal Step S shown in Yes the image forming apparatus designated MFP transmit Ack signal corresponding to Command signal to the terminal device serving as the sender of Command signal Step S . Further the image forming apparatus encrypts the encryption objective data included in Command signal Step S and collects and acquires the information being necessary to create the header of the restricted file Step S . In the present embodiment the user ID included in Command signal is also employed for that to be included in the header . Further other information items of its own such as the apparatus ID the application program information including name of the MFP driver concerned version information etc. the confirming destination information for instance address information including the IP address and the URL are also employed for those to be included in the header . The image forming apparatus acquired the abovementioned information by reading out them from the nonvolatile storage . In addition the image forming apparatus concerned also creates a new restricted file ID.

Based on the information collected and acquired in the above the CPU of the designated MFP creates the header so as to creates the restricted file that includes the header concerned the encrypted data acquired by encrypting the encryption objective data in Step S and the self decompression application program Step S . In this connection since the self decompression application program is stored in advance in the ROM a copy of the self decompression application program is to be included in the restricted file concerned.

Still successively the CPU of the designated MFP registers the management information in regard to the restricted file into the management table Step S . An ID symbol such as a character string etc. uniquely allotted to the restricted file concerned by the CPU is employed as the restricted file ID to be registered into the management table . Further the CPU employs the user ID and the condition information that are included in Command signal . Still further the CPU employs its own apparatus ID read from the nonvolatile storage of its own as the apparatus ID concerned. Yet further the CPU registers the key of cryptograph corresponding to that used at the time when creating the encrypted data .

Still successively the CPU of the designated MFP transmits Result signal including the restricted file created in Step S to the terminal device serving as the sender of Command signal Step S and then finalizes the processing END .

Still successively when the terminal device cannot receive Ack signal from the transmitted destination before a predetermined time has elapsed after transmitting Command signal Step S shown in Yes or when Ack signal received within the predetermined time interval represents a reception error Step S No the CPU of the terminal device finalizes the concerned processing due to the error status END . When receiving Ack signal representing a normal reception from the transmitted destination before a predetermined time has elapsed after transmitting Command signal Step S No Step S Yes Step S Yes the CPU of the terminal device still waits the reception of Result signal . When the terminal device cannot receive Result signal from the designated MFP before a predetermined time has elapsed after receiving Ack signal Step S Yes the CPU of the terminal device finalizes the concerned processing due to the error status END .

Yet successively after receiving Ack signal when the terminal device receives Result signal from the designated MFP before a predetermined time has elapsed Step S No Step S Yes the CPU of the terminal device reads out the file path information of the encryption objective data which is not yet encrypted and was stored in Step S from the nonvolatile storage Step S so as to store the received restricted file through the file path represented by the above read file path information Step S and then finalizes the concerned processing.

Next the operation for decrypting the restricted file and the operation for processing the decrypted data will be detailed in the following.

As described referring to the schematic diagram shown in the restricted file outputted from the image forming apparatus to the terminal device can be stored into the USB storage etc. to carry it to an external environment so as to use the restricted file on an arbitral external apparatus after confirming the access right.

With respect to the usage of the restricted file shows a flowchart indicating a processing flow to be conducted in an arbitral information processing apparatus for instance the terminal device . Further shows another flowchart indicating a processing flow to be conducted in the image forming apparatus serving as the management server. Initially receiving a double clicking operation for the data Step S the OS program of the information processing apparatus determines a kind of the data concerned so as to activate the application program corresponding to the data concerned. For instance when determining that the concerned data to which the double clicking operation is applied is determined as a normal document file Step S No the OS program activates the default editing program etc. so as to open the document file concerned Step S .

When determining that the concerned data to which the double clicking operation is applied is determined as the restricted file Step S Yes the OS program of the information processing apparatus activates the self decompression application program included in the restricted file concerned Step S . After that the self decompression application program activated by the OS program in the above is self decompressed so that the CPU of the information processing apparatus concerned can executes the self decompression application program to implement the operations to be conducted in the information processing apparatus concerned. The CPU of the information processing apparatus concerned parses the header of the restricted file by executing the self decompression application program after the self decompressing operation is completed Step S and further acquires the registry information Step S . Then the concerned CPU compares the registry information with the application program information included in the header of the restricted file Step S so as to determine whether or not the application program indicated by the application program information corresponding application program is already installed in the information processing apparatus concerned Step S .

Successively when determining that the corresponding application program is not yet installed Step S No the CPU conducts an installation request processing of the corresponding application program so as to acquire and install the corresponding application program. The installation request processing will be detailed later on.

Still successively when determining that the corresponding application program is already installed Step S Yes or when completing the installation of the corresponding application program in Step S the CPU activates the corresponding application program hereinafter the MFP driver designated by the application program information corresponding MFP driver Step S . After that the information processing apparatus is operated by executing the application program corresponding MFP driver activated in the above. In the confirmation processing of the access right the CPU executes the corresponding MFP driver to acquire the collating information to be collated with the condition information registered in the management server Step S . For instance the CPU makes the display device of the concerned information processing apparatus display an inputting screen which accepts the user s operation for inputting the user ID and or the password so as to acquire the user ID or the password serving as one of the collating information inputted by the user. Further the CPU acquires the terminal device ID from the system information of the information processing apparatus concerned.

Still successively the CPU executes the corresponding MFP driver so as to create Command signal that includes the collating information acquired and the restricted file ID included in the header Step S . Command signal serves as such a command signal that requests an operation for providing a key of cryptograph to be used for decrypting the encrypted data . The CPU further executes the corresponding MFP driver so as to transmit Command signal to the management server represented by the confirming destination information address information included in the header of the restricted file Step S .

On the other hand when determining that Command signal has been received Step S shown in Yes the CPU of the image forming apparatus serving as the management server sends Ack signal back to the sender of Command signal Step S . After that the CPU reads out the condition information registered in the management table while correlating them with the restricted file ID included in Command signal currently received and then compares the concerned condition information with the collating information included in Command signal currently received so as to determine whether or not the implementation of the decrypting operation should be allowed Step S .

Successively when determining that the implementation of the decrypting operation should be allowed presence of the access right Step S shown in Yes the CPU of the image forming apparatus serving as the management server transmits Result signal including the concerned key of cryptograph to the information processing apparatus serving as the sender of Command signal Step S and then finalizes the processing END . While when determining that the implementation of the decrypting operation should be not allowed absence of the access right Step S No the CPU transmits Result signal including the confirmation result representing the absence of the access right to the information processing apparatus serving as the sender of Command signal Step S and then finalizes the processing END .

Still successively when determining that Ack signal cannot be received yet at the time when a predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S shown in Yes and Step S No the CPU of the information processing apparatus deactivates the corresponding MFP driver so as to finalize the processing concerned END .

Still successively when determining that Ack signal is received before the predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S shown in No and Step S Yes the CPU of the information processing apparatus waits a reception of Result signal including the processing result of Command signal Step S No and Step S No . When determining that Result signal cannot be received yet at the time when a predetermined time interval has elapsed since Ack signal has been received from the image forming apparatus concerned Step S Yes and Step S No the CPU of the information processing apparatus deactivates the corresponding MFP driver so as to finalize the processing concerned END .

Still successively when determining that Result signal is received before the predetermined time interval has elapsed since Ack signal has been received from the image forming apparatus concerned Step S No and Step S Yes the CPU creates a copy of the encrypted data Step S and employs the key of cryptograph for decrypting the created copy of the encrypted data so as to generate decrypted data and deletes the concerned key of cryptograph immediately after the decrypting operation has been completed Step S . After that in the above case the CPU continues to activate the corresponding MFP driver so as to implement various operations for monitoring tracing the decrypted data as the background monitoring operations.

As described in the foregoing since the header of the restricted file includes the confirming destination information of the access right it becomes possible for the user to inquire a presence or absence of the access right from any arbitral one of the management servers residing within the system concerned by using the confirming destination information abovementioned. Further since the management server performs the operation for confirming the access right it becomes possible to change the allowability condition at any time. Accordingly it is possible to change the allowability condition in regard to the decrypting operation etc. as needed even after the restricted file is outputted and as a result it becomes possible to give an aspect of the flexible and robust security to the encrypted data.

Successively when determining that Command signal is received Step S shown in Yes the CPU of the image forming apparatus management server transmits Ack signal corresponding to Command signal to the sender of the Command signal concerned Step S . Still successively the CPU transmits the specific application program designated by the Command signal herein the MFP driver for the image forming apparatus concerned to the sender of Command signal concerned Step S and then finalizes the processing END .

On the other hand when determining that Ack signal cannot be received yet at the time when a predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S shown in No and Step S Yes the CPU of the information processing apparatus forcibly deactivates the self decompression application program due to an error status Step S .

When determining that Ack signal is received before the predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S No and Step S Yes the CPU of the information processing apparatus waits a reception of Result signal including the processing result of Command signal . When determining that Result signal cannot be received yet at the time when a predetermined time interval has elapsed since Ack signal has been received from the image forming apparatus concerned Step S Yes the CPU forcibly deactivates the self decompression application program due to an error status Step S .

Still successively when determining that Result signal is received before the predetermined time interval has elapsed since Ack signal has been received from the image forming apparatus concerned Step S Yes the CPU installs the corresponding application program included in the Result signal concerned into the information processing apparatus concerned Step S and then finalizes the processing END .

As described in the foregoing since the corresponding application program can be acquired from the management server as needed it becomes possible to suppress the capacity of the restricted file at a minimum level compared to such a conventional case that the application program is included in the restricted file . Further since the application program is acquired from the management server it becomes possible to flexibly cope with the update of the application program and or the update of the program version concerned.

The CPU of the information processing apparatus monitors traces the tasks of the decrypted data and the operations to be applied to the decrypted data by executing the application program activated in Step S shown in Step S . Accordingly when detecting a request for conducting any one of various kinds of operations such as a commencement of accessing operation an operation for shifting currently accessing page an implementation of printing a correcting operation change operation a copy operation etc. Step S Yes the CPU conducts processing associated with the occurrence of the above detected request of the concerned operation Step S and then shifts the processing to Step S. In this connection the processing to be conducted in association with the occurrence of the above detected request of the concerned operation will be detailed later on. When detecting no request for conducting any one of the various kinds of operations Step S No the CPU directly shifts the processing to Step S.

In Step S the CPU determines whether or not a predetermined time interval for instance 10 minutes has elapsed since the previous operation for confirming the access right has been completed. When determining that the above predetermined time interval has not elapsed Step S No the CPU shifts the processing back to Step S. In this connection the initial operation for confirming the access right has been completed on the occasion for requesting the key of cryptograph. When determining that the predetermined time interval has elapsed since the previous operation for confirming the access right Step S Yes the CPU again conducts the operation for confirming the access right.

Concretely speaking the CPU creates Command signal for requesting the operation for confirming the access right in regard to the continuation of an operation such as an operation for accessing the decrypted data etc. Step S and then transmits the created Command signal to the management server indicated by the confirming destination information included in the header Step S . As well as Command signal Command signal includes collating information necessary for confirming the access right and the restricted file ID. On that occasion the CPU makes the display device display the inputting screen so as to request the user to again input the collating information such as a user ID a password etc. In this connection when the convenience is an important factor of the system concerned it is also applicable that the system is so constituted that the collating information previously inputted is again employed as it is without requesting the reentry of them.

On the other hand when determining that Command signal has received Step S shown in Yes the CPU of the image forming apparatus management server reads out the condition information registered in the management table while correlating them with the restricted file ID included in Command signal currently received and then compares the concerned condition information with the collating information included in Command signal currently received so as to determine whether the access right is present or absent whether or not the continuation of the operation should be allowed Step S .

Successively when determining that the access right is present Step S shown in Yes the CPU of the image forming apparatus serving as the management server transmits Result signal including the confirmation result representing the presence of the access right allowance of the continued operation Step S and then finalizes the processing END . While when determining that the access right is absent Step S No the CPU transmits Result signal including the confirmation result representing the absence of the access right disallowance of the continued operation Step S and then finalizes the processing END .

Still successively when determining that Result signal corresponding to Command signal is received before a predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S shown in Yes the CPU of the information processing apparatus parses Result signal concerned Step S . When determining that Result signal includes confirmation result representing the presence of the access right Step S Yes the CPU allows the user to continue the operation for accessing the decrypted data Step S . After that the CPU further determines whether or not the task of the decrypted data is completed Step S . When determining that the task of the decrypted data is not completed yet Step S No the CPU shifts the processing back to the Step S so as to continue the monitoring operation. While when determining that the task of the decrypted data is completed Step S Yes the CPU finalizes the processing END . In this connection the present embodiment is so constituted that the decrypted data should be deleted at the time when the task is finalized.

Still successively when determining that Result signal cannot be received before the predetermined time interval has elapsed Step S No Step S Yes and when determining that Result signal includes confirmation result representing the absence of the access right Step S No the CPU forcibly finalizes the task of the decrypted data Step S and finalizes the whole processing END . In this connection it is also applicable that the present embodiment is so constituted that the decrypted data is automatically deleted at the time when the task of the decrypted data is forcibly finalized.

As described in the foregoing during the operation for accessing the decrypted data the operation for confirming the access right is periodically performed at every time when a predetermined time interval has elapsed. For instance in such a case that an allowable term is established as the condition for allowing the access right if the allowable term has elapsed during the continuous operation for accessing the decrypted data the CPU immediately determines that the access right has become absent at the timeout point of the allowable term and forcibly finalizes banns the accessing operation. Further in case that the decrypted data is left in a freely accessible state since the operation for confirming the access right is periodically performed at predetermined time intervals so as to request the user to input the collating information such as a user ID a password etc. it becomes possible to prevent the decrypted data left in the freely accessible state from being accessed by an unauthorized user without any permission. Still further for instance when it is revealed that the operation for decrypting the encrypted data has been performed by using an illegally acquired password which is acquired by employing an injustice method or the like by changing the allowable condition to be established in the management server side it becomes possible to ban the operation for accessing the illegally decrypted data after that and accordingly it becomes possible not only to flexibly cope with various kinds of incidents but also to maintain a robust security of the system concerned.

On the other hand receiving Command signal sent from the information processing apparatus the CPU of the image forming apparatus management server performs the processing same as those shown in however Command signal is replaced by Command signal so as to transmit Result signal including the confirmation result of either the presence of the access right or the absence of the access right.

Successively when determining that Result signal corresponding to Command signal is received before a predetermined time interval has elapsed since Command signal has been transmitted to the image forming apparatus concerned Step S shown in Yes the CPU of the information processing apparatus parses Result signal concerned Step S . When determining that Result signal includes confirmation result representing the presence of the access right Step S Yes the CPU allows the user to perform the concerned operation to be applied to the decrypted data Step S . After that the CPU detects that the concerned operation is actually applied to the decrypted data Step S and then resumes the time measuring operation in regard to the determination in Step S shown in Step S and finally finalizes the whole processing END .

Still successively when determining that Result signal cannot be received before the predetermined time interval has elapsed Step S No Step S Yes and when determining that Result signal includes confirmation result representing the absence of the access right Step S No the CPU determines that the concerned operation to be applied to the decrypted data is disallowable so as to ban the implementation of the concerned operation Step S and finalizes the whole processing END . In this connection it is also applicable that the system is so constituted that a message for notifying the user on the current operation of the fact that the concerned operation has been banned is displayed on the display device .

As described in the foregoing since every time when an operation to be applied to the decrypted data occurs the CPU of the information processing apparatus inquires a presence or absence of the access right in regard to the concerned operation from the management server it becomes possible to heighten the security aspect of the concerned operation to be applied to the decrypted data. Further since the management server confirms the presence or absence of the access right it becomes possible not only to change the allowable conditions at any time as needed but also to flexibly cope with the request for changing the allowable conditions. For instance even in such a case that although the user took out the restricted file created under the disallowable condition that bans the printing operation to a certain business trip destination site it happens to be necessary in the concerned business trip destination site to implement the printing operation in regard to the restricted file concerned it becomes possible for the user to request the manager to change the disallowable condition to an allowable condition that allows the user to implement the printing operation by calling the manager on the telephone line or the like. Then if the manager admits the user s request and changes the disallowable condition to the allowable condition according to the user s request it becomes possible for the user to implement the printing operation at the concerned business trip destination site under the allowable condition changed by the manager.

Referring to the drawings the preferred embodiment of the present invention has been described in the foregoing. However the scope of the present invention is not limited to the above described preferred embodiment. Modifications and additions to be applied to the above described preferred embodiment by a skilled person without departing from the spirit and subject of the invention shall be included in the scope of the present invention.

For instance although the above described preferred embodiment is so constituted that the self decompression application program is included in the restricted file another configuration in which the restricted file does not include the self decompression application program is also applicable in the present invention.

Further it is also applicable that the above described preferred embodiment is so constituted that when the header includes the user information and the apparatus ID those information are transmitted to the management server as subsidiary information of the collating information.

Still further although the above described preferred embodiment is so constituted that the restricted file ID is registered into both the management table and the header of the restricted file so as to confirm the access right for every restricted file under the individual condition it is also applicable that when the presence or absence of the access right is determined with respect to each of all restricted files under a common condition it is not necessary to register the restricted file ID.

Yet further although the above described preferred embodiment is so constituted that the CPU of the information processing apparatus automatically collects the terminal device ID which is to be transmitted to the management server as the collating information by executing the application program for monitoring the decrypted data it is also applicable that the system is so constituted that the user inputs the terminal device ID through the inputting screen.

Incidentally the scope of the allowable objective operations is not limited to those exemplified in the above described preferred embodiment. Further the operation for transmitting the decrypted data is defined as one of various kinds of copy operations.

Further the scope of the confirming destination information is not limited to the address information on the network of the management server but any kind of information which makes the operation for accessing the designated management server possible is available for this purpose. For instance in such a case that the address information can be acquired from the ID information of the management server the case that the address information is provided from the ID information by inquiring the known server etc. it is applicable that the ID information of the management server can be employed as the confirming destination information.

Still further although the above described preferred embodiment is so constituted that the operation for encrypting the original data is performed in the image forming apparatus it is also applicable that the concerned system is so constituted that the above encrypting operation is performed in another separate apparatus while the image forming apparatus creates the restricted file including the encrypted data attached with at least the confirming destination information. For instance in Case aforementioned it is also applicable that the concerned system is so constituted that the management server transmits the key of cryptograph to the terminal device so that the terminal device encrypts original data by using the above transmitted key of cryptograph so as to acquire encrypted data and transmits the encrypted data to the image forming apparatus and then the image forming apparatus creates the restricted file including the above encrypted data so as to transmit the restricted file back to the terminal device and to register the necessary management information into the management table .

Still further although the above described preferred embodiment is so constituted that the image forming apparatus is provided with both the function as the restricted file creating apparatus and the other function as the management server it is also applicable that the concerned system is so constituted that the restricted file creating apparatus and the management server are respectively configured as separate apparatuses. Further the image forming apparatus is not necessary provided with the function as the restricted file creating apparatus and the other function as the management server but it is applicable that each of abovementioned apparatuses is separately installed into the concerned system as an exclusive apparatus.

Yet further although the above described preferred embodiment is so constituted that the information processing apparatus implements the operation for decrypting the encrypted data it is also applicable that the information processing apparatus transmits the encrypted data to the management server so that the management server decrypts the encrypted data sent from the information processing apparatus concerned and then sends the decrypted data back to the information processing apparatus concerned.

According to the access restricted file and the restricted file creating apparatus embodied in the present invention since the access restricted file includes the confirming destination information that represents a management server serving as a confirming destination site to confirm a presence or absence of an access right in regard to the operation for accessing the data it becomes possible to inquire the presence or absence of the access right from the general purpose information processing apparatus based on the confirming destination information in order to effectively utilize the data concerned.

While the preferred embodiments of the present invention have been described using specific term such description is for illustrative purpose only and it is to be understood that changes and variations may be made without departing from the spirit and scope of the appended claims.

