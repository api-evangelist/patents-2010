---

title: Web client command infrastructure integration into a rich client application
abstract: A command interface for a software application is implemented on a client computer. A first definition of the command interface is received from a server computer. The first definition includes rules for encoding the command interface on a web browser. A conversion of the first definition to a second definition is performed. The second definition includes language for encoding the command interface on a user interface of the software application. The second definition is used to render the command interface on the user interface of the software application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09110686&OS=09110686&RS=09110686
owner: MICROSOFT TECHNOLOGY LICENSING, LLC
number: 09110686
owner_city: Redmond
owner_country: US
publication_date: 20100608
---
Application software can be run on a plurality of systems and interfaces. For example customer relationship management CRM systems assist in the management of a company s interactions with clients and sales prospects and customer information regarding products services and customer accounts. Online customer relationship management software provides a business applications platform for customer relationship management typically using a client server model. Using an online CRM system a user at a client computer is able to access CRM information from a server computer and display CRM information at the client computer.

Client based CRM software can often be integrated into application software on a client computer providing a user a commonly used platform from which to access CRM information. However different versions of the application software often include different user interfaces. Differences between the versions of applications used to access CRM information can lead to incompatibility issues and inconsistent functionality between interfaces.

Embodiments of the disclosure are directed to a method for implementing a command interface for a software application on a client computer. A first definition of the command interface is received from a server computer. The first definition includes rules for encoding the command interface on a web browser. A conversion of the first definition to a second definition is performed. The second definition includes language for encoding the command interface on a user interface of the software application. The second definition is used to render the command interface on the user interface of the software application.

The details of one or more techniques are set forth in the accompanying drawings and the description below. Other features objects and advantages of these techniques will be apparent from the description drawings and claims.

The present application is directed to systems and methods for integrating information from a web based infrastructure into a rich client software application such as a messaging application on a client computer.

Messaging applications from different manufacturers may have different user interfaces. In addition the user interface of different versions of a software application from the same manufacturer may be different. For example one user interface may include a command bar and another user interface may include a ribbon. With the systems and methods of the present disclosure a conversion program on the client computer converts information for example CRM information from a web based infrastructure to a format compatible with the user interface of the software application being used on the client computer for example the messaging application. Other software applications may used.

A ribbon user interface hereinafter referred to as a ribbon is a user interface in which a set of buttons are placed on tabs in a tab bar. An example ribbon is shown in and explained later in this disclosure.

A command bar user interface hereinafter referred to as a command bar is a menu driven user interface that includes menu and submenu items and toolbars. An example command bar is shown in and explained later in this disclosure.

The example system includes client computers network and server computers . Client computer includes web browser software such as the Microsoft Internet Explorer web browser from Microsoft Corporation of Redmond Wash. Client computer includes software such as the Microsoft Office Outlook 2010 messaging and collaboration software from Microsoft Corporation of Redmond Wash. that provides email application software for client computer . An email application is one example of a messaging application. The example email application software for client computer includes a ribbon based user interface. Client computer includes software such as the Microsoft Office Outlook 2007 messaging and collaboration software from Microsoft Corporation of Redmond Wash. that also provides email application software for client computer . However the example email application software for client computer includes a command bar user interface.

Server computers include CRM software such as Microsoft Dynamics CRM 5.0 customer relationship management software from Microsoft Corporation of Redmond Wash. that provides CRM functionality. Files and data located on server computers are accessible to client computers through network .

One example of network is a corporate Intranet network. More or fewer client computers networks and server computers may be used. Client computers and are configured to obtain the name and location of a server computer for example server computer or server computer and obtain CRM information from the server computer. The CRM information includes a definition file that defines the format and structure of a CRM command interface typically a ribbon or a command bar that is rendered on client computers and .

Using web browser software for example the Microsoft Internet Explorer web browser on client computer one or more screens of CRM information can be obtained from server computer and rendered as a web page on client computer . The CRM information displayed on the web page of client computer typically includes lists of customer information including account information marketing information product information sales information service information and related items. In addition each page of CRM information may include a command definition providing one or more commands that a user may execute regarding the CRM information. Example commands are edit accounts or view accounts or add a marketing list to an account. Other commands are possible.

CRM information can also be integrated into a messaging and collaboration software application on a client computer and rendered on the user interface of the messaging and collaboration software application. For example using the messaging and collaboration software installed on client computer for example the Microsoft Office Outlook 2010 messaging and collaboration software and using a CRM software program for the client computer for example the Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software CRM information from server computer can be integrated with the messaging and collaboration software. The CRM information is displayed in one or more grids on the user interface of the messaging and collaboration software on client computer .

A grid is an area of the user interface typically a series of columns and rows in which email messages lists etc. are displayed. When the CRM information is displayed on a client based software application such as the Microsoft Office Outlook 2010 messaging and collaboration software the rendering of the CRM information conforms to the format used by the client based software application. For example when the messaging and collaboration software provides a ribbon interface the CRM information is rendered in the form of a ribbon. When the messaging and collaboration software provides a command bar interface the CRM information is rendered in the form of a command bar.

For example the rich client ribbon includes one additional tab the example File tab that is not included in the web client ribbon . As another example the New button is shown as an icon in the example web client ribbon but the New button is shown without an icon in the example rich client ribbon . In examples when the web client ribbon is rendered on other client based software applications there may be additional differences.

For example one or more tabs groups or buttons from the ribbon web client ribbon may not be used in rich client ribbon or on a user interface of other client based software applications and one or more tabs groups or buttons from rich client ribbon or the user interface of other client based software applications may not be used on the example web client ribbon . Furthermore as discussed later in this disclosure markup command language statements included in command definitions for the example web client ribbon and for the example rich client ribbon are different.

The example rich client ribbon includes one or more tabs one or more groups one or more separators separating the one or more groups and one or more command buttons for each group. The groups and buttons for each group shown in correspond to the example Accounts tab . When a different tab is selected for example the Views tab the Create Related tab or the Customize tab is selected a different set of groups buttons and separators is rendered.

The example command bar includes a menu which includes menu items File Edit Accounts Views Create Related Customize View Go To CRM and Help. The Accounts Views Create Related Customize and CRM menu items are added to the command bar when customer relationship management software for example the Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software is installed on client computer . The Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software is typically installed as a plug in software module to the messaging and collaboration software for example the Microsoft Office Outlook 2007 messaging and collaboration software already installed on client computer .

When the Accounts menu item is selected an example drop down accounts submenu is displayed. The example drop down accounts submenu includes submenu items corresponding to the groups buttons and separators of the example web client ribbon . For example the accounts submenu includes the buttons New Edit Activate Delete Delete Duplicates and Merge that are included in the example Records Management group. The accounts submenu also includes the buttons Assign Sharing Add to Marketing List Add Connection and Send Direct Mail that are included in the example Actions group.

The structure and format of the example web client ribbon and rich client ribbon and the example command bar are each specified in a definition file comprised of markup language. The definition file is obtained from a server computer for example server computer typically when client computers and are configured. The markup language comprises a series of statements that specify how to encode the ribbons and the command bar electronically. Typically the Extensible Markup Language XML is the markup language used in the definition files. In this disclosure the terms markup language and XML are used interchangeably.

Because the user interface on the server computer is dynamic the web client ribbon may change after client computers and are configured. Consequently the rich client ribbon is periodically refreshed. Therefore the definition file for the rich client ribbon is updated periodically. The updates occur typically via polling or via periodic updates from the server computer for example server computer . The definition file for the example web client ribbon and for the example rich client ribbon each include versioning information. During polling or during periodic updates from the server computer the version of the definition file is checked. A new definition file is downloaded when the current definition file is not the latest version.

The structure and format of the example web client ribbon is consistent with the structure and format of XML used to render the CRM information as a web page on the web browser for example the Microsoft Internet Explorer web browser on client computer . The example rich client ribbon is consistent with the structure and format of XML used in the message and collaboration software for example the Microsoft Office Outlook 2010 messaging and collaboration software running on client computer .

The example command bar is consistent with the structure and format of XML used in the message and collaboration software for example the Microsoft Office Outlook 2007 messaging and collaboration software running on client computer . Because the structure and format of XML is typically different for these different software applications a conversion program is used to convert the XML from the structure and format of the web client ribbon rendered on client computer to the structure and format of the rich client ribbon rendered on client computer . The conversion program is also used to convert the XML from the structure and format of the web client ribbon rendered on client computer to the structure and format of the command bar rendered on client computer . The conversion program is designed such that the same conversion program that is used to convert web client ribbon to rich client ribbon can be used to convert web client ribbon to command bar .

The conversion program is installed on client computer when CRM software for example the Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software is installed on client computer and the conversion program is installed on client computer when the CRM software for example the Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software is installed on client computer . The objective is to have one definition for a web page ribbon that can be converted both to a rich client ribbon and to a rich client command bar.

Although the examples described disclose how a web page ribbon is converted to a rich client command bar other conversion examples are possible. In general the conversion program uses a common source and converts the common source to a second definition. In the examples discussed the common source defines a ribbon interface and the second definition defines either a ribbon interface or a command bar interface. In other examples the common source may define a command bar interface and the second definition may define a ribbon interface or another command bar interface. Furthermore one or more additional file conversions may be performed. For example the second definition may be converted to a third definition and so on.

In the definition of a ribbon interface for example web ribbon interface tabs groups and buttons form distinct groupings. For example accounts tab is a grouping that includes the record management group sub grouping and the actions group sub grouping. Similarly the record management group sub grouping includes a sub grouping of elements including Edit button and New button . Similarly in the definition of a command bar interface for example command bar interface menu items form groupings. For example the Accounts menu item is a grouping that includes sub grouping of submenu commands each grouping of submenu commands being separated by a separator such as separators and .

The accounts tab tag includes the records management group tag and the actions group tag . The records management group tag includes the edit button tag and the activate button tag . The actions group tag includes the sharing button tag and the share this record button tag . Because only shows a portion of an XML file tags for other tabs groups and buttons are not shown in .

The ribbon tag tab tags group tags and button tags are arranged in an ordered hierarchy in the example XML file . For example the ribbon tag is at the top of the hierarchy and the accounts tab tag and the view tab tag are included within the ribbon tag hierarchy. As another example the records management group tag and the actions group tag are included within the hierarchy of the accounts tab tag . In addition the edit button tag and the activate button tag are included within the hierarchy of the records management group tag .

In addition the example XML file may include one or more rule tags not shown that define one or more rule attributes for one or more tab elements group elements and button elements in the XML file . In examples the one or more rule attributes specify whether the one or more tab elements group elements and button elements are to be rendered on a web client ribbon only or on a rich client only.

In examples a rich client includes messaging and collaboration software. For example if a button is to be rendered only on the web client ribbon for example the web client ribbon on client computer the XML definition for the button includes a rule tag specifying web client only. Similarly if a button is to be rendered only on client or the button includes a rule tag specifying rich client only. In examples different terms may be used to specify web client only or rich client only. Typically if a tab group or button is to be rendered on both a web client such as client computer and a rich client such as client computer or client computer the rule tag is not included for the tab element group element or button element in the XML file.

The XML statements shown in the example XML file are simplified for discussion purposes. An actual XML file typically includes more detail. For example the following is an example portion of an XML file for the example web client ribbon for a records management group 

The following is an example portion of an XML file for the example rich client ribbon for the same records management group 

When the conversion program runs the portion of the XML file for the records management group for the web client ribbon is converted to the format for the records management group for the example rich client ribbon .

The following is an example portion of an XML file for the example web client ribbon for the edit button in the records management group 

The following is an example portion of an XML file for the example rich client ribbon for the edit button in the records management group 

When the conversion program runs the portion of the XML file for the edit button for records management group for the web client ribbon is converted to the format for the edit button for the records management group for the example rich client ribbon .

The conversion program is part of the CRM software for example the Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software that is installed on client computers and . Before the conversion program runs on client computer the CRM software on client computer obtains the XML file for the web ribbon client from server computer . The conversion program then converts the XML file for the web client ribbon to an XML file having the format and structure for the rich client ribbon .

Before the conversion program runs on client computer the CRM software on client computer also obtains the XML file for the web ribbon client from server computer . However the conversion process on client computer is a two step process. First the conversion program on client computer converts the XML file for the web client ribbon to an XML file having the format and structure for the rich client ribbon . Then the conversion program on client computer converts the XML file for the rich client ribbon to an XML file for the command bar . The conversion program identifies the version of messaging and collaboration software on client computer and on client computer in order to determine the conversions to be made.

When the conversion program runs the XML file for the web client ribbon is parsed and all tags are identified. When converting the XML file for the web client ribbon to the XML file for rich client ribbon each identified tag in the XML file for the web client ribbon is converted to the format for a similar tag in the XML file for the rich client ribbon .

For example referring to when parsing the XML file for the web client ribbon the conversion program identifies tag for the ribbon tags and for the tabs tags and for the groups and tags and for the buttons. Each tag also includes one or more attributes. For example each tab group and button has a name attribute. The conversion program also identifies the name attributes for each tag. The actual name of each tag gets preserved during the conversion process. However the format and names of the other attributes may change.

For example the group names Record Management and Actions from the web client ribbon are preserved in the rich client ribbon . Similarly the button names of Edit Activate Assign and Sharing from the web client ribbon are preserved in the rich client ribbon . However from the XML snippet above the tool tip description of Edit this Account for the edit button for the web client ribbon is changed in the conversion process to a tool tip of Edit for the edit button for the rich client ribbon . In this example the conversion program uses the name of the button for the name of the tool tip.

The conversion program also identifies one or more rule tags included in the XML file. The rule tags constitute metadata that identify rules for certain actions in the conversion process. For example rules determine whether one or more buttons from the web ribbon client are to be included in the rich client ribbon . A rule corresponding to a rule tag may cause the conversion program to look for a certain button and change the style of the button for example from one icon to another. A rule may also look for a certain button and determine that the button is not to be included in the rich client ribbon . In addition a rule may specify that one or more tabs not included in the web client ribbon for example the File tab are to be included in the rich client ribbon . Other examples or rules are possible.

The conversion program also merges certain server computer and client computer commands. For example the web client ribbon includes a Views tab the rich client ribbon includes a Views tab and the rich client command bar includes a Views tab . When converting the web client ribbon to the rich client ribbon commands in the Views tab of web client ribbon are merged with the commands of the Views tab in the rich client ribbon . In examples when commands in the Views tab have the same name as commands in the Views tab the commands in the Views tab appear first in the merged Views tab . In a similar manner when converting web client ribbon to the rich client command bar commands in the Views tab are merged with commands in the Views tab .

When the conversion program runs on client computer because the example Microsoft Office Outlook 2007 messaging and collaboration software running on client computer does not support ribbons an additional conversion may be performed to convert the XML file for the rich client ribbon to an XML file for the example command bar . When the conversion program is run to convert the XML file for the rich client ribbon to the XML file for the command bar the XML file for the rich client ribbon is parsed and each tag in the XML file for the rich client ribbon is identified. Each identified tag is converted to a corresponding menu or submenu item in the command bar .

For example the Accounts tab is converted to the Accounts menu item on the command bar . In addition each button for the Accounts tab is converted to a submenu item under the Accounts menu item . Groups are delineated by separators for example separators and . For example the buttons New Edit Activate Deactivate Delete Delete Duplicates Bulk Delete and Merge for the Record Management group are converted to submenu items New Edit Activate Deactivate Delete Delete Duplicates Bulk Delete and Merge in the Accounts submenu . In addition following separator marking the end of the record management group the buttons Assign Sharing Add to Marketing List Add Connection and Send Direct Mail for the Actions group are converted to submenu items Assign Sharing Add to Marketing List Add Connection and Send Direct Mail in the Accounts submenu .

The part of the conversion program that converts the ribbon into the command bar uses hard coded application programming interface API commands to implement the conversion process. The API commands are typically commands provided in a developer kit to implement such functions as creating a menu adding an item to a menu creating a submenu adding a name to a submenu adding a separator etc. The API commands also implement functions such as expanding a menu item into multiple submenu items or collapsing multiple submenu items into one item. Other commands with similar functionality are possible. The exact syntax of the commands is dependent on the messaging and collaboration software for example the Microsoft Office Outlook 2007 messaging and collaboration software installed on client computer .

The CRM software on client computer and on client computer for example the Microsoft Dynamics CRM 5.0 customer relationship management software implements execution of commands in rich client ribbon and command bar via an interpretive layer in the CRM software. The interpretive layer makes use of code already written for the web client ribbon so that a single source can be used and so that new execution code does not need to be written for each messaging and collaboration software user interface. The code to implement the web client ribbon is obtained from server computer by client computer and by client computer before the conversion process is executed. The interpretive layer typically using JavaScript maps or translates a user action on rich client ribbon or command bar to web client ribbon code for implementing the action.

For example when the user presses New button or the user presses the New submenu item from the Accounts submenu the interpretive layer maps the action into code used in the web client ribbon for a New command for example code that is executed when the user presses the New button for web client ribbon on client computer . When the interpretive layer maps the action for pressing New button or New submenu item from the Accounts submenu a new window is opened on client computer and client computer respectively.

The use of the code for web client ribbon effectively makes use of a hidden window on client computer and client computer . The hidden window corresponds to the non rendering of web client ribbon . That is the definition file for web client ribbon is obtained from server computer is stored on client computer and on client computer . However the web client ribbon is not rendered on client computer or on client computer . Instead the commands associated with web client ribbon are interpreted by the messaging and collaboration software on client computer and . For example when a button is clicked on web client ribbon the messaging and collaboration software on client computer recognizes the button as a customized control. A command interpreter in the messaging and collaboration software executes the button click through the hidden window typically using JavaScript. The result of the button click may be passed back to the command interpreter via the hidden window for further action. A hidden window may be also be used with other user interfaces such as a command bar. Thus a hidden window may be used to map commands from one or more user interfaces into common execution code.

At operation a first definition file is obtained from server computer . The first definition file typically an XML file includes a first definition of CRM information that can be rendered as a ribbon on a client computer for example on client computer . When the first definition file is rendered on client computer the CRM information is displayed as a web page on client computer and the ribbon for example web client ribbon shown in is typically rendered at the top of the web page.

At operation a conversion is performed at client computer to convert the first definition to a second definition. The second definition conforms to the definition format used on client computer . In the example flowchart client computer supports a ribbon interface and provides the capability of rendering the CRM information from the first definition file as a ribbon on client computer . Client computer also runs software for a messaging and collaboration application such as the Microsoft Office Outlook 2010 messaging and collaboration software. In addition client computer runs software such as Microsoft Dynamics CRM 5.0 for Outlook customer relationship management software for integrating CRM information into the Microsoft Office Outlook 2010 messaging and collaboration software.

Even though the Microsoft Office Outlook 2010 messaging and collaboration software supports a ribbon interface the format of markup language definitions for the ribbon interface on the Microsoft Office Outlook 2010 user interface is different from the format of markup language definitions used to render the CRM information as a web page on client computer . The conversion performed at operation converts the format of the CRM information from server computer to a format in which the CRM information can be rendered on client computer . The conversion process at operation is explained in more detail later in this disclosure.

At operation the version of the messaging and collaboration software running at the client computer is determined. In this example client computer runs the Microsoft Office Outlook 2010 messaging and collaboration software and client computer runs the Microsoft Office Outlook 2007 messaging and collaboration software. The Microsoft Office Outlook 2010 messaging and collaboration software supports a ribbon interface and the Microsoft Office Outlook 2007 messaging and collaboration software supports a command bar interface.

At operation when it is determined that the messaging and collaboration software running at the client computer supports a ribbon interface for example when is determined that the messaging and collaboration software on client computer is the Microsoft Office Outlook 2010 messaging and collaboration software at operation the CRM information is rendered as a ribbon using the second definition.

At operation when it is determined that the messaging and collaboration software running at the client computer does not support a ribbon interface for example when it is determined that the messaging and collaboration software on client computer is the Microsoft Office Outlook 2007 messaging and collaboration software at operation a second conversion is performed to convert the second definition to a third definition. The third definition defines the markup format for rendering the CRM information as a command bar on the user interface of the messaging and collaboration software running on client computer . The conversion process at operation is explained in more detail later in this disclosure. At operation the CRM information is rendered as a command bar using the third definition.

At operation the first definition is parsed. The first definition is included in a first XML file obtained from server computer . At operation a first tab tag is identified in the first XML file. The first tab tag defines the first tab in the web client ribbon. At operation a determination is made as to whether the first tab is used in the ribbon to be rendered on client computer . Sometimes a tab group or button used on the web client ribbon is not used on the ribbon rendered on client computer . Similarly sometimes a tab group or button on the ribbon rendered on client computer is not used on the web client ribbon. Whenever a tab group or button is used on one ribbon but not on another the definition of a tag includes a rule attribute that indicates whether the tab group or button is to be used.

For example when the first tab is not be rendered on the messaging and collaboration software ribbon a rule attribute specifying web only may be included with the first tab tag in the first definition. In examples other designations may be used instead of web only . Similarly when the first tab is only to be rendered on the messaging and collaboration software ribbon a rule attribute specifying Outlook only may be included with the first tab tag in the first definition. In examples other designations may be used instead of Outlook only .

When it is determined at operation that the first tab is to be used in the second definition at operation the name of the first tab is copied to the second definition. The conversion algorithm used in the conversion process looks for tab group and button elements and when it is determined that those elements are used in the second definition the names of the elements are copied to the second definition. The second definition includes markup language typically XML that corresponds to the format of the messaging and collaboration software for example the Microsoft Office Outlook 2010 messaging and collaboration software used on client computer .

When the first tab is used in the second definition the second definition also includes a first tab tag. Typically the markup language syntax used in the first definition is different than the markup language syntax used in the second definition. However the names of each tag element used in both the first and second definitions is the same. During the conversion process when it is determined that a tag in the first definition is to be included in the second definition the tag name for the first definition is copied to the corresponding tag element in the second definition.

At operation when it is determined that the first tab is not to be used in the second definition control advances to operation . At operation a determination is made as to whether the current tab in this case the first tab is the last tab in the first XML file. When it is determined at operation that the current tab is not the last tab in the first XML file at operation the next tab in the first XML file is identified. Control then passes back to operation where a determination is made as to whether the next tab is used in the second definition.

At operation a first group that is associated with the tab of operation is identified. For example for the example accounts tab the first group is the records management group. At operation a determination is made as to whether the first group is to be included in the second definition. Typically the first group is included in the second definition unless a rule tag is included in the first group element in the first definition. When the rule tag specifies that the first group is for web ribbon only the first group is not included in the second definition.

When a determination is made at operation that the first group is to be included in the second definition at operation the name of the second group is copied to the second definition. As discussed above with regard to the first tab the syntax used in the markup language for the second group in the second definition may be different than the syntax used in the first definition. However when the first group is included in the second definition the name of the first group in the second definition is the same as the name of the first group in the first definition.

When a determination is made at operation that the first group is not be included in the second definition control advances to operation . At operation a determination is made as to whether the first group is the last group in the first tab. When it is determined at operation that the first group is not the last group in the first tab at operation the next group included in the first tab is identified. Control then passes back to operation where a determination is made whether the next group is included in the second definition.

At operation a first button that is associated with the first group is identified. At operation a determination is made as to whether the first button is to be included in the second definition. Similar to the first tab and the first group when the first button is not to be included in the second definition the first button element in the first definition includes a rule tag that specifies that the first button is to be included the web ribbon only.

When a determination is made at operation that the first button is included in the second definition at operation the name of the first button is copied to the second definition. As discussed with regard to the first tab and the first group when a button element is to be included in the second definition the syntax of the markup language for the button element in the second definition is typically different than the syntax of the markup language for the button element in the first definition. However the caption of the button element is the same in both the first definition and the second definition.

When a determination is made at operation that the first button is not to be included in the second definition at operation a determination is made as to whether the button is the last button in the first group. When a determination is made at operation that the first button is not the last button in first group control advances to operation and the next button in the first group is identified. Control then passes to operation where a determination is made as to whether the next button is to be included in the second definition.

When it is determined at operation that the current button is the last button in the first group at operation a determination is made as to whether the current group in this case the first group is the last group in the current tab in this case the first tab. When it is determined at operation that the current group is the last group in the current tab at operation a determination is made as to whether the current tab is the last tab in the first XML file. When it is determined that the current tab is the last tab in the first XML file the conversion process ends.

In the system and methods of the present disclosure the first definition is first converted to the second definition and when required for example when the messaging and collaboration software running on a client computer does not support a ribbon interface a second conversion process converts the second definition to the third definition. Using two conversion processes permits the same conversion software to be used for messaging collaboration software that supports a ribbon interface and messaging and collaboration software that does not support a ribbon interface. In other examples the first definition defining a ribbon interface is converted to the third definition defining a command bar interface directly using only one conversion. When the third definition is executed for example on client computer the object model in the Microsoft Office Outlook 2007 messaging and collaboration software on client computer creates the command bar interface using the third definition.

The second definition is typically stored in a second XML file on client computer . In other examples the second definition is stored in the first XML file on client computer . At operation the second definition is parsed and at operation the first tab tag in the second definition is identified.

At operation the first tab is added as a first menu element in the third definition. For example the accounts tab from the second definition is rendered as an accounts menu item in the third definition. In this example the third definition includes a menu tag with an accounts name corresponding to the tab tag with an accounts name in the second definition.

At operation a first group corresponding to the first tab is identified in the second definition. At operation the first group is added as an element in the third definition. The first group element is added to the third definition within the hierarchy of the first menu element.

At operation a first button corresponding to the first group is identified in the second definition. At operation a first button element is added in the third definition. The first button element is added within the hierarchy of the first group element.

At operation a determination is made as to whether the current button in this case the first button is the last button in the first group. At operation when a determination is made that the current button is not the last button in the first group at operation an additional button element is added to the third definition for each additional button identified in the first group. Each additional button element is added within the hierarchy of the first group element.

At operation when all button elements for the current group in this case the first group have been added a separator element is added for the group. The separator element marks the end of the group. When rendered the separator element is shown as example separator in example command bar .

At operation a determination is made as to whether the current group in this case the first group is the last group in the current tab in this case the first tab. When it is determined that the current group is not the last group in the current tab at operation an additional group element is added to the third definition for each additional group in the current tab. After each additional group element is added to the third definition control passed to operation where one or more additional button elements are added to the third definition for each additional group element.

When it is determined at operation that the current group is the last group in the current tab at operation a determination is made as to whether the current tab is the last tab in the second XML file. When it is determined at operation that the current tab is not the last tab in the second XML file at operation an additional tab element is added to the third definition file for each additional tab in the XML file. Control then passes to operation where one or more additional group elements are added for each additional tab and control passes to operation where one or more additional button elements are added for each additional group. When it is determined at operation that the current tab is the last tab in the second XML file the second conversion process ends.

With reference to example components of client computer are shown. In example embodiments the client computer is a computing device. The client computer can include input output devices a central processing unit CPU a data storage device and a network device. The other client computers and server computers can be configured in a similar manner.

In a basic configuration the client computer typically includes at least one processing unit and system memory . Depending on the exact configuration and type of computing device the system memory may be volatile such as RAM non volatile such as ROM flash memory etc. or some combination of the two. System memory typically includes an operating system suitable for controlling the operation of a networked personal computer such as the WINDOWS operating systems from Microsoft Corporation of Redmond Wash. or a server such as Microsoft Exchange Server 2007 also from Microsoft Corporation of Redmond Wash. The system memory may also include one or more software applications and may include program data.

The client computer may have additional features or functionality. For example the client computer may also include computer readable media. Computer readable media can include both computer readable storage media and communication media.

Computer readable storage media is physical media such as data storage devices removable and or non removable including magnetic disks optical disks or tape. Such additional storage is illustrated in by removable storage and non removable storage . Computer readable storage media may include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer readable storage media can include but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by client computer . Any such computer readable storage media may be part of client computer . Client computer may also have input device s such as keyboard mouse pen voice input device touch input device etc. Output device s such as a display speakers printer etc. may also be included.

The client computer may also contain communication connections that allow the device to communicate with other computing devices such as over a network in a distributed computing environment for example an intranet or the Internet. Communication connection is one example of communication media.

Communication media may typically be embodied by computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media.

The various embodiments described above are provided by way of illustration only and should not be construed to limiting. Various modifications and changes that may be made to the embodiments described above without departing from the true spirit and scope of the disclosure.

