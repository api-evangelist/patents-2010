---

title: Adaptive compensation systems for mitigating distortion due to nonlinear power amplifiers
abstract: A method for pre-processing a signal prior to receipt of the signal by a non-linear device (NLD) to compensate for AM-AM distortion and AM-PM distortion of the signal by the NLD. The method includes generating a modified amplitude rbased on an amplitude xderived from a digitized envelope Rof the signal, generating a scale factor cbased on the modified amplitude rand the amplitude x, generating an AM-AM compensated signal based on the scale factor c, generating a first AM-PM phase compensation value based on the modified amplitude r, and generating an AM-AM and AM-PM compensated signal by modifying a phase of the AM-AM compensated signal based on the first AM-PM phase compensation value.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08654889&OS=08654889&RS=08654889
owner: The Aerospace Corporation
number: 08654889
owner_city: El Segundo
owner_country: US
publication_date: 20100326
---
This invention was made with government support under Contract No. FA8802 09 C 0001 awarded by the Department of the Air Force. The government has certain rights in the invention.

The power amplifier is one of the most important subsystems of modern communication systems. In the case of satellite downlinks the power efficiency of high power amplifiers HPAs is important because power requirements directly impact size weight and cost of the satellite payload. Because the power efficiency is relatively high when the amplifier is operated near the saturation region as may be the case for satellite links the HPA frequently must be operated in such a region. However the nonlinearity of the amplifier in the near saturation region may introduce considerable distortion in the signal to be amplified. As the output power back off is reduced the signal to distortion power ratio at the amplifier output is correspondingly reduced. This may place a significant restriction on the amount of back off that needs to be introduced resulting in a loss of the available output power and equally important a reduced power conversion efficiency. This results in an increased demand on D.C. power which in cases where power is supplied by solar panels may negatively impact the size weight and cost of the satellite payload. Schemes by which the amplifier output back off may be minimized while at the same time mitigating the distortion effects of the amplifier may therefore be desirable. Such mitigation becomes even more important when the amplifier input is comprised of relatively high power signals along with relatively low power signals as in this case distortion due to the strong signals may result in a very poor signal to distortion power ratio for the weak signals.

Previous techniques to mitigate the amplifier distortion effects generally fall into two categories. In the first category may be techniques that attempt to cancel the nonlinear term arising due to the power amplifier in a feedforward or feedback mode with the compensation operation at radio frequency RF . The feedforward linearizer consists of two loops. The first loop subtracts samples of the input signal from samples of the amplifier output signal to produce samples of the main amplifier s distortion. The second loop subtracts the amplified sampled distortion from the delayed version of the main amplifier output to obtain the final linearized output. This arrangement is complex to implement requires a second amplifier that needs to be linear to avoid generating its own distortion terms and results in power loss due to signal combining at the amplifier output. In the feedback linearizer the amplifier s input and output are detected and low pass filtered and the resulting baseband signals are compared. The error signal is used to control the gain of the amplifier so as to minimize the distortion. This technique suffers from the bandwidth limitation on the amplifier input signal as the feedback system may respond to frequencies that are much smaller than the inverse of the delay introduced by the amplifier and associated feedback circuitry thus the technique is limited to relatively narrowband signals.

In the predistortion linearization technique the amplifier input is predistorted such that the overall distortion due to the linearizer and amplifier is minimized. The linearizer gain and phase is obtained iteratively for different input power levels. A digital signal processor DSP version of the Cartesian predistortion scheme has been proposed wherein a look up table storing inphase and quadrature components of the linearizer as a function of the input signal envelope is used for predistortion for a set of input signal envelope values. The signal to be amplified is digitized and sampled values of the signal are modified by interpolated value of the stored inphase and quadrature components of the linearizer. The correction is limited by interpolation errors. In a proposed adaptive version of the DSP Cartesian predistortion scheme the stored values are updated according to the amplifier output signal which is also limited due to the interpolation errors. Based on the feedback architecture of this scheme a power amplifier linearizer for a time division duplex system has been proposed wherein a receiving subsystem is shared between the receiver and the power amplifier feedback subsystem resulting in some reduction of complexity for the time division duplex system.

Methods for pre processing a signal prior to receipt of the signal by a non linear device NLD to compensate for AM AM distortion and AM PM distortion of the signal by the NLD are disclosed. In one embodiment the method includes generating a modified amplitude rbased on an amplitude xderived from a digitized envelope Rof the signal generating a scale factor cbased on the modified amplitude rand the amplitude x generating an AM AM compensated signal based on the scale factor c generating a first AM PM phase compensation value based on the modified amplitude r and generating an AM AM and AM PM compensated signal by modifying a phase of the AM AM compensated signal based on the first AM PM phase compensation value. In another embodiment the method includes compensating by at least one processor an AM AM distortion of the signal based on a scale factor

Also disclosed is a system that in one embodiment includes a non linear electronic signal processing device for processing an input signal and a pre processor in communication with the non linear electronic signal processing device. The non linear electronic signal processing device has a non linear transfer function. The pre processor receives a signal processes the received signal and outputs the processed signal to an input of the non linear electronic signal processing device. The pre processor includes at least one processor programmed to generate a modified amplitude rbased on an amplitude xderived from a digitized envelope Rof the signal generate a scale factor cbased on the modified amplitude rand the amplitude x generate an AM AM compensated signal based on the scale factor c to generate a first AM PM phase compensation value based on the modified amplitude r and generate an AM AM and AM PM compensated signal by modifying a phase of the AM AM compensated signal based on the first AM PM phase compensation value.

Embodiments of the present application are directed to a number of polar predistortion based linearization architectures wherein the gain and phase may be individually compensated. In many cases phase distortion is more important than gain distortion and may be substantially or completely eliminated by architectures presented herein. In certain architectures presented herein the linearizer gain function may be represented by a polynomial of odd degree having coefficients obtained by an explicit minimization of the mean squared error between the actual amplifier output gain response and the ideal response which may be selected to be linear. The method may also be applied to other selected responses. The minimization may be performed using a gradient algorithm with a power 4 optimization index. Such an approach provides very good response up to the input signal amplitude where the amplifier output is saturated. However beyond this value of the saturation input the polynomial based linearizer may result in an oscillatory response at the amplifier output. To avoid this problem a modified linearizer may be used wherein the output of the linearizer is clipped to a value equal to the saturation input for any value exceeding the saturation input. This may result in ideal limiter characteristics for the linearized amplifier. Simulation examples show that a 7or 9degree polynomial provides excellent linearization results. Because the amplifier gain response is selected to be an odd function only the odd degree terms of the linearizer are non zero. Thus only 4 or 5 coefficients may need to be stored for the linearization compared to a large array of gain values as suggested by previous methods.

According to various embodiments the amplitude to phase transfer characteristic of the amplifier may be modeled by a polynomial of the input signal envelope. Typically a 9or lower degree polynomial may be needed to precisely model the characteristics over the entire range of the input signal envelope. Because the range of input signal may be limited for any given power level the approximation may be performed by a 2or 3degree polynomial about a nominal operating point resulting in a significant computational advantage which may be important in applications involving very wide band signals which may need to be sampled at relatively high rates. The coefficients of the relatively low degree polynomial may be updated at time intervals over which the nominal input power level of the amplifier is expected to change significantly due to various factors such as channel variations. The architecture may include a method to evaluate and update the nominal power level as well. At every sample time the expected phase distortion due to the amplifier may be evaluated using a 2or 3degree polynomial and pre compensated for in the AM PM compensator. Architectures that operate at RF and baseband are presented. Open loop adaptive architectures may adapt with respect to the nominal input power level changes.

In addition close loop architectures are presented that may also adapt to the relatively slow changes in the amplifier characteristics as well. In these architectures the error signal between the output of the amplifier with the open loop compensation and the ideal response may be modeled by a parametric model such as a polynomial having coefficients adapted to the variations that may occur in the amplifier characteristics and any other component variations. Because these variations may occur over a much larger time scale compared to the time scale of the signal variations the error model parameters may remain essentially constant. Therefore generation of the adaptive close loop compensation signal to offset the variations in the characteristics of the amplifier and any other components need not depend upon the instantaneous phase or amplitude error. The adaptive close loop compensation signal may instead be derived from the amplifier input signal amplitude and phase without using instantaneous feedback from the amplifier. Accordingly the close loop adaptive architecture of the present application does not have a bandwidth limitation that arises in other feedback architectures of the prior art that require instantaneous output feedback.

Also in contrast to the Cartesian predistortion architecture of the prior art in the close loop architecture of the present application there may be two distinct compensation signals based on the known amplifier characteristics and the variations in the latter respectively. Because the second component of the compensation is relatively insignificant compared to the first the architecture disclosed in the present application may be relatively more robust in terms of stability compared to architectures having a single compensation signal.

Simulations have shown that embodiments of the adaptive compensation system of the present application provide significant performance improvement even when applied to the AM AM and AM PM characteristics of an otherwise state of the art linearized amplifier. It is believed that these embodiments provide a distortion mitigation of a much higher level than is currently available.

In one general aspect embodiments of the present application are directed to devices and methods for pre processing a signal prior to receipt of the signal by a non linear device NLD to compensate for AM AM distortion and AM PM distortion of the signal by the NLD. AM AM distortion is caused by a change in a gain of the NLD arising from a change in an input power level of the NLD. AM PM distortion is caused by a phase shift introduced by the NLD arising from a change in an input power level of the NLD. An NLD that receives an input bandpass signal may comprise only the power amplifier or multiple linear or nonlinear devices such as converters amplifiers etc. in a cascaded arrangement. The input bandpass signal may be for example a single digitally modulated signal such as an offset quadrature phase shift keying OQPSK signal or the sum of a number of digitally modulated signals. In either case the combined signal at the input of the NLD may be represented in the following equivalent forms The AM PM form cos 2 1 The inphase and quadrature form cos 2 sin 2 2 where R t and t are respectively the real envelope and the phase of the bandpass signal s t and u t and v t respectively denote the real inphase and quadrature baseband signals. The frequency fmay be the RF frequency fwhen the nonlinear device is just the power amplifier or it may be equal to the intermediate frequency IF frequency fwhen the NLD is comprised of both the up converter and RF power amplifier. The signal s t may be available at the complex baseband and is equal to u t j v t with j square root over 1 in which case the real base band signals u t and v t are available directly as the real and imaginary components of s t . As will be appreciated from the discussion that follows embodiments of the present application may be implemented differently depending on for example whether the signal s t is at the RF IF frequency or at the complex baseband. The output of the NLD the last stage of which may be the RF power amplifier may be represented by cos 2 3 where the output real envelope R t and the phase t may be obtained in terms of the amplitude transfer characteristics function h and the amplitude to phase transfer characteristics function . These two functions are directly related to the AM AM and AM PM characteristics of the device which are specified in terms of power levels of the sine wave signal used in the measurements of these characteristics. In terms of the amplitude transfer characteristics function h and the amplitude to phase transfer characteristics function the output real envelope R t and the phase t may be represented by 4a 4b In equations 4a and 4b Aand Amay be appropriate input and output normalization amplitudes. For example Aand Amay be selected such that A square root over 2P A square root over 2P where Pdenotes the output power at saturation with the sine wave input signal and Pdenotes the corresponding input power level in watts. However it will be appreciated that any other convenient normalization may also be used with the corresponding modification in the function h and . If there are linear devices in the cascade operating at relatively low signal power levels e.g. bandpass filters such devices may introduce an amount of frequency dependent phase in the signal which will be added to the phase t in equation 3 . The effect of such devices on the AM AM and AM PM model of the composite device is otherwise assumed to be insignificant.

The scale factor cmay be input to the AM AM compensator where it multiplies the inphase and quadrature baseband signals uand vto generate the AM AM compensated signals uand v respectively at the AM AM compensator output. The modified amplitude rat the output of the AM AM compensation synthesizer in may be input to the AM PM compensation synthesizer which generates the negative of the estimate of the phase that will be introduced by the NLD denoted by circumflex over . The phase compensation can be input to trigonometric blocks which compute the cosine and sine respectively of the phase denoted by aand brespectively as follows cos circumflex over sin circumflex over 7 When the sampling rate is relatively high the trigonometric functions may be estimated by the following polynomial type approximations wherein the number of terms is dependent upon the maximum absolute value of circumflex over . For circumflex over 0.3 rad the following approximation may be used cos 1 2 sin 6 8 The outputs of the trigonometric blocks aand b respectively may be input to the AM PM compensator which also receives the AM AM compensated inphase and quadrature signals uand v. The AM PM compensator may add the phase circumflex over to the phase of the AM AM compensated complex baseband signal u j v j square root over 1 according to the following equations 9a 9b The AM AM and AM PM compensated signals uand vmay be converted into analog form using digital to analog converters DACs respectively and low pass filtered with the low pass filters LPFs respectively. The 3 dB bandwidths of the LPFs may be selected to be somewhat higher than the bandwidth of the input baseband signals u t and v t to take into account the nonlinear compensation introduced by the AM AM and AM PM compensators respectively. The filtered baseband signals may be input to the baseband to IF up converter which up converts the complex baseband signal to the IF frequency. After IF filtering and amplification at the IF frequency at block the IF signal may be up converted to the RF frequency at block . The resulting RF signal may then be input to the RF power amplifier the output of which is the desired compensated RF signal s t . It will be appreciated that in certain embodiments some or all of the blocks following the LPFs that filter the AM AM and AM PM compensated signals uand vmay not be a part of the adaptive compensator and may instead comprise the NLD for which AM AM and AM PM compensation is provided by the adaptive compensator .

In another embodiment the up conversion from the baseband signal to the IF frequency may be performed in the digital domain. Selecting the IF frequency such that f 2 0.5 ffor some integer 1 with fdenoting the sampling frequency of the baseband signals uand vin and delaying the sampling clock not shown for the ADC with respect to the sampling clock not shown for the ADC in by T 2 with the sampling period T 1 f the sampled IF signal s mT may be represented by 2 1 21 1 0 1 . . . 10a In equation 10a the sampling interval Tfor the IF signal smay be equal to 0.5 Tin order to satisfy the Nyquist criteria. The expression in equation 10a may be derived from equation 10b below for relating the sampled IF signal to the sampled baseband signals uand vwhen all of the signals are sampled at a rate equal to 2f. Re exp 2 square root over 1 0 1 . . . 10b 

In equation 10b Re denotes the operator that takes the real part of its argument. The equation 10a is obtained from equation 10b by substitution for fand by evaluating the complex exponential function in equation 10b . illustrates a block diagram of a digital baseband to IF converter according to one embodiment for implementing such a conversion. Referring to the digital baseband signals uand vat the output of the adaptive compensator in are input into a pair of multipliers and are multiplied by the sequence 1 output by a sequence generator such that alternate samples of the signals uand vare multiplied by 1. The output of multiplier and the inverted output of multiplier are input to a multiplexer that multiplexes the signals from the multipliers into a single multiplexed signal by alternately selecting samples from its inputs. The multiplexer output signal is input to a DAC . The output of the DAC is filtered and amplified by an analog BPF amplifier to generate the IF signal s t . If the selected IF frequency is equal to f 0.5 ffor some odd integer 1 then the embodiment of may be modified by deleting the multiplier .

Recall that rdenotes the output of the AM AM compensation synthesizer and is equal to the real envelope of the signal that is input to the IF filter and amplifier. The amplifier amplitude to phase transfer characteristic function may be modeled by a polynomial of degree Nover the entire measurement range. Outside the measurement range the phase contributed by the power amplifier or by the NLD in general is assumed to have a constant value. The NLD in may comprise the IF filter and amplifier upconverter and the RF power amplifier wherein generally only the RF power amplifier introduces the nonlinear distortion. In such cases the amplitude to phase transfer characteristic of the NLD may thus be the same as that of the RF power amplifier . The phase introduced by the RF power amplifier or the NLD at time instance k and denoted by may be represented by 

Referring to the nominal operating point Aestimated by the nominal operating point estimator and the polynomial coefficients p p . . . pevaluated by the polynomial r coefficients evaluator may be input to the AM PM compensation synthesizer at the end of each averaging interval of Nsamples. These coefficients may be used by the AM PM compensation synthesizer for a subsequent period of Nsamples. Over any of the consecutive interval of Nsamples the phase compensation circumflex over r required to compensate for the amplifier introduced phase may be computed by the AM PM compensation synthesizer .

For applications where both AM AM and AM PM are significant it may be desirable to compensate for both of these distortion effects. Compensation for the AM AM distortion may be performed by the AM AM compensation synthesizer and the AM AM compensator in . Compensation for AM AM may be implemented using an inverse function such that the cascade of the inverse function and the amplitude transfer characteristic function yields a linear function. Let h x denote the amplitude transfer characteristics function of the amplifier so that the output amplitude y h x with the input signal amplitude equal to x. Let the inverse function of h be modeled by a polynomial of degree Ngiven by 26 The output amplitude of the cascade of the inverse function and the amplifier may thus be represented by 27 The difference between yand xis the error ewhich needs to be minimized in the approximation of the inverse function. Selecting the error measure to be F e for some nonnegative and monotone increasing function F e for example F e e the minimization problem may then involve the minimization of the following optimization function J with respect to the coefficients of the polynomial B x e.g. 

To minimize the number of real time operations the degree Nof the polynomial B x may be made dependent upon the average input signal A and thus dependent upon the amplifier output back off. As the polynomial B x may be an odd degree polynomial the number of non zero coefficients may be equal to N 1 2. In certain embodiments the polynomials corresponding to N 3 5 7 and 9 may be evaluated and stored in memory and depending upon the average value Aor the output back off level the appropriate coefficients may be used. Alternatively the highest degree polynomial may be used for all times at the cost of a possible increase in the number of real time computations.

Referring to the polynomial coefficients B B . . . Bmay be computed at block and as described above and input to the AM AM compensation synthesizer which may compute the modified amplitude r B x based on the polynomial B x . The AM AM compensation synthesizer may also output the scale factor c which is equal to r xif x for some relatively small positive number and otherwise equal to the derivative of B x at x 0 to avoid any numerical problems incurred in dividing one nearly zero number by another number also close to zero. Referring to the AM AM compensator may multiply the inphase and quadrature baseband signals uand vby the scale factor cto generate the AM AM compensated baseband signals uand v. The AM AM compensated baseband signals uand vmay be input to the AM PM compensator for compensating for the AM PM distortion.

In cases in which the signal s t is at the IF frequency the signal s t may be sampled directly to provide the digital inphase and quadrature baseband signals uand v. This may be achieved by sampling the IF signal at a rate Fthat is related to fsuch that the samples of s t relate directly to uand v. For example selection of a sample rate such that f F 2m 1 4 for some appropriate integer m provides the desired result as shown below.

With cos 2 sin 2 37 and with f F 2m 1 4 T 1 F the sample values of the cos and sin terms are given by 

Operation of the AM AM compensation synthesizer of is shown in and may be same as that for the system of . The gain signal may be converted into the analog form by a DAC and filtered by a LPF to generate the analog gain signal c t . The analog gain signal c t may be input to the product modulator . The product modulator may also be connected to the output of the RF BPF amplifier via the coupler . The signal c t amplitude may modulate the RF signal input in the product modulator thus multiplying the real envelope by c t . The product modulator should have a good linearity in terms of both of its inputs. The other output rof the AM AM compensation synthesizer is input to the AM PM compensation synthesizer that generates the phase compensation signal circumflex over . The operation of the AM PM compensation synthesizer of is shown in and may be the same as that of the AM PM compensation synthesizer in the system of . The phase compensation signal may be converted into the analog form by a DAC and filtered by a LPF to generate the analog phase compensation signal circumflex over t . The signal circumflex over t may be input to the phase modulator where it modifies the phase of the RF signal at its input by circumflex over t . Thus with s t denoting the RF input to the product modulator and given by equation 40 cos 2 40 where fdenotes the carrier frequency of the RF signal the output of the phase modulator s t may be represented by cos 2 circumflex over 41 The compensated signal s t is input to the power amplifier chain which may comprise power amplifier to generate the compensated and amplified signal s t at the output.

The adaptive compensators of adapt the compensator with respect to the power level variations at the input of the NLD. These variations are measured in terms of the nominal operating point A which is the measure of average power over some selected time segment. However there may also be variations of the AM AM and AM PM characteristics of the NLD that may be caused by variations in the environmental temperature and with aging. In the case of a power amplifier the variations in AM AM characteristics may be relatively insignificant while the variations in AM PM characteristics may be somewhat significant. For a more precise compensation it may be desirable to take into account such variations. shows one embodiment of closed loop adaptive compensator that takes such variations into account. The adaptive compensator may be implemented for example using a computing device such as for example computing device discussed below in connection with . The compensator of may implement adaptation with respect to the variations in the AM PM characteristics. If required the adaptation with respect to the variations in the AM AM characteristics can be similarly included in system .

The performance of embodiments of the disclosed architecture has been evaluated when applied to compensate for the distortion due to a traveling wave tube amplifier TWTA and one of its linearized versions. In the discussion that follows the performance is presented when the TWTA is described in terms of the Saleh model. Similar results were obtained for the case of an otherwise linearized TWTA. For the Saleh model the amplitude to phase transfer characteristics function r in equation 4 with r denoting the normalized and possibly modified due to the AM AM compensation input signal real envelope may be represented by 1 2.5293 2.8168 48 plots the phase transfer characteristics function r versus r for the Saleh model. also shows the result of approximating the function r by a polynomial g r see equation 12 of degree 5. The polynomial approximation is given by 0.6523 3.015 5.1079 3.4528 0.0454 0.0004 49 As may be inferred from the two graphs are very close with the rms approximation error equal to 0.0012 rad.

The amplitude transfer characteristics function h x in equation 4 for the Saleh model may be represented by 1 1.9638 0.9945 52 The AM AM distortion is compensated by a function B x of equation 36 where the polynomial B x may be an odd degree polynomial obtained by the iterative optimization described by equations 28 35 . The parameter Ain equation 36 depends upon the degree of polynomial B x selected for optimization. plots the amplitude transfer characteristics function h x given by equation 52 . also shows the result with the distortion compensation when the degree of the polynomial B x is 7 with 4 nonzero terms. The polynomial B x for this case may be represented by 0.7612 0.2532 0.0835 1.0292 53 The parameter Afor this case is equal to 0.763.

The performance of the compensation system may be evaluated when the input to the amplifier is the sum of a wideband signal and a narrow band signal wherein both the signals are digitally modulated signals with OQPSK modulation. In the simulation example both the signals are filtered by square root raised cosine filters. The WB signal has a rate R 100 Msps with the square root raised cosine filter roll off factor equal to 0.3. The narrowband NB signal with rate R 4.44 Msps has the filter roll off factor 0.21. The separation between the center frequencies of the two signals fis equal to 68.12 MHz thus avoiding any overlap among their spectrums. Both the signals have the same peak power spectral densities. The ratio of the power levels of the two signals is 22.5 or 13.52 dB. The performance may be obtained in terms of the probability of bit error for the two signals in the presence of the distortion introduced by the amplifier and the receiver thermal noise. The results may be obtained for various values of the output power back off in dB relative to the maximum possible power level at the amplifier input with a tone signal input. Due to the nature of the band limited digital signals the minimum achievable output power back off is strictly greater than zero.

The performance of the NB signal can be improved by increasing above 0 dB. Such an increase results in a penalty in terms of an effective increase in the required overall E N . The overall increase in the required E N due to a higher E N for the NB signal compared to the WB signal by dB may be represented by 10 log 1 10 1 58 From equation 58 for the case considered in the simulation example E N is about 0.19 dB with E N E N 3 dB. With the difference in the E N of the two signals equal to 6 dB E N 0.53 dB. Thus the amplifier may be operated at saturation even with two signals at its input with only a minimal increase in the overall required E N .

It will be appreciated by one of ordinary skill in the art that at least some of the embodiments described herein or parts thereof may be implemented using hardware firmware and or software. The firmware and software may be implemented using any suitable computing device s . shows an example of a computing device according to one embodiment. For the sake of clarity the computing device is illustrated and described here in the context of a single computing device. However it is to be appreciated and understood that any number of suitably configured computing devices can be used to implement a described embodiment. It will also be appreciated that one such device or multiple devices may be shared in a time division multiplex mode among compensators for multiple power amplifiers as may be the case for example in a base station of a mobile communication network. For example in at least some implementations multiple communicatively linked computing devices are used. One or more of these devices can be communicatively linked in any suitable way such as via one or more networks. One or more networks can include without limitation the Internet one or more local area networks LANs one or more wide area networks WANs or any combination thereof.

In this example the computing device comprises one or more processor circuits or processing units one or more memory circuits and or storage circuit component s and one or more input output I O circuit devices . Additionally the computing device comprises a bus that allows the various circuit components and devices to communicate with one another. The bus represents one or more of any of several types of bus structures including a memory bus or memory controller a peripheral bus an accelerated graphics port and a processor or local bus using any of a variety of bus architectures. The bus may comprise wired and or wireless buses.

The processing unit may be responsible for executing various software programs such as system programs applications programs and or program modules blocks to provide computing and processing operations for the computing device . The processing unit may be responsible for performing various voice and data communications operations for the computing device such as transmitting and receiving voice and data information over one or more wired or wireless communications channels. Although the processing unit of the computing device is shown in the context of a single processor architecture it may be appreciated that the computing device may use any suitable processor architecture and or any suitable number of processors in accordance with the described embodiments. In one embodiment the processing unit may be implemented using a single integrated processor.

The processing unit may be implemented as a host central processing unit CPU using any suitable processor circuit or logic device circuit such as a general purpose processor. The processing unit also may be implemented as a chip multiprocessor CMP dedicated processor embedded processor media processor input output I O processor co processor microprocessor controller microcontroller application specific integrated circuit ASIC field programmable gate array FPGA programmable logic device PLD or other processing device in accordance with the described embodiments.

As shown the processing unit may be coupled to the memory and or storage component s through the bus . The bus may comprise any suitable interface and or bus architecture for allowing the processing unit to access the memory and or storage component s . Although the memory and or storage component s may be shown as being separate from the processing unit for purposes of illustration it is worthy to note that in various embodiments some portion or the entire memory and or storage component s may be included on the same integrated circuit as the processing unit . Alternatively some portion or the entire memory and or storage component s may be disposed on an integrated circuit or other medium e.g. hard disk drive external to the integrated circuit of the processing unit . In various embodiments the computing device may comprise an expansion slot to support a multimedia and or memory card for example.

The memory and or storage component s represent one or more computer readable media. The memory and or storage component s may be implemented using any computer readable media capable of storing data such as volatile or non volatile memory removable or non removable memory erasable or non erasable memory writeable or re writeable memory and so forth. The memory and or storage component s may comprise volatile media e.g. random access memory RAM and or nonvolatile media e.g. read only memory ROM Flash memory optical disks magnetic disks and the like . The memory and or storage component s may comprise fixed media e.g. RAM ROM a fixed hard drive etc. as well as removable media e.g. a Flash memory drive a removable hard drive an optical disk . Examples of computer readable storage media may include without limitation RAM dynamic RAM DRAM Double Data Rate DRAM DDRAM synchronous DRAM SDRAM static RAM SRAM read only memory ROM programmable ROM PROM erasable programmable ROM EPROM electrically erasable programmable ROM EEPROM flash memory e.g. NOR or NAND flash memory content addressable memory CAM polymer memory e.g. ferroelectric polymer memory phase change memory ovonic memory ferroelectric memory silicon oxide nitride oxide silicon SONOS memory magnetic or optical cards or any other type of media suitable for storing information.

The one or more I O devices allow a user to enter commands and information to the computing device and also allow information to be presented to the user and or other components or devices. Examples of input devices include data ports ADCs DACs a keyboard a cursor control device e.g. a mouse a microphone a scanner and the like. Examples of output devices include data ports ADCs DACs a display device e.g. a monitor or projector speakers a printer a network card . The computing device may comprise an alphanumeric keypad coupled to the processing unit . The keypad may comprise for example a QWERTY key layout and an integrated number dial pad. The computing device may comprise a display coupled to the processing unit . The display may comprise any suitable visual interface for displaying content to a user of the computing device . In one embodiment for example the display may be implemented by a liquid crystal display LCD such as a touch sensitive color e.g. 76 bit color thin film transistor TFT LCD screen. The touch sensitive LCD may be used with a stylus and or a handwriting recognizer program.

The processing unit may be arranged to provide processing or computing resources to the computing device . For example the processing unit may be responsible for executing various software programs including system programs such as operating system OS and application programs. System programs generally may assist in the running of the computing device and may be directly responsible for controlling integrating and managing the individual hardware components of the computer system. The OS may be implemented for example as a Microsoft Windows OS Symbian OS Embedix OS Linux OS Binary Run time Environment for Wireless BREW OS JavaOS or other suitable OS in accordance with the described embodiments. The computing device may comprise other system programs such as device drivers programming tools utility programs software libraries application programming interfaces APIs and so forth.

Various embodiments may be described herein in the general context of computer executable instructions such as software or program modules blocks being executed by a computer. Generally program modules blocks include any software element arranged to perform particular operations or implement particular abstract data types. Software can include routines programs objects components data structures and the like that perform particular tasks or implement particular abstract data types. An implementation of these modules blocks or components and techniques may be stored on and or transmitted across some form of computer readable media. In this regard computer readable media can be any available medium or media used to store information and accessible by a computing device. Some embodiments also may be practiced in distributed computing environments where operations are performed by one or more remote processing devices that are linked through a communications network. In a distributed computing environment program modules blocks may be located in both local and remote computer storage media including memory storage devices.

Although some embodiments may be illustrated and described as comprising functional component or modules blocks performing various operations it can be appreciated that such components or modules blocks may be implemented by one or more hardware components software components and or combination thereof. The functional components and or modules blocks may be implemented for example by logic e.g. instructions data and or code to be executed by a logic device e.g. processor . Such logic may be stored internally or externally to a logic device on one or more types of computer readable storage media. Examples of hardware elements may include processors microprocessors circuits circuit elements e.g. transistors resistors capacitors inductors and so forth integrated circuits application specific integrated circuits ASIC programmable logic devices PLD digital signal processors DSPs field programmable gate array FPGA logic gates registers semiconductor devices chips microchips chip sets and so forth. Examples of software may include software components programs applications computer programs application programs system programs machine programs operating system software middleware firmware software modules blocks routines subroutines functions methods procedures software interfaces application program interfaces API instruction sets computing code computer code code segments computer code segments words values symbols or any combination thereof. Determining whether an embodiment is implemented using hardware elements and or software elements may vary in accordance with any number of factors such as desired computational rate power levels heat tolerances processing cycle budget input data rates output data rates memory resources data bus speeds and other design or performance constraints.

It also is to be appreciated that the described embodiments illustrate example implementations and that the functional components and or modules blocks may be implemented in various other ways which are consistent with the described embodiments. Furthermore the operations performed by such components and or modules blocks may be combined and or separated for a given implementation and may be performed by a greater number or fewer number of components and modules blocks.

It is worthy to note that any reference to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment. The appearances of the phrase in one embodiment in the specification are not necessarily all referring to the same embodiment.

Unless specifically stated otherwise it may be appreciated that terms such as processing computing calculating determining or the like refer to the action and or processes of a computer or computing system or similar electronic computing device that manipulates and or transforms data represented as physical quantities e.g. electronic within registers and or memories into other data similarly represented as physical quantities within the memories registers or other such information storage transmission or display devices.

While certain features of the embodiments have been illustrated as described above many modifications substitutions changes and equivalents will now occur to those skilled in the art. It is therefore to be understood that the appended claims are intended to cover all such modifications and changes as fall within the scope of the embodiments.

A first method for pre processing a signal prior to receipt of the signal by a NLD to compensate for AM AM distortion and AM PM distortion of the signal by the NLD is disclosed hereinabove. In one embodiment the first method includes generating by at least one processor a modified amplitude rbased on an amplitude xderived from a digitized envelope Rof the signal generating by the at least one processor a scale factor cbased on the modified amplitude rand the amplitude x generating by the at least one processor an AM AM compensated signal based on the scale factor c generating by the at least one processor a first AM PM phase compensation value based on the modified amplitude r and generating by the at least one processor an AM AM AM PM compensated signal by modifying a phase of the AM AM compensated signal based on the first AM PM phase compensation value. In certain embodiments of the first method the signal is a complex baseband signal and a digitized representation of the signal includes an inphase signal component uand a quadrature signal component v. In one such embodiment the AM AM compensated signal includes an inphase signal component uand a quadrature signal component v and the step of generating an AM AM compensated signal includes determining uas the product c uand vas the product c v.

In certain embodiments of the first method the signal is an RF signal or an IF signal. In one such embodiment the step of generating an AM AM compensated signal includes multiplying the signal by an analog representation of the scale factor c.

In certain embodiments of the first method the step of generating a modified amplitude rincludes evaluating a function B x to generate r. B may be an inverse function of an amplitude transfer function h of the NLD.

In certain embodiments of the first method the step of generating a scale factor cincludes determining

In certain embodiments of the first method the step of generating a first AM PM phase compensation value includes determining coefficient values of a polynomial of degree nthat approximates an amplitude to phase transfer function of the NLD and evaluating r wherein r is equal to the first AM PM phase compensation value. The degree nof may be 2 or 3 in certain embodiments. The step of generating a first AM PM phase compensation value may further include in certain embodiments estimating a nominal operating amplitude Abased on an average value of the modified amplitude rover each of a number of time intervals T and adaptively updating coefficient values of such that approximates the amplitude to phase transfer function of the NLD about the nominal operating amplitude A.

In certain embodiments the first method further includes generating a second AM PM phase compensation value by evaluating a function circumflex over r and generating an AM AM and AM PM compensated signal by modifying a phase of the AM AM compensated signal based on the second AM PM phase compensation value. circumflex over may be a polynomial function of degree nand model a phase error caused by at least one of 1 environmentally induced variations in an amplitude to phase transfer function of the NLD 2 time dependent variations in an amplitude to phase transfer function of the NLD and 3 an unmodeled nonlinearity of the NLD. Coefficient values of circumflex over may be adaptively determined using a gradient algorithm for minimizing error between circumflex over and .

In certain embodiments the first method further includes iteratively determining coefficient values of B using a gradient algorithm for minimizing error between an input amplitude x and h B x and terminating the iterative determination when h B x is substantially linear over a range of x. B may be a polynomial of degree N. In certain embodiments of the first method the degree Nof B is an odd number. For example the degree Nof B may selected from the group consisting of 3 5 7 and 9 in certain embodiments.

In certain embodiments the first method further includes limiting B to a constant value Afor values of x A wherein Ais a minimum value of x for which h B x is substantially equal to a saturation amplitude A.

In certain embodiments the first method further includes based on changes in an average value of the modified amplitude rover a number of time intervals T adaptively modifying the degree Nof B.

A second method for pre processing a signal prior to receipt of the signal by a NLD to compensate for AM AM distortion and AM PM distortion of the signal by the NLD is disclosed hereinabove. In one embodiment the second method includes compensating by at least one processor an AM AM distortion of the signal based on a scale factor

In certain embodiments the second method further includes generating a second AM PM phase compensation value determined by a function circumflex over r and compensating by at least one processor the AM PM distortion of the signal based on the second AM PM phase compensation value. circumflex over may be a polynomial function of degree nand model a phase error caused by at least one of 1 environmentally induced variations in an amplitude to phase transfer function of the NLD 2 time dependent variations in an amplitude to phase transfer function of the NLD and 3 an unmodeled nonlinearity of the NLD. Coefficient values of circumflex over may be adaptively determined using a gradient algorithm for minimizing error between circumflex over and .

Also disclosed hereinabove is a system that in one embodiment includes a non linear electronic signal processing device for processing an input signal and a pre processor in communication with the non linear electronic signal processing device. The non linear electronic signal processing device may have a non linear transfer function. In certain embodiments the non linear electronic signal processing device may be a power amplifier. In other embodiments the non linear electronic signal processing device may include a cascade of multiple signal processing devices. In one such embodiment at least one device in the cascade of multiple signal processing devices may be a power amplifier.

The pre processor may receive a signal process the received signal and output the processed signal to an input of the non linear electronic signal processing device. The pre processor may include at least one processor programmed to generate a modified amplitude rbased on an amplitude xderived from a digitized envelope Rof the signal generate a scale factor cbased on the modified amplitude rand the amplitude x generate an AM AM compensated signal based on the scale factor c generate a first AM PM phase compensation value based on the modified amplitude r and generate an AM AM and AM PM compensated signal by modifying a phase of the AM AM compensated signal based on the first AM PM phase compensation value.

In certain embodiments the processor s may be further programmed to store a polynomial function B of degree Nand evaluate B x wherein B x r. B may be an inverse function of an amplitude transfer function h of the non linear electronic signal processing device. In certain embodiments the degree Nof B may be an odd number. For example the degree Nof B may be selected from the group consisting of 3 5 7 and 9 in certain embodiments. In certain embodiments the degree Nof B may be based on changes in an average value of the modified amplitude rover a number of time intervals T.

In certain embodiments the processor s may be further programmed to store a polynomial of degree nthat approximates an amplitude to phase transfer function of the non linear electronic signal processing device and evaluate r wherein r is equal to the first AM PM phase compensation value. In certain embodiments the degree nof may be selected from the group consisting of 2 and 3.

In certain embodiments the processor s may be further programmed to estimate a nominal operating amplitude Abased on an average value of the modified amplitude rover each of a number of time intervals T and adaptively update coefficient values of such that approximates the amplitude to phase transfer function of the non linear electronic signal processing device about the nominal operating amplitude A.

In certain embodiments the processor s may be further programmed to generate a second AM PM phase compensation value by evaluating a function circumflex over r and generate the AM AM and AM PM compensated signal by modifying the phase of the AM AM compensated signal based on the second AM PM phase compensation value. circumflex over may be a polynomial function of degree nand model a phase error caused by at least one of 1 environmentally induced variations in an amplitude to phase transfer function of the non linear electronic signal processing device 2 time dependent variations in an amplitude to phase transfer function of the non linear electronic signal processing device and 3 an unmodeled nonlinearity of the non linear electronic signal processing device. Coefficient values of circumflex over may be adaptively determined using a gradient algorithm for minimizing error between circumflex over and .

