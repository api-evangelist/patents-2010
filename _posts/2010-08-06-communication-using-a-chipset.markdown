---

title: communication using a chipset
abstract: A technique for communicating information using an electronic device that includes an IEEE 802.11-compliant chipset is described. This communication technique facilitates transmission of data packets in IEEE 802.11 frames in a communication channel by the IEEE 802.11-compliant chipset using time division multiple access (TDMA). In particular, the electronic device may queue a data packet in a software queue. Based on available space in a hardware queue in the IEEE 802.11-compliant chipset, this data packet may be provided to the hardware queue for inclusion in an IEEE 802.11 frame that is compliant with an IEEE 802.11 communication protocol. Then, the electronic device provides time-slot control information to the IEEE 802.11-compliant chipset based on a timing-synchronization signal. In this way, the electronic device gates the release of the data packet from the hardware queue for transmission in the IEEE 802.11 frame by the IEEE 802.11-compliant chipset.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08457124&OS=08457124&RS=08457124
owner: Palo Alto Research Center Incorporated
number: 08457124
owner_city: Palo Alto
owner_country: US
publication_date: 20100806
---
The present disclosure relates to techniques for communicating information. More specifically the present disclosure relates to techniques for communicating data packets in a communication channel by a carrier sense multiple access CSMA based chipset using time division multiple access TDMA .

Networks that use carrier sense multiple access CSMA with contention avoidance protocol such as IEEE 802.11 typically have poor performance for real time traffic for example with voice over Internet protocol VoIP or video data streams. This performance problem can be pronounced when there is high contention for the communication channel in the network or when some of the terminals or nodes in the network are hidden from the remaining nodes and the carrier sense mechanism in CSMA fails.

One technique for solving the performance problem is to communicate information in the network using time division multiple access TDMA . However the high cost of developing such a chipset can be prohibitive.

Hence what is needed is a method and an electronic device that facilitates TDMA communication with a CSMA chipset without the problems listed above.

The disclosed embodiments relate to a method for communicating information that is performed by an electronic device that includes an IEEE 802.11 compliant chipset. During operation the electronic device queues a data packet in a software queue. Then the electronic device provides the data packet to a hardware queue in the IEEE 802.11 compliant chipset for inclusion in an IEEE 802.11 frame. Note that the data packet is provided based on available space in the hardware queue and that the IEEE 802.11 frame is compliant with an IEEE 802.11 communication protocol. Next the electronic device provides time slot control information to the IEEE 802.11 compliant chipset based on a timing synchronization signal thereby gating the release of the data packet from the hardware queue for transmission in the IEEE 802.11 frame in a communication channel by the IEEE 802.11 compliant chipset using time division multiple access TDMA .

In some embodiments the time slot control information includes a count value for a timer in the IEEE 802.11 compliant chipset. Alternatively the time slot control information may include a timing signal generated by a timer in software.

Furthermore the electronic device may disable a contention avoidance feature in the IEEE 802.11 compliant chipset and or configure the IEEE 802.11 compliant chipset to release one data packet at a time from the hardware queue.

Note that providing the data packet to the hardware queue may involve an asynchronous operation. Additionally gating the hardware queue may involve writing a value to a hardware port in the IEEE 802.11 compliant chipset.

A variety of techniques may be used to ensure time synchronization among electronic devices including the electronic device that communicate via the communication channel using TDMA. In some embodiments the electronic device communicates timing synchronization information associated with the timing synchronization signal to another IEEE 802.11 compliant chipset in a communication system using in band communication in the communication channel. For example the timing synchronization information may be provided to the IEEE 802.11 compliant chipset for inclusion in a standard header field in the IEEE 802.11 frame that includes the data packet. In this way the time slot synchronization information may facilitate common timing of the communication channel using TDMA. However in other embodiments the electronic devices may receive the timing synchronization signal from an external source using out of band communication.

In some embodiments the electronic device queues multiple data packets in multiple software queues and maps software queues to hardware queues. Then the electronic device provides the data packets to the hardware queues in the IEEE 802.11 compliant chipset for inclusion in IEEE 802.11 frames. Note that the data packets are provided based on available space in the hardware queues and the IEEE 802.11 frames are compliant with the IEEE 802.11 communication protocol. Next the electronic device provides additional time slot control information to the IEEE 802.11 compliant chipset based on the timing synchronization signal to gate the release of the data packets from the hardware queues for transmission by the IEEE 802.11 compliant chipset in the communication channel using TDMA.

Moreover a subset of the data packets may be included in a given IEEE 802.11 frame and or a given time slot may include multiple mini time slots that include an associated subset of the data packets.

Note that the number of software queues and the number of hardware queues are selected based on a timing error associated with the gating and utilization of the communication channel. Additionally the hardware queues may be associated with different communication priorities and or the data packets may be provided from the software queues to the hardware queues based on a packet scheduler which performs the mapping.

In some embodiments a given hardware queue is associated with a given data packet transmission time of a subset of the data packets for a given data rate in the communication channel thereby facilitating inclusion of the data packets within a bounded time duration of assigned time slots. Furthermore a sequence of data packets in a data stream which have different data packet transmission times may be assigned to one of the hardware queues that can accommodate a largest data packet transmission time in the different data packet transmission times.

Another embodiment provides a computer program product for use with the electronic device. This computer program product includes instructions for at least some of the operations performed by the electronic device.

Table 1 provides possible data packet combinations in a time slot in accordance with an embodiment of the present disclosure.

Note that like reference numerals refer to corresponding parts throughout the drawings. Moreover multiple instances of the same part are designated by a common prefix separated from an instance number by a dash.

Embodiments of an electronic device that includes an IEEE 802.11 compliant chipset a method for communicating information using the electronic device and a computer program product e.g. software that includes instructions for operations in the method are described. This communication technique facilitates transmission of data packets in IEEE 802.11 frames in a communication channel by the IEEE 802.11 compliant chipset using time division multiple access TDMA . In particular the electronic device may queue a data packet in a software queue. Based on available space in a hardware queue in the IEEE 802.11 compliant chipset this data packet may be provided to the hardware queue for inclusion in an IEEE 802.11 frame that is compliant with an IEEE 802.11 communication protocol. Then the electronic device provides time slot control information to the IEEE 802.11 compliant chipset based on a timing synchronization signal. In this way the electronic device gates the release of the data packet from the hardware queue for transmission in the IEEE 802.11 frame by the IEEE 802.11 compliant chipset.

By facilitating the use of the IEEE 802.11 compliant chipset to communicate the data packets in IEEE 802.11 frames in the communication channel using TDMA this communication technique may eliminate the need to develop and manufacture a separate TDMA chipset. Consequently this communication technique may solve the problem of the high cost of entry in the market by enabling a low cost solution based on a commercially available chipset. In the process the communication technique may provide the advantages of TDMA communication in networks that use an IEEE 802.11 communication protocol including close to 80 bandwidth efficiency.

In the discussion that follows the IEEE 802.11 compliant chipset an IEEE 802.11 frame format and the IEEE 802.11 communication protocol are used as illustrations of the communication technique. More generally in other embodiments the communication technique may be used with other chipsets frame formats and communication protocols including other carrier sense multiple access CSMA communication protocols.

We now discuss embodiments of the electronic device. presents a block diagram of an electronic device that includes an IEEE 802.11 compliant chipset . In this electronic device a data packet is queued in a software queue such as one of software queues . Then this data packet is provided to one of hardware queues based on available buffer space in the hardware queue for example using a packet scheduler that determines a mapping from software queues to hardware queues for subsequent inclusion in an IEEE 802.11 frame that is compliant with an IEEE 802.11 communication protocol such as IEEE 802.11a or IEEE 802.11n . For example the data packet may be transferred to the hardware queue using an asynchronous operation such as a direct memory access DMA .

More generally electronic device may queue multiple data packets in multiple software queues and the packet scheduler may map software queues to hardware queues . Furthermore electronic device may provide the data packets to hardware queues based on available buffer space in hardware queues for subsequent inclusion in IEEE 802.11 frames.

Next electronic device provides time slot control information to chipset based on the timing synchronization signal to gate the release of a corresponding data packet from one of hardware queues for transmission by chipset in the IEEE 802.11 frame in a communication channel using TDMA. In this way electronic device gates the release of the data packet from hardware queues and facilitates TDMA communication.

Note that in some embodiments the time slot control information includes a timing signal that is provided by optional slot timer which may be implemented in hardware or software in electronic device . However in other embodiments the time slot control information includes a count value that is provided to optional slot timer in chipset i.e. the time slot control information is provided by software that executes in electronic device .

At a given time this time slot control information gates the release of a data packet from one of hardware queues . In some embodiments the timing signal provided by optional slot timer or optional slot timer writes a value to hardware port which performs the gating after an associated delay of approximately 1 s.

Moreover a frame assembly mechanism such as an IEEE 802.11 distributed coordination function adds headers to the IEEE 802.11 frame which are associated with the data packet . Subsequently transmitter transmits the resulting IEEE 802.11 frame in a time slot on the communication channel using TDMA.

Furthermore time slot header may include timing synchronization information if in band time synchronization is used a transmitter node identifier a number of data packets and or control information such as reservations network topology a checksum etc. . Additionally data packet header may include a receiver node identifier a byte length a checksum etc. . This information may facilitate CSMA subsequent reservations by nodes such as electronic device in and TDMA communication. Note that the reservations may determine which node gets which time slot and frame and which data packet s are in that time slot.

As noted previously data packets may be assigned to time slots using a packet scheduler that maps software queues to hardware queues . For example the packet scheduler may use techniques such as weighted fair queuing or priority queuing to fit the data packets in hardware queues into the bounded time of time slots . However if an entire time slot is assigned to a single node it may be difficult to get the correct timing by gating hardware queues . In order to reduce the impact of missed timing on the utilization or efficiency of the communication channel in some embodiments time slot duration of a given time slot is sub divided into mini time slots having mini time slot duration which may be assigned to one or more receiving nodes. For example a 1000 s time slot may include four is mini time slots which are each separated by a guard interval or time delay such as a 1 s delay . In embodiments with mini time slots a mini time slot scheduler may be used to assign data packets from hardware queues to these mini time slots such as a strict priority scheduler which may use a counter in hardware queues or in software and or a weighted fair queuing scheduler.

Note that the use of mini time slots may cause a slightly poorer overall average utilization of the communication channel. Thus in general the number of software queues and the number of hardware queues may be selected based on a timing error associated with the gating and the utilization of the communication channel.

The functionality in electronic device that configures and controls chipset may be implemented in dedicated hardware and or in software such as instructions that are executed by a processor so long as the underlying IEEE 802.11 hardware i.e. chipset supports gated transmit hardware queues and has a low latency hardware queue enable via a register setting. For example electronic device may include an embedded RISC processor and or a software solution such as a real time Linux operating system e.g. real time application interface .

This is shown in which presents a block diagram of an electronic device that includes IEEE 802.11 compliant chipset . Electronic device includes one or more processors or processing units chipset memory and one or more signal lines coupling these components together. Note that the one or more processing units may support parallel processing and or multi threaded operation.

Furthermore memory may include volatile memory and or non volatile memory. More specifically memory may include ROM RAM EPROM EEPROM flash one or more smart cards one or more magnetic disc storage devices and or one or more optical storage devices. Memory may store an operating system that includes procedures or a set of instructions for handling various basic system services for performing hardware dependent tasks. In some embodiments the operating system is a real time operating system. Memory may also store communication procedures or a set of instructions in a communication module . These communication procedures may be used for communicating with one or more electronic devices or nodes that are remotely located with respect to electronic device in the network.

Memory may also include multiple program modules or sets of instructions including packet scheduler or a set of instructions and or timing module or a set of instructions . Note that one or more of these program modules may constitute a computer program mechanism or a software driver for chipset .

During operation data packets are queued in software queues such as software queue A and software queue B . Then data packets are provided to hardware queues in chipset based on available space in the hardware queues for subsequent inclusion in IEEE 802.11 frames that are compliant with an IEEE 802.11 communication protocol. In particular packet scheduler may determine the mapping of software queues to the hardware queues which may correspond to time slots and or mini time slots in the IEEE 802.11 frames.

Then timing module provides time slot control information to chipset based on a timing synchronization signal that is derived from timing synchronization information . This time slot control information may be used to gate the release of data packets from the hardware queues for transmission in the IEEE 802.11 frame in a communication channel by chipset using TDMA.

Note that time slot control information may be generated in hardware such as a slot timer in either electronic device or chipset . Thus time slot control information may include a timing signal or a count value. Furthermore timing synchronization information may include mutual synchronization information that is shared between electronic devices or nodes in the network and or may be provided by an external source. This timing synchronization information may be communicated to or among the electronic devices using in band and or out of band communication.

In some embodiments assignment of data packets from software queues and or hardware queues is also based on data packet priorities and or an associated one of data streams such as data stream A or data stream B .

Furthermore in some embodiments electronic device provides reservation information such as currently reserved time slots and or mini time slots as well as future reservation requests by the electronic devices in the network to chipset for inclusion in the IEEE 802.11 frames.

In an exemplary embodiment TDMA communication over IEEE 802.11a or 802.11n is implemented in the physical layer using IEEE 802.11 compatible chipset features such as those in a chipset from Atheros Communication Inc. of Santa Clara Calif. In particular a custom packet is embedded inside of an IEEE 802.11 physical layer convergence protocol PLCP header using a reserved IEEE 802.11 frame type and slotting and queuing features may be configured to increase performance. As a consequence to all non TDMA nodes in the network it will appear that the communication channel is occupied by standards compliant frames of an unknown type.

In the Atheros chipset all of the queues may be initialized in CBR scheduled mode with OneShot enabled. As a consequence each of the ten hardware queues Q Q is blocked and will queue data packets until both of the following conditions are true the CBR timer expires and the OneShotArm is set true via a register setting. Note that because the hardware queues are run in OneShot mode the CBR timer may be run at a very short interval e.g. 5 s such that there is minimum latency between OneShotArm and the beginning of data packet transmission.

Once a hardware queue is enabled via the above two conditions it will continue sending data packets in priority order until the queue ReadyTime expires or until a Virtual End Of List VEOL is detected. In order to ensure that each setting of OneShotArm for the hardware queue transmits exactly one data packet VEOL may be set on every data packet queued. Therefore ReadyTime may be set to a large value such as time slot duration .

Because scheduling is performed using TDMA headers contention avoidance features in the Atheros chipset may be disabled for example by setting minimum values for parameters such as AIFS and CWmin CWmax. In addition backoff after transmit and virtual collisions may be disabled. This may allow the electronic device to contend for the communication channel after zero backoff time slots without increasing the contention window.

As described previously in the context of a guard interval or time delay may be included at the end of each time slot or mini time slot. For example at 54 Mbps time slot length or duration may be 400 s which corresponds to 2500 time slots per second . These time slots may each have a 10 s guard band. Note that in the remaining 390 s a single data packet of 2562 bytes may be transmitted. Furthermore note that at 54 Mbps time slot duration may be 400 s and mini time slot duration may be 65 s.

In some embodiments multiple hardware queues may be used for different data packet sizes or different data packet transmission times and or different data packet priorities which may allow the total air time for each time slot or mini time slot to be bounded. This is shown in which presents a block diagram of hardware queues in the IEEE 802.11 compliant chipset. In particular there are different classes of time bound hardware queues including bounded data packet transmission times of 250 500 and 1000 s for low priority and high priority data streams for example web page or file transfer data streams versus voice video or network control data streams . In some embodiments there are a total of ten hardware queues and high medium and low data packet priorities may be spread over these hardware queues in distinct subsets. For example Q may include VoIP data packets having a size of 128 bytes or less Q may include video data packets such as those associated with a high definition video stream having a size of 1500 bytes or less etc. Note that by reducing the number of combinations to a small manageable set of hardware queues there may be a good tradeoff between granularity which reduces the impact of missed timing on utilization and the overall average utilization. Also note that the data packet priority can be based on the overall latency thereby determining the order in which the data packets go into the hardware queues.

Thus in some embodiments it may be desirable to send data packets having lengths up to 128 bytes 512 bytes or 1500 bytes. These different data packet sizes may be associated with different hardware queues. If it is assumed that each data packet is separated by a minimum time interval 25 s for IEEE 802.11a then Q may include data packets having a size of 128 bytes or less 65 s at 54 Mbps Q may include data packets having a size of 512 bytes or less 125 s at 54 Mbps and Q may include data packets having a size of 1500 bytes or less 269 s at 54 Mbps . Therefore any combination with 65125269390 for non negative values of a b and c may be transmitted in a given time slot. Table 1 provides possible data packet combinations in the given time slot.

Note that the first in first out order of a data stream may be maintained by detecting an ordered data steam and using a single large hardware queue for such a data stream. For example if a TCP IP data stream is detected all of the data packets may be placed in a 1500 byte hardware queue regardless of their size or data packet transmission times for a given data rate because this hardware queue can accommodate the data packet with the largest data packet transmission time in this data stream.

A variety of techniques may be used to ensure time synchronization among electronic devices that communicate via the communication channel using TDMA. As noted previously in some embodiments the electronic device communicates timing synchronization information associated with the timing synchronization signal to another IEEE 802.11 compliant chipset in a communication system using in band communication in the communication channel i.e. mutual synchronization . For example the timing synchronization information may be provided to chipset for inclusion in a header field in the IEEE 802.11 frame that includes the data packet. In this way the time slot synchronization information may facilitate common timing of the communication channel using TDMA. However in other embodiments the electronic devices may receive the timing synchronization signal from an external source using out of band communication. For example the timing synchronization signal may be associated with a positioning system such as the Global Positioning System.

In some embodiments the IEEE 802.11 timing synchronization function is modified to provide time synchronization. For example if the network includes a home media center that distributes content to a small number of displays such as fewer than 10 devices within 2 3 hops time may be centrally distributed from the media center using the IEEE 802.11 timing synchronization function. Otherwise a mutual synchronization technique may be used.

We now describe an embodiment of the method. presents a flow chart illustrating a method for communicating information using electronic devices and or . During operation the electronic device queues a data packet in a software queue operation . Then the electronic device provides the data packet to a hardware queue in the IEEE 802.11 compliant chipset for inclusion in an IEEE 802.11 frame operation . Note that the data packet is provided based on available space in the hardware queue and that the IEEE 802.11 frame is compliant with an IEEE 802.11 communication protocol. Next the electronic device provides time slot control information to the IEEE 802.11 compliant chipset based on a timing synchronization signal operation thereby gating the release of the data packet from the hardware queue for transmission in the IEEE 802.11 frame in a communication channel by the IEEE 802.11 compliant chipset using TDMA.

In some embodiments of method there may be additional or fewer operations. Moreover the order of the operations may be changed and or two or more operations may be combined into a single operation.

Furthermore in some embodiments electronic devices and or include fewer or additional components. For example in chipset is included in electronic device but in other embodiments it may be external to electronic device . Moreover two or more components may be combined into a single component and or a position of one or more components may be changed. Furthermore the functionality of these electronic devices may be implemented more in hardware and less in software or less in hardware and more in software as is known in the art. In some embodiments some or all of the functionality of electronic devices and or may be implemented in one or more application specific integrated circuits ASICs and or one or more digital signal processors DSPs .

In instructions in the various modules in memory may be implemented in a high level procedural language an object oriented programming language and or in an assembly or machine language. This programming language may be compiled or interpreted i.e. configurable or configured to be executed by the one or more processing units or processors .

Note that electronic devices and or may include one of a variety of devices capable of manipulating computer readable data or communicating such data between two or more electronic devices or nodes over a network including a computer terminal a desktop computer a laptop computer a network node or terminal a server a mainframe computer a kiosk a portable electronic device such as a cellular phone or PDA a server and or a client computer in a client server architecture . Moreover the communication channel may include the Internet World Wide Web WWW an intranet a wired network an optical network a wireless network LAN WAN MAN or a combination of networks or other technology enabling communication between electronic devices.

The foregoing description is intended to enable any person skilled in the art to make and use the disclosure and is provided in the context of a particular application and its requirements. Moreover the foregoing descriptions of embodiments of the present disclosure have been presented for purposes of illustration and description only. They are not intended to be exhaustive or to limit the present disclosure to the forms disclosed. Accordingly many modifications and variations will be apparent to practitioners skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present disclosure. Additionally the discussion of the preceding embodiments is not intended to limit the present disclosure. Thus the present disclosure is not intended to be limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

