---

title: Method and system for task mapping based on corresponding virtual modem identifiers in an operating system for virtual modems within a multi-SIM multi-standby communication device
abstract: A multiple-subscriber identity module (multi-SIM) multi-standby communication device includes a single operating system (OS) and a single radio resource unit that is shared by multiple virtual modems (VMs) within a virtual modem framework (VMF). The OS maps VM tasks of the multiple VM to OS resource spaces according to corresponding VM IDs. which may be embedded in global variables utilized in the single OS to access OS resources. The single OS may run the mapped VM tasks utilizing OS resources in the OS resource spaces. The OS may run VM tasks utilizing OS resources in OS resource spaces identified by corresponding VM IDs.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09072035&OS=09072035&RS=09072035
owner: Broadcom Corporation
number: 09072035
owner_city: Irvine
owner_country: US
publication_date: 20100623
---
This patent application makes reference to claims priority to and claims the benefit from U.S. Provisional Patent Application Ser. No. 61 261 922 filed on Nov. 17 2009.

Certain embodiments of the invention relate to communication systems. More specifically certain embodiments of the invention relate to a method and system for task scheduling in an operating system for virtual modems within a multi SIM multi standby communication device.

With the development of mobile communication systems mobile devices may utilize various mobile communication techniques such as for example global system for mobile communications GSM Universal Mobile Telecommunications System UMTS Long Term Evolution LTE network and wireless local area network WLAN to receive desired services. In instances where a mobile device subscribes to a communication network subscriber information may be required to identify the mobile device to the network for various network services such as authentication accounting billing and security services. The subscriber information may be stored in a subscriber identity module SIM card inserted in the mobile device. A SIM card is a card or a chip installed in the mobile device providing information to identify the subscriber carrying the mobile device to networks.

Further limitations and disadvantages of conventional and traditional approaches will become apparent to one of skill in the art through comparison of such systems with some aspects of the present invention as set forth in the remainder of the present application with reference to the drawings.

A method and or system for task scheduling in an operating system for virtual modems within a multi SIM multi standby communication device substantially as shown in and or described in connection with at least one of the figures as set forth more completely in the claims.

These and other advantages aspects and novel features of the present invention as well as details of an illustrated embodiment thereof will be more fully understood from the following description and drawings.

Certain embodiments of the invention may be found in a method and system for task scheduling in an operating system for virtual modems within a multi SIM multi standby communication device. In various embodiments of the invention a multiple subscriber identity module multi SIM multi standby communication device comprises a single radio resource unit providing open system interconnect OSI layer one which is also referred to as the physical layer PHY and RF for example functionalities. The single radio resource unit is shared by a plurality of virtual modems VMs in a virtual modem architecture VMA . The VMA is deployed over the single radio resource unit to handle operations in a multi standby mode. The VMA comprises a plurality of virtual modems VMs a virtual modem framework VMF and a virtual modem controller VMC . Each VM is uniquely associated with a single one of a plurality of SIM cards that are coupled to the multi SIM multi standby communication device. A single operating system OS may be installed on the multi SIM multi standby communication device to run or execute programs for procedures and or activities related to VMs in the VMA. The OS may be operable to handle VM tasks associated with corresponding one of the plurality VMs in the VMA. VM tasks of the plurality of VMs may be mapped to specific OS resource spaces of the OS based on corresponding VM IDs. The OS may run each of the mapped VM tasks utilizing OS resources located in the corresponding OS resource spaces. VM ID information may be embedded in global variables and or static variables that may be utilized in the OS to access the OS resources. An OS resource space for each of the VM tasks may be identified or allocated through its own copy of global and static variables in the OS. The OS may run each of the mapped VM tasks utilizing OS resources located in corresponding OS resource spaces. In instances where VM tasks of different VMs are mapped to a same OS resource space OS resources located in the same OS resource space may be re used or re run for each of the mapped VM tasks respectively without duplicating the OS resources. For example the same OS resource space may be mapped into different physical memory based on corresponding VM ID to ensure legacy software compatible with multiple VMs. In this regard the legacy software may be utilized over the same OS resource space for the different VMs without interfering with one to another. To arbitrate conflicts in OS resource contention a task priority may be determined for each of the mapped VM tasks based on corresponding VM environment such as information related to a VM state and or task context. Resulting VM task scheduling information may be stored and utilized for execution of corresponding ones of the VM tasks accordingly.

A multi SIM multi standby communication device such as the multi SIM multi standby communication device may comprise suitable logic circuitry interfaces and or code that are operable to communicate or support various network services such as authentication billing and or security with a plurality of communication access networks such as for example the UMTS network the LTE network and the GSM network . Multiple SIM cards such as SIM cards may be inserted in the multi SIM multi standby communication device whenever needed. The inserted SIM cards may be coupled or connected with the multi SIM multi standby communication device through one or more SIM card sockets or connections. The multi SIM multi standby communication device may read or retrieve SIM identification information from the SIM cards via the one or more SIM card sockets or connections. The retrieved SIM identification information may be stored within the multi SIM multi standby communication device to support various network services such as authentication billing and security whenever needed. In this regard the multi SIM multi standby communication device may be configured to activate the retrieved SIM identification information either on one SIM card at a time or on multiple SIM cards at the same time depending on implementation and or device configuration. In instances where the retrieved SIM identification information is activated on one SIM card at a time the multi SIM multi standby communication device may operate in a single standby mode. In instances where the retrieved SIM identification information is activated on two or more SIM cards at the same time the multi SIM multi standby communication device may operate in a multi standby mode. In this regard the multi SIM multi standby communication device in a multi standby mode may be operable to support multiple subscriptions at the same time. A user of the multi SIM multi standby communication device may be allowed to utilize multiple numbers multiple different service plans and or one or more network carriers at the same time whenever the multi SIM multi standby communication device is in a multi standby mode.

U.S. application Ser. No. 12 816 782 which is filed on Jun. 16 2010 provides detailed descriptions that a Virtual Modem Architecture VMA may be adopted over a single radio resource unit to support a multi standby mode on a multi SIM multi standby communication device and is hereby incorporated herein by reference in its entirety. A single radio resource unit may comprise suitable logic circuitry interfaces and or code that are operable to provide PHY and RF functionalities to support desired services on a communication device. For example the single radio resource units may be integrated into the multi SIM multi standby communication devices respectively for PHY and RF support.

A multi SIM multi standby communication device such as the multi SIM multi standby communication device may be configured to concurrently handle multiple tasks or instances deployed on the single radio resource unit . Each task or instance is associated with one of the multiple SIM cards . A task may also be called an instance of a process. An air interface protocol stack and or a Common Application Programming Interface CAPI module may comprise multiple tasks. A collection of air interface protocol stack tasks and or CAPI tasks associated with a single SIM card together with appropriate physical layer PHY DSP functionalities and or RF functionalities supported by the single radio resource unit is referred to as a Virtual Modem VM . Each VM in the VMA may be assigned to handle instances related to one of the multiple SIM cards . A VM may be in one of a plurality of VM states comprising for example an active state an idle state or a suspended state. In the active state radio resources are assigned to the VM and a valid connection between a VM and an associated cell is established for data and or voice communication. The VM may be allowed to utilize radio resources available in the radio resource unit to communicate services related to a specific SIM card. In the idle state no valid or active connection between the VM and an associated cell is established however associated registration information is retained in the associated cell. In the idle state the VM may be allowed to utilize limited radio resources available in the single radio resource unit to monitor paging events and to perform normal idle mode activities such as cell selection reselection. In the suspended state a VM may be suspended from using radio resources available in the single radio resource unit . Before entering the suspended state the VM may need to suspend or abort procedures such as for example data transfer operating band change and or manual public land mobile network PLMN search which are currently being executed on the VM.

Radio resources available in the single radio resource unit may be shared by multiple VMs in the VMA . In order to arbitrate or resolve contention for available radio resources in the single radio resource unit the VMA may be operable to manage or control the VMs to transition among one or more of a plurality of VM states and or coordinate procedures or activities initiated by multiple VMs which may be running on a single operating system OS installed on the multi SIM multi standby communication device . An OS is referred to as a software platform on top of which other programs run. For example each of the OSs may be installed on one of the multi SIM multi standby communication devices respectively to run programs for procedures or activities related to one or more VMs.

In various exemplary embodiments of the invention the OS may be operable to run programs to handle VM related tasks hereinafter called VM tasks associated with procedures or activities related to multiple VMs in the VMA . The OS may be configured to coordinate and or optimize the usage of OS resources for VM tasks of multiple VMs in the VMA . The OS resources may comprise OS codes and OS data which may be stored in a device physical memory random access memory RAM . The OS resources in the device physical memory may be indexed via pointers or memory addresses and may be shared by VM tasks for corresponding ones of the plurality of VMs on the multi SIM multi standby communication device . However global variables and or static variables that are utilized to access the OS resources in the device physical memory may be maintained inside each individual VM task. In this regard VM identifiers IDs may be embedded in global and static variables that are utilized to access to the OS resources in the device physical memory. Each of the VM tasks may then have access to the OS resources in the device physical memory through its own copy of global and static variables. A memory address or a pointer for each of the VM tasks may be calculated or determined based on a corresponding VM ID. VM tasks associated with different VMs may be transparently mapped to OS resource spaces that are spaces in the device physical memory and are indexed by the corresponding determined memory addresses. An OS resource space may comprise a code space and a data space. The OS may be operable to run or execute the VM tasks utilizing OS resources located in corresponding OS resource spaces which may be indicated by corresponding VM IDs.

In various exemplary embodiments of the invention the OS may be operable to share OS resources in the device physical memory among VM tasks of different VMs without duplicating the OS resource. For example in instances where VM tasks of different VMs are mapped to a same OS resource space in the device physical memory OS resources located in the same OS resource space may be re used or re run for each of the VM tasks respectively based on corresponding copies of global and static variables for each of the VM tasks. More specifically the same OS resource space may be mapped into different physical memory based on corresponding VM ID to ensure legacy software compatible with multiple VMs. In this regard the legacy software may be utilized over the same OS resource space for the different VMs without interfering with one to another.

In various exemplary embodiments of the invention the OS may be operable to arbitrate or resolve contention for the OS resources via VM task scheduling. In this regard a task priority may be determined by the OS for each of the VM tasks based on a corresponding VM environment such as a VM state and or task context. For example a VM task for a VM in an active state may be assigned a higher priority than a VM task for a VM in an idle state. In another example a VM task for a paging message may have a higher priority than a VM task for a cell broadcasting message. The OS may be operable to schedule VM tasks of multiple VMs based on corresponding task priorities.

The UMTS network may comprise suitable devices circuitry interfaces and or code that are operable to provide and or voice services to various UMTS capable communication devices such as the multi SIM multi standby communication device using UMTS technology. In this regard the UMTS network may be operable to authenticate users such as the multi SIM multi standby communication devices for UMTS access utilizing SIM cards. A SIM card for UMTS is also known as universal subscribe identity module USIM . Only authorized users may access the UMTS network . The UMTS network may be operable to check the validity of USIM identification information on one or more USIM cards coupled to for example the multi SIM multi standby communication device . The UMTS network may determine whether the multi standby communication device is allowed to access the UMTS network for various network services such as for example authentication accounting and or billing services.

The LTE network may comprise suitable devices circuitry interfaces and or code that are operable to provide and or voice services to various LTE capable communication devices such as the multi SIM multi standby communication device using LTE technology. In this regard the LTE network may be operable to authenticate users such as the multi SIM multi standby communication devices for LTE access utilizing SIM cards. A SIM card for LTE is also known as Universal Integrated Circuit Card UICC . Only authorized users may access the LTE network . The LTE network may be operable to check the validity of UICC identification information on one or more UICCs coupled to for example the multi SIM multi standby communication device . The LTE network may determine whether the multi SIM multi standby communication device is allowed to access the LTE network for various network services such as for example authentication accounting and or billing services.

The GSM network may comprise suitable devices circuitry interfaces and or code that are operable to provide and or voice services to various GSM capable communication devices such as the multi SIM multi standby communication device using GSM technology. In this regard the GSM network may be operable to authenticate users such as the multi SIM multi standby communication devices for GSM access utilizing SIM cards. Only authorized users may access the GSM network . The GSM network may be operable to check the validity of SIM identification information on one or more SIM cards coupled to for example the multi SIM multi standby communication device . The GSM network may determine whether the multi SIM multi standby communication device is allowed to access the GSM network for various network services such as for example authentication accounting and or billing services.

In an exemplary operation a multi SIM multi standby communication device such as the multi SIM multi standby communication device may be connected or coupled with multiple SIM cards such as the SIM cards through one or more SIM card sockets or connections. SIM identification information on each of the multiple SIM cards may be communicated to the multi SIM multi standby communication device through the one or more SIM card sockets. The multi SIM multi standby communication device may operate in a single standby mode or a multi standby mode depending on device configuration and or user preferences. A user of the multi SIM multi standby communication device in a multi standby mode may be allowed to utilize SIM identification information associated with each of the multiple SIM cards to receive corresponding services at the same time. In this regard the multi SIM multi standby communication device may be operable to deploy the VMA over the single radio resource unit to support operations involved in a multi standby mode. Each VM in the VMA may be assigned to or associated with one of the multiple SIM cards . Each of the VM tasks may be transparently mapped to a specific OS resource space for OS resources based on a corresponding VM ID. OS resources in the OS may be shared by VM tasks of different VMs without duplication. In this regard the same OS resource space required for access by different VMs may be mapped into different physical memory based on corresponding VM ID to ensure legacy software compatible with each of the different VMs. In other words the legacy software may be utilized over the same OS resource space for the different VMs without interfering with one to another. A task priority may be calculated or determined for each of the VM tasks based on related VM environment so as to arbitrate or resolve contention for the OS resources. VM tasks may be executed or run on the OS based on corresponding task priorities.

The wireless radio unit may comprise suitable logic circuitry interfaces and or code that may be operable to communicate radio frequency signals with various communication networks such as for example the LTE network and the GSM network . SIM identification information that is retrieved from one or more of the SIM cards may be communicated via the wireless radio unit to identify the multi SIM multi standby communication device to network for desired network services such as accounting billing services.

The user interface unit may comprise suitable logic circuitry interfaces and or code that may enable a user to interact with the multi SIM multi standby communication device . For example the user interface unit may be operable to present the user with information on SIM cards available to the multi SIM multi standby communication device . The user interface unit may allow the user to enter a preferred SIM card selection and or a desired application selection.

The processor unit may comprise suitable logic circuitry interfaces and or code that may be operable to manage and or control operations of device components such as for example the wireless radio unit the user interface unit the SIM database and or the SIM card controller . For example the processor unit may be operable to coordinate and or control operations of the SIM card controller in response to a SIM card selection from the user interface unit . The processor unit may also be operable to utilize a single OS such as the OS to run programs related to a specific application via the application processor based on an application selection from the user interface unit .

The processor unit may be operable to select one or more SIM cards based on user preferences and or device configuration. The processor unit may communicate the SIM card selection information to the SIM card controller so that the selected one or more SIM cards may be connected to the SIM card sockets and thereby to the processor unit . The selected SIM cards may be actively connected to the SIM card controller to enable downloading of corresponding SIM identification information into the SIM database of the multi SIM multi standby communication device . Notwithstanding in accordance with various embodiments of the invention after SIM identification information is downloaded from each of the selected SIM cards such as the SIM cards into the SIM database of the multi SIM multi standby communication device the SIM identification information corresponding to one or more of the plurality of SIM cards may be in an active state or in a standby state in the SIM database . More specifically at a given time instant SIM identification information actually being utilized or applied to access corresponding services by the multi SIM multi standby communication device is in an active state otherwise in a standby state.

In instances where the multi SIM multi standby communication device is configured to operate in a single standby mode the processor unit may communicate with the SIM database to activate the stored SIM identification information related to one SIM card at a time. In other words the multi SIM multi standby communication device in a single standby mode may be operable to utilize SIM identification information activated for a single SIM card at a time. In instances where the multi SIM multi standby communication device is configured to operate in a multi standby mode the processor unit may be operable to communicate with the SIM database to activate the stored SIM identification information corresponding to multiple SIM cards such as the SIM cards at the same time. Specifically the multi SIM multi standby communication device in a multi standby mode may be operable to utilize SIM identification information activated for multiple SIM cards at the same time. In this regard the processor unit may be operable to allow a user of the multi SIM multi standby communication device to utilize SIM identification information associated with each of the SIM cards to receive corresponding services at the same time. For example the user may therefore be allowed to utilize multiple numbers multiple different service plans and or network carriers associated with each of the multiple SIM cards at the same time on the multi SIM multi standby communication device . The processor unit comprises a communication processor and an application processor

The communication processor may comprise suitable logic circuitry interfaces and or code that may be operable to utilize a VMA over single radio resource unit such as the single radio resource unit associated with the wireless radio unit to support a multi standby mode. The VMA is a multi SIM multi standby platform and comprises a virtual modem controller VMC and a plurality of VMs. Each VM in the VMA is assigned or related to one of the multiple SIM cards . For a given time instant a VM may operate in one of in one of a plurality of VM states namely an active state an idle state or a suspended state. To avoid radio resource conflicts at most one of the VMs in the VMA may be in the active state to transmit and or receive traffic related to a corresponding SIM card. One or more VMs may be in the suspended state at the same time. One or more VMs may be in the idle state at the same time depending on radio resources available in the single radio resource unit for sharing. Radio resources available in the single radio resource unit may be shared among the VMs. In this regard the VMA may enable concurrently monitoring paging events related to each of related SIM cards. For example VMs may receive a paging advertisement message from an associated cell to check incoming traffic. Upon detection of an intended traffic related to a specific SIM card such as the SIM card which is to be handled by a VM the VMA may perform a procedural conflict check and or a radio resource conflict check on other VMs to determine whether there are any conflicts. In instances where there may be one or more conflicts the VMA may be operable to arbitrate the conflicts and provide a resolution.

In instances where services and or procedures associated with one or more of the SIM cards are in progress the VMA may suspend the one or more VMs to ensure an uninterrupted radio resource usage by the VM related to the SIM card . Once radio resources become available in the single radio resource unit for sharing by the suspended VMs the VMA may resume the suspended VMs so as to continue normal idle mode activities and or tasks such as for example paging reception decoding serving cell measurements and or neighbor cell measurements. In this regard the VMA may be operable to concurrently monitor paging events to check incoming traffic and concurrently perform idle mode procedures such as cell selection reselection based on radio resources available in the single radio resource unit

In instances where no services and or procedures associated with each of the SIM cards is in progress the VMA may transition the VM related to the SIM card from an idle state to an active state to transmit and or receive the detected intended traffic related to the SIM card . The communication processor may communicate the traffic related to the SIM card to the application processor to support desired applications.

The application processor may comprise suitable logic circuitry interfaces and or code that may be operable to run various applications such as video and or audio multimedia applications based on traffic received by the communication processor . The application processor may present applications to users through the user interface unit .

The SIM card controller may comprise suitable logic circuitry interfaces and or code that may be operable to manage and or control connections from multiple SIM cards such as the SIM cards to the SIM card sockets which are directly coupled with the processor unit . In this regard the SIM card controller may be operable to establish connections between the SIM cards and the processor unit . The SIM card controller may be configured to switch SIM card connection from one to another as needed without re booting the multi SIM multi standby communication device .

A SIM card such as the SIM card may comprise suitable logic circuitry interfaces and or code that may be operable to store subscriber personal identification information such as for example operator network phone number activated services billing and credit information. The SIM card may also store the user s identity for gaining access to the network and receiving calls and user s personal information such as phone directory and received SMS messages. The SIM card may be implemented as a small printed circuit board. The SIM card may be inserted in a mobile device such as the multi SIM multi standby communication device in order for the multi SIM multi standby communication device to properly access a corresponding network. The SIM card may be connected to the multi SIM multi standby communication device via the SIM card controller .

The OS may comprise suitable logic circuitry interfaces and or code that may be operable to run software programs for applications procedures and or activities on the multi SIM multi standby communication device . In various exemplary embodiments of the invention the OS may be operable to handle VM tasks of multiple VMs in the VMA . Specifically the OS may manage or coordinate the usage of OS resources such as OS codes and OS data to support multiple VM tasks of different VMs in the VMA . The OS resources may be stored in the device physical memory for sharing by multiple VMs. Global variables and or static variables that are utilized in the OS to access the OS resources in the device physical memory may be maintained inside each individual VM task. VM identifier ID information associated with each of the VM tasks may be embedded in global and static variables that are utilized to access the OS resources. A VM task may have its own copy of global and static variables to access the OS resources in the device physical memory . A VM task may be mapped to a specific OS resource space in the device physical memory according to a corresponding VM ID. The OS may run or execute programs for each of the VM tasks utilizing OS resources located in an OS resource space indicated by a corresponding VM ID.

In various exemplary embodiments of the invention VM tasks of different VMs may share OS resources located in a same OS resource space in the device physical memory without duplicating the corresponding OS resources. For example in instances where VM tasks of different VMs in the VMA are mapped to the same OS resource space in the device physical memory OS resources located in the same OS resource space may be re used or re run for each of the VM tasks of different VMs respectively. In this regard the same OS resource space may be mapped into different physical memory based on corresponding VM ID to ensure legacy software compatible with each of the different VMs. The legacy software may be utilized over the same OS resource space for the different VMs without interfering with one to another.

To arbitrate or avoid conflicts in OS resource contention the OS may be operable to perform VM task scheduling based on VM task priorities. In this regard a task priority may be determined for each of the VM tasks based on an associated VM environment which may comprise information such as a VM state and or task context on an associated VM. For example the OS may assign a higher task priority on a VM task associated with a VM in an active state than on a VM task associated with a VM in an idle state. A VM task related to a paging message may have a higher priority than a VM task related to a cell broadcasting message.

The memory may comprise suitable logic circuitry interfaces and or code that may be operable to store information such as executable instructions and data that may be utilized by the processor unit and or other device components such as for example the SIM database . The SIM database may comprise suitable logic circuitry interfaces and or code that may be operable to record and or store SIM identification information retrieved from one or more SIM cards such as the SIM cards . The stored SIM identification information may be in an active state or in a standby state within the SIM database . For a given time instant only SIM identification information in an active state may be actually utilized or applied by the multi SIM multi standby communication device to support desired network services such as accounting billing services. Depending on device configuration for a given time instant SIM identification information in an active state may correspond to one or more SIM cards. The device physical memory may comprise suitable logic circuitry interfaces and or code that may be operable to record and or store OS resources such as OS codes and OS data that are utilized to execute or run software programs related to VM tasks of multiple VMs in the VMF . The memory may comprise RAM ROM low latency nonvolatile memory such as flash memory and or other suitable electronic data storage.

In an exemplary operation a multi SIM multi standby communication device such as the multi SIM multi standby communication device may be connected or coupled to multiple SIM cards such as the SIM cards through the SIM card controller . The processor unit may be operable to retrieve SIM identification information from the SIM cards . The retrieved SIM identification information may be stored in the SIM database . In instances where the multi SIM multi standby communication device is configured to operate in a multi standby mode the communication processor may communicate with the SIM database to activate the stored SIM identification information corresponding to multiple SIM cards such as the SIM cards at the same time. More specifically the multi SIM multi standby communication device in a multi standby mode may utilize SIM identification information activated for the SIM cards at the same time. A user of the multi SIM multi standby communication device may therefore be allowed to receive services related to the SIM cards at the same time. The communication processor may run the VMA over the single radio resource unit to handle traffic through the wireless radio unit . Each of VM tasks of multiple VMs in the VMA may be executed or run over the OS . The OS resources such as OS codes and OS data stored in the device physical memory may be shared by the VM tasks of multiple VMs in the VMA . The VM ID and or the VM ID related information may be embedded in global variables and or static variables that are utilized in the OS to access the OS resources in the device physical memory . In this regard each of the VM tasks may utilize its own VM ID specific global and static variables in the OS to access the OS resources in the device physical memory . The OS may execute or run each of the VM tasks utilizing OS resources in a specific OS resource space indicated by a corresponding VM ID. In instances where VM tasks of different VMs are mapped to the same OS resource space in the device physical memory the OS may run each of the VM tasks utilizing OS resources located in the same OS resource space in the device physical memory . To arbitrate or resolve contention for the OS resources the OS may be operable to perform VM task scheduling based on task priorities. A task priority for a specific VM task may be determined based on an associated VM environment such as a VM stat and related VM context.

The MMI module may comprise suitable logic interfaces and or code that may be operable to provide interaction between a user of the multi SIM multi standby communication device and one or more applications that are executed on the multi SIM multi standby communication device .

The SIMIO module may comprise suitable logic interfaces and or code that may be operable to manage access to SIM cards such as the SIM cards .

The VMF may comprise suitable logic interfaces and or code that may be operable to provide an enhancement to the Real Time Operating System. The VMF may be deployed or implemented on the communications processor

A VM such as the VM refers to an instance of an air interface protocol stack and or its interface to the user namely a Common Application Programming Interface CAPI together with a single set of radio resources such as radio resources available in the single radio resource unit . A VM such as the VM may comprise suitable logic interfaces and or code that may be operable to handle instances namely CAPI tasks and or air interface protocol stack instances associated with one of the SIM cards . Different VMs such as the VM and the VM may be configured to handle instances corresponding to two different SIM cards. For example the VM may handle instances related to the SIM card while the VM may be assigned to handle instances related to the SIM card . The plurality of VMs such as VMs may be configured to share the same set of radio resources namely available radio resources in the single radio resource unit . In this regard multiple copies of global and static data may be maintained to be utilized by the VMs respectively. A VM such as the VM may operate independently from other VMs and may be in one of the plurality of VM states namely an active state an idle state and a suspended state. The VM may comprise a CAPI task unit a VCC an air interface protocol stack together with the single radio resource unit . CAPI and or stack operations within the VM may be managed via the VCC .

The CAPI task unit may comprise suitable logic interfaces and or code that may be operable to process MMI or user requests. The CAPI task unit comprises CAPI tasks related to a specific SIM card such as the SIM card .

A VCC such as the VCC may comprise suitable logic interfaces and or code that may be operable to perform admission control with the VMC for the CAPI module at the primitive levels. The VCC is a dual instance module for managing its own task or instance and queuing messages. The VCC may be operable to interact with the VMC for radio resource requests associated with CAPI tasks in the CAPI task unit . The VCC may communicate with the air interface protocol stack to coordinate stack operations corresponding to the CAPI tasks in the CAPI task unit .

An air interface protocol stack such as the air interface protocol stack may comprise suitable logic interfaces and or code that may be operable to provide air interface protocols to support various signaling operations. For example in 3GPP standard the stack may comprise Non Access Stratum NAS protocols and Access Stratum AS protocols to handle bearer level signaling and Radio Resource Control RRC signaling respectively.

The VMC may comprise suitable logic interfaces and or code that may be operable to coordinate requests for the usage of radio resources available in the single radio resource unit among multiple associated VMs such as the VM and the VM . In this regard the VMC may be operable to resolve contention for radio resources by transitioning the VM and the VM between the three VM states. For example the VMC may be operable to ensure that at most one of the VM and the VM is in the active state for a given time instant. In this regard the VMC may suspend for example the VM from using or sharing radio resources available in the single radio resource unit in order to allow an uninterrupted radio resource usage by the VM . The suspended VM may be resumed whenever radio resources in the single radio resource unit become available for sharing by the VM to continue idle mode activities on the VM .

The VMC may be operable to coordinate the usage of the radio resources to support concurrent procedures initiated by the VM and the VM . For example the VM and the VM each may be granted by the VMC a portion of radio resources available in the single radio resource unit to concurrently monitor paging events and or to concurrently perform idle mode procedures or activities such as for example cell selection reselection by sharing the single radio resource unit .

The single radio resource unit may comprise suitable logic interfaces and or code that may be operable to provide PHY and RF support.

In an exemplary operation the MMI module may interact between a user of the multi SIM multi standby communication device and applications that are related to the SIM card and the SIM card for example inserted into the SIM card controller . Tasks or instances related to the SIM card and the SIM card may be handled by the VM and the VM respectively. The VMC may coordinate the usage of radio resources available in the single radio resource unit for sharing by the VM and the VM . For a given time instant at most one of the VM and the VM may be allowed to use the single radio resource unit . In other words for a given time instant at most one of the VM and the VM may operate in an active state to transmit and or receive traffic related to a corresponding SIM card. The VM and or the VM may be in an idle state whenever there is no intended traffic for corresponding SIM cards detected. In an idle state the VM and the VM may be operable to concurrently perform paging monitoring and or idle mode procedures such as cell reselecting by sharing radio resources available in the single radio resource unit . For example a VM such as the VM in the idle state may be operable to check or detect an incoming traffic related to the SIM card based on received paging messages. Upon detection of an intended traffic related to the SIM card the VM may remain in the idle state if traffic related to other SIM cards such as the SIM card is still being handled. Otherwise the VMC may transition the VM from the idle state to an active state in order to transmit and or receive the detected traffic related to the SIM card .

The OS task scheduler may comprise suitable logic interfaces and or code that may be operable to schedule VM tasks for each related VM such as the VM and the VM in the VMF . The OS task scheduler may be operable to manage the usage of OS resources such as OS codes and OS data stored in the device physical memory to run VM tasks of VM and the VM . The OS task scheduler may be operable to embed VM ID information in global variables and or static variables that may be utilized to access the OS resources in the device physical memory . In this regard the OS task scheduler may be operable to map VM tasks to specific OS resource spaces of the device physical memory based on corresponding VM IDs.

The OS may run VM tasks utilizing OS resources located in the OS resource spaces indicated by corresponding VM IDs. In instances where one or more VM tasks of different VMs are mapped to a same OS resource space in the device physical memory the OS resources located in the same OS resource space may be re used to run each of the VM tasks of different VMs without duplicating the OS resources. More specifically the OS may map the same OS resource space into different physical memory based on corresponding VM ID to ensure legacy software compatible with multiple VMs. In this regard the OS may be operable to utilize the legacy software over the same OS resource space for the different VMs without interfering with one to another.

In order to arbitrate or resolve conflicts in OS resource contention the OS task scheduler may be operable to perform VM task scheduling based on VM task priorities. A task priority of a VM task may be determined based on an associated VM environment such as a VM state and or task context. Resulting VM task scheduling information may be stored in the memory for example for each of the VM tasks. The stored VM task scheduling information may comprise VM ID entry function task priority task context and associated stack point. The VM tasks may be executed according to the corresponding stored scheduling information for each of the VM tasks.

The device physical memory may comprise suitable logic interfaces and or code that may be operable to store OS resources such as OS codes and OS data. The OS resources in the device physical memory may be accessed via pointers or memory addresses which may be related to VM ID information. Each of the VM tasks may have an access to the OS resources based on a corresponding VM ID. The OS resources in the device physical memory may be shared among each of the VM tasks of different VMs in the VMF . The device physical memory may comprise a plurality of random access memory RAM .

In an exemplary operation the OS task scheduler may be operable to handle each of the VM tasks associated with each of the different VMs such as the VM and the VM in the VMF . The usage of OS resources such as OS codes and OS data stored in the device physical memory may be managed to support VM tasks of VM and the VM respectively. The VM ID or corresponding VM ID information may be embedded in global variables and or static variables that may be utilized to access the OS resources in the device physical memory . In this regard each of the VM tasks may be mapped to specific OS resource spaces of the device physical memory based on corresponding VM IDs. The OS task scheduler may be operable to communicate with the OS to run a VM task utilizing OS resources located in an OS resource space indicated by a corresponding VM ID. In instances where VM tasks for different VMs are mapped to the same OS resource space in the device physical memory the OS resources in the same OS resource space may be re used to run each of the VM tasks of the different VMs without duplicating the OS resources. To arbitrate conflicts in OS resource contention VM tasks may be scheduled based on VM task priorities. Resulting VM task scheduling information may be utilized by the OS to execute each of the VM tasks accordingly.

In various exemplary aspects of the method and system for task scheduling in an operating system for virtual modems within a multi SIM multi standby communication device a multi SIM and multi standby communication device such as the multi SIM multi standby communication device comprises a single radio resource unit such as the single radio resource unit . The single radio resource unit is shared by a plurality of VMs such as the VM and the VM in the VMA . The VMF is deployed over the single radio resource unit . Each VM is uniquely associated with a single one of a plurality of SIM cards such as the SIM cards that are coupled to the multi SIM multi standby communication device through the SIM card controller . The multi SIM multi standby communication device may be operable to concurrently handle traffic related to each of the SIM cards utilizing a corresponding one of VMs in the VMF . For example the VM and the VM may be responsible to handle traffic related to the SIM card and the SIM card respectively. As described with regard to . a single OS such as the OS may be installed on the multi SIM multi standby communication device to run programs for procedures and or activities related to VMs such as the VM and the VM in the VMF .

The OS task scheduler may be operable to handle VM tasks associated with the VM and the VM in the VMF by sharing OS resources stored in the device physical memory . The OS task scheduler may be operable to map VM tasks of each of the VM and the VM to specific OS resource spaces namely code spaces and data spaces of the single OS namely the OS based on corresponding VM IDs. The OS may be operable to run each of the mapped VM tasks utilizing OS resources located in the OS resource spaces within the device physical memory . VM ID information may be embedded in global variables and or static variables that may be utilized in the OS to access the OS resources in the device physical memory . An OS resource space for each of the mapped VM tasks may be identified or allocated through its own copy of global and static variables. Each of the mapped VM tasks may be run or executed on the OS utilizing OS resources located in corresponding OS resource spaces. In instances where VM tasks of different VMs are mapped to a same OS resource space in the device physical memory OS resources located in the same OS resource space may be re used or re run for each of the mapped VM tasks respectively without duplicating the OS resources. For example the same OS resource space may be mapped into different physical memory based on corresponding VM ID to ensure legacy software compatible with multiple VMs. In this regard the legacy software may be utilized over the same OS resource space for the different VMs without interfering with one to another. To arbitrate conflicts in OS resource contention the OS task scheduler may be operable to determine a task priority for each of the mapped VM tasks based on corresponding VM environment such as information on a VM state and or task context. Resulting VM task scheduling information may be stored and utilized by the OS to execute each of the mapped VM tasks accordingly.

Other embodiments of the invention may provide a non transitory computer readable medium and or storage medium and or a non transitory machine readable medium and or storage medium having stored thereon a machine code and or a computer program having at least one code section executable by a machine and or a computer thereby causing the machine and or computer to perform the steps as described herein for task scheduling in an operating system for virtual modems within a multi SIM multi standby communication device.

Accordingly the present invention may be realized in hardware software or a combination of hardware and software. The present invention may be realized in a centralized fashion in at least one computer system or in a distributed fashion where different elements are spread across several interconnected computer systems. Any kind of computer system or other apparatus adapted for carrying out the methods described herein is suited. A typical combination of hardware and software may be a general purpose computer system with a computer program that when being loaded and executed controls the computer system such that it carries out the methods described herein.

The present invention may also be embedded in a computer program product which comprises all the features enabling the implementation of the methods described herein and which when loaded in a computer system is able to carry out these methods. Computer program in the present context means any expression in any language code or notation of a set of instructions intended to cause a system having an information processing capability to perform a particular function either directly or after either or both of the following a conversion to another language code or notation b reproduction in a different material form.

While the present invention has been described with reference to certain embodiments it will be understood by those skilled in the art that various changes may be made and equivalents may be substituted without departing from the scope of the present invention. In addition many modifications may be made to adapt a particular situation or material to the teachings of the present invention without departing from its scope. Therefore it is intended that the present invention not be limited to the particular embodiment disclosed but that the present invention will include all embodiments falling within the scope of the appended claims.

