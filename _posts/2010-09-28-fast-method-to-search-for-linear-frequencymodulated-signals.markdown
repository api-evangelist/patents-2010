---

title: Fast method to search for linear frequency-modulated signals
abstract: A computer implemented method for determining frequency and slope of a linear frequency modulated signal. Windowed signal data is collected and used for formulating a search surface function which can be calculated recursively. The function is divided into parts. Part values are calculated at an underspecified number of points corresponding to the number of parts. The search surface function part values are interpolated at values between frequency values. An interpolation geometry is chosen and then the function part values are interpolated at values between frequency values and slopes. Function parts are added together giving a restored search surface function. The frequency and slope values can be searched to find the values that maximize the search surface function. Other embodiments result in faster execution.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08407020&OS=08407020&RS=08407020
owner: The United States of America as represented by the Secretary of the Navy
number: 08407020
owner_city: Washington
owner_country: US
publication_date: 20100928
---
The invention described herein may be manufactured and used by or for the Government of the United States of America for Governmental purposes without the payment of any royalties thereon or therefor.

The invention relates to signal processing systems and methods in general and particularly to a signal processing method that employs recursive interpolation and sparse matrix methods implementation with thresholding in order to speed up the search for the parameters of a linear frequency modulated signal.

The linear frequency modulated FM signal or chirp is used extensively in signal processing to model man made or natural signals. When the parameters starting frequency and slope or chirp rate are unknown it is necessary to search a two dimensional parameter space. Since there are on the order Nuseful pairs of starting frequencies and slopes to test a brute force search would require a computational load of Nfor a length N input data record. The state of the art method using the Fast Fourier Transform FFT achieves a computational load of Nlog N.

Consider the linear frequency modulated FM chirp signal defined by a exp2 1 1 where N and i are integers a is an amplitude is a phase angle parameter the slope parameter exists in the range 2 2 the frequency parameter f exists in the range 02 and the time samples are 1 

When f are unknown the maximum likelihood ML solution searches over the two dimensional space f . Let be selected from the set

Note that the frequency search resolution is 2 times finer than an FFT requiring that a size 2N transform be used. There are N 1 N 2 1 bins to search for this sampling of the f plane. The search surface function is given by 

The brute force calculation of the search surface F x. . . x f is implemented in MATLAB available from The MathWorks Inc. 3 Apple Hill Drive Natick Mass. 01760 2098. The MATLAB code is presented in TABLE I below and shows the elapsed time for the calculation.

Since correlating the input data at each test frequency and slope requires N operations the process is of order N N 1 N 2 1 N 2. This is prohibitive if N is large.

The maximum likelihood search is typically done using the fast Fourier transform FFT to greatly speed up the search over f. For a given choice of we form the de chirped signal

A reduction is possible when taking advantage of the zero padded FFT bringing the computational load to N 2 1 2Nlog N . The MATLAB code is presented in TABLE II below.

The MATLAB code given in TABLE II produces exactly the same surface as the brute force method. Our observed speedup factor of about 550 is mainly due to the vectorization that we used in the FFT approach as opposed to the inefficient looping that we used in the brute force algorithm. Despite the improvements the order Nlog N computational load still too high for many applications.

Known in the prior art is Gruber et al. U.S. Pat. No. 5 249 150 which is said to disclose a circuit and method for iteratively estimating Fourier coefficients of one or more Fourier components of a measuring signal that utilizes a filter to determine the Fourier coefficients for sampling time k 1. The coefficients are utilized to obtain an estimate of the measuring signal at sampling time k. A subtractor circuit subtracts an actual sample of the measuring signal at sampling time k from the estimate of the measuring signal at sampling time k to obtain a difference signal. The difference signal is inputted back into the filter to determine an estimate of the Fourier coefficients at sampling time k.

Known in the prior art is Fukuda et al. U.S. Pat. No. 5 960 373 which is said to disclose a frequency analyzing method for analyzing frequency components of an original signal. The method has a spectrum detecting step of detecting from the original signal energy levels of components of a predetermined number of orthogonal function waves which have waveforms each having same start position and end position in a predetermined time window and in which the number of occurrences of periods in the predetermined time window or frequencies are different from each other and an orthogonal function wave changing step of changing at least one of the start position and the end position within the predetermined time window after completion of the spectrum detecting step wherein the spectrum detecting step and the orthogonal function wave changing step are alternately repeated. According to Fukuda it is possible to provide frequency analyzing method and apparatus which can contribute to estimate each correct fundamental frequency from a complex distorted wave signal such as a musical signal or the like by a relatively simple construction and to provide complex sound separating method and apparatus using the frequency analyzing method or apparatus.

Also known in the prior art is Scheppach U.S. Pat. No. 6 484 112 which is said to disclose a method for estimating the frequency of a time signal by means of a discrete Fourier transformation DFT and interpolation between support points of the DFT spectrum. According to the method the Hamming window is used in a known manner for filtering and the interpolation is carried out according to the mathematically calculated solution. The method makes use of the fact that a function of the third degree which can serve as a correction distance has a clear solution within the definition range of the amount ratio between a secondary maximum and a primary maximum of the DFT spectrum. The correction distance is calculated according to this solution on the basis of the ratio of the secondary maximum and the primary maximum.

Also known in the prior art is Nelson U.S. Pat. No. 6 577 968 which is said to disclose a method of estimating the frequency of a signal by first receiving a signal forming a row vector segmenting the row vector converting the row vector to a first matrix multiplying the first matrix by a weight and performing a Fourier transform on the result of the last step. These same steps are repeated on a delayed version of the signal. The next steps are calculating a complex conjugate for each result of the last step forming a cross spectrum matrix selecting a magnitude in the cross spectrum matrix that is above a threshold and setting an angular frequency of the signal to either the phase of the selected magnitude the phase of the mean of the complex numbers in the row in which appears the selected magnitude or the selected magnitude. The frequency of the signal is then set to the estimated angular frequency divided by the product of 2 and the signal delay period. Additional rows are processed if need be.

Also known in the prior art is Hillerstrom U.S. Pat. No. 6 598 005 which is said to disclose a method for measuring a frequency f 2 of a sinusoidal signal V t A sin t with an essentially constant amplitude A. Measured values are registered in the form of the instantaneous level of the signal V t V t h and V t 2 h at three points of time separated by a predetermined measuring period h which corresponds to a measurement frequency f 1 h. Then the measured values are applied to a calculating device which recursively estimates the quantity y t given by y t y t h e t s V t h where e t V t V T 2 h 2 y t h and s V t h V t h 0. The choice of and s . controls the convergence speed of y t cos h and the noise sensitivity of the measurement system. Finally the frequency is calculated or looked up in a table based on the expression f t f 2 arc cos y t .

Also known in the prior art is Michel U.S. Pat. No. 7 076 380 which is said to disclose a method for analyzing the frequency in real time of a non stationary signal and corresponding analysis circuit. According to the invention the signal is sampled digitized and broken up into sub bands. In each sub band the signal is modeled by an auto regressive filter the transfer function of which is of the form 1 A z . By an adaptive method that is recursive in time and in order all the polynomials A z that have a degree between 1 and a maximum value are calculated. The order of the model is estimated and the polynomial that has this order is retained. The roots of this polynomial are calculated and the components are monitored. The frequency and the amplitude of the sinusoidal components of the signal are thus obtained. Applications include aeronautics electromagnetic mechanics seismic prospecting zoology and others.

Also known in the prior art is Shim et al. U.S. Pat. No. 7 103 491 which is said to disclose a method of estimating parameters of time series data using a Fourier transform. The parameter estimation method can directly estimate modes and parameters indicating the characteristics of a dynamic system on the basis of the Fourier transform of the time series data. The method is advantageous in that it can estimate parameters of the system through a single Fourier transform without repeatedly calculating a Fourier transform thus shortening the time required to estimate the parameters.

Also known in the prior art is Rao U.S. Pat. No. 7 124 042 which is said to disclose a system and method for estimating parameters of multiple tones in an input signal. The method includes receiving samples of the input signal generating a frequency transform FT of the samples identifying multiple amplitude peaks in the FT corresponding to the tones and determining parameter estimates characterizing each of the multiple tones based on the peaks. For each tone the effects of the other tones are removed from the FT of the peak of the tone using the parameter estimates of the other tones to generate modified FT data for the tone. Single tone estimation is applied to the modified FT data to generating refined parameter estimates of the tone which is used to update the parameter estimates of the tone. After refining the estimates for each tone the entire process may be repeated one or more times using successive refined estimates to generate final estimates for the parameters.

A literature search revealed a number of algorithms related to this problem that include the following. There are algorithms that attain fast performance by searching only over 1 dimensional space of see J. Cao N. Zhang and L. Song A fast algorithm for the chirp rate estimation in 4 2008 pp. 45 48 January 2008 P. M. Djuric and S. M. Kay Parameter estimation of chirp signals vol. 38 pp. 2118 2126 December 1990 and W. Li M. Dan X. Wang D. Li and G. Wang Fast estimation method and performance analysis of frequency modulation rate via rat in 2008 Zhangjiajie China pp. 144 147 June 2008 . These algorithms confuse signals with different starting frequency and similar slope and typically require a higher signal to noise ratio SNR to work properly.

There are algorithms that integrate in the time frequency transform TF plane see S. Barbarossa Analysis of multicomponent lfm signals by a combined wigner hough transform vol. 43 pp. 1511 1515 June 1995 S. Krishnan and R. Rangayyan Detection of chirp and other components in the time frequency plane using the hough and radon transforms in 1997 vol. 1 Victoria BC Canada pp. 138 141 August 1997 and J. Wood and D. Barry Radon transformation of time frequency distributions for analysis of multicomponent signals vol. 42 pp. 3166 3177 November 1994 . The computation of the TF distribution adds significant processing load. In addition because of cross terms these methods can have difficulties with multi component signals.

There are algorithms that are based on the fractional Fourier transform FrFT See H. M. Ozaktas O. Ankan M. A. Kutay and G. Bozdaki Digital computation of the fractional fourier transform vol. 44 September 1996. No significant processing improvement can be obtained because of the necessity of calculating a FrFT for each assumed slope.

A set of similar algorithms called various names such as the discrete chirp Fourier transform DCFT See C. A. Aceros Moreno and D. Rodriguez Fast discrete chirp fourier transforms for radar signal detection systems using cluster computer implementations in 48 vol. 2 pp. 1047 1050 August 2005 discrete quadratic phase transform DQPT See M. Z. Ikram K. Abed Meraim and Y. Hua Fast discrete quadratic phase transform for estimating the parameters of chirp signals vol. 7 pp. 127 135 April 1997 and polynomial time frequency transform PTFT See G. Bi and Y. Wei Split radix algorithms for arbitrary order of polynomial time frequency transforms vol. 55 pp. 134 141 January 2007 and Y. Ju and G. Bi Generalized fast algorithms for the polynomial time frequency transform vol. 55 pp. 4907 4915 October 2007 . The DCFT is defined as 

In short one is left with the FFT based algorithm described above that has Nlog N computational load as the only realistic solution available up to now. There is a need for more efficient and less time consuming methods for analyzing linear frequency modulated signals.

A primary objective of the present invention is to provide improved systems and methods to identify a linear frequency modulated LFM signal or chirp signal in noise.

It is also a primary objective of the present invention to produce an apparatus that can perform the identification of the parameters of the linear frequency modulated LFM signal in noise.

It is also an objective of the present invention to produce an apparatus that can perform the identification of the parameters of the linear frequency modulated LFM signal in noise with a computational time that is of the order of N where N is an integer that represents the number of data points to be examined.

Accordingly there is provided a computer implemented method for determining start frequency and frequency shift rate hereinafter slope of a linear frequency modulated signal. Windowed signal data is collected and used for formulating a search surface function. The function is divided into parts. Part values are calculated at a reduced number of points corresponding to the length of the parts. The search surface function part values are interpolated at values between frequency values. An interpolation geometry is chosen and then the function part values are interpolated at values between frequency values and slopes. Function parts are added together giving a restored search surface function. Breaking the data into parts can be formulated in a recursive fashion by always breaking into two parts then operating on each half by again breaking into halves and so forth. The frequency and slope values can be searched to find the values that maximize the search surface function. Other embodiments result in faster execution.

In one embodiment the method doesn t calculate function values for which the frequency crosses 0 or N 2.

In another embodiment the method performs the additional step of amplitude thresholding the function values to eliminate data points for which the amplitude is lower than a threshold value.

The foregoing and other objects aspects features and advantages of the invention will become more apparent from the following description and from the claims.

This describes an algorithm that achieves Nperformance with a measured speed up factor of more than 20 for N 512. An approximate algorithm is also described that is nearly optimal and achieves performance with a measured speed up factor of 40 at N 2048 at a cost of a 2 dB increase in the minimum detectable signal level.

This approach has a computational load Nrather than Nlog N and can offer a factor of more than 20 in processing speed up. An approximation based on thresholding is also described that can achieve even more computational reduction.

As a first step the function F is generalized and the function G is defined to operate on an arbitrary time segment of the data of length K. Let

In other words G iK f is a transform of the windowed data of length K starting at time index i. The full length N transform can be written 1 . 4 

The algorithm G becomes recursive in the sense of a function calling itself if we write in general 2 22 . 6 

We can continue the recursion dividing into halves until each call to function G is applied to a single sample of data. Although interesting the recursive decomposition does not significantly change computing performance. To make progress we need to use interpolation.

Notice that in Eq. 6 the functions G i K 2 f and G i K 2 K 2 f operate on a shorter data record than G i K f yet the functions must be calculated for all N 1 N 2 1 choices of f . Clearly the search surface is oversampled.

As the data segment size gets smaller the smoothness of the image increases. Conversely as the surfaces of smaller data windows are added together the result is always finer in detail. We take advantage of this observation by calculating fewer transform points that is for fewer f bins as K becomes smaller. So as we divide the data into two parts we decimate the requested values of both f and by a factor of two. However since we still need the higher resolution surfaces to sum we need to interpolate the surfaces before the summation. We will find that the interpolation requires less computation than calculating the surfaces at high resolution.

Turning to the black dots represent the points f for which we have already calculated G i K 2 f . The empty circles are to be estimated by interpolation. On the right side of the figure we see a blow up of a typical cluster of points. In we have identified six interpolation geometries. In each geometry we interpolate to determine the value of a point directly in between two existing points. The geometries are denoted by B A B D B E B F B G and B C .

Our approach is to first perform B C interpolation vertical in frequency domain only everywhere possible which doubles the number of frequency points then use one of the other geometries to fill in the missing values of .

Once B C interpolation geometry has been applied to all possible pairs it is then possible to use B A B D B E B F or B G interpolation geometries to fill in the remaining circles in the figure. This is illustrated in and in which we use B C followed by B D.

Now referring to on the top row you see the search surfaces from the data windows representing the first through fourth quarters of the data. The correlation structure that is apparent in the data runs diagonally from upper left to bottom right. The angle however depends on the time slice.

In we see five interpolation geometries to fill in the missing value. The best geometry to use is the one that matches the main axis of the correlation. One of these geometries is the best for each time slice. As we will see next it is a simple matter of determining the correlation coefficient between point B and A D E F and G under the assumption of white noise input to see which correlation has the highest magnitude. In each situation we can use the best interpolation geometry.

To carry out the interpolation we appeal to statistical analysis of the complex search values assuming the input is independent Gaussian noise. Let z be a point that is to be estimated from points yand y. Let the interpolation be accomplished by the linear operation .

The principle of orthogonality requires that E circumflex over z z 0 and E circumflex over z z 0. Expanding 

Thus the correlation structure depends only upon frequency difference and slope difference. This means that the same interpolation can be used anywhere in the f grid. Note however that it depends also on the time values t so varies depending on which data window is being transformed. The interpolation coefficients can be pre computed. shows the results of the prior art FFT method and shows the results of the interpolation method. While the difference is not clear visually the two surfaces produce different numerical values however there is a large difference in computational speed.

Let lbe the number of complex operations needed to compute the surface for G i K f at the required decimated K 1 frequency bins times K 2 1 bins. Since we divide the data into two K 2 windows we need 2loperations to calculate the initial K 2 1 frequency bins times K 4 1 bins on each half. Then the number of missing bins to interpolate on each half surface equals

We can eliminate f pairs for which the frequency crosses 0 or N 2 i.e. the Nyquist frequency . The frequencies that cross are limited to triangular regions appearing as black in . Elimination of these points results in a factor of 2 savings.

We can apply code optimization. Processor extensions such as Streaming SIMD Extensions SSE which are available on Pentium 3 and above can be used. This can result in a theoretical factor of 4 improvement for single precision floating point computations however a factor of 2 is more realistic.

An additional significant improvement can be obtained by thresholding the amplitude surfaces G i K f . Algorithm speedup can be achieved because first interpolation calculations need only be done on the threshold exceedences and second the costly final search for largest value is avoided. Refer to and in which we have applied a threshold to and before summation of the windowed halves. Thresholding allows the complex surface data to be stored efficiently in a sparse matrix. Interpolation and matrix summations can be accomplished using sparse matrix techniques. In order to prevent loss of important maxima in the search surface the threshold must be lowered as K becomes smaller. In theory if we are trying to detect a certain signal level A F x x. . . x f the threshold must be divided by 4 at each recursion level. The factor of four accounts for a factor of 2 for the reduction of the processing gain at the lower value of K and another factor of 2 to account for the scaling the mean value of F is proportional to N with independent Gaussian noise input . At some point in the recursion there is no more advantage to thresholding as the threshold becomes too low to be useful.

A comparison of execution times for various methods of calculating the search surface is given in and . shows the execution time of the FFT method triangles recursive interpolation open circles and thresholded method with a high threshold using sparse matrix methods closed circles as a function of log N . These performances were derived using an Intel Pentium 4 processor operating at 3 GHz. Execution times include the time needed to search the amplitude surface for the largest element. is a diagram similar to obtained using a low threshold. The execution times for FFT and interpolation methods are slower than those shown in and the difference between the FFT and interpolation methods is also much less dramatic. This is because we have now included the time to search the surface for the largest amplitude element. The performance improvement for the interpolation method is dramatic. Thresholding was used only for K N 4 and above. For N 2048 the speedup ratio approaches 40 at the higher threshold and about 30 at the lower threshold setting.

We have developed a fast algorithm for maximum likelihood search of the parameters of a linear frequency modulated LFM signal in noise. The algorithm is order Ncomplexity improving upon the state of the art which is order NlogN complexity. The algorithm was shown to have a speedup factor of over 20 in comparison to an efficient implementation of the prior art algorithm. However the time needed to then search for the largest value in the resulting two dimensional surface is sufficiently large that it accounts for about half of the overall computational load. To remedy this problem we demonstrated a sparse matrix implementation that used thresholding to increase the overall speedup factor to about 30.

The determined chirp signal parameters can then be cross referenced with a database of known chirp signal parameters. For example known biological signals such as bird calls or whale songs could be compressed to their most fundamental frequencies and stored in a database. The extracted chirp signal parameters can be compared against the known biological signals to find the known biological signal that most nearly matches the extracted chirp signal parameter. The known signal can then be identified to a user as a near match.

It will be understood that many additional changes in the details materials steps and arrangement of parts which have been herein described and illustrated in order to explain the nature of the invention may be made by those skilled in the art within the principle and scope of the invention as expressed in the appended claims.

