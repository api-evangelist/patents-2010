---

title: Virtual smart card through a PC/SC interface
abstract: A technique of providing a cryptographic service on a computer having a processor includes deploying an executable cryptographic agent set on the computer, each executable cryptographic agent from the executable cryptographic agent set being a set of instructions executed on the processor. The technique also includes activating an executable cryptographic agent on the computer, each executable cryptographic agent being constructed and arranged to generate cryptographic codes which change over time in response to activation of the agent. The technique further includes providing, to an application running on the computer, access to the executable cryptographic agent through a Personal Computer/Smart Card (PC/SC) interface of the computer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08453232&OS=08453232&RS=08453232
owner: EMC Corporation
number: 08453232
owner_city: Hopkinton
owner_country: US
publication_date: 20100930
---
A conventional authentication system includes a user authentication token a user computer and an authentication server which connects to the user computer over a network. For the user to authenticate to the authentication server the user physically plugs the user authentication token into the user computer. One conventional user authentication token plugs into a USB port of the user computer.

After the authentication token is physically plugged into the user computer the authentication token dynamically generates tokencodes such as a one time passcode OTP and supplies the generated tokencode as well as a digital certificate to an application upon request via the Personal Computer Smart Card PC SC interface of the user computer.

Current software packages in the form of virtual smart cards are capable of providing OTPs and digital certificates for use by a certain set of specialized applications.

Most applications however are not able to access virtual smart cards through the PC SC interface even as they are able to access physical smart cards i.e. hardware tokens through the PC SC interface. Special applications which have access to certain libraries e.g. PKCS are required to be used which recognize tokencodes and certificates generated by these programs. More generic applications running on e.g. Microsoft Windows or Linux are currently unable to take advantage of virtual smart cards.

In contrast to the above described scenario in which a physical token is required for a generic application to access tokencodes generated by the token this disclosure describes a technique for simulating a hardware token in software. This simulated or virtual token can be accessed through the PC SC interface. As with a hardware token the virtual token contains credentials that can be read by a smart card application that sits on top of a smart card stack with the PC SC interface towards the bottom of the stack and the virtual smart card at the bottom of the stack. Besides housing credentials such as tokencodes and digital certificates the virtual smart card can perform cryptographic operations that are normally performed within the smart card such as key generation encryption decryption and signing.

Such a technique of providing a cryptographic service on a computer having a processor is presented as an embodiment of a method. The method includes deploying an executable cryptographic agent set on the computer each executable cryptographic agent from the executable cryptographic agent set being a set of instructions executed on the processor. The method also includes activating an executable cryptographic agent on the computer each executable cryptographic agent being constructed and arranged to generate cryptographic codes which change over time in response to activation of the agent. The method further includes providing to an application running on the computer access to the executable cryptographic agent through the PC SC interface of the computer.

Providing access to the executable cryptographic agent can include locating on a non volatile memory coupled to the processor a token seed value and generating based on the token seed value a set of one time passcodes which act as a cryptographic code. Along this vein deploying the executable cryptographic agent set on the computer can include providing a set of inquiries to a user receiving a set of enrollment answers from the user in response to the set of inquiries each enrollment answer from the set of enrollment answers corresponding to an inquiry from the set of inquiries and storing the sets of inquiries and enrollment answers on the non volatile memory. In this case the sets of inquiries and enrollment answers in combination with a personal identification number provide a vehicle for the user to be identified within the computer. Also activating the executable cryptographic agent on the computer can include providing from the non volatile computer readable storage medium the set of inquiries to a prospective user receiving a set of answers from the prospective user in response to the set of inquiries and comparing the received set of answers to the stored set of enrollment answers. Further providing the set of inquiries to the prospective user can include sending via a network interface on the computer a message to the prospective user the message including the set of inquiries. In this case the prospective user is connected to a network through a virtual desktop environment and the network interface is coupled to the network to which the prospective user is connected.

Providing access to the executable cryptographic agent can include making available to the application a digital certificate from the executable cryptographic agent through the PC SC interface. In this case the digital certificate is constructed and arranged to identify the user to a third party.

Providing access to the executable cryptographic agent can include making available to the application a public key from the executable cryptographic agent through the PC SC interface and providing encryption services for messages generated and sent to third parties by the application. In this case the public key is constructed and arranged to match a private key from a third party.

Providing access to the executable cryptographic agent can include making available to the application a private key from the executable cryptographic agent through the PC SC interface and providing decryption services for messages generated and sent from third parties to the user via the application. In this case the private key is constructed and arranged to match public keys contained in the messages.

The technique can further include activating a second executable cryptographic agent from the executable cryptographic agent set on the computer and providing to a second application running on the computer access to the second executable cryptographic agent through the Personal Computer Smart Card PC SC interface of the computer.

A further embodiment to the technique of is an apparatus configured to provide a cryptographic service. The apparatus includes a memory. The apparatus further includes a processor coupled to the memory. The processor is configured to deploy an executable cryptographic agent set on the apparatus each executable cryptographic agent from the executable cryptographic agent set being a set of instructions executed on the processor. The processor is also configured to activate an executable cryptographic agent on the apparatus each executable cryptographic agent being constructed and arranged to generate cryptographic codes which change over time in response to activation. The processor is further configured to provide to an application running on the apparatus access to the executable cryptographic agent through a Personal Computer Smart Card PC SC interface of the apparatus.

The memory can be configured to store a token seed value. In this case activating the executable cryptographic agent on the apparatus includes locating the token seed value on the memory and generating based on the token seed value a set of one time passcodes which act as a cryptographic code.

Further the apparatus can further include an input output interface. In this case deploying the executable cryptographic agent set on the apparatus includes providing a set of inquiries to a user via the input output interface receiving via the input output interface a set of enrollment answers from the user in response to the set of inquiries each enrollment answer from the set of enrollment answers corresponding to an inquiry from the set of inquiries and storing the sets of inquiries and enrollment answers on the memory. The sets of inquiries and enrollment answers in combination with a personal identification number can provide a vehicle for the user to be identified within the apparatus.

Activating the executable cryptographic agent can include providing from the memory the set of inquiries to a prospective user via the input output interface receiving via the input output interface a set of answers from the prospective user in response to the set of inquiries and comparing the received set of answers to the stored set of enrollment answers.

The apparatus can further include a network interface. In this case providing the set of inquiries to the prospective user can include sending via the network interface a message to the prospective user the message including the set of inquiries. Further the prospective user can be connected to a network through a virtual desktop environment and the network interface can be coupled to the network to which the prospective user is connected.

The processor can be further configured to activate a second executable cryptographic agent from the executable cryptographic agent set on the apparatus and provide to a second application running on the processor access to the second executable cryptographic agent through the PC SC interface.

A further embodiment to the technique of is a computer program product having a non transitory computer readable storage medium which stores code to provide a cryptographic service on a computer. The code includes instructions to deploy an executable cryptographic agent set on the computer each executable cryptographic agent from the executable cryptographic agent set being a set of instructions executed on the processor. The code also includes instructions to activate an executable cryptographic agent on the computer each executable cryptographic agent being constructed and arranged to generate cryptographic codes which change over time in response to activation. The code further includes instructions to provide to an application running on the computer access to the executable cryptographic agent through the PC SC interface of the computer.

Activating the executable cryptographic agent on the computer can include locating on a memory coupled to the processor a token seed value and generating based on the token seed value a set of one time passwords which act as a cryptographic code.

Deploying the executable cryptographic agent set on the computer can include providing a set of inquiries to a user receiving a set of enrollment answers from the user in response to the set of inquiries each enrollment answer from the set of enrollment answers corresponding to an inquiry from the set of inquiries and storing the sets of inquiries and enrollment answers on the memory. In this case the sets of inquiries and enrollment answers in combination with a personal identification number provide a vehicle for the user to be identified within the computer.

Activating the executable cryptographic agent on the computer can include providing from the memory the set of inquiries to a prospective user receiving a set of answers from the prospective user in response to the set of inquiries and comparing the received set of answers to the stored set of enrollment answers.

The code can further include instructions to activate a second executable cryptographic agent from the executable cryptographic agent set on the computer and provide to a second application running on the computer access to the second executable cryptographic agent through the PC SC interface.

Providing access to the executable cryptographic agent through the PC SC interface of the computer can include deploying a windowing module in a software layer above that of the PC SC interface and providing a subset of data input to and output from the PC SC interface to a log file stored on the memory. In this case the windowing module is a dynamically linked library configured to provide an application programming interface for a PKCS unit test module to access the cryptographic agent.

An improved technique of providing a cryptographic service on a computer includes providing to an application running on the computer access to an executable cryptographic agent through a Personal Computer Smart Card PC SC interface of the computer. The application is generally configured to run in an operating system on the computer. Providing access to the executable cryptographic agent can include sending a digital certificate or a public or private key to the application. In this way the application offers two level security to standard PC applications while alleviating the need for a physical smart card device.

Communications medium can include a public network e.g. the Internet . Further communications medium can include a firewall between the general public and computer to limit access to authorized users of computer . In some circumstances communications medium can also include secure channels between nodes such as remote server and computer .

Authentication server includes a system configured to determine the veracity of a one time password supplied by a system using communications medium .

Computer is configured to run application which requires cryptographic codes verified by authentication server in order to identify user to a third party on remote server . To this effect computer runs a cryptographic agent which generates the cryptographic codes used by application . Cryptographic codes commonly take the form of tokencodes e.g. one time passcodes which are generated according to a mathematical algorithm at predetermined time intervals e.g. one minute. Within this system two factor security e.g. security involving a OTP and a user supplied personal identification number is achieved on standard applications without the use of a physical smart card device.

Input output device includes a keyboard mouse and monitor although other elements can include but are not limited to a speech to text interpreter a touch screen a microphone and speakers. Input output device converts thoughts and actions of user into bit streams interpretable by computer .

Processor is configured to run at least application and cryptographic agent . Processor can take the form of but is not limited to an Intel or AMD based MPU and can be a single or multi core running single or multiple threads.

Memory coupled to processor is configured to store executables and data associated with application and cryptographic agent . Further cryptographic data such a token seed value used to generate cryptographic codes is also stored on memory .

Network interface also coupled to processor is connected to communications medium . Network interface is further operable to enable user to log in to computer from a remote location. Network interface can take the form of but is not restricted to an Ethernet card an 802.11a b g n wireless receiver transmitter a dial up modem or a Token Ring LAN.

Operating system is stored in memory and runs on processor . Operating system preferably includes PC SC interface through which cryptographic agent takes in requests from application for cryptographic codes and gives out the cryptographic codes to application . For example PC SC interface is a service embedded within operating system . Specifically PC SC interface is a standard operating system level service which runs in Microsoft Windows and Linux and works with applications which run in such operating systems.

During operation user deploys cryptographic agent onto computer via input output device . The deploying involves user establishing an identity within computer that is stored in memory . Once the identity is established user may log into computer as the need arises. A subsequent successful login by user will activate cryptographic agent in processor .

To activate some time later user sends a signal to input output interface containing answers to life questions displayed on input output interface . Input output interface then sends a signal to processor containing the answers. Processor sends a signal to memory requesting the enrollment answers previously stored upon the retrieval of which memory sends a signal back to processor containing the enrollment answers. Processor performs a comparison the answers input at input output interface to the enrollment answers. Processor then sends a signal to input output interface containing results of the comparison . If comparison is successful then cryptographic agent is activated and user is logged in.

User preferably sends the signal to input output interface from a location local to computer . Alternatively user can be connected to a network through a virtual desktop environment where network interface is coupled to the network to which the prospective user is connected. That is user logs in remotely to computer . A remote desktop environment in which user works is e.g. Remote Desktop Citrix etc.

Once logged in user may activate application which requires cryptographic data assuring a third party of the identity of user . For example user can attach a digital certificate into an email to be sent using application . Alternatively user can obtain a public key to be sent in an encrypted email using application . Still further user can obtain a private key to be used in decrypting an email containing a public key from a third party the decryption being performed by application . Such digital certificates and public and private keys are housed within cryptographic agent and provide assurance to a third party of the identity of user as well as authentication data to the third party.

Application upon being requested to perform the cryptographic function sends a signal to PC SC interface requesting cryptographic data. PC SC interface then sends a signal to cryptographic agent requesting cryptographic data.

Cryptographic agent upon receiving the request for cryptographic data performs a generation of a tokencode e.g. a one time passcode. The generation is accomplished by accessing in memory a token seed value which when combined with other parameters e.g. system time produces a one time passcode valid for a predetermined time interval e.g. one minute .

Once the one time password is generated cryptographic agent sends a signal to PC SC interface indicating the one time passcode is available. Upon obtaining the one time passcode PC SC interface sends a signal to application including a message that the one time passcode is available to be accessed from PC SC interface .

Application can perform cryptographic functions using the passcode and or the public and private keys. For example application can access a private key housed in cryptographic agent for decrypting an email message containing a public key generated using a compatible one time passcode. Further application can access a public key housed in cryptographic agent to be sent with an encrypted message the encrypted message would then be decrypted by a third party.

Note that with the system described above application is ignorant of the origin of the cryptographic data it uses. That is application makes no differentiation between data retrieved from a physical smart card or a virtual smart card in the form of cryptographic agent . This ignorance of the data s origin on part of application is possible because the application gets the data from PC SC interface . In turn PC SC interface is configured to obtain smart card data from various sources. Cryptographic agent is configured to generate cryptographic data in a form recognizable to PC SC interface in order to be useful to application .

A further advantage of system lies in its usefulness beyond a single cryptographic agent . For example two cryptographic agents may be deployed for either multiple users and or multiple applications. Each cryptographic agent generates cryptographic data independently and occupies different address spaces in memory so that PC SC interface has a way of recognizing the origin and destination of each cryptographic datum sent to it.

System as described above can be used for a backup authentication system for users who lose or forget their physical smart cards which generate one time passcodes. Users can activate cryptographic agent as needed once deployed in the presence of a trusted agent e.g. a system admin. Further the user can deactivate cryptographic agent by shutting down computer or logging off.

Alternatively system can be used as a testing platform. In this case cryptographic agent acts as a smart card simulation agent in which targeted smart card data that is used on a variety of smart card systems is generated by cryptographic agent . Further system also includes a virtual smart card API which is placed on top of PC SC interface . Virtual smart card API takes the form of a dynamically linked library configured to provide an API for a PKCS unit test module to access cryptographic agent . Virtual smart card API acts as a windowing module in a software layer above PC SC interface and is deployed through an execution of an API call. Virtual smart card API once deployed provides the targeted data that passes to and from PC SC interface to a log file on memory for inspection by system testers.

The executable cryptographic agent set deployed in step can be a single cryptographic agent or multiple agents. In the case of multiple agents each agent is associated with a unique user and or an application running on the processor or multiple processors .

The cryptographic codes which change over time generated by a cryptographic agent activated in step can take the form of one time passcodes. The one time passcodes have a lifetime of e.g. one minute.

The PC SC interface which provides access to a cryptographic agent in step is configured to recognize cryptographic data from both agents in software form and as physical smart cards.

While various embodiments of the invention have been particularly shown and described it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention as defined by the appended claims.

For example it should be understood that some embodiments are directed to an electronic environment which utilizes system that provides a cryptographic service on a computer having a processor. Some embodiments are directed to system . Some embodiments are directed to a process of providing cryptographic service on a computer having a processor. Also some embodiments are directed to a computer program product which enables computer logic to perform the providing of cryptographic service on a computer having a processor.

In some arrangements system is implemented by a set of processors or other types of control processing circuitry running software. In such arrangements the software instructions can be delivered to system in the form of a computer program product illustrated generally by a diskette icon in having a computer readable storage medium which stores the instructions in a non volatile manner. Examples of suitable computer readable storage media include tangible articles of manufacture and apparatus such as CD ROM flash memory disk memory tape memory and the like.

