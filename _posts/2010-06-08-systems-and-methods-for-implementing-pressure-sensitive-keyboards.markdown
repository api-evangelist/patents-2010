---

title: Systems and methods for implementing pressure sensitive keyboards
abstract: Systems and methods for implementing pressure sensitive keys to produce digital signals that emulate actuation of conventional “momentary on” digital keys of a conventional keyboard. The pressure sensitive keys may be implemented to generate an alternating open/short digital signal representative of the amount of pressure applied to a given key at any given time. The open/short digital signal may be supplied as a signal representative of applied key pressure to a legacy keyboard key matrix and controller or other processing device of an information handling system that is configured to measure keyboard input based on “momentary-on” digital signals.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08711011&OS=08711011&RS=08711011
owner: Dell Products, LP
number: 08711011
owner_city: Round Rock
owner_country: US
publication_date: 20100608
---
This patent application is a continuation in part of U.S. patent application Ser. No. 12 316 703 titled Keyboard With User Configurable Granularity Scales For Pressure Sensitive Keys by Mark A. Casparian et al. filed on Dec. 16 2008 the entire disclosure of which is incorporated herein by reference.

The techniques described herein relate to systems and methods for keyboards and more particularly for pressure sensitive keyboards.

As the value and use of information continues to increase individuals and businesses seek additional ways to process and store information. One option available to users is information handling systems. An information handling system generally processes compiles stores and or communicates information or data for business personal or other purposes thereby allowing users to take advantage of the value of the information. Because technology and information handling needs and requirements vary between different users or applications information handling systems may also vary regarding what information is handled how the information is handled how much information is processed stored or communicated and how quickly and efficiently the information may be processed stored or communicated. The variations in information handling systems allow for information handling systems to be general or configured for a specific user or specific use such as financial transaction processing airline reservations enterprise data storage or global communications. In addition information handling systems may include a variety of hardware and software components that may be configured to process store and communicate information and may include one or more computer systems data storage systems and networking systems.

Many information handling systems use keyboards to obtain user input. Some prior keyboard solutions have provided pressure sensitive keys. The most common technique to provide pressure sensitive keys is to use variable resistance sensing techniques to provide an indication of the pressure applied by a user to a key. Variable capacitance sensing has also been utilized in some prior art products such as console gamepad controllers. While pressure sensitive buttons have been used before improved techniques and control of pressure sensitive keys are still needed particularly for gaming keyboards.

Systems and methods are disclosed herein for implementing pressure sensitive keys to produce alternating digital open short signals that emulate actuation of conventional momentary on digital keys. In one embodiment the disclosed systems and methods may be implemented in an manner that allows a pressure sensitive keyboard to be implemented using variable capacitance variable conductance variable resistance or other suitable pressure sensitive measurement methodology to generate an alternating open short digital signal representative of the amount of pressure applied to a given key at any given time. The open short digital signal may be supplied as a signal representative of applied key pressure to a legacy keyboard controller or other processing device of an information handling system that is configured to measure keyboard input based on momentary on signals. In one exemplary embodiment the disclosed systems and methods may be advantageously implemented to provide a drop in replacement keyboard for a standard type momentary on keyboard of an information handling system e.g. portable information handling system such as a notebook computer that employs a conventional keyboard controller configured to receive momentary on digital key signals and no analog keyboard signals. Other examples of portable information handling system include but are not limited to MP3 players portable data assistants cellular phones tablet computers etc.

The disclosed systems and methods may be implemented in one exemplary embodiment to achieve fast response time and or for interfacing with a legacy keyboard controller. In this regard pressure sensing digital output circuitry e.g. controller microcontroller or other processing device s may be implemented in a manner that supports any number of pressure sensitive keys is compatible with a legacy keyboard controller and device drivers and using little additional power. In one exemplary embodiment falling edge triggered digital interrupt inputs may be provided to a processing device of pressure sensing digital output circuitry rather than feeding analog signals to an ADC. This advantageously allows improved response time to a user s input e.g. finger pressure . Further circuitry may be provided in another exemplary embodiment to interface any number of variable pressure sensitive keys to a legacy keyboard e.g. 8 bit microcontroller and 24 bit interface to a legacy keyboard matrix . Low power capability may be provided by using pressure sensing digital output circuitry that processes code in an interrupt service routine ISR whenever an interrupt due to application of pressure on a pressure sensitive key is sensed on any of the digital inputs of the circuitry and then goes to sleep i.e. low power state while it continues to actively monitor its interrupt digital inputs for any other event. Thus the pressure sensing digital output circuitry only monitors trigger events runs code when it detects them and then goes back to sleep again until another trigger event is detected. This translates into ultra low power consumption for this embodiment which is advantageous for drop in replacement keyboard arrays that are capable of operating on an existing information handling system power supply.

Advantageously the disclosed systems and methods may be implemented in another embodiment to provide a drop in replacement of a current production keyboard array for an information handling system such as a notebook computer e.g. for build to order specification after market replacement in an existing previously built information handling system updated production run etc. without requiring any mechanical electrical device driver or operating system OS changes to the existing information handling system. In such an embodiment the pressure sensitive keys and the pressure sensing digital output circuitry may be integrated into a replacement keyboard assembly that is mechanically and electrically compatible with the information handling system host equipment e.g. including legacy keyboard controller and using native OS keyboard drivers to operate the keyboard. The disclosed systems and methods may also advantageously be implemented in one embodiment to provide pressure sensitive key capability for use with older games that only accept user key toggling because no special code patches are required to allow applications running on a host information handling system to understand keyboard input from the pressure sensitive keys of the disclosed keyboard systems i.e. the keyboard input to the game is understood by the game as input from a legacy USB keyboard.

The disclosed pressure sensitive keyboard measurement methods and systems may be optionally implemented in one exemplary embodiment with user configurable pressure sensitive keys and techniques for controlling these keys for keyboards. In such an embodiment user configuration information including information for user configurable granularity scales can be communicated from a host system to the keyboard and stored for later use by a keyboard controller or other processing device associated with the keyboard to control the operation of the pressure sensitive keys. Alternatively such user configuration information may be employed by a software application operating on the host system that communicates with a keyboard controller to control the operation of the pressure sensitive keys. Either way greater control of the pressure sensitive keys can be provided. This configurability is of particular use for applications such as where the keyboard is being used for gaming by a user running a gaming application on an information handling system. In particular the user can configure the granularity scale for each pressure sensitive key so that each key can provide a desired gaming response. In addition different configuration files can be stored so that a user can select and use different configurations for different games and or different users can select and use different configurations based upon their personal preferences.

In one respect disclosed herein is a keyboard system including one or more pressure sensitive keys configured to provide analog output signals corresponding to each given one of the pressure sensitive keys that is representative of pressure applied to the given key and pressure sensing interface circuitry coupled to receive the analog output signal from each given one of the pressure sensitive keys the pressure sensing digital output circuitry being configured to provide a separate alternating open and short digital output signal based thereupon having a frequency that is representative of pressure applied to the corresponding given one of the pressure sensitive keys.

In another respect disclosed herein is a method of accepting user input from a keyboard including providing one or more pressure sensitive keys producing an analog output signal for each given one of the pressure sensitive keys when depressed by a user the analog output signals being representative of pressure applied to the given pressure sensitive key by the user and providing a separate alternating open and short open short digital output signal based upon the analog output signal the alternating open and short open short digital output signals having a frequency that is representative of the pressure applied to the given pressure sensitive key by the user.

For purposes of this disclosure an information handling system may include any instrumentality or aggregate of instrumentalities operable to compute classify process transmit receive retrieve originate switch store display manifest detect record reproduce handle or utilize any form of information intelligence or data for business scientific control or other purposes. For example an information handling system may be a personal computer a server computer system a network storage device or any other suitable device and may vary in size shape performance functionality and price. The information handling system may include random access memory RAM one or more processing resources such as a central processing unit CPU or hardware or software control logic ROM and or other types of nonvolatile memory. Additional components of the information handling system may include one or more disk drives one or more network ports for communicating with external devices as well as various input and output I O devices such as a keyboard a mouse and a video display. The information handling system may also include one or more buses operable to transmit communications between the various hardware components.

As described herein systems and methods are provided to implement pressure sensitive keys by producing a digital open short signal that is representative of the amount of pressure applied to a given key at a given time. Conventional keyboards typically use rubber dome based keys that provide a momentary on switch contact via a make or break contact with two layers of flex PCB printed circuit board with a raw exposed conductor pad on both layers that come into contact with one another upon a key press. In gaming applications gainers typically use the W A S and D keys for travel movements forward left backward right respectively Q and E keys are typically used for strafing left and right respectively and the spacebar key is used for jumping although gaming keys are not restricted to these particular keys or functions. Rather than tapping a button a few times to make a gradual turn or several rapid taps to make a sharp turn it is more natural for a user to apply more pressure on the A or D keys to pull a tighter turn and or turn with gradual or sharpness of turn desired proportionally to the amount of finger pressure applied to the respective keyboard key. Such capability is not only more intuitive but allows the user easier granular control over game play input such as gradually turning sharp turn variable speed of travel movement slow walk spring the rate of fire of a gun variable degree of the amount of strafing to the left or right but not limited to these examples. The advantageous solutions described herein enable variable capacitance measurement for implementing pressure sensitive keys and may be optionally implemented with user configurable granularity scales for these pressure sensitive keys to allow enhanced user control of how keys respond in a gaming application and or any other desired application. Further information on the use of user configuration information such as user configurable granularity scales may be found in U.S. patent application Ser. No. 12 316 703 filed Dec. 16 2008 which is incorporated herein by reference in its entirety.

There are many kinds of game genres. The features and ways to utilize variable pressure control vary from game to game or from genre to genre. For example in a first person shooter FPS game a particular variable pressure button may be used to control the speed of fire single shot multiple shots faster multiple shots machine gun rapid fire . For real time strategy games the variable finger pressure sensitivity of the key may mean something completely different. With a variety of game genres and even within a particular genre there are many game titles where the user will want to save their keyboard s pressure sensitive button definitions in a profile for the game even with the ability to categorize by game genre. It is also desirable to allow the user to configure how the pressure sensitive button should work. For example the user may want the full range of gradual variable control. In another instance the user may want this button to act like a momentary on off switch button. In still another instance the user may want the button to operate as four 4 possible positions e.g. slow walk fast walk jog sprint depending on the amount of pressure applied by the finger. This user configuration information and this user configurable granularity control in particular as described below can be communicated to and stored by the keyboard to provide the user this capability of configuring how the keyboard pressure sensitive keys will operate.

The keyboard embodiments described herein have from one to all of their keys controlled via pressure sensitive sensors such as variable conductance or variable capacitance sensors. As described in more detail below an injection molded rubber dome sheet and flex circuitry can be used in one exemplary embodiment to accommodate both pressure sensitive keys and traditional momentary on switch based keys. Using the disclosed systems and methods a typical 24 bit digital pathway can be used from the keyboard array to the keyboard s microcontroller for any momentary on keys. Typically a keyboard microcontroller has three dedicated 8 bit digital input ports to take in this data though it need not be limited to this. Current keyboards use rubber dome momentary on switches. The key cap has a rod or chimney stack on its bottom side. There is also a nipple or actuator on the bottom side of the rubber dome. As the user presses down on the key cap the chimney stack presses down on the rubber dome which in turn presses the nipple actuator down on the flex circuitry beneath it. This pressing motion brings flex circuitry from one signal layer in direct contact with flex circuitry in a second signal layer. As a result the two connections make contact signaling to the microcontroller that the key has been pressed the momentary on signal . These rubber dome momentary on switches can be used for the non pressure sensitive keys for the keyboards described herein.

In one exemplary embodiment pressure sensitive keys may be configured to use rubber dome keys with conductive half spheres or half domes located on the underside of the rubber domes. In such an embodiment the following principle may be employed as the conductive sphere is pressed harder against a printed circuit board PCB or flexible PCB underneath it the conductive sphere s surface area contact increases with pressure thus increasing the capacitance of that contact in relationship with a nearby charged trace. The capacitance can be measured and sent to a keyboard controller as alternating open short alternating off on digital signals representative of the measured capacitance value without the need for further analog to digital signal conversion. The embodiments disclosed herein therefore can use analog based variable pressure keys and incorporate them with digitally based momentary on switches of typical keyboards to make a keyboard that supports both regular make break keys and keys with variable forger pressure sensitivity and at the same time that is compatible with legacy momentary on measurement keyboard controllers such as are typically found in information handling systems such as notebook and desktop computers. This variable finger pressure sensitivity is particularly useful for gaming applications where there is a consistent need for more intuitive gaming interfaces.

For keyboards with both types of keys signal inputs from both types of keys can be provided in one embodiment to a keyboard controller via a digital input block. For example digital input can be provided directly to the keyboard controller by the typical keyboard array of momentary on switches. These are the keys that operate as either switch on or off essentially providing a digital 1 or 0 back to the microcontroller. Capacitive sensing or other key pressure sensing circuitry can also be present for providing alternating open short digital input signals for the keyboard controller that are representative of the amount of pressure applied to a given pressure sensitive key at any given time. At the same time the keyboard controller can also support any number of digitally based momentary on switch based keys.

In the practice of the disclosed systems and methods pressure sensing measurement circuitry such as capacitive sensing digital output circuitry may be for example embedded or integrated within a keyboard controller though it may also be located external to the microcontroller as well. In the latter case a drop in keyboard having both conventional momentary on and pressure sensitive keys may be provided that has digital outputs for both types of keys that are compatible with a legacy digital keyboard controller. This capability may be advantageously employed for example to enable a build to order methodology in which either type of keyboard i.e. traditional keyboard with only momentary on keys or gaming keyboard with at least some pressure sensitive keys may be selectively assembled to a common information handling system notebook chassis or common desktop keyboard chassis having a legacy keyboard controller e.g. based on details of a specific customer order.

In one embodiment for example the pressure sensitive keys may be variable capacitance pads that are coupled to provide an analog signal input to capacitive sensing digital output circuitry available from Texas Instruments of Dallas Tex. and having part number MSP430F2111. However any other type of suitable capacitive sensing digital output circuitry may be employed including for example any circuitry that uses RC discharge time to measure sensor capacitance as described in U.S. Pat. No. 3 936 674 which is incorporated herein by reference in its entirety. The capacitive sensing digital output circuitry may be further optionally provided integrally or separately with signal switching circuitry e.g. switch circuitry configured to interface with the legacy keyboard matrix array e.g. 16 columns 8 rows which require current sinking capability as well as to provide for capability of providing pressure sensitivity to all keys in a keyboard.

Examples of suitable signal switching circuitry for interfacing with a legacy keyboard controller include but are not limited to optoisolators or MOSFET switches that interface with the keyboard controller in a manner as will be described further herein. The momentary on switch based keys input when present can be sent via for example a 24 bit digital path to the digital I O of the keyboard controller e.g. legacy 8051 based microcontroller available from sources such as Intel Infineon Technologies NXP Silicon Laboratories etc. The keyboard controller can also have an optional embedded I2C master slave block used to talk to peripheral ICs integrated circuits for additional functionality. A serial EEPROM can also be optionally provided as part of the keyboard to communicate with the keyboard controller for example to provide the VID vendor identification and DID device identification information to the microcontroller via the I2C bus.

It is further noted that for an electronic lighting control embodiment where aspects of key lighting are implemented for the keyboard a combination pulse width modulator PWM and LED light emitting diode driver integrated circuit can be used such as part number MAX6964AEG available from Maxim. Such integrated circuits for example can receive commands from a host system such as a personal computer through the keyboard controller to drive RGB red green blue LEDs for keyboard lighting as instructed by the host system. The personal computer or host system for example can be configured to communicate with the keyboard controller through a USB connection and the keyboard controller can be configured to convert these commands into a serial I2C stream provided to the PWM and LED driver integrated circuit which can in turn pulse width modulate the correct amount of light dimming and color to be provided for the keyboard lighting.

As described further below a common injection molded silicon rubber sheet can be used with built in rubber domes and a common flex circuitry to support both digital momentary on switches and pressure sensitive sensors e.g. variable resistance or variable capacitance . For variable capacitance sensing as the user s finger applies pressure to the plastic keycap it can be configured to press on the depressible rubber dome which has a conductive spherical shaped actuator on the bottom side. As the key cap is pressed the conductive spherical shaped actuator comes into contact with one plate of a capacitor. An insulating layer is located above a second plate for the capacitor so that it is isolated from the first plate. Thus the conductive actuator does not contact the second plate and a capacitance develops between the two plates. As the user puts more pressure onto the keycap more surface area of the conductive material from the conductive actuator will lie over first plate thereby increasing the capacitance between the two plates. Referring to the exemplary embodiment of to measure the capacitance change plate two may be connected to ground and plate one may have a trace connected to it that is routed to an I O pin on pressure sensing digital output circuitry e.g. TI MSP430 controller . The conductive material for the capacitive actuator may either be impregnated into the rubber dome material or may be an external piece of material that is attached to the rubber dome via mechanical snap in means via adhesive or a hot fusing method. Other methods for providing a conductive and flexible actuator can also be used.

In operation of one embodiment of the keyboard the amount of finger pressure applied by a user to a given key is sensed by the pressure sensing e.g. variable capacitance sensing digital output circuitry and is digitally provided to the keyboard controller via switching circuitry e.g. optoisolator MOSFET etc. that provides alternating open short signal current pull down signals to the keyboard controller in a manner that emulates toggling of a conventional momentary off on digital key. In an optional embodiment configuration information provided by a user may be employed to adjust the operation of the pressure sensitive keys e.g. via the pressure sensing circuitry other processing device or software executing on a host system to which the keyboard is coupled. This user configuration information for example can optionally adjust the sensitivity and output levels generated by the keyboard controller based upon the pressure sensitive signals received with respect to the pressure sensitive keys as described in U.S. patent application Ser. No. 12 316 703 filed Dec. 16 2008 which is incorporated herein by reference in its entirety. The keyboard controller can then in turn provide output signals to the host system that indicate pressure amounts. The host computer can then use these keyboard output signals with respect to particular software application functions being operated by the host computer. For gaming applications such pressure sensitive functions may include the variability in the speed of travel slow walk trot run etc. the amount of turning slow fast etc. the amount of strafing for a first person shoot game the amount of braking for a vehicle race game the degree of the rate of fire the height of one s jump and or any other desired variable gaming feature.

The embodiments will now be described in more detail with respect to the drawings. describes a system including variable keys. shows an example structure for variable keys. provide examples for the operation of the pressure sensitive keys. provides a circuit diagram for detection of capacitive sensitive keys and digital alternating open short output to a keyboard controller. And is a flow diagram illustrating initialization detection of variable capacitance provided by pressure sensitive keys.

The pressure sensing digital output circuitry includes a pressure sensing block that receives an analog signal representative of the pressure applied to each of analog keys and then outputs an alternating high and low high low digital output bit stream signal having a frequency that is representative of this pressure being applied to each of analog keys to a corresponding switching element of switching circuitry e.g. optoisolator transistor such as MOSFETs etc. . Each switching element of switching circuitry responds to a digital signal corresponding to a given analog key by providing a toggled alternating open short off on digital signal to a corresponding intersection point in the 16 8 key matrix which corresponds to that analog key in a manner as described further herein. It will be understood that the particular embodiments illustrated herein are exemplary only and that the components and function of pressure sensing interface circuitry may be implemented using any one or more circuitry components suitable for receiving analog signals representative of key pressure from pressure sensitive keys and providing corresponding alternating open short digital output signals having a toggled frequency that is representative of key pressure from pressure sensitive keys that is suitable for example for digital input to a legacy keyboard controller .

The control circuitry within the keyboard controller is coupled to receive on off signals from the digital input block . The control circuitry processes this key information and is connected to an output communication interface so that this key information can be communicated to external devices such as host components of an information handling system through communication path . In addition external devices can optionally communicate control and or other configuration information to the keyboard controller though this same output communication interface through communication path . Examples of possible information handling system components may be found described in U.S. patent application Ser. No. 12 586 676 filed Sep. 25 2009 which is incorporated herein by reference in its entirety.

It is noted that the output communication interface and communication path can take a variety of forms. The communication path can be a wired communication path or a wireless communication path as desired. With respect to personal computer systems such as desktop computers and laptop computers the output communication interface will often be a Bluetooth interface if a wireless interface is desired and will often be a USB universal serial bus interface if a wired interface is desired. However it is again noted that any desired communication interface can be utilized. It is further noted that the keyboard controller and the control circuitry can be implemented as a microcontroller e.g. legacy 8051 based microcontroller or custom microcontroller that runs firmware stored on a memory device associated with the keyboard controller and or control circuitry .

It is also noted that the user configuration information can be optionally stored in random access memory RAM or other memory storage that is associated with pressure sensing circuitry either internally or externally . Thus the configurable analog key control parameters can be stored for example on a RAM device in the keyboard or on the host system e.g. on a hard drive and can provide a wide variety of configurable parameters that can be adjusted by a user through an application programming interface API to a software utility application that for example has a graphic user interface GUI to allow a user to edit the parameters through the software utility. For example the user configuration information may be stored for example in nonvolatile or volatile memory on board the keyboard system . Alternatively the user configuration information may be stored on the host system or other device that is coupled by communication path to output interface off keyboard controller. Either way single and or multiple different user configuration files and or multiple game or application configuration files may be stored allowing a user to select the applicable or desired keyboard configuration file depending on the game or application being used by the user and or depending upon the particular user using the keyboard at the time in a manner as described in U.S. patent application Ser. No. 12 316 703 filed Dec. 16 2008 which is incorporated herein by reference in its entirety.

In the layered structure a base represents the bottom of the layered structure and can be made of a material that can support the key structure such as a hard plastic material. A flexible PCB printed circuit board is then provided on top of the base . The PCB includes circuit traces or connections that provide for electrical signals to be generated and communicated when keys are depressed. For example circuit connection is used to provide digital output and circuit connection pads and are used to provide the analog output . The next layer is flexible insulator such as a flexible PCB without circuit connections. The next layer is another flexible PCB that can include circuit traces or connections that work in conjunction with the connections on PCB to provide for electrical signals to be generated and communicated when keys are depressed. For example circuit connection is used to provide the digital output . A relatively thin flexible layer can then be provided above PCB and can be made from an injection molded silicon rubber sheet. This flexible layer is configured to have a molded flexible rubber dome for each key. For example flexible dome is provided for analog key cap and flexible dome is provided for digital key cap .

For the digital key an actuator is also provided underneath the dome that causes circuit trace to be engaged with circuit trace when the digital key cap is depressed. When circuit trace touches the circuit trace a signal is now active indicating the key was pressed causing a digital output to be generated. This digital output can be configured to provide a momentary on indication of whether or not the key has been depressed. The digital key cap can be made from hard plastic.

For the analog key a conductive and flexible half dome is provided that flexes when depressed as described in more detail below to vary the capacitance associated between circuit pad and circuit pad when analog key cap is depressed. Essentially pad and pad are the two plates of a capacitor. The variable capacitance between these two plates are measured from signal trace by sending this trace to capacitance reading circuitry. As stated below pad can be coupled to ground. It is noted that the conductive and flexible half dome can be made for example from a conductive rubber material that is conductive flexible and capable of reforming its shape after being depressed and released. Prior art techniques have made this material from a carbon impregnated rubber.

As shown in more detail with respect to described below electrical pad is shaped like a donut with an insulative material in the middle. Circuit trace connects to the circuit pad through a via within the insulative material with the conductive pad being located in the middle of the insulative center of the donut area. Pad may be attached to a signal trace but the preferred method of embodiment has pad being coupled to a given charge such as being attached to ground. Due to insulator layer the conductive half dome may only make contact to circuit pad through the hole in the insulator .

As described further below as the conductive and flexible half dome makes contact with circuit pad and is deformed by pressure from the analog key cap the capacitance between pad and pad increases. As more pressure is applied to the analog key cap the half dome gradually deforms and flattens out on top of the insulator causing a larger conductive surface area to run parallel to pad . Effectively there are two parallel plates provided by pads and with a fixed thickness insulator dielectric between them. Pad has a fixed surface area as it is printed onto the PCB . However pad has a variable surface area or is a variable sized parallel plate due to the action of half dome as it is depressed. As the surface area of pad gradually increases due to action of half dome as greater force is applied to the analog key cap the capacitance between plates and gradually increases as well. This variable capacitance can be sensed measured and used as an indication of the pressure being applied to the analog key cap .

The advantage of the variable capacitance methodology over variable resistance is that the sensor is implemented on the PCB directly. For variable resistance methods a sensor material is required per key that changes impedance when touched. This adds to the keyboard s BOM build of materials cost. It also reduces a source of variability of touch performance from PCB to PCB due to the variance of the impedance of printed traces or of the tolerance to passive resistors or other resistive materials used.

In one embodiment disclosed herein pressure sensitive capacitive keys may be configured to generate a variable indication of how hard a key has been depressed. In this regard is a diagram for different depressed states for the conductive and flexible half dome structure of . In its initial state the bottom edge of the half dome structure has a bottom edge position indicated by Line . As the key is depressed the half dome structure will move through the gap in the Flex PCB layer see and down towards insulator and connection pad on PCB . Line represents the bottom edge of half dome structure when it has been depressed some distance. Line represents the bottom edge of half dome structure when it has been depressed far enough to touch connection pad through the gap in insulator . It is also noted that bottom edge will have flattened out slightly due to this contact as shown with respect to Line . Line shows that the bottom edge of half dome structure will continue to flatten as it is depressed. And Line is a further indication of this flattening of the half dome structure . As stated above as the half dome structure is moved closer to connection pad half dome structure will touch connection pad and will then flatten out causing a larger surface area for electrical plate relative to electrical plate . As the surface area of the plate increases due to increased pressure on analog keycap the capacitance between pad and pad correspondingly increases. This change in capacitance C can be used as an indicator of the pressure that has been used to depress the key associated with the half dome structure . Connection pad can be coupled to pressure sensing block of pressure sensing digital output circuitry that operates to sense and measure the electrical information provided from connection pad .

In this exemplary embodiment pressure sensing digital output circuitry employs RC capacitive measurement methodology with falling edge event driven interrupt performed on a per pin basis. Information on RC capacitive measurement may be found for example in U.S. Pat. No. 3 936 674 which is incorporated herein by reference in its entirety. Using this methodology each capacitive pad through is charged and discharged via traces one at a time and the amount of time for the discharge of each corresponding pad is measured using a timer operating at a high speed e.g. timer operating at about 16 MHz or other suitable speed . Using this methodology the higher the capacitance the longer the discharge time thus providing a higher digital count output from the timer of digital output circuitry . In this regard as the depressible half sphere on the bottom side of the keycap of each capacitive pad is depressed by applied finger pressure the amount of surface area in contact increases thus resulting in an increased capacitance on the pad. According to the capacitance relationship as a plate surface area increases its capacitance increases.

In one exemplary embodiment pressure sensing digital output circuitry may be implemented by a TI MSP430F2111 microcontroller or other suitable circuitry that employs RC discharge time to measure the variable capacitance of each analog key as follows. In this exemplary embodiment each signal lines acts as a single input output I O line between a given falling edge triggered interrupt digital port P.X of pressure sensing digital output circuitry and a corresponding given analog key . The capacitive plate of each analog key is also coupled to ground through a resistor e.g. 6 M or other resistor value selected to provide sufficiently slow RC discharge time to provide the desired measurement resolution for the given application . In this configuration each signal line is employed to charge discharge and produce an interrupt when the voltage of the capacitor of analog key crosses a low voltage threshold. For example a given port P.X of a given I O line may be set to output high to charge e.g. with 500 nA charging current the capacitive plate of a corresponding analog key to near V and a free running timer of the pressure sensing digital output circuitry read to mark the start time. Then the given port P.X is set to input with negative edge interrupt enabled and the resistor coupled to the capacitive plate of the corresponding analog key discharges the capacitive plate of the analog key to ground during which pressure sensing digital output circuitry may go into low power mode to save power. When the voltage of the capacitive plate crosses an interrupt voltage Vdue to this discharge to ground an interrupt is generated which causes the free running timer to be read again and the elapsed time for discharge of the capacitive plate of the analog key from near Vto Vis calculated. Pressure sensing digital output circuitry may then return to high power mode. The discharge timer count of the capacitive plate of each analog key is proportional to its present capacitance which depends on the amount of pressure currently applied to the key . In one exemplary implementation multiple capacitor readings of a given analog key may be averaged to filter out common mode noise e.g. by using a charge cycle followed immediately by a discharge cycle and averaging the two values.

Still referring to the exemplary embodiment of pressure sensing digital output circuitry provides a corresponding digital output for each capacitive pad and its input . Each digital output signal P. corresponds to a respective capacitive pad input P. . In this embodiment each digital output signal is produced in an intermittent alternating high low manner with a frequency that emulates the action of a user s finger toggling away at a conventional digital momentary on digital key at a variable speed that is based on the amount of pressure being applied to the corresponding pressure sensitive analog key . Thus open short mechanical user toggling control may be advantageously replaced by electrical control based on the key pressure applied by a user to provide a similar intermittent alternating high low signal output without requiring a user to toggle the keys. It will be understood that although the exemplary microcontroller of pressure sensing digital output circuitry of employs 8 digital falling edge triggered interrupt inputs Port P. and 8 digital outputs Ports P. it is possible to select a different chip s to support more pressure sensitive keys.

In the exemplary embodiment of keyboard system is implemented to be interchangeable with a legacy USB keyboard for interconnection with standard 8 bit keyboard controller via a standard 16 8 key matrix with 16 columns 8 rows and native device drivers. However it will be understood that one or more features of the disclosed systems and methods may be implemented in non legacy or customized keyboard systems and in any arrangement of one or more circuitry components as may be suitable for a given application.

In the exemplary embodiment of legacy keyboard controller has a standard keyboard matrix open short input provided for the keys on a standard keyboard that is arranged as 16 columns by 8 rows so that only 24 signals interface with the keyboard controller rather than a signal line per key which would require over signals to the keyboard controller . The keyboard controller operates by initially selecting a single row and applying a logic level 1 to it. There are 16 keys in a column with only one of those keys intersecting with the particular row that s at logic 1. To detect if a key is pressed in a row each column is sequentially grounded. If a key is pressed it shorts the column to the row thus causing the row voltage to drop or go low. When the keyboard controller detects the low voltage on the selected row the pressed key can be determined by the column row intersection that was electrically shorted. Once all columns have been queried in a single row the keyboard controller sequences to the next row and so on until all rows have been queried thus sampling the logic level for every key.

In summary though a low voltage sense is used to detect a key press in normal keyboard microcontroller operation an electrical short is required at each intersection of the keyboard key matrix to indicate the press of a key. Thus a direct alternating high low digital output signal from a microcontroller such as IT MSP430F2111 is incompatible with the inputs to such a legacy keyboard controller . However in the illustrated embodiment switching circuitry may be provided as an interface between pressure sensing digital circuitry and legacy keyboard controller for analog keys . The purpose of the switching circuitry is to convert a high low digital output stream into a stream of opens shorts. For example as shown in a separate optoisolator has been provided for each corresponding analog key switch location. Examples of such optoisolators include but are not limited to AVAGO 4N35 or ACPL 227 optocouplers available from Avago Technologies of San Jose Calif.

In the exemplary embodiment of each optoisolator provides an electrical control over the make or break short or open circuit connection at a given column row intersection location of keyboard matrix open short input for that particular key. This advantageously allows analog keys to be implemented with a conventional keyboard matrix arrangement and legacy keyboard controller along with its firmware and device driver . Further the implementation of this embodiment of switching circuitry allows any key and or any number of keys of a conventional keyboard matrix to be provided with pressure sensing capability.

In one embodiment upon host boot up a measurement of each of the analog keys may be performed sequentially scanning process as labeled in step . This scanning process may be performed multiple times e.g. 100 times in order to allow the master clock and PCB conditions to stabilize.

Though not required for some applications it may be advisable to provide additional filtering of the count measurement to remove any residual noise and further increase sensitivity of the capacitive pads as capacitive pad measurements are often noisy due to a number of factors such as temperature humidity voltage drift component tolerances and 50 60 Hz mains. In step a base capacitance is established and tracked as the base capacitance of the capacitive pad can change due to environmental conditions such as temperature humidity voltage drift and or component tolerances. Note that this is a slow type of change as changes occur in minutes not microseconds. A baseline capacitance is established as the capacitance of each pad during the open state when no finger is pressing on the key . As any of the above mentioned environmental factors changes the base capacitance for each pad is updated and stored. If a decrease in capacitance is detected the software must adjust the base capacitance rapidly since this is not a function of the sensor excitation. We can do this be re averaging with the current count result. If an increase in capacitance is detected the base capacitance may be adjusted very slowly as this may be due to a finger hovering over a key and not because of an environmental drift effect. For example the base capacitance may be adjusted by 1 with each measurement but only if no keys are pressed. Additionally an optional low pass filter e.g. implemented in firmware software or otherwise may also help to eliminate the presence of any 50 60 Hz main power noise that may coupled onto the capacitive pads. For example in one exemplary embodiment the low pass noise filter may be implemented as a software based IIR infinite impulse response filter or essentially as a DC tracking filter.

Finally in step sensing for user pressure on each of analog keys is started. The endless loop of this sensing process is described further below in relation to .

Still referring to the degree of applied pressure to a presently pressed key is next determined e.g. in a binning operation by comparing the filtered count value to a pre determined scale of counts per resolution in step based on the stored adjusted capacitance value or filtered count value of step . Then in step a low active output of pressure sensing digital output circuitry is toggled that corresponds to the identity of the presently pressed key e.g. output P. is toggled for corresponding input P. . This toggled signal mimics or emulates the action of a user repeatedly pressing a conventional digital key for a number of times that is proportional or otherwise relative to the strength of the desired input i.e. greater pressure on analog key corresponds to more rapid user repeat rate on digital key .

For example in one exemplary embodiment four levels of different toggle output resolution i.e. alternating toggle rate frequency may be pre defined for measured timer counts of a pressed key . As an example a maximum toggle rate may be defined to correspond to a maximum timer count level of 200 with four decreasingly lower toggle rate levels defined for timer counts of 180 160 140 and 120 and anything below 120 being disregarded as noise e.g. toggle rate frequency of 20 times second for timer count range of 180 200 toggle rate frequency of 16 times second for timer count range of 160 180 toggle rate frequency of 10 times second for timer count range of 140 160 toggle rate frequency of 8 times second for timer count range of 120 140 and no toggling for timer count range of less than 120. It will be understood that this particular number of timer count levels and corresponding timer count values is exemplary only and that greater or fewer numbers of timer count levels and or different timer count values may be employed in other embodiments. Following is example code for the four timer count level embodiment described above 

It will be understood that step described above is optional and only may be employed when the number of analog keys exceeds the number of output lines . Alternatively methodology may pause the round robin measurements whenever a pressed key is identified as exceeding the threshold adjusted capacitance value determine the degree of applied pressure to pressed key based on its capacitance and toggle the output signal of the pressed key . The count value of the identified pressed key may be monitored and reevaluated for as long as it remains pressed by reevaluating the pressed key s timer count by rerunning it through the binning operation to see if the pressure is changed and outputting an updated digital bit stream signal based thereon. Once it is determined that the identified key is no longer being pressed then the round robin procedure may resume to the next key and inquire of its count value for this round robin cycle. Either way the round robin cycle continues for as long as the keyboard system is powered up. After shut down the pressure sensing digital output circuitry may be reset on next power up all keys reinitialized e.g. per and the round robin key capacitance measurement routine initialized again.

It will be understood that one or more of the tasks functions or methodologies described herein may be implemented for example as firmware or other computer program of instructions embodied in a tangible computer readable medium that is executed by a CPU microcontroller or other suitable processing device.

Further modifications and alternative embodiments of the techniques described herein will be apparent to those skilled in the art in view of this description. It will be recognized therefore that the techniques described herein are not limited by these example arrangements. Accordingly this description is to be construed as illustrative only and is for the purpose of teaching those skilled in the art the manner of carrying out the techniques described herein. It is to be understood that the forms of the techniques described herein shown and described are to be taken as the presently preferred embodiments. Various changes may be made in the implementations and architectures. For example equivalent elements may be substituted for those illustrated and described herein and certain features of the techniques described herein may be utilized independently of the use of other features all as would be apparent to one skilled in the art after having the benefit of this description of the techniques.

