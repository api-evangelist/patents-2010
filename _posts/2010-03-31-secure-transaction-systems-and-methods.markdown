---

title: Secure transaction systems and methods
abstract: A user transaction request is received at a client device. A web browser plug-in communicates the user transaction request to a server that determines whether the user transaction request is a secure transaction. Transaction data is received from the server via the web browser plug-in. If the received transaction data indicates a secure transaction, the user is prompted to provide biometric data, which is received from the user. The web browser plug-in then communicates a transaction confirmation to the server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08904495&OS=08904495&RS=08904495
owner: Synaptics Incorporated
number: 08904495
owner_city: San Jose
owner_country: US
publication_date: 20100331
---
This application claims the benefit of U.S. Provisional Application No. 61 249 218 filed Oct. 6 2009 the disclosure of which is incorporated by reference herein. This application also claims the benefit of U.S. Provisional Application No. 61 292 820 filed Jan. 6 2010. This application also references the following U.S. Non Provisional Applications U.S. Non Provisional application Ser. No. 12 731 027 filed Mar. 24 2010 U.S. Non Provisional application Ser. No. 12 731 037 filed Mar. 24 2010 U.S. Non Provisional application Ser. No. 12 731 050 filed Mar. 24 2010 U.S. Non Provisional application Ser. No. 12 751 952 filed Mar. 31 2010 U.S. Non Provisional application Ser. No. 12 751 964 filed Mar. 31 2010 U.S. Non Provisional application Ser. No. 12 751 983 filed Mar. 31 2010 U.S. Non Provisional application Ser. No. 12 751 969 filed Mar. 31 2010 and U.S. Non Provisional application Ser. No. 12 793 499 filed Jun. 3 2010. All of these co pending applications are incorporated by reference herein.

Typical user authentication systems and procedures use passwords to authenticate the identity of the user. In many instances Web sites are authenticated using SSL Secure Sockets Layer or other protocols. SSL is a protocol for securely transmitting information via the Internet. When using SSL a Web site is authenticated via its certificate. The user seeking access to the Web site is then authenticated by username and password.

Although passwords are commonly used to authenticate users passwords are subject to various attacks such as phishing attacks social engineering attacks dictionary attacks and the like. Typically longer passwords with combinations of letters and numbers provide a higher level of security. However these longer passwords are more difficult for users to remember. Additionally passwords provide a single factor of authentication by requiring the user to provide something they know. This factor does not provide any physical authentication of the user s identity. Thus any person can access the user s Web based accounts and information if they gain knowledge of the user s password and username. Additionally anyone with knowledge of a user s password can initiate transactions e.g. purchase transactions and fund transfers without the user s permission.

Another potential threat that occurs when using passwords is commonly referred to as Man in the Browser attacks. These types of attacks involve malicious software applications malware running in the internet browser while the user is logging on to a web site or performing a financial transaction.

One of the implementations of this attack is to get access to user s password when the user provides their password to the internet browser. After this point malware can conduct any type of malicious action with the user s account.

Another example of a Man in the Browser attack is to modify the transaction information on the fly and dupe the user by encouraging them to confirm a transaction which they didn t intend to confirm. The malware residing in the internet browser has full access to all graphical user interface parts of the browser window text etc. and may change them whenever necessary. Therefore it s important to not trust the browser user interface when conducting important financial operations or when logging in to a web account.

Therefore it is desirable to provide a user authentication method and system that offers a more secure authentication of the user and more secure transactions than commonly used password based systems and methods.

The systems and methods described herein relate to biometric authentication of users. Biometrics biometric information and biometric data refers to measurable biological characteristics of a user such as fingerprint characteristics facial characteristics eye characteristics voice characteristics also referred to as a voiceprint and the like. As discussed herein biometric information provides an additional level of security when used in systems and procedures related to authentication of a user and the implementation of secure transactions.

Particular examples discussed herein use fingerprint biometric information to authenticate one or more users. In other embodiments any type of biometric information may be used instead of fingerprint information. Additionally a particular embodiment may utilize multiple types of biometric information e.g. fingerprints and voiceprints to authenticate a user. Certain described embodiments refer to swipe style fingerprint sensors. However alternate embodiments may include any type of fingerprint sensor such as a placement sensor. In particular embodiments the biometric sensor is physically attached or manufactured into a client device such as a computer cellular phone and so forth. In other embodiments the biometric sensor is a portable device that is temporarily coupled to the client device e.g. a pluggable USB device for enrollment authentication and or secure transaction procedures.

As used herein a web application a web based application and a web enabled application refers to a software application or software routine that is capable of communicating with one or more web servers or similar devices via the Internet or other data communication network. Additionally a plug in browser plug in or a browser extension refers to an application or extension that provides a variety of different features and functions. Particular examples of plug ins and browser plug ins discussed herein provide features and functions related to user authentication while for example accessing web sites implementing secure transactions and the like. In particular embodiments the browser plug in is installed as part of the manufacturing process of devices equipped with associated biometric devices. In other embodiments the browser plug in is downloaded e.g. via the Internet at any time after the device is manufactured. In specific implementations the browser plug in is operable with any biometric device that supports the Windows Biometric Framework or other supported architectures or systems.

As discussed above typical passwords do not provide any physical authentication of the user s identity. Thus any person can access a user s Web based accounts and related information if they gain knowledge of the user s password and username. Additionally anyone with the user s password and username can initiate a transaction such as a financial transaction without the user s permission. Using biometric information in the user authentication and or transaction process provides an increased level of security by authenticating physical characteristics of the user. Thus an imposter with the correct password but lacking the required physical characteristics will not be authenticated by the system and not permitted to initiate a transaction needing user permission.

The systems and methods described herein perform biometric user authentication in several steps. A specific discussion of these user authentication steps is provided below.

Browser extension is capable of communicating transaction details random challenges signature information and other data to biometric service . Biometric service verifies the digital signature of an agent application prior to communicating with the agent application. Biometric service may communicate transaction details and related information to agent application . During a secure transaction biometric service also verifies the text presented in a transaction window to the user until the user confirms the transaction by interacting with biometric sensor e.g. by presenting the user s fingerprint to a fingerprint sensor . Agent application is responsible for launching transaction window and displaying transaction information in the transaction window. Biometric service communicates with one or more web servers as part of the user authentication procedure and during implementation of the secure transaction. Additional details regarding the enrollment and biometric authentication of a user are discussed below.

The web browser application receives the transaction data and any additional data and communicates the received data to a biometric service block such as biometric service shown in . The biometric service then generates a window and displays transaction data in the window block . This window is for the benefit of the user to view and confirm the transaction details. The biometric service then monitors the transaction data presented in the window to ensure that the presented data is not modified block e.g. by a malicious application or a malicious user. If the biometric service detects that any of the data in the window is modified the biometric service instructs the web server to cancel the transaction block . The biometric service may verify the integrity of the data in the window at regular e.g. periodic time intervals or at random time intervals.

If the data in the window is not modified the user is then given the opportunity to review the transaction data presented in the window and either 1 confirm the transaction by providing valid biometric data or 2 deny the transaction by canceling the window or canceling the transaction block . If the user does not provide valid biometric data or the user closes the window cancels the transaction the biometric service instructs the web server to cancel the transaction block . If the user provides valid biometric data the biometric service generates a confirmation token and communicates the confirmation token to the web server block . The web server then validates the confirmation token block . If the confirmation token is determined by the web server to be invalid the web server cancels the transaction block . However if the confirmation is determined by the web server to be valid the web server processes the transaction block and notifies the biometric service when the transaction is complete block .

The web browser application creates an HTTP request associated with the secure transaction and communicates the request to an appropriate web server. The web server requests information from the user to complete the requested secure transaction. The web server then returns various information such as transaction details a shared key and a random challenge. This information returned by the web server is identified by a specific HTML tag inserted into the HTML code by the web server. Upon receiving this information from the web server the web browser displays an appropriate response. The biometric browser extension detects the HTML tag inserted by the web server and requests the generation of a display window to display the transaction details and ask the user to confirm the transaction details by providing biometric authorization. The biometric browser extension interacts with the biometric service to obtain an authentication token if the user provides valid biometric information e.g. a valid fingerprint is scanned by a fingerprint sensor .

The biometric service validates the digital signature of the biometric browser extension to be certain the biometric browser extension has not been modified or experienced any tampering. If the user provides valid biometric authorization and the biometric browser extension has not suffered any tampering the biometric service creates an HTTPS connection with the appropriate web server and communicates the authentication token to the web server. The web server then validates the authentication token and completes the transaction.

In a particular embodiment an agent application generates the display window to the user that provides transaction details and requests that the user confirm the transaction details by providing biometric authorization. This agent application is monitored by the biometric service to detect any modification of or tampering with the information displayed in the displayed window.

When a user begins using a device that has an associated biometric sensor the user enrolls with the biometric user authentication system by binding their user credentials with the user s biometric template a fingerprint template in specific implementations . The biometric template contains information related to the user s biometric characteristics also referred to as biometric information obtained from a biometric sensor that scans or reads the user s biometric characteristics such as a fingerprint. A user identification process identifies a particular user among multiple enrolled users e.g. multiple users enrolled with a particular device system or biometric sensor . A user verification process verifies that the user who provided their biometric information is who they claim to be by comparing the user s biometric information with the biometric template obtained during enrollment of the user. The enrollment identification and verification of users are discussed in greater detail herein.

During an example enrollment process that uses a fingerprint sensor as the biometric sensor a user swipes their finger across the fingerprint sensor several times to create a fingerprint template. The fingerprint template contains qualitative fingerprint information that allows the user s fingerprint to be distinguished from fingerprints associated with other users. In alternate embodiments a placement fingerprint sensor also referred to as a static fingerprint sensor is used such that a user places their finger on the fingerprint sensor rather than swiping their finger across the fingerprint sensor. After creating a fingerprint template the user provides user credentials such as a password cryptographic key random seed and the like. The systems and procedures described herein bind the user s fingerprint template with the user credentials. The fingerprint template and user credentials are then stored in a secure storage device. In one embodiment the secure storage device is contained within the fingerprint sensor hardware. In other embodiments the secure storage device is contained in a device that utilizes the fingerprint sensor.

During an example user identification process also referred to as a user verification process a user swipes their finger across a fingerprint sensor. The process then determines whether the user s fingerprint information matches a fingerprint template associated with the fingerprint sensor. If the user s fingerprint information matches a fingerprint template the user s credentials are released to the user and or a service or process requesting the user verification. Thus the user credentials are not released from the secure storage device until a matching fingerprint template is confirmed. In particular embodiments the user credentials released as a result of a match with a fingerprint template are not necessarily the same credentials provided by the user during the enrollment process. For example the user credentials released after finding a matching fingerprint template may include an OTP One Time Password token RSA signature and the like. The enrollment process can be initiated by a Web server a Web browser plug in and the like.

The described systems and methods communicate user credentials to a specific address location or other recipient identifier. Thus even if an imposter can gain access to the user credentials the system will send those user credentials to a predetermined address or location thereby preventing the imposter from attempting to have the user credentials sent to an alternate address or location. The address or location information is stored within the user credentials and is established as part of the enrollment process.

Particular embodiments of the systems and methods discussed herein use strong cryptographic algorithms implemented in hardware and or software. Example cryptographic algorithms include AES Advanced Encryption Standard 256 SHA Secure Hash Algorithm 256 and RSA 2048. Example biometric sensors are compatible with various standards such as OATH OCRA OATH Challenge Response Algorithms TOPT Time based One time Password Algorithm HOPT HMAC Based OTP Algorithm PKCS Public Key Cryptography Standards 11 RSA SecureID RSA Security based OTP and the like.

In a particular implementation each biometric sensor has a unique identifier ID that is used to strengthen the level of security provided by the system or process. This unique ID provides an additional authentication factor representing something you have . Since each biometric sensor has a unique ID each user s biometric template and user credentials can be uniquely associated with a specific biometric sensor.

Specific implementations include a biometric sensor as part of a multi component or multi element authentication system. Particular embodiments may include one or more authentication factors such as 1 something you are 2 something you have and 3 something you know.

The systems and methods described herein are useful in performing Web site authentication. In example embodiments a Web site that supports the authentication procedures discussed herein includes an HTML Hyper Text Markup Language tag that identifies a Web browser plug in also referred to as a biometric plug in that is installed on the user s computing device. This HTML tag indicates to the browser that the Web site supports biometric authentication. Other example embodiments include an extension of an existing Web browser plug in. Further implementations may utilize a browser helper object ActiveX control Browser Extension or other approaches. In particular implementations the Web browser plug in obtains the biometric sensor s unique ID and communicates that unique ID or a hash of the unique ID to a web server via HTTP or HTTPS.

When a user accesses the Web site the Web browser plug in is activated and detects that a biometric sensor is installed in the user s computing device. The Web site suggests that the user enroll with their biometric sensor to provide a more secure user authentication. If the user accepts the Web site generates a secret key and passes the secret key to the user s computing device via a secure connection between the Web site and the user s computing device. The Web browser plug in then activates the enrollment process to enroll the user. This enrollment process includes binding the Web site to the specific user. The web site then generates a secret key and passes the secret key to the user s computing device via a secure connection between the Web site and the user s computing device. In a particular implementation the enrollment process includes enrolling the user s fingerprint and generating a secure key.

If the user also wants to bind their computing device with Web site authentication the Web browser plug in sends the biometric sensor s ID to the Web site server or other device system. Multiple embodiments store information in various formats and on various devices or components within a system. Example embodiments may utilize a hash of the shared secret a hash of the biometric sensor ID and the like. At this point the user can select different factors for authentication. In a particular embodiment the Web site may require stronger authentication when an important operation is being performed on the Web site such as accessing a bank account or other sensitive data.

After a user has enrolled with a particular Web site that supports biometric authentication subsequent visits to the same Web site cause the Web browser plug in to detect that the user has already enrolled with the Web site. In this situation the Web site prompts the user to perform user authentication e.g. using the biometric device . In the case of a fingerprint sensor the user swipes their finger across the fingerprint sensor or places their finger on the fingerprint sensor. If the fingerprint information matches a fingerprint template associated with the fingerprint sensor the Web browser plug in releases user secrets from the user credentials. In particular embodiments the fingerprint sensor releases an OTP token or an RSA signature instead of plaintext credentials. After the credentials are released they are communicated to the Web site to complete the user authentication process. In specific implementations the server may generate a random challenge and communicate that challenge to the client device. The Web browser plug in or the biometric sensor uses this challenge to construct a response based on the secure key and the random challenge. The response may be a hash of the secure key a hash of the random challenge or any other calculation. The server validates the user credentials and authenticates the user if the validation is successful.

In particular implementations the user performs the enrollment process for each Web site the user accesses that supports biometric authentication. Additionally different user credentials are associated with each Web site with which the user enrolls. Thus if the user enrolls with five different Web sites that support biometric authentication the biometric sensor in the user s computing device stores five separate sets of user credentials each of which is associated with one of the five different Web sites. Additionally if different users access the same Web site separate user credentials and separate biometric templates are maintained for each user.

Particular embodiments of the Web browser plug in support WBF Windows Biometric Framework thereby supporting any biometric device that supports the WBF interface. The Web browser plug in also supports the Application Programming Interface specified by the BioAPI Consortium.

In alternate embodiments the systems and methods determine that a Web site supports biometric authentication by providing a service or process that monitors Web site data and detects certain types of transactions on secure web sites. When a secure transaction is initiated the systems and methods check the computing device accessing the Web site to determine if the computing device includes a fingerprint sensor or other biometric device. If so an enrollment and or authentication process is activated to offer an enhanced level of security to the user as described herein.

In a particular embodiment application is an Internet browser application executing on host PC and communicating with various web servers via the Internet. Application includes a browser extension or browser plug in that communicates with biometric service . In one implementation biometric service is a secure application executing in a background mode on host PC . Thus biometric service provides a communication interface to biometric sensor . The browser extension or browser plug in associated with application is capable of communicating transaction details random challenges signature information user information and other data to biometric service . Biometric service also communicates with one or more web servers as part of the user enrollment and or user authentication procedure.

System includes a browser application capable of communicating with a web server and a biometric service . Browser application includes a biometric extension that facilitates communication and handling of biometric related data. In alternate embodiments biometric extension is replaced with a browser application plug in. Web server is coupled to a secure database that stores various data such as data used during the biometric user enrollment and authentication procedures as discussed herein.

Biometric service communicates with a Windows biometric framework and a fingerprint sensor . Windows biometric framework also communicates with a fingerprint sensor that is not able to communicate directly with biometric service . Thus Windows biometric framework provides an interface between fingerprint sensor and biometric service . Fingerprint sensor is capable of communicating directly with biometric service without needing Windows biometric framework . Fingerprint sensor is coupled to a secure storage that stores user credentials an encryption key and related data.

During operation of system web server sends a web page e.g. an HTML page and a random challenge to browser application . Biometric extension communicates the random challenge to biometric service which requests a response from fingerprint sensor or requests a response from fingerprint sensor via Windows biometric framework . Fingerprint sensor sends a response to biometric service after a valid fingerprint swipe or scan . Thus if a user fails to swipe a finger or fingerprint sensor reads invalid fingerprint information no response is sent to biometric service . In alternate embodiments fingerprint sensor sends an invalid fingerprint message to biometric service if the fingerprint sensor reads invalid fingerprint information. If biometric service receives a positive response from fingerprint sensor e.g. a valid fingerprint swipe the biometric service communicates a response to the random challenge to web server using a secure communication link. Additional details regarding biometric user enrollment and authentication are provided below.

In a particular embodiment a secret key also referred to as a secure key is generated by a web server and stored by the web server. The secret key is also provided to the biometric sensor and or the system containing the biometric sensor and stored along with the biometric template associated with the user. The secret key can be a cryptographic key DES AES etc. a random seed a random number an RSA private key and so forth. In alternate embodiments the secret key is generated by a client device and communicated to the web server. The secure key may be transferred using HTTP or HTTPS and can be transferred directly to the browser application or directly to the browser application plug in or browser application extension . The biometric template is typically generated during enrollment of the user. Additionally if the biometric device has a unique ID that unique ID is sent to the web server for storage and use in future authentication procedures.

In particular embodiments binary files used in the systems and methods discussed herein are signed and authenticated prior to running the binary files. This approach blocks malicious attempts to replace or edit the binary files. Additionally applications communicating with the biometric service are validated at runtime.

Procedure receives user credentials associated with the user block . Example user credentials include a password a cryptographic key a random seed or any other similar confidential information. Next the procedure binds the user credentials with the fingerprint template block then stores the user credentials and the fingerprint template block in a secure storage device.

In a specific embodiment the procedure also binds a particular web site e.g. a web site requesting biometric enrollment and or biometric authentication of a user with the fingerprint template. Thus a particular user may perform the biometric enrollment procedure for each web site that the user is to provide future biometric authorization or biometric authentication.

If the fingerprint information read by the fingerprint sensor matches the information stored in the fingerprint template the biometric authentication system retrieves the credentials associated with the user block . The user credentials are then communicated to a requesting process or system block .

If a biometric device is installed in the system executing the web browser application the web browser application offers enhanced security to a user through the use of the biometric device block . If the user accepts the offer of enhanced security at block the user enrolls using the biometric device block . The user enrolls for example using the enrollment procedure discussed herein. If the user does not accept the offer of enhanced security at block the web browser application operates without biometric authentication block .

The invention may also involve a number of functions to be performed by a computer processor such as a microprocessor. The microprocessor may be a specialized or dedicated microprocessor that is configured to perform particular tasks according to the invention by executing machine readable software code that defines the particular tasks embodied by the invention. The microprocessor may also be configured to operate and communicate with other devices such as direct memory access modules memory storage devices Internet related hardware and other devices that relate to the transmission of data in accordance with the invention. The software code may be configured using software formats such as Java C XML Extensible Mark up Language and other languages that may be used to define functions that relate to operations of devices required to carry out the functional operations related to the invention. The code may be written in different forms and styles many of which are known to those skilled in the art. Different code formats code configurations styles and forms of software programs and other means of configuring code to define the operations of a microprocessor in accordance with the invention will not depart from the spirit and scope of the invention.

Within the different types of devices such as laptop or desktop computers hand held devices with processors or processing logic and also possibly computer servers or other devices that utilize the invention there exist different types of memory devices for storing and retrieving information while performing functions according to the invention. Cache memory devices are often included in such computers for use by the central processing unit as a convenient storage location for information that is frequently stored and retrieved. Similarly a persistent memory is also frequently used with such computers for maintaining information that is frequently retrieved by the central processing unit but that is not often altered within the persistent memory unlike the cache memory. Main memory is also usually included for storing and retrieving larger amounts of information such as data and software applications configured to perform functions according to the invention when executed by the central processing unit. These memory devices may be configured as random access memory RAM static random access memory SRAM dynamic random access memory DRAM flash memory and other memory storage devices that may be accessed by a central processing unit to store and retrieve information. During data storage and retrieval operations these memory devices are transformed to have different states such as different electrical charges different magnetic polarity and the like. Thus systems and methods configured according to the invention as described herein enable the physical transformation of these memory devices. Accordingly the invention as described herein is directed to novel and useful systems and methods that in one or more embodiments are able to transform the memory device into a different state. The invention is not limited to any particular type of memory device or any commonly used protocol for storing and retrieving information to and from these memory devices respectively.

Embodiments of the systems and methods described herein facilitate enrollment and authentication of users through a biometric device such as a fingerprint sensor. Certain embodiments described herein facilitate one or more secure transactions. Additionally some embodiments are used in conjunction with one or more conventional fingerprint sensing systems and methods. For example one embodiment is used as an improvement of existing fingerprint detection and or sensing systems.

Although the components and modules illustrated herein are shown and described in a particular arrangement the arrangement of components and modules may be altered to enroll and authenticate users in a different manner or to implement secure transactions in a different manner. In other embodiments one or more additional components or modules may be added to the described systems and one or more components or modules may be removed from the described systems. Alternate embodiments may combine two or more of the described components or modules into a single component or module.

Although specific embodiments of the invention have been described and illustrated the invention is not to be limited to the specific forms or arrangements of parts so described and illustrated. The scope of the invention is to be defined by the claims appended hereto and their equivalents.

