---

title: Synchronization of navigation and image information for handheld scanner
abstract: A computer peripheral that operates either as a computer mouse or as a scanner. The peripheral includes navigation sensors that generate information on motion of the device and an image array that captures successive image frames of an object being scanned. In a mouse mode, the peripheral periodically transfers readings from the navigation sensors to a computing device so that the computing device can track a position of the device. In a scanner mode, in addition to obtaining navigation information from the navigation sensors, the peripheral also captures image frames as it is moved across the object. Operation of the navigation sensors and image array may be synchronized such that an association between the image data and the navigation information may be generated and maintained as image frames are transferred to the computing device, even if some of the frames are dropped in transmission between the scanner-mouse and a computer.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08339467&OS=08339467&RS=08339467
owner: Dacuda AG
number: 08339467
owner_city: Zurich
owner_country: CH
publication_date: 20100325
---
This application relates generally to handheld computer related devices that can be adapted to act as image scanners and more specifically to forming composite images from image frames generated by such handheld computer related devices.

Image scanners are frequently used in business and even home settings. A scanner can acquire in digital form an image of an object. Generally the scanned object is flat such as a document or a photograph. Once scanned the image can be manipulated e.g. rotated cropped and color balanced processed e.g. copied to be pasted elsewhere and further handled such as attached to an e mail sent over a telephone line as a fax or printed as a copy.

A scanner includes an image array but the image array is generally smaller than the object to be scanned. The scanner can nonetheless acquire an image of the entire object because there is relative motion of the image array and the object during scanning. During this time of relative motion the output of the image array represents different portions of the object at different times. As the scanner moves relative to the object successive outputs of the image array are captured and then assembled into an image representing the entire item.

In some scanners such as a flatbed scanner the object to be scanned is held in a fixed position. The scanner is constructed such that the image array is mechanically constrained to move only along a predefined path relative to that fixed position. As a result information about the relative position of the object and the image array can be used to position the successive outputs of the image array within an image such that the image accurately represents the object being scanned.

Other scanners are handheld such that mechanical constraints on the movement of the image array relative to the object to be scanned may be reduced. However application of handheld scanners may still be limited by some constraints. For example some handheld scanners may be constrained to move in only one or two directions when pressed against a surface containing an object to be scanned. As in a flatbed scanner successive outputs of the image array are captured and assembled into an image. Though without mechanical constraints imposed on relative motion of the image array and the object being scanned accurately assembling successive outputs of the image array into an image is more complicated.

In some instances handheld scanners are intended to only be effective on relatively small items such as business cards so that there are a relatively small number of outputs to be assembled into the image. In other instances use of a handheld scanner is cumbersome requiring a user to move the scanner in a predetermined pattern. For example a user may be instructed to move the scanner across the object so that the output of the image array represents parallel strips of the object that can be relatively easily assembled into a composite image. In other cases the output of handheld scanner is simply accepted as imperfect appearing fuzzy or distorted as a result of the successive outputs of the image array being inaccurately assembled into an image.

Image processing techniques that can assemble successive outputs of a two dimensional image array into a composite image are known in other contexts. These techniques are referred to generally as image stitching. However such image stitching techniques have not generally been applied in connection with handheld scanners. Image stitching techniques developed for example for processing cinematographic images or digital photographs may be too slow or require too much computing power to be practically applied to developing a composite image from a handheld scanner.

The effectiveness of a system that forms a composite image based on image data obtained from a hand held device may be improved by providing image data and information related to position of the hand held device in a synchronized format.

In some embodiments there is provided a computer peripheral that comprises an image array a motion sensor a computer interface and control circuitry. The control circuitry can be adapted to read a value from the motion sensor and using the read value generate an instance of a cumulative position value trigger the image array to capture an image and transfer image data from the image array and an instance of the cumulative position value through the computer interface in a format that associates the image data with the instance of the cumulative position value the instance of the cumulative position value being associated with a time at which the image array is triggered to capture the image.

In other embodiments a method of operating a computer peripheral comprising an image array a plurality of motion sensors and a computer interface is implemented. The method comprises at each of a plurality of times generating multi dimensional position information using the plurality of motion sensors repeatedly capturing images with the image array each image being captured at a respective time and generating associated image data and transferring the image data associated with each of a plurality of captured images through the computer interface the image data for each image being transferred in a format that associates with the image data multi dimension position information generated for a respective time associated with capture of the image.

In further embodiments there is provided a method of operating a computer peripheral comprising an image array a plurality of motion sensors and a computer interface. The method comprises operating the computer peripheral during a mouse mode by repeatedly transferring a value from each of the plurality of motion sensors through the computer interface and operating the computer peripheral during a scan mode by repeatedly reading a value from each of the plurality of motion sensors and using the read value generating an instance of a respective cumulative position value of a plurality of cumulative position values triggering the image array to capture an image and transferring image data from the image array and an instance of each of the plurality of cumulative position values through the computer interface in a format that associates the image data with the instances of the plurality of cumulative position values the instances of the plurality of cumulative position values being associated with the time at which the image array is triggered to capture the image.

The inventors have recognized and appreciated that a handheld scanner can be easy to use and produce high quality images even of relatively large objects by applying an improved image stitching process. Known handheld scanners suffer from various shortcomings. Some scanners rely on constraining motion of the scanner into a predefined path as an object is scanned. However such scanners have been found to be difficult to use or to produce poor quality images when the scanner is not moved along the predetermined path. Other scanners rely on navigation sensors on the handheld scanner to determine the position of successive image frames even if the scanner is not moved along a predetermined path. However navigation sensors have been found to be not accurate enough to provide good quality images. Yet other scanners have relied on image processing to position within a composite image portions e.g. strips of images captured by the handheld scanner. However these techniques are either too slow or do not produce good quality images particularly if the scanner traces over portions of the object that have been previously scanned.

According to some embodiments a good quality composite image of scanned object can be quickly formed by determining relative position of successive image frames captured using a handheld scanning device. Relative positions or poses of the image frames in the composite image can be determined quickly enough that the composite image can be displayed to a human operator of the scanning device as the scanning device is being moved. As a result the display can be painted as the user scans the object revealing portions of the object that have already been scanned and portions that remain to be scanned. The display thus can provide important feedback to the user that may both facilitate faster scanning of an object and improve the user experience particularly when motion of the scanning device over the object is not mechanically constrained.

In some embodiments a stream of image frames taken while a scanning device is moving across an object are stitched together to form a composite image of the object. Image stitching involves multiple techniques to determine relative position of the image frames. These techniques may be applied sequentially. However according to some embodiments at least two of the frames positioning techniques are applied concurrently with a first technique serving to provide coarse positioning of image frames in the stream as they are obtained. A second technique operates on the coarsely positioned image frames to adjust the position to achieve a finer alignment.

The coarsely positioned image frames may be displayed as the coarse position of each frame is determined. Each image frame may be presented on a display device in a position proportional to its determined position within the composite image. The coarse positioning can be performed fast enough that image frames can be displayed with a small delay relative to when the image frames are captured. The composite image on the display may appear to a user of the scanner as if the object being scanned is being painted on the display as the user moves the scanner over the object.

During the scanning process as new image frames are being acquired and stitched into the composite image a fine adjustment may be made to the determined relative positions of the image frames. Though fine adjustments may be made to improve the image quality as scanning progresses the composite image based on the coarsely positioned images may be displayed for the user during scanning before the fine adjustments are made. The coarsely positioned image frames may act as an input for a more accurate image alignment technique that provides the fine adjustments.

Image frames may be stored in a way that facilitates fine adjustments and rendering a composite image based on the adjusted positions of the image frames without constraints on motion of the scanning device. Storage of the image frames with information that defines an order for those image frames also allows an accurate composite image to be presented even if portions of the object are traced over by the scanning device during the scanning process. Accordingly in some embodiments when fine adjustments are made to a subset of the image frames all or a portion of the composite image may be re rendered with the most recently acquired image frames overlying those previously acquired.

Image stitching techniques as described herein are not limited for use with small objects. They may be applied to scan objects with dimensions that are larger than a business card such as more than 4 inches per side. In some embodiments the techniques may be employed with objects such as a piece of paper that is larger than 7 inches by 10 inches or even an object that is much larger such as a poster hung on a wall. Further there is no requirement that the user move the scanning device along a predefined path. A handheld scanning device according to some embodiments may still produce an accurate image even if portions of the object being scanned are scanned over.

In some embodiments the coarse positioning technique may be based on positioning each newly acquired image frame relative to one or more previously obtained image frames in a localized region of the composite image. In an exemplary embodiment described herein coarse positioning may entail positioning each new image relative to an immediately preceding image frame. Though it should be appreciated that coarse positioning may entail positioning each new image frame relative to more than one preceding image frame that is determined to depict at least a portion of the object being scanned that is represented in the new image frame.

In some embodiments multiple coarse positioning techniques may be used together. For example coarse positioning may be based on navigation information indicating motion of the scanning device and or image matching techniques that are used to align succeeding image frames to preceding image frames. As a specific example two such coarse positioning techniques are employed. In the first navigation information indicating motion of the scanning device between the time the preceding image frame is captured and a time when a succeeding image frame is captured is used to determine an initial estimate of a position of the succeeding image frame relative to the preceding image frame. In the second image matching may be used to register successive image frames to provide a relative pose between the image frames that is more accurate than can be achieved based on navigation information alone. A pose of an image may define its location in two or more dimensions relative to a frame of reference as well as its orientation with respect to a frame of reference which may be defined by the initial position and orientation of the scanning device at the time a scan is initiated.

Though the initial estimate based on navigation information in some embodiments may provide an adequate course positioning of image frames in other embodiments a second coarse positioning technique may provide more accurate position information. In an exemplary embodiment described herein coarse positioning based on image matching techniques is performed using the coarse positions generated based on navigation information as an input. The coarse positioning based on navigation information for example may be used to bound the computations aligning successive image frames based on matching overlapping portions of the image frames.

Regardless of whether or how the navigation information is used the pose of the succeeding image frame yielding the highest degree of similarity in overlapping portions may be taken as defining the coarse position of the successive image frame. Such coarse positioning of successive image frames may generate a composite image that is accurate enough to provide useful information. Yet because processing is performed only on local image frames that partially overlap a newly acquired image frame each newly acquired image frame can be added to the composite image quickly enough to display the composite image to a user as a representation of progress of the scanning process.

One or more fine adjustment techniques also may be used. Fine adjustments may be made in parallel to the coarse positioning of successive image frames such that displayed image quality may improve as the scan progresses. Fine adjustments may be based on global positioning of image frames. Global positioning may involve determining a position of an image frame within the composite image based on positioning of image frames beyond the immediately preceding image frame. In some instances global positioning may entail processing on all or some subset of the collected image frames as a group.

In some embodiments the coarse positioning derived using local positioning techniques may be used as an initial estimate of positions in applying a global positioning technique. In some embodiments the results of local positioning of the image frames may be stored in a data structure that can be taken as representing as a network of nodes each node representing an image frame connected by edges each edge representing a relative displacement between the image frames corresponding to the nodes connected by the edge. The position of each image frame relative to some reference point can be derived based on combining relative positions of preceding image frames that trace out a path along the edges of the network from the reference point to the image frame. As successive image frames are obtained by a scanning motion that involves moving back and forth across an object in an unconstrained fashion some image frames will overlap multiple preceding image frames creating multiple paths through the network to an image frame. Because the relative displacement between each image frame is inaccurate inconsistencies between the position of each image frame when computed along different paths through the network may result.

In the network as a whole there may be multiple paths to each of multiple nodes creating multiple sources of inconsistency in position information. A metric of inconsistency across the network may be computed. Information about the image frames and their positions determined using a local positioning technique may be stored such that a correction computed based on the identified inconsistency can be applied to the determined positions of the image frames. Such a corrected composite image may be used directly and or as an input to a further fine adjustment technique.

Accordingly inconsistencies in positioning of an image frame can be identified by processing successive image frames to coarsely position each new image frame using local comparison to previously positioned image frames. When a new image frame is found to overlap a neighboring image frame representing a previously positioned image frame other than the preceding image frame the position of the new image frame can be computed in at least two ways. In a first computation the position of the new image frame can be computed relative to the preceding image frame. In a second computation the position of the new image frame can be computed by matching the new image frame to the previously positioned neighbor image frame. A difference between these two computed positions can be taken as a measure of inconsistency for intermediate image frames that fall between the neighbor image frame and the preceding image frame in the succession of image frames.

Fine positioning of the image frames may entail adjusting previously determined positions of the image frames to reduce the inconsistency. For example the intermediate image frames each can be repositioned such that the position of the new image frame when computed using the first computation representing positioning relative to the preceding image frame more nearly matches the position computed using the second computation representing positioning relative to the neighbor image frames. In some embodiments each intervening image frame may be repositioned in a way that reduces a metric of inconsistency over all of the intervening image frames.

In some embodiments the image frames are represented in a data structure defining a network capturing relative positions of each image frame relative to other image frames to which it overlaps. Because of inaccuracies in the image matching process and other elements of the system the network of relative positions will assign inconsistent positions to each of the image frames depending on the path through the network. By adjusting the overall network to reduce the overall inconsistency a more accurate composite image may be formed. In some embodiments known techniques for minimizing inconsistency in a network may be employed.

The global positioning process that includes identifying and reducing inconsistency in the network may be repeated multiple times. The process may be repeated for different portions of the network or for different network configurations as more image frames are captured and more nodes and edges are added to the network. Further the global positioning process and the coarse positioning process need not access the same data simultaneously and the processes may proceed in parallel. Both processes may be performed while image frames are being captured through scanning generating a composite image that can be displayed to a user during a scan operation with resolution that improves over time.

In some embodiments the composite image adjusted in this fashion may be taken as the final composite image. In other embodiments further fine adjustments alternatively or additionally may be made to the determined position of image frames using image matching techniques applied to multiple image frames. Regardless the composite image may then be further processed in any suitable way. The composite image for example may be displayed for a user or may be provided to one or more application programs that can manipulate display or extract information represented in the composite image.

Techniques as described herein for forming a composite image from successive image frames may be used in conjunction with any suitable scanning device that can acquire such image frames. However such techniques are well suited for use in conjunction with a scanner constructed as a peripheral attached to a personal computer. These techniques provide a desirable user experience despite constrains imposed by the environment such as a need for low cost components limited power and limited bandwidth and processing power.

As an example of a suitable scanning device image capture components may be incorporated into a computer mouse forming a scanner mouse computer peripheral. Though it should be appreciated that application of these techniques is not limited to use within a scanner mouse. The techniques may be used in any device suitably configured to capture successive image frames of an object. Examples of other suitable devices include a dedicated handheld scanner device and a cell phone or portable computer equipped with a camera.

When these techniques are applied in a scanner mouse the scanner mouse can be coupled to a computer using known techniques for connecting computer peripherals to a computer. Image processing techniques may be implemented by programming a computer to which the scanner mouse is coupled. A scanned image may be rendered to a user of the scanner mouse using a display for the computer. Though it should be appreciated that it is not a requirement that a composite image formed using techniques as described herein be displayed to a user. In some embodiments the composite image may be passed to software applications or other components within or coupled to the computer for processing.

Turning to an example is provided of a system employing techniques as described herein. System comprises a computer a scanning device is coupled to the computer and an object to be scanned. shows as an example of a scanning device scanner mouse which is here shown coupled to computer as a computer peripheral.

Components of system may be supported on any suitable surface . In this example surface is a flat horizontal surface such as a desk or a table. Such a surface is suitable for scanning objects such as pieces of paper containing text or photographs. Though it is not a requirement that all of the components of the system be supported on the same surface or even that the surface be horizontal or flat. It is also not a requirement that the object be paper.

Object may be of any suitable size type and may comprise any suitable content. For example the content of object may be of any textual image or graphical form or a combination thereof. In addition the content of object may be of any gradient. As regards a size of the scanned object it may vary from for example a business or credit card or smaller to a document of dimensions that are equal to or exceed 4 inches per side. Moreover in some embodiments object may comprise a piece of paper that is larger than 7 inches by 10 inches or a much larger object such as a poster.

Computing device may be any suitable computing device such as a personal computer. Scanner mouse may be coupled to computing device via any suitable wired or wireless connection. For example a Universal Serial Bus USB connector may be employed to couple computer mouse to computing device . Processing of images collected by scanner mouse and visualization of results of the processing may be controlled via for example one or more processors of computing device as discussed in more detail below.

In some embodiments of the invention image stitching comprising creating a composite image from a stream of image frames captured by the scanning device as an object is scanned may be performed by any suitable components of computing device . Both coarse positioning of the image frames and a subsequent finer alignment of the image frames to generate a final composite image may be performed within computing device . Though in some embodiments information on the image frames comprising positional and rotational data and image data may be pre processed in the scanning device in any suitable way. Further in some embodiments some or all of the steps of the image stitching process may be performed within the scanning device such as scanner mouse . In yet further embodiments generation of the composite image may be performed in a server or other computing device coupled to a computer over a network or otherwise geographically remote from scanner mouse . Accordingly the processing of the image frames may be apportioned in any suitable way between the scanner mouse computer peripheral and one or more computing devices.

System comprises the scanning device which is in this example incorporated into a computer mouse and is therefore referred to as scanner mouse . Object placed on supporting surface may be scanned by moving scanner mouse over object in any suitable manner. In particular in accordance with some embodiments of the invention motion of scanner mouse is not constrained within the plane defined by surface and a person moving scanner mouse may move it freely back and forth over object until the entire object is scanned.

In this example scanner mouse may comprise a button that enables a user to switch between a scanner mode and a mouse mode. In the scanner mode scanner mouse operates as a scanner while in the mouse mode the scanning device functions as a pointing device commonly known as a computer mouse. Button may be incorporated in a body of scanner mouse in any suitable manner. In this example button incorporated in the body of scanner mouse in a location that would be below a thumb of the user grasping the mouse. Because scanner mouse incorporates the functionality of a conventional computer mouse the device may comprise any other input elements such as a wheel one or more buttons or keys and others collectively indicated in as elements . Though it should be appreciated that scanner mouse may comprise any suitable elements as embodiments of the invention are not limited in this respect.

In some embodiments depressing button may place scanner mouse in a scanning mode in which it generates image data in conjunction with navigation information indicating position of the scanner mouse at times when the image data was acquired. Depressing button may also generate a signal to computer to indicate that image data representing a scan of an object is being sent. Releasing button may have the opposite result reverting scanner mouse to a mode in which it generates conventional mouse navigation data and appropriately signaling computer of the changed nature of the data generated by scanner mouse .

Though it should be appreciated that any suitable control mechanism may be used to switch between modes. Button may be omitted in some embodiments of the invention. Accordingly the switching between the scanner and mouse modes may be performed via any suitable alternative means. Thus any components suitable to receive user input for switching between the modes may be employed. For example in some embodiments the switching between the scanner and mouse modes may be performed via computing device . In such scenarios any suitable control included within a user interface of display device may be used to accept input instructing scanner mouse to switch between the mouse and scanner modes. In addition in some embodiments scanner mouse may automatically switch between the scanner and mouse modes in response to a trigger. An example of a trigger may be associated with a determination that the scanning device is placed over an object e.g. a document to be scanned. Also the scanning device may automatically switch between the modes based on certain characteristics of the scanned object.

As shown in computing device may be associated with any suitable display device . Display device may include a monitor comprising a user interface. The user interface may be for example a graphical user interface which accepts user inputs via devices such as a computer keyboard and scanner mouse used in a mode as a conventional computer peripheral. It should be appreciated that system may comprise any other suitable components which are not shown for simplicity of representation. Display device may be used to present to the user an image of object as object is being scanned. During scanning display may depict portions of object that have been traced over by movement of scanner mouse . Such a display may be rendered quickly such that the user perceives the display being painted in real time during scanning. In addition display may present a final image is formed through the scanning.

Computing device may comprise image manipulation software so that a user may make modifications to or otherwise process a displayed composite image. Such processing that may be effectuated in any fashion and via any suitable means. Accordingly the user may be enabled to control the way in which the composite image is presented on the display device. For example the user may instruct that the composite image be presented to the user in an enlarged form. Alternatively when the object being scanned is large e.g. a poster a respective composite image may be displayed at a smaller scale. Furthermore the composite image may be presented in a modified form automatically for example to suit a particular application or in response to characteristics of the scanned object.

In addition in some embodiments a suitable component of computing device may be used to adjust a size of the composite image displayed on display device . The size of the composite image may be adjusted in accordance with a way in which the user moves the scanning device over the object being scanned. Further the user may be allowed e.g. via a user interface to select any suitable format for the composite image which may be performed during the scanning process or at any other suitable time. Moreover in some embodiments the size of the composite image may be adjusted e.g. cropped skewed or scaled to provide an aspect ratio and or size suitable to a known page format such as for example ANSI A ANSI B and any other suitable formats.

In embodiments in which the scanning device can operate in a scanning mode and as a convention computer peripheral such as a mouse scanner mouse may comprise any suitable components for it to operate as a conventional computer peripheral. In addition scanner mouse has an image capture capability and may therefore output image data representing object being scanned as a sequence of successive image frames. Accordingly scanner mouse includes components for capturing image frames of an object which may include a light source an image array and suitable optical elements such as lenses and mirrors to provide optical paths between the light source and object and between object and the image array.

In addition scanner mouse may provide position information in conjunction with image data. Accordingly scanner mouse may comprise navigation sensors shown in as sensors and . Sensors and may comprise sensors as known in the art e.g. laser sensors of mouse design. Though the scanning device in accordance with some embodiments of the invention may comprise any suitable number of navigation sensors of any type.

Each of the navigation sensors and separately senses a motion of scanner mouse in x and y directions which may be taken as two orthogonal directions in the plane defined by the lower surface of scanner mouse . As a result a rotation of scanner mouse in that plane denoted as may be derived either in scanner mouse or in computing device from outputs of navigation sensors and

In some embodiments navigation sensors and may be positioned at an adjacent window . This positioning may help ensure that when the scanning device is placed on an object being scanned such as a piece of paper the navigation sensors do not protrude beyond the edges of the piece of paper. Nevertheless the distance between the navigation sensors may be set to be large enough for the navigation sensors to be able to calculate rotational displacement of the scanning device with sufficient resolution. Accordingly illustrates navigation sensors and on opposing sides of window . Though any suitable positioning of such sensors may be used.

Alternatively or additionally other types of sensors may be included in scanner mouse . As an example of another variation instead of or in addition to laser sensors used to implement navigation sensors and scanner mouse may comprise other types of sensors that can collect navigation information nonlimiting examples of which include one or more accelerometers gyroscopes and inertial measurement unit IMU devices. In addition to navigation information such sensors may provide information on the user s current activity and may signify motion of the scanner mouse that triggers operations relating to scanning. For example a rapid back and forth movement detected by a repeated alternating high acceleration detected by such sensors may be interpreted as a user input that ends the scanning process and discards an image acquired.

As an example of another variation a contact sensor that may enable a rapid and reliable detection of the scanning device being lifted may be included. An output of a sensor indicating that scanner mouse has been lifted off a page being scanned may trigger an end or restart of a scanning process. In some embodiments a contact image sensors CISs may be implemented as additional optical components a light source and an image sensor incorporated into one module. Though it should be appreciated that outputs of an image array that captures image frames of an object being scanned may similarly indicate that the scanner mouse has been lifted.

It should be appreciated that scanner mouse may further comprise other components that implement mouse and scanner functionalities of the scanning device. Thus scanner mouse may comprise a processor memory a power supply a light source various optical elements a USB interface and any other suitable components. The bottom surface of scanner mouse shown in may also comprise pads as known in the art to aid in sliding the scanner mouse.

Scanner mouse also comprises one or more image sensors which are shown by way of example only as an image array . The image array may be a two dimensional matrix of sensing elements which may be of any suitable type. Though it should be appreciated that any suitable image sensor may be utilized. Image array may be positioned in box in order to capture images of objects visible through window .

Further scanner mouse may comprise a light source which is represented here by way of example only as light array . Light array may comprise one or more arrays or Light Emitting Diodes LED or other suitable light emitting components. Additionally scanner mouse may comprise optical components which are not shown for simplicity of representation. The optical components such as lens module s may provide an optical path. Any suitable systems of mirrors prisms and other components may form the optical path to direct light from light arrays through window and to receive light from an object to be image through window and direct it to image array .

In some embodiments light array may be configured such that the light reaching window provides uniform illumination over window . Though if uniform illumination is not achieved suitable calibration techniques may be used. Also light array and image array and the optical components creating optical paths between those components and window may be arranged in such a way that the optical path for the incident light does not interfere with the optical path to the image array .

Various user controls coupled to processor may be used to receive user input for controlling operation the scanner mouse . User controls may comprise for example one or more keys a scroll wheel e.g. input elements shown in and an input element for switching between the mouse and scan modes e.g. button in .

Operation of scanner mouse may be controlled by processor . Processor may be any suitable processor including a microcontroller a Field Programmable Gate Array FPGA Application Specific Integrated Circuit ASIC or any other integrated circuit collection of integrated circuits or discrete components that can be configured to perform the functions described herein.

Processor may be configured to perform the functions described herein based on computer executable instructions stored in a memory . Memory may be part of the same component as processor or may be a separate component. Computer executable instructions in memory may be in any suitable format such as microcode or higher level instructions. In some embodiments though memory may be achieved by a circuit configuration that provides fixed inputs.

Accordingly components of scanner mouse may be coupled to processor . Thus it may be that processor may receive and respond to an input indicating that the scanner mouse should switch between the mouse mode and scan mode. Additionally processor may receive and respond to inputs from various sensors e.g. the image sensors such as image array navigation sensors and and others .

Processor may also generate control signals that turn on light array and trigger image array to capture an image frame. In some embodiments these actions may be synchronized such that light array is on while image array is capturing an image but off otherwise to conserve power.

Processor may store process and or forward to other image data. In some embodiments processor may temporarily buffer image data in memory . Accordingly memory may represent one or more types of storage media and need not be dedicated to storing computer executable instructions such that memory may alternatively or additionally store image data acquired from image array .

The image array may be controlled to acquire image frames of the scanned object at a frame rate that allows acquiring overlapping image frames even when a user moves the rapidly scanner mouse over the scanned object. In some embodiments the frame rate and an angle of view may be adjustable. These settings may together define a size of an overlapping area of two sequential image frames.

In some embodiments image array is controlled to capture an image frames at a rate of about 60 frames per second. A frame rate of 60 frames per second may be employed in an embodiment in which the optical system captures an image frame represent an area of an object that has a smallest dimension on the order of about 1.5 cm. Based on physics of human motion that suggest a human is unlikely to move scanner mouse at a rate faster than approximately 0.4 msec such parameters provide an overlap from one image frame to a next image frame of at least 50 . Such an overlap may ensure reliable registration of one image frame to a next which may be used as a form of coarse positioning of image frames. As a specific example image array and the optical components not shown may be adapted to capture image frames representing an area of object having a minimum dimension between 1 cm and 5 cm. Such a system may operate at a frame rate between about 30 frames per second and about 100 frames per second. Though any suitably sized array may be used with any suitable frame rate.

It should be appreciated that image array may be triggered to capture images in any suitable manner. Scanner mouse may comprise any suitable component or components that keep track of time and determines times when images are captured. Accordingly in the example illustrated scanner mouse may comprise control circuitry that includes clock which may be a component as is known in the art that generates signals that control the time at which one or more operations with scanner mouse are performed. In the embodiment illustrated clock is shown coupled to image array and may control image array to capture images at periodic time intervals. In some embodiments operation of other components such as navigation sensors and and processor may also be controlled by clock . Navigation sensors and may receive a signal from clock that triggers the navigation sensors to record navigation information at a periodic rate. Additionally clock may provide a signal to processor that controls processor to read navigation information from the sensors and close to a time at which image array is triggered to capture an image. Though the specific control circuitry used to time the functions performed by scanner mouse is not critical to the invention. In some embodiments for example operation of image array may be controlled by processor so that processor triggers image array to capture an image. Also it should be appreciated that though shows a separate clock timing functions may alternatively or additionally be provided by processor .

In some embodiments processor may be part of the control circuitry that synchronizes operations of the components of scanner mouse . As a specific example conventional navigation sensors include one or more registers that store values representing detected motion since the last reset of the register. Such position registers are illustrated as registers and in . Processor may generate control signals to reset position registers and associated with navigation sensors and respectively at any suitable time. In some embodiments processor may reset the registers each time an image frame is captured. In this way the values output by navigation sensors and which are derived from the position registers and may indicate movement of scanner mouse between successive image frames. In other embodiments processor may generate control signals to reset position registers and at times when respective values are read from the registers which may occur more frequently than when an image frame is read out of image array . Regardless of when registers and are read and reset processor may maintain information indicating motion of the scanner mouse relative to its position at the start of a scan regardless of the number of image frames read. This cumulative position information may be stored in memory . In the example of memory is shown to have a register holding this cumulative position information. In this example each navigation sensor is shown to have a register and cumulative position information is shown stored in a register. This representation is used for simplicity. Navigation sensors and for example may separately store navigation information associated with motion in the x direction and the y direction. Accordingly more than one register may be present.

Regardless of the memory structure used to store such navigation information when processor reads the values from registers and the values may be used to update the values in register to reflect any additional motion of the scanner mouse since the last update of the cumulative position register .

Within the scanner mouse each image frame may be associated with navigation information that may be passed to computing device for use in determining a coarse position of the image frame within a composite image to be formed. That navigation information may be in any suitable form. For example navigation information may be expressed as frame to frame changes in position of each of the navigation sensors and from which a relative pose between frames can be determined. Though it should be appreciated that relative poses could be computed in scanner mouse and provided as the navigation information. Alternatively in some embodiments cumulative position information may be provided as the navigation information. In such embodiments the computing device may compute frame to frame changes in position of the navigation sensors and based on changes in cumulative position information. From these values relative poses between frames could be computed. Such an approach may be beneficial if there is a risk of dropped frames when image frames are transmitted through computer interface . Regardless of the specific format of the navigation information information collected by processor may be provided to another device such as computer for any suitable processing. That processing may include generating a composite image displaying it on a display device. Though in some embodiments the composite image may be at least partially created within the scanning device.

Accordingly processor may communicate with other devices through an interface such as computer interface . Scanner mouse may be coupled to a computing device such as for example computing device and in the example illustrated computer interface may implement communications between scanner mouse and computing device . Processor may control selection of such information from the image and navigation sensors forming the selected information into data packets and transmission of the data packets via computer interface to computing device . Accordingly computer interface may receive the data packets comprising data such as images captured by image and navigation sensors of scanner mouse and transmit the data to computing device as the data is received. In the embodiment illustrated computer interface may represent a conventional computer interface for connecting computer peripherals to a computing device. As a specific example computer interface may be components implementing a USB interface.

Computer interface may also be used to transfer control signals from the computing device to the scanning device. For example a signal instructing a selection of the mouse mode or the scan mode may be sent from the computing device to the scanner mouse computer peripheral. Alternatively or additionally processor may send command or status information through computer interface .

Computer interface may alternatively serve as a source of power to energize components of the scanning device. As a specific example a USB connection includes leads that per the USB standard supply up to 500 microAmps of power. Though in some embodiments the scanning device may communicate wirelessly with the computing device. In such scenarios the scanning device may be powered by battery. In addition the scanning device may be powered in any suitable manner including via means combining wired and wireless functionalities.

In this example light array is connected to power source which draws power through computer interface . In some embodiments light arrays require more power than can be supplied through computer interface . Accordingly light arrays may be strobed only while an image is being captured. Strobing may reduce the average power. To provide an appropriate power when light arrays are on power source may contain an energy storage device. As a specific example power source may contain a 1000 microFarad capacitor that is charged from computer interface and discharged to supply power when light array is strobed.

The components illustrated in may be operated in a scan mode in which scanner mouse is moved over a scanned object and a stream of image frames is acquired. The image frames may be passed to a computing device for processing into a composite image. The composite image may be used by different applications. illustrates an exemplary system that may generate and use a composite image.

In this example scanner mouse may be coupled with computing device . It should be appreciated that any suitable scanning and computing devices may be used as embodiments of the invention are not limited in this respect. Moreover some embodiments of the invention may be implemented in a device incorporating functionalities of both the scanning device and the computing device as described herein.

In the example illustrated computing device may comprise framework which comprises any suitable components having computer executable instructions for implementing functions as described herein. In framework a hardware abstraction layer may operate as an interface between the physical hardware of computer and software components. In embodiments in which scanner mouse communicates over a standard computer interface HAL may be a component of a conventional operating system. Though any suitable HAL may be provided.

At a higher level framework comprises core that may perform processing of image and navigation information as described to generate a composite image. Core may comprise a preprocessor for preprocessing the image and navigation information which may be performed in any suitable manner. For example in embodiments in which each image frame is associated with navigation information representing cumulative motion of navigation sensors on scanner mouse since the initiation of a scan preprocessing may entail computing frame to frame differences in position sensors or relative pose between frames. Alternatively or additionally preprocessing may entail extracting features from image frames to support feature based image matching. Though preprocessor may preprocess image data and navigation information in any suitable way.

The preprocessed information may be the basis for processing to provide coarse and fine positioning of image frames. In the example illustrated in a component denoted by way of example only as Fast track of core may perform the coarse positioning of image frames. Core also comprises a component denoted by way of example only as Quality track which may perform the fine positioning of image frames.

In some embodiments successive image frames collected during a scan of an object are represented as a network stored as a data structure in computer memory. The data structure may be configured in any suitable way to represent each image frame as a node in network . Edges between each pair of nodes may represent relative positioning of the image frames. Initially nodes may be added to network by fast track as image frames are received from scanner mouse . The initial edges in the network may be based on relative positions which may be derived from coarse positioning information generated by fast track processing . However quality tack processing may access network and make fine adjustments to the edges in the network.

In some embodiments processing in fast tack is independent of processing in quality tack . Moreover processing in quality track can be performed without the entire network being constructed. Accordingly fast tack processing and quality tack processing may be performed in separate processes. Separate processes may be implemented using features of computer systems as are known in the art. Many conventional computer systems have operating systems that provide separate processes sometimes called threads. In embodiments in which computer contains a multi core processor each process may execute in a separate core. Though it is not a requirement that fast tack and quality tack processing be performed in separate cores or even in separate processes.

Upon completion of processing of all image frames of a scan network may contain a final composite image representing scanned object . A position can be assigned to each node in the network based on the position information defined by the edges of the network. Thus the composite image can be represented by the collection of the image frames in positions indicated in the network. The edges in the network may be directional to preserve the order in which image frames were acquired. Accordingly in embodiments in which an later image frame partially or totally overlaps an earlier image frame the portion of the composite image where there is overlap may be represented by the most recently acquired composite image. Though any suitable approach may be used to determine the content of a composite image when image frames overlap. The overlapping portions of the image frames for example could be average on a pixel by pixel basis.

Further it should be appreciated that during scan operation network contains a representation of a composite image. Though the image frames may be imprecisely positioned relative to each other creating a blurring or jagged appearance to the composite image if displayed.

To allow the composite image to be used outside of core or to allow components outside of core to control the image generation processes core may communicate with other components via a core application programming interface API .

In framework may also comprise user interface tools providing different functionalities related to processing a composite image generated by core . These user interface tools may directly interface with a user such as through a graphical user interface. Though such user interface tools may interact with applications that in turn are interacting with a user or a running in response to actions by a user.

User interface tools may be perform any suitable functions. An example of one tool may be a renderer here implemented in software. Render may access network through API and render a composite image on a user interface of any suitable display such as display . The renderer may render a completed composite image. Though in some embodiments renderer may continuously update the display as image frames are being added to network by fast track processing and image frames are adjusted in the network by quality tack processing . In this way a user operating a scanning mouse may see the progress of the scan which areas of an object have been scanned and which areas remain to be scanned.

In addition to rendering a composite image for a user user interface tools may receive user inputs that control operation of core . For example user inputs may trigger a scan end a scan reset a scan or discard a scanned image. Further in some embodiments user inputs may control the size or aspect ratio of a scanned image or otherwise input values of parameters used in operation of core .

User interface tools may be implemented in any suitable way to perform any suitable functions. In this example components implemented according to DirectX and OpenGL are shown by way of example only. User interface tools may comprise components implemented in any suitable way.

Moreover user interface elements may exchange image data and commands with applications rather than directly with a human user. A composite image of the scanned object may be utilized by any suitable application executed by computing device or any other suitable device. The applications may be developed for any suitable platforms. In the example of applications such as Win32 application Win64 application Mac OS X application and Others . . . are shown by way of example only. Though it should be appreciated that any suitable applications may utilize the composite image generated using techniques described herein as embodiments of the invention are not limited in this respect.

Framework may operate in conjunction with any suitable applications that can utilize and or further process the composite image in any suitable way. Different applications that can be stored in memory of computing device or be otherwise associated with computing device e.g. via the Internet may enable processing of the image information to extract any suitable information. Thus some of such applications may determine context and other different properties of the image information. The image information may also be analyzed to extract and process content of the image which may involve identifying whether the image comprises a business or a credit card pictures notes text geometric shapes or any other elements. Any suitable text and image recognition applications may be utilized. Further any suitable statistical information on the image content may be extracted.

In scenarios where the image information on the scanned object comprises text suitable applications may detect certain information in the text and provide the user with additional information related to the text. For example in one embodiment an application may identify certain words in the text for example those that are not included in a dictionary and obtain information relating to these words e.g. via the computing device connected to the Internet . The application can also identify the relevance of word groups sentences and paragraphs which may then by highlighted on the composite image via any suitable means. As another example a suitable application may detect literature references in the text and in response the references may also be obtained via the Internet. Thus a composite image generated by framework may be used in any suitable way and the manner in which it is used is not critical to the invention.

Turing to an example of an approach for coarse positioning of two consecutive image frames is illustrated. Coarse positioning of image frames of a scanned object may comprise aligning consecutive image frames based on matching portions of the image frames showing corresponding portions of the object being scanned. schematically illustrates such a process of aligning two image frames based on matching portions of the image frames corresponding to respective portion of the object being scanned. In this example an image frame represents a preceding image frame and image frame represents a succeeding image frame taken as a scanning device moves over the object being scanned. Though image frame may be aligned with any one or more image frames that partially overlaps with image frame based on matching content of the image frames within the overlapping areas.

During the coarse positioning an initial pose of image frame may first be estimated based on information from navigation sensors e.g. navigation sensors shown in . The initial pose estimate may be associated with some imprecision expressed as a zone of uncertainty as shown in . Though not readily illustrated in a two dimensional drawing the zone of uncertainty may represent uncertainty in both displacement and orientation.

In some scenarios the zone of uncertainty may be small enough that an initial pose estimate may provide adequate coarse positioning of image frame . However in some embodiments alternatively or additionally a second coarse positioning technique based on matching content in a portion of image frame with content in a corresponding portion of image frame may be used.

The pose of image frame that results in a suitable match of content in the overlapping areas may be taken as the position of image frame relative to image frame . The pose that provides a suitable match may be determined based on aligning features or other image content. Features such as corners lines and any other suitable features may be identified using known image processing techniques and may be selected for the matching in any suitable way.

In some embodiments the matching process may be simplified based on navigation information. It may be inferred that the pose of image frame that aligns with image frame provides a pose within area of uncertainty . To reduce processing required to achieve alignment and to thus increase the speed of the local positioning of image frames in some embodiments the navigation information may be used. If image frame in aligned with image frame using feature matching processing required to find corresponding features can be limited by applying the zone of uncertainty . For example image frame includes a feature . A corresponding feature should appear in image frame within a zone of uncertainty A around a location predicted by applying navigation information that indicates motion of scanner mouse between the times that image frame was acquired and image frame was acquired. Accordingly to find a feature in image corresponding to feature only a limited number of features need to be compared to feature .

If other matching techniques are employed navigation information may also be used in a similar way. For example overlapping regions in different poses of image frame are iteratively compared on a pixel by pixel basis the navigation information can be used to identify overlapping portions to be compared and to limit the number of poses to be tried to find a suitable match.

Regardless of the matching technique employed any suitable criteria can be used to determine a suitable match. In some embodiments a match may be identified by minimizing a metric. Though it should be appreciated that a suitable match may be determined without finding an absolute minimum. As one example a pose of image may be selected by finding a pose that minimizes a metric expressed as the sum of the difference in positions of all corresponding features. Such a minimum may be identified using an iterative technique in which poses are tried. Though in some embodiments known linear algebraic techniques may be used to compute the pose yielding the minimum.

In image frames and contain matching portions comprising equal image content which is shown by way of example only as a strawman. Once the equal image content in image frames and is identified using any suitable technique the image frames may be aligned using the equal image content. In image frame aligned with image frame is shown by way of example only as image frame A.

In embodiments of the invention scanning of an object may be performed by moving a scanner mouse computer peripheral over the object. A stream of image frames may thus be captured which are then stitched together to form a composite image representing the object. As a user is moving the scanning device over the object and new image frames in the stream are being captured their respective coarse positions may be determined. Each coarsely positioned image frame may be presented on a display device in a position proportional to its determined position within the composite image. The coarse positioning can be performed fast enough that image frames may be displayed to the user on the display device with a small delay relative to when the image frames are captured. As a result a composite image representing a progression of the scanning process of the object being scanned appears to be painted on the display device. Furthermore a fine adjustment may be made to the relative positions of the coarsely positioned image frames.

The image frames are shown in as superimposed over text document to demonstrate exemplary movements of the scanning device over the text document. It should be appreciated that each subsequent image frame may be oriented in any suitable way with respect to a preceding image frame as embodiments of the invention are not limited to any particular movement of the scanning device over an object being scanned. In the embodiment illustrated an image frame is positioned based on comparison to an immediately preceding image frame which is not a requirement of the invention. A succeeding image may be locally positioned by being aligned with respect to any other preceding frames if there is overlap.

Next as shown in a succeeding image frame may be captured that partially overlaps image frame . In some embodiments the scanning device may capture the stream of image frames at a rate that ensures that each new image frame partially overlaps at least one of the preceding image frames.

As new image frames are being captured as part of the stream of image frames a subsequent image frame that partially overlaps preceding image frame may be captured as shown in . Further a new image frame may be captured as illustrated in . Image frame partially overlaps image frame .

Because motion of scanner mouse is not constrained each new image frame may overlap an immediately preceding image frame as well as other neighbor preceding frame. As illustrated in the example of respective areas of overlap of image frame with image frames and are larger than an area where image frame overlaps with the immediately preceding image frame . However in accordance with some embodiments each new image frame is for coarse positioning in fast track processing is positioned relative to an immediately preceding image frame.

If image frame is the first image frame in the stream its position may be taken as an origin for a frame of reference in which other image frames will be positioned. If image frame is not the first image frame in the stream it may have a position determined relative to a preceding image frame that in turn may either define the origin or have a position relative to the origin through one or more intermediate image frames. Regardless of how many image frames are in the series relative image poses of the image frames may define positions for all image frames.

Regardless of the position in the stream each succeeding image frame after the first may be captured and processed as image frame . An initial pose of image frame may be determined with respect to the pose X Y of image frame . During a time between when image frame is captured and when image frame is captured the navigation sensors indicate a change in the position of the scanning device by a value of x in the x direction and by a value of y in the y direction. Also the navigation sensors indicate a rotation of the scanning device by a value of . Accordingly the initial estimate of the pose of image frame with respect to image frame may be denoted as X x Y y .

Image frames that are locally positioned with respect to preceding image frames may be stored as a network of image frames which may then be used for global positioning or other processing. The network may comprise nodes representing image frames and edges representing relative position of one node to the next.

In image frames and are successively processed. As each new image frame is acquired its initial pose estimated from navigation information may be adjusted to provide an improved estimate of relative position of the new image frame by aligning the new image frame with a preceding image frame. Thus shows that as a new image frame is captured its pose may be determined by matching image frame with a preceding image frame which is in this example is image frame . A relative pose of image frame with respect to image frame is thus determined. Similarly when the next image frame is captured its relative pose with respect to the preceding image frame may be determined in the same fashion as shown in .

As the stream of image frames is acquired a user may move the scanning device back and forth across an object to be scanned possibly tracing over regions of the object that were previously imaged. Accordingly a new image frame that overlaps multiple preceding image frames may be captured. In the illustrated example new image frame that overlaps image frames and as shown in . A respective new node may be added to the network to represent image frame as illustrated in .

In the figures dark arrows illustrate an order in which image frames are captured and the image frames may be said to be layered on top of each other as they are captured so that the most recently captured image frame is placed or layered on top of prior image frames. The dark arrows also indicate the relative positions initially used to add image frames to the network as part of fast processing.

In addition the possibility of a new image frame overlapping multiple preceding image frames provides a possibility for a more accurate positioning of image frames based on global information meaning information other than a match to an immediately preceding image.

Dashed lines shown in may be a relative position of an image frame with respect to an overlapping image frame other than an immediately preceding image frame. Thus node is shown to be connected via respective edges to nodes and which represent respective overlapping neighbor image frames. These edges may be added as part of processing in the quality track and may be used to more finely determine positions of image frames as described in greater detail below.

Though could be taken as demonstrating a sequence of image frames as they are captured they could also be taken as a demonstration of what could be displayed for a user based on the network being built as illustrated in . As each image frame is captured and locally positioned it may be presented on a display device in a position proportional to its determined position within the composite image represented by the network. For example as the scanning process of the text document begins image frame is first displayed. Next when the user moves the scanning device and image frame is captured respective larger portion of the composite image of the text document may be displayed to the user with a small delay which may not be perceived by the user as disrupting or slowing down the scanning process. Thus the composite image on the display may appear to the user as if the object being scanned is being painted on the display as the user moves the scanning device over the object.

Image stitching techniques in accordance with some embodiments of the invention may be used to generate a composite image of a scanned object of any suitable type. As shown in the above examples the object being scanned may be a text document an image a graph or any combination thereof. Further content the object may be in represented in grayscale or it may comprise various colors. Image frames representing text such as is illustrated in may contain multiple edges or other features that may be used in aligning image frames. For example such features as lines and corners may be used if the scanned object includes text and or image s . Though techniques as described herein are not limited to such embodiments.

For example image frames may be aligned using area based matching. As shown in image frames illustrated in the content of an object being scanned e.g. a photo rather than text may be an image having content of different color gradient across the image. Hence the area based matching may be suitable for aligning image frames of such object. Also illustrate that motion of a scanning device between successive image frames may involve rotation in addition to displacement in an x y plane. Rotation may be reflected in the angular portion of the relative pose between frames.

Determining a pose of an image frame based on adding relative poses along a path through the network also has the effect of accumulating errors in determining relative pose of each image frame area also accumulated. Such errors can arise for example because of noise in the image acquisition process that causes features or characteristics in one image frame to appear differently in a subsequent image frame. Alternatively features in consecutive image frames with similar appearances that actually correspond to different portions of an object being scanned may be incorrectly deemed to correspond. Thus for any number of reasons there may be errors in the relative poses. For image frames along a single swipe though these errors in relative pose may be small enough so as not to be noticeable.

However as a user swipes a scanning device back and forth across an object motion of the scanning device in direction will generate image frames acquired at a later time adjacent image frames acquired at an earlier time. In particular as the path through the network proceeds beyond node along segment eventually a node on the path will have a position near node . When this occurs the accumulated errors in relative positions along the path including segment may be substantial enough to create a noticeable effect in a composite image including image frames associated with nodes and if both nodes are positioned on based on accumulated relative poses in paths from node . Positioning of image frames in the composite image for example may create a jagged or blurred appearance in the composite image.

To provide an image of suitable quality quality track processing may be performed on the network. This processing may adjust the relative pose information along the edges of the network to avoid the effects of accumulated errors in relative pose. Accordingly during the scanning process in accordance with come embodiments of the invention as new image frames are being captured and stitched into the composite image a fine adjustment may be made to the determined relative positions of image frames already in the network. Fine adjustments may be made in parallel to the coarse positioning of successive image frames such that displayed image quality may improve as the scan progresses. Fine adjustments may be based on global positioning of image frames which may involve determining a position of an image frame within the composite image based on positioning of image frames other than the immediately preceding image frame. illustrate coarse positioning and find positioning respectively according to some embodiments.

Process may start an any suitable time. For example the process may start when a scanning device instructed to begin scanning of an object captures a first image frame. For example in embodiments where the scanning device comprises a scanner mouse peripheral coupled to a computing device e.g. scanner mouse the scanner mouse may receive a signal to switch to a scan mode. The signal may be received via any suitable input element associated with the scanner mouse e.g. a button such as button . Alternatively the signal may be received via the computing device e.g. via a control on a user interface . Moreover in embodiments where the scanning device comprises other device such as a cell phone or a PDA the signal to initiate scanning may be provided via any other suitable means. When the scanning is initiated a first image frame in the stream may be captured and an initial estimate of its pose may be estimated based on a position of the scanning device.

Regardless of how process is initiated the process may be performed during scanning of an object using the scanning device. Thus process comprises processing steps that may be applied as each new frame is being captured as part of the stream of image frames.

At block a new current image frame in the stream may be positioned by estimating its relative pose based on navigation information obtained from sensors tracking position and orientation of the scanning device as the device is moved over the object being scanned. The sensor may comprise for example navigation sensors e.g. navigation sensors and . For each image frame after the first the current image frame may be regarding as succeeding another image frame in the series and its relative pose may be determined relative to this preceding image frame. The navigation information indicating motion of the scanning device between the time the preceding image frame is captured and a time when a succeeding image frame is captured is used to determine an initial estimate of a relative pose of the succeeding image frame relative to the preceding frame.

At block the current image frame may be matched to a preceding image frame to provide an adjusted relative pose that is more accurate than the initial estimate of the relative pose. The matching of the frames may be performed based on one or more features in the image frames. The relative pose of the succeeding image frame may be determined by matching at least a portion of the succeeding image frame to a portion of the preceding image frame. The relative pose of the succeeding frame for such a match may be taken as the relative pose between the preceding and succeeding image frames.

Matching portions of the image frames may be done by feature matching and selection a relative pose to minimize an error in the distance between corresponding features in the image frames. The features may be selected in any suitable way but in some embodiments features may be selected adaptively as discussed in more detail below in connection with . An area based matching may be employed additionally or alternatively and the selection of whether a feature based or area based matching is used may be made dynamically based on the content of the image frames.

The image frames may be represented as a network capturing a relative pose of each image frame relative to each of one or more other image frames with which it overlaps. Accordingly when the current image frame is captured and locally positioned with respect to a previously positioned image frame a respective node representing the current image frame may be added to the network of image frames as shown at block . The network comprises nodes connected via edges with a node representing an image frame and an edge between two nodes representing that respective image frames have been matched and a relative pose between the respective image frames has been determined. Though in the embodiment described herein local positioning comprises positioning relative to an immediately preceding image frame and only one edge is added during local positioning for each new image frame.

As the scanning progresses the respective portions of the object being scanned represented by the processed image frames may be displayed to a user of the scanning device using any suitable display device based on the coarse positioning of the image frames. Hence as the succeeding image frame is captured a composite image may be updated to present the portion of the object scanned thus far which creates the appearance for the user that the user is painting the display by moving the scanning device across an object. Accordingly at block the composite image may be updated and rendered to the user of the scanning device on the display device to display a further portion of the object corresponding to the current image frame. Because the user may thus observe the progress of the scanning such visualization improves the user experience and allows for prompt user feedback.

At block it may be determined whether more images frames will be captured and locally aligned via process . Such determination may be performed in any suitable manner. Though in some embodiments user input will be provided to end the scanning process which will signal that no further image frames will be processed. The scan process may end for example if a user depresses or releases a control such as button . In other embodiments the scanning process may end if the user picks up the scanning device so that it is no longer in contact with the object being scanned. Such a motion may be detected by an accelerometer in the scanning device a contact sensor or by detecting a change in light on a sensor on the surface of the scanning device adjacent the object being scanned.

During local positioning of image frames as each successive image frame is matched with a preceding image frame and its relative pose with respect to one or more overlapping prior image frames i.e. either an immediately preceding frame or other prior image frames is determined a positioning error in the relative positions of successively captured image frames may be accumulated. The error may be associated with inaccuracies in the image matching process and other elements of the scanning system e.g. sensors collecting navigation information . Because of the positioning error the composite image may comprise distortions.

Accordingly in some embodiments of the invention to create an improved final composite image a finer alignment of a relative position of each locally positioned image frame may be performed. The finer alignment which may also be referred to as a global positioning of image frames may involve adjusting relative positions of the image frames to decrease the positioning error. Fine alignment may be considered to be performed independently of and in parallel with the coarse positioning of successive image frames such that displayed image quality may improve as the scan progresses.

Accordingly in process starts at block where an image frame is selected from the network. The selected image frame may be the latest image frame captured as a part of a stream of image frames and locally positioned within the network of image frames.

At block neighboring image frames of the selected image frame may be identified in the network. Neighboring image frames may be identified as those overlapping with the selected image other than an immediately preceding image frame. As described above the network contains edges defining relative poses between image frames which may be combined into a pose for each image frame with respect to an origin. This pose information may be used to identify image frames representing overlapping portions of the object being scanned allowing neighboring image frames to be identified. The identified image frames will in most instances only partially overlap the selected image frame. Though in some embodiments the neighboring image frames identified at block will overlap with the selected image frame by at least some threshold amount that will permit a reliable determination of relative pose between the image frame selected at block and the neighbors identified at block . This overlap for example may be at least 30 overlap in some embodiments though any suitable threshold may be used. If not neighbors are identified the process may loop back to block until another image frame is available for which there are neighboring images.

Next the identified neighboring images may be matched with the selected image as shown in block . As a result of the matching relative poses of the selected image frame with respect to the neighboring image frames may be computed. Thus new edges may be added to the network to represent the computed relative poses.

In some embodiments the selected image may be matched with each neighboring image frame pair wise. Though in other embodiments a match may entail concurrently finding relative positions of the selected image frame and all neighbors. Such a match may be performed using any suitable matching technique including feature matching or area matching techniques as described above for pair wise matching of image frames. However rather than determining the relative position of two image frames that meets some criteria matching more than two image frames may entail determining relative positions of all the image frames being matched that meets some criteria. As an example the relative positions of the selected image frame and its neighbors may be determined by solving a linear algebraic equation that minimizes a measure of squared error between corresponding features in the image frames. Such a solution has more degrees of freedom than a solution used to determine relative poses pair wise because the relative pose of each additional image frame introduces more degrees of freedom. However the same computational techniques including solutions involving iterative attempts to find the best match may be employed.

Such matching may be performed using any suitable techniques including those described throughout this application. For example processes described in connection with may be utilized. Regardless of how the matching is performed once matching portions are identified the relative poses that yield those matches may be identified as the relative poses of the selected image with respect to the neighboring images.

Regardless of how the relative poses are determined process may continue to block where the relative poses calculated at block may be inserted in the network. At this point no new nodes are being added to the network and the process at block involves inserting edges to the network with the added edges representing relative poses of the selected image frame with respect to neighboring image frames previously in the network.

The network may then be adjusted as in process . In this example node may represent the selected image frame and relative pose for that image frame may be computed by matching the new image frame to preceding neighbor image frames other than the immediately preceding image frame with which the selected image frame overlaps. In this example image frames represented by a group of nodes containing nodes and may be taken as the neighboring image frames.

The computed relative poses for the selected image frame and its neighbors may be added to the network in a form of edges. Thus illustrates edges shown in dashed line representing the relative poses between node and neighbors and respectively.

Depending on the technique for matching a selected image frame with its neighbors node representing the immediately preceding image frame in the sequence may be included in the group of nodes representing neighbors. If node is regarded as representing a neighbor an existing edge between nodes and may be replaced with an edge computed during matching of a selected image frame to its neighbors. As a specific example in embodiments in which matching a selected image frame to its neighbors involves concurrently matching multiple image frames re computing a relative pose between a selected image frame and an immediately preceding frame may produce more consistent relative pose information.

Similar processing may continue for each new image frame that overlaps with more than one preceding image frame as shown in .

The relative poses calculated by matching selected image frames to groups of neighboring image frames may create inconsistencies in the network because the added edges create multiple paths through the network to a node. The inconsistency results because a different pose may be computed for an image frame by accumulating the relative poses along the different paths to the node. Processing in quality track may entail reducing this inconsistency.

The inconsistency in the network is illustrated for example in connection with . illustrate that the network built as shown in connection with has been expanded as a user moves a scanning device back and forth across an object. In a sense a sequence of image frames is closed into a loop which is shown by way of example only as any suitable configuration sequence of image frames may be substituted.

Because of inaccuracies in the image matching process and other elements of the system the network of relative positions will assign inconsistent positions to each of the image frames depending on the path through the network. shows a path through the network representing the edges in the order in which nodes were added to the network. The edges along path may be the edges added to the network as part of fast track processing . Path represents a path that includes an edge between nodes and added as part of processing at block . As depicted graphically in the computed pose at node may be different depending on whether the computation is based on relative poses along path or path .

This difference represents an inconsistency in the network. Further inconsistencies may exist if there are more than two paths two a node. Additionally similar inconsistencies may exist for other nodes in the network. These inconsistencies may be combined into an overall metric on inconsistency such as for example the sum of all inconsistencies or the sum of the square of all the inconsistencies. Though linear algebraic techniques are known for reducing the inconsistency in network and any suitable technique including known techniques for network processing may be employed.

Regardless of what technique is used by adjusting the overall network to reduce the overall metric of inconsistency a more accurate composite image may be formed. Fine positioning of the image frames may comprise adjusting previously determined positions of the image frames to reduce the inconsistency. In some embodiments each intervening image frame may be repositioned in a way that reduces a metric of inconsistency over all of the intervening image frames as illustrated schematically in .

Returning to inconsistency in the network may be determined at block by computing differences in poses for each of one or more nodes computed along different paths through the network to the node. These paths may be along edges initially added as part of fast track processing or as added or adjusted during quality track processing. These inconsistencies may be combined into a metric of inconsistency across the network as a whole. The metric may be computed as a sum of squares of individual inconsistencies or using known network processing techniques or in any other suitable way.

Regardless of how the metric of inconsistency is computed at decision block it may be determined whether the inconsistency is equal to or above a threshold. For example the threshold may depend on a desired quality and or speed of acquisition of the composite image. As a specific example it may be desired that the processing as described herein may result in an image that can be displayed with good quality at a resolution of 300 dpi a commonly used quality for printers. Such a resolution may be translated into an acceptable inconsistency such as 0.06 mm or less. Accordingly a threshold may be set such that an adjustment may be performed if an inconsistency for any image frame is exceeds this amount. Though a threshold meeting quality and speed criteria may be determined in any other suitable way including empirically.

If at block it is determined that the inconsistency is equal to or above the threshold the network may be improved by decreasing the inconsistency. Accordingly if at block the metric of inconsistency is equal to or above a threshold process may branch to block where the poses of the images in the network may be updated. In some embodiments adjustment of relative poses of nodes of the paths through the network may be distributed so that the difference e.g. a mean error between the recomputed relative poses and the respective relative poses found in the network before the relative poses are recomputed is minimized across the nodes. The difference is thus used to adjust positions of intermediate image frames that fall between the neighbor image frame and the preceding image frame of the selected image in the succession of image frames. Though any suitable technique may be used to reduce inconsistency including solving using linear algebraic techniques a multivariate set of equations with the equations representing expressions of variables representing poses associated with nodes along paths that yielded inconsistencies. Solution of such a set of equations may reflect values of the variables i.e. poses of image frames that reduces or minimizes inconsistency. Though it should be appreciated that network processing techniques are known and can be used.

Once the network is updated at block the process may proceed to block . At block a composite image being rendered may be updated. The entire composite image may be re rendered based on the updated network. Though in some embodiments only the portions of the network impacted by edges that were adjusted may be rendered. Such portions may be identified based on nodes joined by networks that were adjusted or downstream nodes that couple to those nodes such that the pose of the downstream node is directly or indirectly computed relative to a node having a pose that is changed. The process may then end.

Referring back to decision block if it is determined that the inconsistency is less than the threshold process may branch to decision block where it may be determined whether a stable subnet of image frames is identified among the image frames forming the composite image. The subnet may be referred to as stable when for a subnet of sufficient size the inconsistency is relatively small. A value which is considered small and a subnet of sufficient size may be determined in any suitable manner including through empirical selection to yield adequate quality and speed of processing. In addition known techniques for processing networks may be used to identify a stable subnet.

Subsequently if it is determined at block that the stable subset is present within the network process may freeze such subnet at block . The freezing comprises identifying poses of image frames represented by the nodes of the stable subnet as final. These poses are not adjusted further as the scanning progresses and the composite image is updated. Thus the image frames associated with the stable subnet may be treated as one larger image frame. Other image frames may be matched to this larger image frame though in quality track processing the positions of the image frames within the subnet may not be adjusted and paths through that subnet may not be regarded in measuring inconsistency.

Process may then end. If it is determined at block that the stable subset is not present within the network process may likewise end. Though it should be appreciated that process represents one iteration of a process that may be repeated iteratively as a nodes are added to a network. Accordingly upon ending process may be repeated using a different selected image frame and the process may be repeated until the entire network is deemed to be stable or all captured images have been selected. Though in some embodiments process may be repeated until any suitable criteria is met.

Various approaches for coarse alignment of image frames and fine adjustment may be used. illustrates in more detail a process of such coarse alignment of image frames that may be performed by a component of a computing device such as computing device .

Process may start at any suitable time. For example process may be initiated when a scanning device such as a scanner mouse described in accordance with some embodiments of the invention is employed to scan an object. As indicated in by block process may be performed for each new image frame as it is captured as part of a stream of image frames collectively used to obtain a composite image of the object being scanned.

As a first step of process a new current image frame also referred to herein as a succeeding image frame may be captured at block . The image frame may be captured via any suitable image sensor s such as an image array e.g. image array shown in . The first image frame may be regarded as establishing a frame of reference. For each image frame after the first navigation information indicating motion of the scanning device between the time a preceding image frame is captured and a time when each succeeding image frame is captured may be captured at block . Though it should be appreciated that capturing the image frame and the navigation information may be performed in any suitable order. In some embodiments a frame rate and a rate at which the navigation information is acquired may be synchronized such that navigation information is provided with the image frame. Though the specific technique used to associate navigation information with succeeding image frames is not a limitation on the invention.

Next at block data comprising the image frame and the navigation information may be sent to a suitable location from which they may be accessed by comprising component s for collectively processing the data. In embodiments where the scanning device comprises a scanner mouse coupled to a computing device the data may be processed in the computing device via one or more processors. In embodiments implemented using an exemplary inventive framework described in connection with the data may be processed in the core of the framework e.g. core of framework . Nevertheless in some embodiments component s adapted to process the image frame and the navigation information may be located within the scanning device. Alternatively or additionally the processing of the image frame and the navigation information may be apportioned in any suitable manner along the scanning device and the computing device.

After the image frame and the navigation information are sent to the components adapted to process the data as a first step features that may be useful for aligning the current image frame with a preceding image frame may be extracted at block . The features may be extracted using any suitable feature extraction technique. Furthermore the featured may be of any suitable type such as lines corners etc. Also it should be appreciated that embodiments of the invention are not limited to matching of image frames based on features because area based matching may additionally or alternatively be used.

Next at block an initial estimate of a pose of the new image frame may be determined based on the navigation information. The initial estimate of the pose is determined with respect to a pose of the preceding image frame as shown for example in . The initial estimate may be then adjusted locally by matching locally the current image frame with one or more of the previous overlapping image frames e.g. image frames captured prior to the current image frame . Thus at block process searches for a match of the current new image frame to a preceding image frame by attempting to find a relative pose of the current image frame that results in alignment of the current image frame with the preceding image frame based on a criteria defining a most appropriate match. An exemplary matching process is illustrated below in connection with .

The matching may utilize features extracted at block . Though adaptive feature selection may be performed as shown in more detail in connection with

As a result of processing at block a relative pose of the current image frame that achieves match with the preceding image frames is determined. Thus the initial estimate of the relative pose of the current image frame based on navigation information may be adjusted based on the local image frame matching.

After the current image frame is matched with the preceding image frame the image frame may be added to the network based on the match at block . Hence a respective node representing the image frame is added to the network. The node may be connected to the preceding node in the network via an edge representing the relative pose of the node with respect to the preceding node.

In embodiments of the invention the coarse alignment of image frames by matching each incoming frame locally with a preceding image frame allows quickly stitching the image frames together. Thus as an image frame is captured and positioned the frame may be added to the composite image displayed on a suitable display device. The composite image may thus be rendered to the user on a user interface with a small delay so that the image appears to be painted as the scanning progresses. Thus at block the composite image may be rendered on the display device based on the network of the image frames. Because the user may thus observe the progress of the scanning such visualization improves the user experience and allows for prompt user feedback.

At block process may then determine whether more image frames may be captured. This may depend on whether the scanning of the object is still in progress. If this is the case process may return to block to perform a processing of a new image frame as described above. Alternatively if it is determined at block that no further image frames are captured process may end. However it should be appreciated that illustrates only the coarse alignment of each new image frame and that the new image frame as all as other frames in the network may then be globally aligned for finer adjustment of the image frames within the composite image.

Process may end in any suitable manner. For example in embodiments where the scanning device comprises a scanner mouse the device may be switched back to the mouse mode. Furthermore the scanning device may be lifted above the surface being scanned. Also the scanning of the object may be complete meaning that no further improvements to the composite image are possible.

Further an overview of a process that represents processing at block in in accordance with some embodiments of the invention is provided with reference to . Process may start any at suitable time when an image frame is matched with a previous image frame. The previous frame may be for example an immediately preceding image frame in the stream of image frame as used to position a succeeding image frame in the coarse alignment of image frames. Though the process of may be used for determining relative pose of any two image frames. Accordingly the preceding image frame may be a neighbor preceding image frame other than the immediately preceding image frame for some embodiments of the process of .

At block equal content may be found between the current image frame and the previous image frames which may be performed using any suitable technique. The equal content may comprise any suitable features and or portions of the image frames. In some embodiments identification of equal content may be guided by navigation information providing an initial estimate of alignment between image frames. At this step a metric of the match between overlapping portions of image frames may be computed.

Process may then continue to block where the relative pose of the current image frame relative to the previous image frame may be adjusted. As part of this adjustment a metric indicating the degree of match may be computed.

At decision block it may be determined whether a further improvement to the adjusted relative pose is possible. Such a condition may be detected for example if adjustment of the relative pose improved the metric of match between the image frames. Further improvement may also be possible if adjustment in the relative pose in all possible dimensions have not yet been tried. Conversely it may be determined that no further improvement is possible if adjustments in all possible dimensions have been tried and none resulted in improvement.

If the improvement is possible process may branch back to block where other portions of the image frames representing equal content e.g. feature s and or area s may be identified for the matching. Thereafter processing may proceed to block where further adjustments to the relative pose may be tried.

If it is determined at decision block that no further appreciable improvement is possible the adjusted pose may be identified as the best pose of all of the determined poses. Any suitable criteria may be used for characterizing a pose as the best. For example in some embodiments the best pose may comprise a pose to which only suitably small adjustments are possible which do not warrant for further processing. This pose may thus be returned as an output of process at block .

In a process of matching of overlapping image frames may start at any suitable time. In some embodiments process may begin when features are extracted from the overlapping image frames being matched. The features may be any suitable features examples of which comprise corners lines and any other elements. Each feature is associated with a location within the image. In this example process of matching two image frames referred to as image and image respectively is illustrated. Specifically process is used to compute a pose of image with respect to image .

Process begins after features have been extracted from the images to be matched. Such feature extraction may be performed as part of preprocessing of images or as part of fast track processing before process is executed or at any other suitable time. At block it may be determined whether there are more than a certain threshold number of features in both of images and . In this example the threshold number of features is denoted as n. The ndefines a minimum number of features that is sufficient to perform the alignment based on feature matching. Any suitable value may be used for nand such a value may be determined in any suitable way including empirically.

If it is determined at block that the number of features exceeds the threshold n process may branch to block where corresponding features from images and are identified. In particular at block for each feature in image a corresponding feature in image may be identified. Each pair of such respective features found in both images and may be referred to as an association.

Next at block it may be determined whether a number of identified associations are above a threshold denoted as nin this example. The threshold nmay denote a minimum number of associations that can be used to determine a relative pose between the two images. In one embodiment nmay have a value of 2 meaning that at least two features equal between images and need to be identified. Though embodiments of the invention are not limited in this respect and any suitable threshold may be substituted.

If it is determined at block that the number of associations exceeds the threshold n process may branch to block where a pose of image with respect to image may be calculated using the identified associations.

In practice a pose that exactly aligns all of the associations is not possible. For example locations of features within the images may be determined with some imprecision because the image may have some distortions e.g. due to optics distortion in an image array . Moreover in some scenarios the associations may be identified incorrectly e.g. when image frames comprise features that are not straightforward to extract . Accordingly because these errors exact matching may not be possible. Rather a suitably close approximation may be determined. In the example of at block the pose that minimizes the quadratic error between the associations is calculated as the approximation. It should be appreciated however that any suitable techniques may be applied.

Next at block the calculated relative pose of image with respect to image may be returned to be used in any suitable processing. Thus the pose may be used in local positioning of image frames. For example a node representing image frame and an edge representing the calculated pose may be added to a network of image frames as described above. Process may then end.

As shown in if it is determined at block that the number of associations does not exceeds the threshold n which may indicate that a number of corresponding features sufficient for matching has not been identified process may branch to block where the initial pose estimate for image is selected as a pose to be returned. Accordingly process continues to block to return the initial pose estimate based on navigation information as the output of the matching.

Referring back to block if it is determined at this block that the number of features extracted in both images to be matched does not exceed the threshold n process may branch to block where a pose where an area based matching process may begin. Various relative poses are tested to determine whether a pose leading to a suitable match can be identified. The poses tried may be iteratively guessed via any suitable technique. The technique may involve guessing a pose within a space of possible poses and in some embodiments may incorporate some aspect of randomness.

Though in some embodiments guessing of poses may be based on a priori information such as the navigation information and a search pattern in which the pose guessed at each iteration is guessed based on whether the pose guessed in a prior iteration increased or decreased a degree of match relative to a prior pose guessed.

As shown in a process of guessing the pose is iterative. Accordingly a suitable iterative technique may be applied to calculate a sequence of guessed poses to select the most suitable. Regardless after the pose is guessed at block process may continue to block where an error representing differences on a pixel by pixel basis between overlapping portions of images and may be calculated based on the guessed pose of image . The error may provide a measure of how well the two images match if they are aligned when the guessed pose is used. For example a mean quadratic error between corresponding pixels in images and may be calculated.

The result of the error calculation may be then processed at block where the error may be compared to a threshold to determine whether this error is acceptable to consider a match between the two images as a correct match. In the example illustrated at block the error is evaluated by determining whether it is below threshold t. The threshold may be set in any suitable way and to any suitable value.

Consequently if it is determined at block that the error is below the threshold t the guessed pose may be selected to be returned as the output of process at block . The selected guessed pose may then be returned at block upon which process may end.

Conversely if it is determined at block that the error is not below a threshold the process may reach block . If the number of iterations has not exceeded a limit expressed as i the process may loop back to block where another pose is guessed. Processing may proceed iteratively in this fashion until a suitable match is found at block or the number of iterations i is exceeded. If the number of iterations is exceeded the process proceeds to block where the initial pose based on navigation information may be returned.

The process of stitching of image frames according to some embodiments of the invention comprises first coarsely positioning the image frames to present a composite image to a user with a small delay which may be described as a real time display. The coarse positioning of the image frames comprises positioning the image frames based on the local matching which may position the frames with some inconsistencies. To reduce the inconsistencies the image stitching involves a process of finer positioning of the coarsely positioned image frames.

Advantageously the matching of image frames as described in connection with is performed so as to allow presenting the composite image to the user quickly enough to appear to be in real time to the user meaning that the delay between moving the scanning device over a portion of an object and the system presenting an image of that portion is so small that the user perceives motion of the scanning device to be controlling the display. Multiple criteria may be used to end the process of matching and to thus provide as a result of the matching a calculated result pose of a current image frame denoted as image in this example. These criteria may be reflected in the parameters n n t and i which result in an alignment being computed based on feature matching if sufficient features can be determined to align. Area matching may be used if in adequate features are not identified. Regardless of which approach is used if the result is not adequate or cannot be determined quickly enough navigation information may be used as an initial pose recognizing that adjustments may subsequently be made as part of global alignment.

Both coarse and fine alignment of image frames in accordance with some embodiments of the invention employ matching of image frames. To provide fast but accurate processing of image frames in accordance with some embodiments of the invention which allows the fast rendering and update of a composite image to the user as an object is being scanned distinctive features may be selected for matching of the image frames with sufficient accuracy. The matching may be based on any suitable features. In some embodiments of the invention adaptive feature matching may be employed.

The adaptive feature matching is premised on an assumption that suitable features in an image may be represented as those portions of an image having a characteristic that is above a threshold. For example if a feature to be identified is a corner intensity gradients in a subset of pixels may be computed. If the gradients in each of two directions exceed some threshold the subset of pixels may be regarded as a corner. Lines may be identified by a gradient in a subset of pixels exceeding a threshold. Though it should be appreciated that any suitable characteristics can be used to identify any suitable type of feature.

Regardless of the feature and the characteristic more pronounced features may allow for faster and more accurate matching of images. Accordingly in some embodiments features are selected adaptively based on image content to ensure that a sufficient number of features yielding good matching characteristics are identified.

In the example of a threshold is denoted as t. The threshold may correspond to a value for a characteristic that may depend on the nature of the feature. As noted above for corners the characteristic may be based on gradients in multiple directions but for other types of features values of other characteristics may be measured and compared to the threshold.

A further feature that may be included in a system to form a composite image from a stream of image frames generated by a hand held scanning device may be a mechanism to synchronize image data with navigation information generated by navigation sensors on the scanning device while the device is operating in scan mode. In some embodiments this mechanism may be implemented by processing within the scanning devices. In the scanning device each image frame may be associated with the navigation information providing an indication of the position and orientation of the scanner mouse at the time the image frame was captured. The navigation information may then be transmitted to the computing device in a format that allows the computing device to associate the navigation information with the image frame. The computing device can use the navigation information to determine a coarse position of the image frame to thus position the image frame within a composite image. A better quality image may then be made using finer alignment techniques.

However the more accurately the navigation information reflects a pose of the scanner mouse with respect to the composite image when the image frame was captured the faster a good quality composite image may be generated. Accordingly in some embodiments of the invention a time at which the one or more image sensors are triggered to capture an image and a time at which the navigation information is acquired from the navigation sensors may be synchronized. Thus the navigation information may be collected close in time to when the image data is acquired. The image data may be transferred to the computing device associated with the navigation information to preserve this synchronization.

The navigation information may be of any suitable form and in some embodiments may be obtained from navigation sensors or may be computed from information obtained from navigation sensors. In some embodiments the navigation information may be multi dimensional positional information which may represent either a change in position between two times or may represent an absolute position within a frame of reference such as a frame of reference established by the position of the scanning device at the initiation of a scan. In some embodiments the navigation information may be derived from indications of motion of each of a plurality of sensors in at least two dimensions.

The navigation sensors may comprise for example laser sensors each of which may sense motion in two dimensions. As an example each navigation sensor may output a change in its position which could be indicated as x in the x direction and by y in the y direction which may be orthogonal to the x direction. Navigation information in the x and y directions may be useful in a scenario as illustrated in in which the scanning device moves across a generally planar surface . Use of laser sensors as in a conventional mouse may also be well suited for scenarios in which the surface is opaque. Though in other scenarios a change in the position of a sensor may be indicated by a value of z in a z direction wherein the z direction is orthogonal to both x and y directions. It should be appreciated that embodiments of the invention are not limited to a number of dimensions in which the motion is tracked or that the dimensions need not be orthogonal. Alternatively or additionally the navigation information may be derived from sensors other than laser sensors such as inertial sensors.

Though regardless of the nature of this navigation data and the nature of the sensors from which it is directly or indirectly obtained it may be desirable to synchronize image frames with the navigation information as provided to a computing device that forms a composite image from a stream of image frames. In synchronizing image data and navigation information the navigation information may better represent a pose of the scanning device at the time the image data was captured. As a result the computing device may better estimate a coarse position of each image frame within a composite image.

As an example of how such synchronization may be achieved a scanner mouse as illustrated in may operate to generate synchronized navigation information and image data. To collect information on a motion of the scanner mouse the navigation sensors such as navigation sensors and may be polled by a processor such as processor shown in . Both of the navigation sensors and may be polled at certain time intervals for navigation information. The time intervals may be periodic time intervals or time periods of any suitable temporal gradation or tied to any suitable event or events. As shown in each of navigation sensors and may comprise a register such as registers and where values representing motion of scanner mouse as detected by the sensor may be accumulated. In the embodiment illustrated these values represent for each of the motion sensors sensed motion in both the x and y directions since the last reset of the register. In some embodiments processor may generate control signals to reset one or more of the accumulated motion registers and once the values output by navigation sensors are read from the registers.

In mouse mode these values from the navigation sensors may be read and transferred at a prescribed rate. Processor may reset registers and each time they are read. In scan mode processor may similarly read and reset registers and . Though alternatively or additionally scanner mouse may keep track of its absolute position with the position being absolute with respect to a frame of reference. That frame of reference may be the pose of the scanner mouse upon receipt of a control signal to initiate scan mode or some other reference point.

In some embodiments the absolute position may be implemented by allowing registers and to continuously accumulate values by resetting them at the initiation of scan mode and not resetting them as they are read. However in some embodiments registers and may not be large enough to track motion during a full scan. Accordingly processor may maintain one or more cumulative position values. In some embodiments a cumulative position value may be maintained for each direction of motion measured by each of the navigation. As a specific example separate cumulative position values may be maintained for x motion tracked by navigation sensor y motion tracked by navigation sensor x motion tracked by navigation sensor and y motion tracked by navigation sensor .

As processor reads and resets registers and it may update the cumulative position values thus creating a new instance of each cumulative position value by adding to the prior instance of the cumulative position a value read from a respective one of the sensors indicating a difference in the position of scanner mouse from the previous time and a current time at which the navigation sensors were read. In the scanning device the frame of reference may initially be established based on a position of the scanning device.

The cumulative position value may be stored in a suitable location in scanner mouse . For example the value may be stored in register shown in . In addition register may store other information.

When processor receives an input instructing scanner mouse to switch to the scanner mode scanner mouse begins operating so that in addition to tracking via the navigation sensors its motion scanner mouse also captures image information as the device is moved over an object being scanned. The image information may be captured via any suitable image sensor. In some embodiments an image array such as image array show in captures image information as a stream of image frames is captured as the object is being scanned. Processor triggers image array to capture an image and then reads data out of image array representing the captured image. Processor transfers this data through computer interface as an image frame that may be used to form a composite image. Processing to form the composite image may use navigation information associated with the image frame to derive a coarse position of the image frame in the composite image.

To provide navigation information that accurately represents a position of an image frame processor may read values from the navigation sensors close to the time at which processor triggers image array to capture the image information. These sensor readings may be used to generate the instances of the cumulative position information associated with the image frame and transferred through computer interface in a format that preserves this association.

Any suitable format may be used to transfer image data and navigation information in a way that preserves the association. In some embodiments as image frames are being captured image data for the frame is transferred to the computing device as a stream of bits which may be formatted as a packet to comply with the protocol used by computer interface . Image data for an image frame may be transmitted as one or more of the packets such that a stream of image frames is transmitted as a stream with one or more packets per image frame. An association between the image data for a frame and multi dimensional position information representing may be maintained by placing the multi dimensional position information at predefined positions within the stream of packets.

In some embodiments position information for an image frame such as cumulative position value determined as discussed above may be stored at a location in the stream of packets that is determined relative to one or more packets that contain image data for the frame.

Though even if packets are not used to convey data the image data for an image frame may be associated with the cumulative position values for that image frame via any suitable format. In some embodiments the cumulative position values may be appended to the end of the image data. For example bits representing the cumulative position values may be transferred through computer interface immediately after the bits representing pixels of the image data.

Appending the cumulative position values at the end of the image data allows time for calculation of an instance of the cumulative position value based on values read from the navigation sensors at the time the image capture was triggered to be completed. If insufficient time is available for computing an updated instance of the cumulative position values the cumulative position value may also be appended to the end of the data transferred for a succeeding image frame in the stream of image frames. In other embodiments the cumulative position value may be appended at the beginning of the succeeding image frame. Other different ways to associate the image data with the cumulative position value may be substituted including transferring the cumulative position values in a separate packet between the packets containing data representing successive image frames.

Turing to a flowchart of a process that may be performed by processor is illustrated. A process of obtaining a value that is referred to as an absolute position of the scanner mouse during its operation is shown by way of example. Process may be performed for each direction in which each motion sensor such as each of the navigation sensors and tracks motion. In the case in which each of two navigation sensors tracks motion in two dimensions the process may occur essentially four times in parallel. Though such an effect may be achieved by repeating each step in the process for each direction of each sensor rather than in parallel processing threads.

Process may begin when a scanner mouse is placed in scan mode or when a scan process is reset. A position of the scanner mouse at this time may be taken as the reference position and memory elements within the scanner mouse that track motion of the scanner mouse may be reset at this time. The processor of the scanner mouse may then begin to poll the navigation sensors.

When a processor of the scanner mouse polls the navigation sensor a value on the motion of the scanner mouse tracked by the sensor since its last reset is read from it. This value may indicate an incremental motion of the scanner mouse since last reset rather than an absolute position relative to the frame of reference established when scan mode was entered. The absolute position of the scanner mouse may be computed by accumulating these increments of motion.

Accordingly at block a value indicating an increment of motion of the scanner mouse may be received from a navigation sensor. In some embodiments these values may be pushed by the sensor to the processor such as by issuing an interrupt to the processor. Though in other embodiments the processor polls the sensor at intervals determined by the processor. Such intervals may be determined for example by a timer or clock. Regardless of when the values are obtained from the sensors between receiving sensor values the processor may be idle or may perform other computations or operations.

Regardless of what triggers the processor to receive a value representing an increment in the embodiment illustrated the increment is read from the navigation sensor by the processor of the scanner mouse. In the navigation sensor relative position increments may be tracked in a suitable location e.g. a register such as one of the register and . In the embodiment illustrated reading the sensor also resets these values such that each time the sensor is read the value reflects incremental motion since the last read of the sensor.

Next at block the value indicating the increment of the motion of the scanner mouse may be added to a current absolute position to generate a new instance of the absolute position. At each point during operation of the scanner mouse in scan mode the device keeps track of its current absolute position. Thus the absolute position value comprises a cumulative result of repeatedly determining a position of the scanner mouse based on reading values from its navigation sensors.

The current absolute position of the scanning device may be stored in a suitable location in the scanner mouse. For example register which may be located in memory or in other component e.g. processor of the scanner mouse may store the current absolute position. When the increment is added to the current absolute position register may be updated to store an updated value of the current absolute position representing a new instance of that position. The value of the updated current absolute position may then be provided to used in connection with any suitable processing. For example when capture of an image is triggered the current instance of the absolute position may be obtained and may be associated with the image data so that it can be transferred to the computing device as discussed in greater detail below.

Process may then follow to decision block where it may be determined whether further increments in the position of the scanner mouse may be received from the sensors. For example if the scanner mouse is operating in scan mode the navigation sensors may be polled for values representing increments of motion for as long as the device continues to operate in scan mode. If it is determined at block that process is not completed it may return to block where next values representing motion of the scanner mouse from one or more sensors and in one or more dimensions may be received. Alternatively if it is determined at block that process is completed process may end.

One use of the instances of the absolute position information generated through process may be to associate position information with image frames. As image frames are captured during the progress of the scan the absolute position of each image frame may then be provided in a format associated with the image data for the image frame to the computing device. Such an association may be achieved by synchronizing position information with the image data.

Process may start at any suitable time. For example an image frame may be captured at a periodic rate that may be driven by a timer or synchronized by some other hardware component. In some embodiments clock may control image array to capture images at any suitable time intervals. Though images may be captured in response to any suitable event or events which may be asynchronous and may be generated by any suitable control circuitry.

Regardless of what triggers an image to be captured referring to components of scanner mouse shown in process may begin with image array capturing image data. Accordingly at block an image exposure may be started. The image data may be captured by a suitable image capturing device such as for example image array . Image array may be a two dimensional image array such as a CCD array as is known in the art of still and video camera design. However any suitable image capturing device may be used as embodiments of the invention are not limited in this respect. An image exposure may be started at block using techniques as known in the art and the specific technique used may depend on the nature of the image array used. For example in some embodiments image capture may be triggered by clearing the values stored in the image array and then strobing lighting arrays to expose detectors of the image array with light reflected from an object to be imaged. The light may generate an electrical output from the detector elements that may be recorded in the image array. In some embodiments triggering an image capture may alternatively or additionally include applying control signals to the image array to enable it to capture and then store electrical outputs from detector elements. In some embodiments of the invention the duration of the image exposure may be approximately 1 millisecond. However any other suitable duration may be used depending on characteristics of the image array environment and other factors as embodiments of the invention are not limited in this respect.

Next at block navigation information may be read out from one of the navigation sensors denoted here by way of example as Sensor . To read the navigation information Sensor may be polled by the processor of the scanner mouse. In some embodiments clock may signal reading out navigation information from the navigation sensors. Similarly at block navigation information may be read out from other navigation sensor denoted by way of example as Sensor . In this example scanner mouse comprises two navigation sensors and and Sensor may be for example navigation sensor in which case Sensor may be navigation sensor . However it should be appreciated that any suitable number of navigation sensors may be used and the sensors may be polled for the navigation information in any suitable order.

Next block absolute position of the scanner mouse may be calculated using the navigation information collected from Sensor and the navigation information collected from Sensor . The absolute position comprises a cumulative position value determined based on a difference in the position of scanner mouse from the previous time and a current time at which the navigation sensors were read. Because the navigation sensors are polled and read close in time to when the image exposure has began the absolute position is determined for a time when the image was captured. Accordingly in the computing device the image may then be positioned within the composite image. It should be noted that processing at blocks may comprise reading navigation sensors and determining an instance of the current absolute position or the cumulative position value as shown in connection with .

Process then continues to block where the image data may be associated with the absolute position calculated at block . The absolute position which is also referred to herein as the cumulative position value may be associated with the image in any suitable manner and format. In some embodiments this association may be created by storing the instance of the absolute position determined at block for latter transmission in a predetermined time with respect to image data. For example the absolute position may be appended to the end of the image as the image is transmitted.

At block the image data for the image frame may be transmitted from the scanner mouse to the computer device. In a scanner mouse as illustrated in transmission may be achieved by transferring the image data read from image array through computer interface . In some embodiments the image data may be associated with one or more cumulative position values that are generated for a time at which an image frame in a stream of image frames is captured in which case transmitting at block may also include transmitting the position values. As one example the image data associated with the cumulative position values may be transferred to the computing device as a sequence of data packets. The data packets may be transferred in accordance with a suitable protocol such as for example a USB protocol.

In some embodiments values from the sensors may not be read at a time that is synchronized to triggering image capture at block . Accordingly timestamps may be used to associate position information with an image frame which is conceptually illustrated by an optional dashed block . In such embodiments for each of the navigation sensors a suitable component of the scanner mouse e.g. the processor may keep track of a time when the navigation sensor was read to produce a cumulative position value. The timestamp may indicate a time relative to a temporal frame of reference that allows a time at which navigation sensors are read to a time at which images are captured. For example the image capture could be triggered by a timer that counts intervals between successive image captures. A value in this timer when a sensor is read may serve as a timestamp indicating a time relative to image capture times at which the sensor was read. After accumulated values of a position of the scanner mouse are computed based on values read from the navigation sensors these values timestamps for the values used in computing the computed position and the image data may be transferred to the computing device as shown at block .

Information collected by the processor of the scanner mouse e.g. processor may be provided to a computing device such as computer for any suitable processing. That processing may depend on the format in which information is transmitted but may result in computation of a relative pose between successive image frames as received by the computing device as prelude to incorporating the image data into a composite image. Hence as denoted by a page reference A process may follow to a process where the information collected by the processor of the scanner mouse may be preprocessed in the computing device.

In at decision block it may first be determined whether the transmission of the image as transferred associated with the cumulative position value is successful. If it is determined that the image transmission was not successful and the transferred image therefore was not received in the computing device process may continue to block where the computing device may receive next image from the scanner mouse. In the embodiment illustrated each of the image frames transferred may also be associated with a cumulative position value. As a result even if some image frames are not transferred successfully process may nonetheless be performed on the next image that is received successfully.

If it is determined at block that the image transmission was successful process may branch to block where the cumulative position values which may be an indicator of an absolute position may be extracted based on their association with the image data. Further the cumulative position values may be converted into a relative position delta which indicates a change in the position of the navigation sensors in the scanner mouse in two or more dimensions relative to a position of the scanner mouse at the time the previously received image frame was captured.

In embodiments where the timestamps are transmitted from the scanner mouse as illustrated at block in process may include an optional block where the time stamps may be used to compute position information at the time an image frame was captured which may then be used to compute changes in pose between successive image frames. Interpolation or extrapolation may be used to compute a position. For example if position information was acquired at a time shortly before an image frame was captured is available a rate of change in position may be computed using prior position information. The rate of change and the timestamp may be used to extrapolate from position information to position at the time the image frame was captured. In other scenarios if position information is available for times as indicated by the timestamps before and after capture of an image frame an interpolation technique may be used to compute a position associated with the image frame.

At block of process an initial relative pose estimate for the image frame may be calculated using the relative position deltas for each of the navigation sensors. In addition to a motion of the scanner mouse the x and y directions which may be taken as two orthogonal directions in the plane defined by the lower surface of scanner mouse a rotation of scanner mouse in that plane denoted as may be derived in the computing device from the relative position deltas based on separation of the navigation sensors and differences in their x and y motions. The initial relative pose estimate may be associated with some imprecision expressed as a zone of uncertainty as discussed above. In some embodiments this uncertainty may be computed based on known precision of navigation sensors as used in a scanner mouse. In embodiments in which each received image frame is received and processed the extent of the zone of uncertainty may be the same for all image frames processed. Though in embodiments in which some image frames may not be received successfully because of transmission failures the zone of uncertainty may be computed so that it is larger in proportion to the time between successive image frames processed. This time may be determined based on sequence numbers attached to frames in the scanner mouse or by timing on the computing device or in any other suitable way.

In the embodiment illustrated the relative pose is computed in a plane. It should be appreciated that in some embodiments the pose of the image frame may comprise a position of the frame in a three dimensional 3D space defined by the x y and z dimensions in which case the pose may also comprise a rotation in the 3D space about each of the x y and z axes.

Next at block the image frame associated with the initial pose estimate may be placed in a queue for further processing which may be perfumed in any suitable manner. For example the image frame may be stored in a buffer in memory of the computing device where image frames may be stored for consecutive processing as a stream of image frames. The processing may include fast track processing and subsequent quality track processing leading to generation of a composite image that is then displayed on a display device.

Regardless of how the image frames are processed at block it may be determined whether the scanning is completed. This determination may be performed based on any suitable indication. For example the scanner mouse may be switched from the scanner mode to the mouse mode e.g. when a user depresses a button associated with the scanner mouse and the scanning of the object may be completed. Any other triggers may lead to the determination that the scanning is completed including a disconnection of the scanner mouse from the computing device and other circumstances. If it is determined at block that the scanning is completed process may end. Alternatively it is determined at block that the scanning is not completed process may return to block where another image data along with the information on a position of the scanner mouse may be received from the scanner mouse.

In some embodiments described above image data is associated with position information and that association is preserved as the image data and position information is transferred to a computing device. B and C illustrate different ways in which the image data may be associated with navigation information obtained from the navigation sensors. The navigation information may comprise the cumulative position information and any other suitable information. In the example illustrated the image data associated with the cumulative information may be transferred to the computing device as a sequence of data packets. The data packets may be transferred using any suitable protocol such as the USB protocol.

In some embodiments the image frame may be associated with the navigation information that is obtained for a time at which the image frame is captured as shown in . illustrates conceptually that a packet or a sequence of packets denoted collectively as packet may contain the image data for an image frame associated with the navigation information.

In data for a current image frame denoted as Image may be associated with the navigation information so that the navigation information is appended at the end of image frame . Navigation information is denoted as Navigation information to illustrate that it is obtained for a time at which Image was captured.

The transmission of image frame may begin before the preparation of navigation information to be appended to image frame is completed. If so the preparation of navigation information may be completed during the time when data on image frame is being transferred. Accordingly by the time when a portion of image frame is transmitted to the computing device navigation information in a form suitable for appending to image frame e.g. as a number of pixels may be appended to image frame . The thus appended navigation information is transferred to the computing device associated with image frame to indicate a position of the scanner mouse at a time when image frame was captured. In the embodiment of the navigation information representing position information at the time of capture of an image frame is appended as a footer to the data representing that image frame.

In other embodiments data for an image frame may be transmitted with navigation information that represents a time at which a previously transmitted image frame was captured. Accordingly demonstrates that a data packet or a sequence of packets may comprise an image frame that is a succeeding image frame for Image in the stream of image frames captured by an image array of the scanner mouse. In image frame is schematically denoted as Image to illustrate that it succeeds Image . Image frame may be transmitted with navigation information providing position information for Image . In the example illustrated in navigation information is appended at the end of image frame . Navigation information may be appended as a footer for the packet . In this example packet may include an identifier of the image frame with which it is associated so that navigation information may be associated with a specific preceding packet. Though in other embodiments the association between navigation information may be based simply on packet ordering as received.

It should be appreciated that embodiments of the invention are not limited to a way in which navigation information is appended to image frame . Thus data packets such as a data packet in may comprise navigation information that is appended at the beginning of image frame . In the examples illustrated in connection with image frame may contain image data for an image frame that immediately succeeds the image frame for which navigation information is provided. However image frame may be otherwise related to the image frame for which navigation information is provided as embodiments of the invention are not limited in this respect.

At some time after the image is captured by image array the transfer of the image data may begin as shown in a timeline . In the image transfer is shown by way of example to begin at time D which is explained in more detail below. The image transfer may comprise reading the image data from image array . In some embodiments image array may capture image data representing pixel values in the image that are organized as a series of lines. The image data may be read from image array line by line via a suitable interface. The image data may packaged for transmission in accordance with a suitable protocol such as the USB protocols.

In the exemplary timelines described with reference to each of the navigation sensors of the scanner mouse such as navigation sensors and may be polled at time intervals which are illustrated to be periodic in this example and are also shown to occur more frequently than an image is captured. Processor may poll navigation sensors and . As shown by timelines and illustrating polling of navigation sensors and denoted as Sensor and Sensor respectively the polling of the navigation sensors may be initiated at suitable times. In the embodiment illustrated the sensors are polled prior to a time 3 when the image exposure begins. Thus shows by way of example that Sensor is polled at a time 1 while Sensor is polled at a time 2. Though Sensor may be polled prior to Sensor . Also it should be appreciated that any sensor values read at approximately the same time that an image exposure begins may be used to determine position information and the polling need not occur prior to the time 3. 

In this example the polling of Sensor and Sensor comprises reading values accumulated on internal registers of the sensors e.g. registers and in and resetting the registers after the values are read. In this example the values comprise cumulative position values indicating a change in the position of the scanner mouse by a value of x in the x direction and by a value of y in the y direction.

The navigation information comprising the values read from Sensor and Sensor may be accumulated by processor which may be any suitable microprocessor. The values may be accumulated in a suitable location in memory of the scanner mouse such as register as described above in connection with . Timeline illustrates that values accumulated in register from Sensor may be read from the register at time A. Similarly values accumulated in register from Sensor may be read from the register at time B as shown by timeline . The values accumulated in register from Sensor are read at time A prior to time B at which the values accumulated in register from Sensor are read.

A timeline illustrates a process of preparing the navigation information accumulated by processor for associating the navigation information with the image frame that is captured during the image exposure shown at timeline . In this example the navigation information may be associated with the image frame by being appended to the end of the image frame and in the illustrated embodiment may be formatted as a footer of the image frame. Thus the preparation of the navigation information is referred to as a footer preparation in . The footer preparation may begin at a time C which occurs some time after the navigation information is read from Sensors and at times A and B respectively. The preparation of the footer may comprise converting the navigation information into a format that allows this information to be transferred to the computing device along with the image frame data which may entail storing the information at time C in a separate location from which it can be transferred through computer interface .

As illustrated in timeline of after the image frame has been captured the image transfer begins at time D. At the completion of the image data transfer the navigation information prepared to be associated with the image frame as a footer may be transferred through the computer interface as shown by a striped block at timeline . The navigation information thus associated with the image frame may be transferred e.g. as a packet formed in accordance with the USB protocol to the computing device. As a result the computing device may receive the image frame with the navigation information that accurately indicates a position of the scanner mouse at the time the image frame was captured. The composite image generated by the computing device may then be updated to incorporate the image frame at a position proportional to the position of the scanner mouse when the image frame was acquired.

Having thus described several aspects of at least one embodiment of this invention it is to be appreciated that various alterations modifications and improvements will readily occur to those skilled in the art.

For example it is described above that a network is processed as a whole to reduce inconsistency. It should be appreciated that it is not necessary that the entire network be processed at one time. Portions of the network representing subsets of the nodes and their associated edges may be processed. The portions may be selected in any suitable way such as by selecting only those nodes in paths to a newly added node.

As another example an embodiment is described in which a node is added to a network based on a match between an image frame and an immediately preceding image frame as part of fast track processing. An embodiment is also described in which a match to neighboring nodes results in additional edges added to the network in a quality track processing. It should be appreciated that addition of edges may be performed in any suitable process. For example fast track processing may entail addition of edges of neighboring nodes as well as for an immediately preceding node.

Also an embodiment was described in which each image frame generated by a scanning device is captured and processed. In some scenarios a user may move a scanning device so slowly that there is sufficient overlap between multiple image frames in a portion of a stream of image frames generated by the scanning device that the latest image frame may be aligned with the earliest image frame in that portion of the stream. In this case the intervening frames in that portion of the stream need not be processed. In some embodiments preprocessor may detect such a scenario and delete the intervening frames from the stream provided to fast track processing .

Also it was described that user interface tools render a composite image from a network. Rendering may involve transferring all of the image frames reflected by nodes in the network into a display buffer in an order in which the image frames were captured. Such processing may result in most recent image frames overlaying older image frames. In some embodiments older image frames that are completely overlaid by newer image frames may be omitted from the network or may be ignored during rendering of a composite image. Though other alternatives are possible.

For example when the network contains overlaying image frames containing pixels that represent the same portions of the object being scanned these image frames may be averaged on a pixel by pixel basis as a way to reduce noise in the composite image display. Averaging may be achieved in any suitable way. For example the pixel values may be numerically averaged before any pixel value is written to the display buffer or overlaying image frames may be given display characteristics that indicate to components of an operating system driving a display based on the content of the frame buffer that the newer image frames should be displayed in a semi transparent fashion.

As an example of another possible variation it was described that a pose for each node in a network relative to a point of reference was computed from relative poses between nodes. This computation may be performed at any suitable time. For example a pose of each node may be computed and stored in memory in conjunction with the node when edges to the node are determined or updated. Though the pose of each node may be recomputed from the network when the pose is used.

Such alterations modifications and improvements are intended to be part of this disclosure and are intended to be within the spirit and scope of the invention. Accordingly the foregoing description and drawings are by way of example only.

The above described embodiments of the present invention can be implemented in any of numerous ways. For example the embodiments may be implemented using hardware software or a combination thereof. When implemented in software the software code can be executed on any suitable processor or collection of processors whether provided in a single computer or distributed among multiple computers.

Further it should be appreciated that a computer may be embodied in any of a number of forms such as a rack mounted computer a desktop computer a laptop computer or a tablet computer. Additionally a computer may be embedded in a device not generally regarded as a computer but with suitable processing capabilities including a Personal Digital Assistant PDA a smart phone or any other suitable portable or fixed electronic device.

Also a computer may have one or more input and output devices. These devices can be used among other things to present a user interface. Examples of output devices that can be used to provide a user interface include printers or display screens for visual presentation of output and speakers or other sound generating devices for audible presentation of output. Examples of input devices that can be used for a user interface include keyboards and pointing devices such as mice touch pads and digitizing tablets. As another example a computer may receive input information through speech recognition or in other audible format.

Such computers may be interconnected by one or more networks in any suitable form including as a local area network or a wide area network such as an enterprise network or the Internet. Such networks may be based on any suitable technology and may operate according to any suitable protocol and may include wireless networks wired networks or fiber optic networks.

Also the various methods or processes outlined herein may be coded as software that is executable on one or more processors that employ any one of a variety of operating systems or platforms. Additionally such software may be written using any of a number of suitable programming languages and or programming or scripting tools and also may be compiled as executable machine language code or intermediate code that is executed on a framework or virtual machine.

In this respect the invention may be embodied as a non transitory computer readable medium or multiple computer readable media e.g. a computer memory one or more floppy discs compact discs CD optical discs digital video disks DVD magnetic tapes flash memories circuit configurations in Field Programmable Gate Arrays or other semiconductor devices or other non transitory tangible computer storage medium encoded with one or more programs that when executed on one or more computers or other processors perform methods that implement the various embodiments of the invention discussed above. The computer readable medium or media can be transportable such that the program or programs stored thereon can be loaded onto one or more different computers or other processors to implement various aspects of the present invention as discussed above.

The terms program or software are used herein in a generic sense to refer to any type of computer code or set of computer executable instructions that can be employed to program a computer or other processor to implement various aspects of the present invention as discussed above. Additionally it should be appreciated that according to one aspect of this embodiment one or more computer programs that when executed perform methods of the present invention need not reside on a single computer or processor but may be distributed in a modular fashion amongst a number of different computers or processors to implement various aspects of the present invention.

Computer executable instructions may be in many forms such as program modules executed by one or more computers or other devices. Generally program modules include routines programs objects components data structures etc. that performs particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various embodiments.

Also data structures may be stored in computer readable media in any suitable form. For simplicity of illustration data structures may be shown to have fields that are related through location in the data structure. Such relationships may likewise be achieved by assigning storage for the fields with locations in a computer readable medium that conveys relationship between the fields. However any suitable mechanism may be used to establish a relationship between information in fields of a data structure including through the use of pointers tags or other mechanisms that establish relationship between data elements.

Various aspects of the present invention may be used alone in combination or in a variety of arrangements not specifically discussed in the embodiments described in the foregoing and is therefore not limited in its application to the details and arrangement of components set forth in the foregoing description or illustrated in the drawings. For example aspects described in one embodiment may be combined in any manner with aspects described in other embodiments.

Also the invention may be embodied as a method of which an example has been provided. The acts performed as part of the method may be ordered in any suitable way. Accordingly embodiments may be constructed in which acts are performed in an order different than illustrated which may include performing some acts simultaneously even though shown as sequential acts in illustrative embodiments.

Use of ordinal terms such as first second third etc. in the claims to modify a claim element does not by itself connote any priority precedence or order of one claim element over another or the temporal order in which acts of a method are performed but are used merely as labels to distinguish one claim element having a certain name from another element having a same name but for use of the ordinal term to distinguish the claim elements.

Also the phraseology and terminology used herein is for the purpose of description and should not be regarded as limiting. The use of including comprising or having containing involving and variations thereof herein is meant to encompass the items listed thereafter and equivalents thereof as well as additional items.

