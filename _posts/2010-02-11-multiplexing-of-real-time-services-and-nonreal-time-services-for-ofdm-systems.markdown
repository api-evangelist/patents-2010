---

title: Multiplexing of real time services and non-real time services for OFDM systems
abstract: Transmitter and receiver units for use in an OFDM communications system and configurable to support multiple types of services. The transmitter unit includes one or more encoders, a symbol mapping element, and a modulator. Each encoder receives and codes a respective channel data stream to generate a corresponding coded data stream. The symbol mapping element receives and maps data from the coded data streams to generate modulation symbol vectors, with each modulation symbol vector including a set of data values used to modulate a set of tones to generate an OFDM symbol. The modulator modulates the modulation symbol vectors to provide a modulated signal suitable for transmission. The data from each coded data stream is mapped to a respective set of one or more “circuits”. Each circuit can be defined to include a number of tones from a number of OFDM symbols, a number of tones from a single OFDM symbol, all tones from one or more OFDM symbols, or some other combination of tones. The circuits can have equal size or different sizes. Different circuits can be used for full rate data (e.g., active speech) and low rate data (e.g., silence periods).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08194776&OS=08194776&RS=08194776
owner: Qualcomm Incorporated
number: 08194776
owner_city: San Diego
owner_country: US
publication_date: 20100211
---
This application is a continuation of U.S. patent application Ser. No. 11 165 451 entitled MULTIPLEXING OF REAL TIME SERVICES AND NON REAL TIME SERVICES FOR OFDM SYSTEMS filed Jun. 23 2005 now U.S. Pat. No. 7 751 492 issued Jul. 6 2010 which is a continuation of U.S. patent application Ser. No. 09 614 970 entitled MULTIPLEXING OF REAL TIME SERVICES AND NON REAL TIME SERVICES FOR OFDM SYSTEMS filed Jul. 12 2000 now U.S. Pat. No. 6 952 454 issued Oct. 4 2005 which is a continuation in part of U.S. patent application Ser. No. 09 532 492 entitled HIGH EFFICIENCY HIGH PERFORMANCE COMMUNICATIONS SYSTEM EMPLOYING MULTI CARRIER MODULATION filed Mar. 22 2000 abandoned and U.S. patent application Ser. No. 09 539 224 entitled METHOD AND APPARATUS FOR MEASURING AND REPORTING CHANNEL STATE INFORMATION IN A HIGH EFFICIENCY HIGH PERFORMANCE COMMUNICATIONS SYSTEM filed Mar. 30 2000 now U.S. Pat. No. 6 473 467 issued Oct. 29 2002 which are incorporated herein by reference in their entirety for all purposes.

The present invention relates to data communication. More particularly the present invention relates to a novel and improved communications system employing multi carrier modulation and having high efficiency improved performance and enhanced flexibility.

A modern day communications system is required to support a variety of applications. One such communications system is a code division multiple access CDMA system that conforms to the TIA EIA IS 95 Mobile Station Base Station Compatibility Standard for Dual Mode Wideband Spread Spectrum Cellular System hereinafter referred to as the IS 95 standard. The CDMA system supports voice and data communication between users over a terrestrial link. The use of CDMA techniques in a multiple access communication system is disclosed in U.S. Pat. No. 4 901 307 entitled SPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEM USING SATELLITE OR TERRESTRIAL REPEATERS and U.S. Pat. No. 5 103 459 entitled SYSTEM AND METHOD FOR GENERATING WAVEFORMS IN A CDMA CELLULAR TELEPHONE SYSTEM both assigned to the assignee of the present invention and incorporated herein by reference.

An IS 95 compliant CDMA system is capable of supporting voice and data services over the forward and reverse communications links. Typically each voice call or each traffic data transmission is assigned a dedicated channel having a variable but limited data rate. In accordance with the IS 95 standard the traffic or voice data is partitioned into code channel frames that are 20 msec in duration with data rates as high as 14.4 Kbps. The frames are then transmitted over the assigned channel. A method for transmitting traffic data in code channel frames of fixed size is described in U.S. Pat. No. 5 504 773 entitled METHOD AND APPARATUS FOR THE FORMATTING OF DATA FOR TRANSMISSION assigned to the assignee of the present invention and incorporated herein by reference.

A number of significant differences exist between the characteristics and requirements of voice and data services. One such difference is the fact that voice services impose stringent and fixed delay requirements whereas data services can usually tolerate variable amounts of delay. The overall one way delay of speech frames is typically required to be less than 100 msec. In contrast the delay for data frames is typically a variable parameter that can be advantageously used to optimize the overall efficiency of the data communications system.

The higher tolerance to delay allows traffic data to be aggregated and transmitted in bursts which can provide a higher level of efficiency and performance. For example data frames may employ more efficient error correcting coding techniques requiring longer delays that cannot be tolerated by voice frames. In contrast voice frames may be limited to the use of less efficient coding techniques having shorter delays.

Another significant difference between voice and data services is that the former typically requires a fixed and common grade of service GOS for all users which is usually not required or implemented for the latter. For digital communications systems providing voice services this typically translates into a fixed and equal transmission rate for all users and a maximum tolerable value for the error rate of speech frames. In contrast for data services the GOS may be different from user to user and is also typically a parameter that can be advantageously optimized to increase the overall efficiency of the system. The GOS of a data communications system is typically defined as the total delay incurred in the transfer of a particular amount of data.

Yet another significant difference between voice and data services is that the former require a reliable communications link that in a CDMA system is provided by soft handoff. Soft handoff results in redundant transmissions from two or more base stations to improve reliability. However this additional reliability may not be required for data transmission because data frames received in error may be retransmitted. For data services the transmit power needed to support soft handoff may be more efficiently used for transmitting additional data.

Because of the significant differences noted above it is a challenge to design a communications system capable of efficiently supporting both voice and data services. The IS 95 CDMA system is designed to efficiently transmit voice data and is also capable of transmitting traffic data. The design of the channel structure and the data frame format pursuant to IS 95 have been optimized for voice data. A communications system based on IS 95 that is enhanced for data services is disclosed in U.S. patent application Ser. No. 08 963 386 now U.S. Pat. No. 6 574 211 entitled METHOD AND APPARATUS FOR HIGH RATE PACKET DATA TRANSMISSION filed Nov. 3 1997 assigned to the assignee of the present invention and incorporated herein by reference.

Given the ever growing demand for wireless voice and data communication however a higher efficiency higher performance wireless communications system capable of supporting voice and data services is desirable.

The present invention provides a novel and improved communications system capable of supporting multiple types of services having different delay requirements. Such types of services may include for example full duplex real time FDRT services that require short one way delay e.g. voice half duplex real time HDRT services that can tolerate longer one way delay as long as the delay does not vary by a large amount e.g. video audio non real time NRT services that are not quite as sensitive to delays e.g. packet data and others. Data for these different types of services can be efficiently transmitted using various mechanisms some of which are described below.

An embodiment of the invention provides a transmitter unit for use in a multi carrier e.g. OFDM communication system and configurable to support multiple types of services. The transmitter unit includes one or more encoders a symbol mapping element and a modulator. Each encoder receives and codes a respective channel data stream to generate a corresponding coded data stream. The symbol mapping element receives and maps data from the coded data streams to generate modulation symbol vectors with each modulation symbol vector including a set of data values used to modulate a set of tones to generate an OFDM symbol. The data from each coded data stream is mapped to a respective set of one or more circuits with each circuit including a particular set of one or more tones. The modulator modulates the modulation symbol vectors to provide a modulated signal suitable for transmission. The transmitter unit can further include a set of scaling elements that scale the coded data streams with a set of scaling factors to provide power adjustment.

The modulator can include an inverse Fourier transform a cyclic prefix generator and an upconverter. The inverse Fourier transform receives the modulation symbol vectors and generates a time domain representation of each modulation symbol vector to provide the corresponding OFDM symbol. The cyclic prefix generator repeats a portion of each OFDM symbol to generate a corresponding transmission symbol and the upconverter modulates the transmission symbols to generate the modulated signal.

Each circuit can be defined to include a number of tones from a number of OFDM symbols to provide temporal and frequency diversity a number of tones from a single OFDM symbol all tones from one or more OFDM symbols or some other combination of tones. The circuits can have equal size or different sizes.

The data for each channel data stream can be transmitted in packets. Each packet can be defined to include various fields depending on the particular implementation. In one implementation each packet includes packet type identifier indicative of a change in the circuit to be used to transmit the next packet a circuit identifier indicative of a particular circuit to be used to transmit the next packet and a data field for the payload. In another implementation each packet includes a user identifier indicative of an intended recipient of the packet and a data field for the payload.

The channel data streams can be transmitted over slots with each slot including a number of OFDM symbols. Each slot can be further divided into two or more partitions with each partition including one or more OFDM symbols and used to support one or more types of service. For example one partition of each slot can be used to support full duplex real time services having a short delay requirements and another partition of each slot can be used to support half duplex real time and or non real time services having more relaxed delay requirements.

For improved efficiency full rate data for a particular channel data stream can be transmitted via a first circuit and lower rate data can be transmitted via a second circuit. The second circuit can be transmitted every X number of slots X 1 or can be a lower capacity circuit. An indication to use a new circuit can be sent in a field of the packet transmitted on the current circuit or can be sent via a control channel. The new circuit may be utilized after receiving an acknowledgment of the receipt of such indication to use the new circuit.

In another specific implementation the transmitter unit includes one or more cover elements coupled to the respective encoders. Each cover element receives and covers a respective coded data stream with a particular Walsh sequence assigned to that coded data stream to generate a corresponding covered data stream. The scaling elements then scale the covered data streams with respective scaling factors to generate scaled data streams. A summer receives and sums the scaled data streams to provide a combined data stream that is then provided to the modulator. Each Walsh sequence can be transmitted over multiple tones of each of the OFDM symbols used for the Walsh sequence. Also the length of the Walsh sequence can be matched to the number of tones in each OFDM symbol. For example Walsh sequences of length 128 can be used for OFDM symbols having 128 tones and the 128 chips of each Walsh sequence can be transmitted on the 128 tones of one OFDM symbol.

Another embodiment of the invention provides a method for generating and transmitting a modulated signal capable of supporting multiple types of services. In accordance with the method one or more channel data streams are received and each channel data stream is coded with a particular coding scheme to generate a corresponding coded data stream. The data from the coded data streams are mapped to generate modulation symbol vectors with each modulation symbol vector including a number of data values used to modulate a number of tones to generate an OFDM symbol. The data from each coded data stream is mapped to a respective set of one or more circuits with each circuit including a respective set of one or more tones. The coded data streams can be scaled with respective scaling factors to provide power adjustment. The modulation symbol vectors are then modulated to provide a modulated signal suitable for transmission.

To perform multi carrier modulation each modulation symbol vector is first transformed to a time domain representation to provide a corresponding OFDM symbol. A portion of each OFDM symbol is then repeated to generate a corresponding transmission symbol and the transmission symbols are further processed to generate the modulated signal.

The invention further provides a receiver unit capable of receiving and processing the modulated signal generated in the manner described above.

As shown in communications system includes a first system in communication with a second system . System includes a transmit data processor that 1 receives or generates data 2 processes the data to provide antenna frequency or temporal diversity or a combination thereof and 3 provides processed modulation symbols to a number of modulators MOD through . Each modulator further processes the modulation symbols and generates an RF modulated signal suitable for transmission. The RF modulated signals from modulators through are then transmitted from respective antennas through over communications links to system .

In the embodiment shown in system includes a number of receive antennas through that receive the transmitted signals and provide the received signals to respective demodulators DEMOD through . As shown in each receive antenna may receive signals from one or more transmit antennas depending on a number of factors such as for example the operating mode used at system the directivity of the transmit and receive antennas the characteristics of the communications links and others. Each demodulator demodulates the respective received signal using a demodulation scheme that is complementary to the modulation scheme used at the transmitter. The demodulated symbols from demodulators through are then provided to a receive data processor that further processes the symbols to provide the output data. The data processing at the transmitter and receiver units is described in further detail below.

For simplicity communications system is shown to include one transmitter unit i.e. system and one receiver unit i.e. system . However other variations and configurations of the communications system are possible. For example in a multi user multiple access communications system a single transmitter unit may be used to concurrently transmit data to a number of receiver units. Also in a manner similar to soft handoff in an IS 95 CDMA system a receiver unit may concurrently receive transmissions from a number of transmitter units. The communications system of the invention may include any number of transmitter and receiver units.

Each transmitter unit may include a single transmit antenna or a number of transmit antennas such as that shown in . Similarly each receiver unit may include a single receive antenna or a number of receive antennas again such as that shown in . For example the communications system may include a central system i.e. similar to a base station in the IS 95 CDMA system having a number of antennas that transmit data to and receive data from a number of remote systems i.e. subscriber units similar to remote stations in the CDMA system some of which may include one antenna and others of which may include multiple antennas. Generally as the number of transmit and receive antennas increases antenna diversity increases and performance improves as described below.

As used herein an antenna refers to a collection of one or more antenna elements that are distributed in space. The antenna elements may be physically located at a single site or distributed over multiple sites. Antenna elements physically co located at a single site may be operated as an antenna array e.g. such as for a CDMA base station . An antenna network consists of a collection of antenna arrays or elements that are physically separated e.g. several CDMA base stations . An antenna array or an antenna network may be designed with the ability to form beams and to transmit multiple beams from the antenna array or network. For example a CDMA base station may be designed with the capability to transmit up to three beams to three different sections of a coverage area or sectors from the same antenna array. Thus the three beams may be viewed as three transmissions from three antennas.

The communications system of the invention can be designed to provide a multi user multiple access communications scheme capable of supporting subscriber units having different requirements as well as capabilities. The scheme allows the system s total operating bandwidth W e.g. 1.2288 MHz to be efficiently shared among different types of services that may have highly disparate data rate delay and quality of service QOS requirements.

Examples of such disparate types of services include voice services and data services. Voice services are typically characterized by a low data rate e.g. 8 kbps to 32 kbps short processing delay e.g. 3 msec to 100 msec overall one way delay and sustained use of a communications channel for an extended period of time. The short delay requirements imposed by voice services typically require a small fraction of the system resources to be dedicated to each voice call for the duration of the call. In contrast data services are characterized by bursty traffics in which variable amounts of data are sent at sporadic times. The amount of data can vary significantly from burst to burst and from user to user. For high efficiency the communications system of the invention can be designed with the capability to allocate a portion of the available resources to voice services as required and the remaining resources to data services. In some embodiments of the invention a fraction of the available system resources may also be dedicated for certain data services or certain types of data services.

The distribution of data rates achievable by each subscriber unit can vary widely between some minimum and maximum instantaneous values e.g. from 200 kbps to over 20 Mbps . The achievable data rate for a particular subscriber unit at any given moment may be influenced by a number of factors such as the amount of available transmit power the quality of the communications link i.e. the C I the coding scheme and others. The data rate requirement of each subscriber unit may also vary widely between a minimum value e.g. 8 kbps for a voice call all the way up to the maximum supported instantaneous peak rate e.g. 20 Mbps for bursty data services .

The percentage of voice and data traffic is typically a random variable that changes over time. In accordance with certain aspects of the invention to efficiently support both types of services concurrently the communications system of the invention is designed with the capability to dynamic allocate the available resources based on the amount of voice and data traffic. A scheme to dynamically allocate resources is described below. Another scheme to allocate resources is described in the aforementioned U.S. patent application Ser. No. 08 963 386.

The communications system of the invention provides the above described features and advantages and is capable of supporting different types of services having disparate requirements. The features are achieved by employing antenna frequency or temporal diversity or a combination thereof. In some embodiments of the invention antenna frequency or temporal diversity can be independently achieved and dynamically selected.

As used herein antenna diversity refers to the transmission and or reception of data over more than one antenna frequency diversity refers to the transmission of data over more than one sub band and temporal diversity refers to the transmission of data over more than one time period. Antenna frequency and temporal diversity may include subcategories. For example transmit diversity refers to the use of more than one transmit antenna in a manner to improve the reliability of the communications link receive diversity refers to the use of more than one receive antenna in a manner to improve the reliability of the communications link and spatial diversity refers to the use of multiple transmit and receive antennas to improve the reliability and or increase the capacity of the communications link. Transmit and receive diversity can also be used in combination to improve the reliability of the communications link without increasing the link capacity. Various combinations of antenna frequency and temporal diversity can thus be achieved and are within the scope of the present invention.

Frequency diversity can be provided by use of a multi carrier modulation scheme such as orthogonal frequency division multiplexing OFDM which allows for transmission of data over various sub bands of the operating bandwidth. Temporal diversity is achieved by transmitting the data over different times which can be more easily accomplished with the use of time division multiplexing TDM . These various aspects of the communications system of the invention are described in further detail below.

In accordance with an aspect of the invention antenna diversity is achieved by employing a number of N transmit antennas at the transmitter unit or a number of N receive antennas at the receiver unit or multiple antennas at both the transmitter and receiver units. In a terrestrial communications system e.g. a cellular system a broadcast system an MMDS system and others an RF modulated signal from a transmitter unit may reach the receiver unit via a number of transmission paths. The characteristics of the transmission paths typically vary over time based on a number of factors. If more than one transmit or receive antenna is used and if the transmission paths between the transmit and receive antennas are independent i.e. uncorrelated which is generally true to at least an extent then the likelihood of correctly receiving the transmitted signal increases as the number of antennas increases. Generally as the number of transmit and receive antennas increases diversity increases and performance improves.

In some embodiments of the invention antenna diversity is dynamically provided based on the characteristics of the communications link to provide the required performance. For example higher degree of antenna diversity can be provided for some types of communication e.g. signaling for some types of services e.g. voice for some communications link characteristics e.g. low C I or for some other conditions or considerations.

As used herein antenna diversity includes transmit diversity and receive diversity. For transmit diversity data is transmitted over multiple transmit antennas. Typically additional processing is performed on the data transmitted from the transmit antennas to achieved the desired diversity. For example the data transmitted from different transmit antennas may be delayed or reordered in time or coded and interleaved across the available transmit antennas. Also frequency and temporal diversity may be used in conjunction with the different transmit antennas. For receive diversity modulated signals are received on multiple receive antennas and diversity is achieved by simply receiving the signals via different transmission paths.

In accordance with another aspect of the invention frequency diversity can be achieved by employing a multi carrier modulation scheme. One such scheme that has numerous advantages is OFDM. With OFDM modulation the overall transmission channel is essentially divided into a number of L parallel sub channels that are used to transmit the same or different data. The overall transmission channel occupies the total operating bandwidth of W and each of the sub channels occupies a sub band having a bandwidth of W L and centered at a different center frequency. Each sub channel has a bandwidth that is a portion of the total operating bandwidth. Each of the sub channels may also be considered an independent data transmission channel that may be associated with a particular and possibly unique processing coding and modulation scheme as described below.

The data may be partitioned and transmitted over any defined set of two or more sub bands to provide frequency diversity. For example the transmission to a particular subscriber unit may occur over sub channel at time slot sub channel at time slot sub channel at time slot and so on. As another example data for a particular subscriber unit may be transmitted over sub channels and at time slot e.g. with the same data being transmitted on both sub channels sub channels and at time slot only sub channel at time slot and so on. Transmission of data over different sub channels over time can improve the performance of a communications system experiencing frequency selective fading and channel distortion. Other benefits of OFDM modulation are described below.

In accordance with yet another aspect of the invention temporal diversity is achieved by transmitting data at different times which can be more easily accomplished using time division multiplexing TDM . For data services and possibly for voice services data transmission occurs over time slots that may be selected to provide immunity to time dependent degradation in the communications link. Temporal diversity may also be achieved through the use of interleaving.

For example the transmission to a particular subscriber unit may occur over time slots through x or on a subset of the possible time slots from 1 through x e.g. time slots and so on . The amount of data transmitted at each time slot may be variable or fixed. Transmission over multiple time slots improves the likelihood of correct data reception due to for example impulse noise and interference.

The combination of antenna frequency and temporal diversity allows the communications system of the invention to provide robust performance. Antenna frequency and or temporal diversity improves the likelihood of correct reception of at least some of the transmitted data which may then be used e.g. through decoding to correct for some errors that may have occurred in the other transmissions. The combination of antenna frequency and temporal diversity also allows the communications system to concurrently accommodate different types of services having disparate data rate processing delay and quality of service requirements.

The communications system of the invention can be designed and operated in a number of different communications modes with each communications mode employing antenna frequency or temporal diversity or a combination thereof. The communications modes include for example a diversity communications mode and a MIMO communications mode. Various combinations of the diversity and MIMO communications modes can also be supported by the communications system. Also other communications modes can be implemented and are within the scope of the present invention.

The diversity communications mode employs transmit and or receive diversity frequency or temporal diversity or a combination thereof and is generally used to improve the reliability of the communications link. In one implementation of the diversity communications mode the transmitter unit selects a modulation and coding scheme i.e. configuration from a finite set of possible configurations which are known to the receiver units. For example each overhead and common channel may be associated with a particular configuration that is known to all receiver units. When using the diversity communications mode for a specific user e.g. for a voice call or a data transmission the mode and or configuration may be known a priori e.g. from a previous set up or negotiated e.g. via a common channel by the receiver unit.

In the diversity communications mode data is transmitted on one or more sub channels from one or more antennas and at one or more time periods. The allocated sub channels may be associated with the same antenna or may be sub channels associated with different antennas. In a common application of the diversity communications mode which is also referred to as a pure diversity communications mode data is transmitted from all available transmit antennas to the destination receiver unit. The pure diversity communications mode can be used in instances where the data rate requirements are low or when the C I is low or when both are true.

The MIMO communications mode employs antenna diversity at both ends of the communication link and is generally used to improve both the reliability and increase the capacity of the communications link. The MIMO communications mode may further employ frequency and or temporal diversity in combination with the antenna diversity. The MIMO communications mode which may also be referred to herein as the spatial communications mode employs one or more processing modes to be described below.

The diversity communications mode generally has lower spectral efficiency than the MIMO communications mode especially at high C I levels. However at low to moderate C I values the diversity communications mode achieves comparable efficiency and can be simpler to implement. In general the use of the MIMO communications mode provides greater spectral efficiency when used particularly at moderate to high C I values. The MIMO communications mode may thus be advantageously used when the data rate requirements are moderate to high.

The communications system can be designed to concurrently support both diversity and MIMO communications modes. The communications modes can be applied in various manners and for increased flexibility may be applied independently on a sub channel basis. The MIMO communications mode is typically applied to specific users. However each communications mode may be applied on each sub channel independently across a subset of sub channels across all sub channels or on some other basis. For example the use of the MIMO communications mode may be applied to a specific user e.g. a data user and concurrently the use of the diversity communications mode may be applied to another specific user e.g. a voice user on a different sub channel. The diversity communications mode may also be applied for example on sub channels experiencing higher path loss.

The communications system of the invention can also be designed to support a number of processing modes. When the transmitter unit is provided with information indicative of the conditions i.e. the state of the communications links additional processing can be performed at the transmitter unit to further improve performance and increase efficiency. Full channel state information CSI or partial CSI may be available to the transmitter unit. Full CSI includes sufficient characterization of the propagation path i.e. amplitude and phase between all pairs of transmit and receive antennas for each sub band. Full CSI also includes the C I per sub band. The full CSI may be embodied in a set of matrices of complex gain values that are descriptive of the conditions of the transmission paths from the transmit antennas to the receive antennas as described below. Partial CSI may include for example the C I of the sub band. With full CSI or partial CSI the transmitter unit pre conditions the data prior to transmission to receiver unit.

In a specific implementation of the full CSI processing mode the transmitter unit preconditions the signals presented to the transmit antennas in a way that is unique to a specific receiver unit e.g. the pre conditioning is performed for each sub band assigned to that receiver unit . As long as the channel does not change appreciably from the time it is measured by the receiver unit and subsequently sent back to the transmitter and used to precondition the transmission the intended receiver unit can demodulate the transmission. In this implementation a full CSI based MIMO communication can only be demodulated by the receiver unit associated with the CSI used to precondition the transmitted signals.

In a specific implementation of the partial CSI or no CSI processing modes the transmitter unit employs a common modulation and coding scheme e.g. on each data channel transmission which then can be in theory demodulated by all receiver units. In an implementation of the partial CSI processing mode a single receiver unit can specify it s C I and the modulation employed on all antennas can be selected accordingly e.g. for reliable transmission for that receiver unit. Other receiver units can attempt to demodulate the transmission and if they have adequate C I may be able to successfully recover the transmission. A common e.g. broadcast channel can use a no CSI processing mode to reach all users.

The full CSI processing is briefly described below. When the CSI is available at the transmitter unit a simple approach is to decompose the multi input multi output channel into a set of independent channels. Given the channel transfer function at the transmitters the left eigenvectors may be used to transmit different data streams. The modulation alphabet used with each eigenvector is determined by the available C I of that mode given by the eigenvalues. If H is the N Nmatrix that gives the channel response for the Ntransmitter antenna elements and Nreceiver antenna elements at a specific time and is the N vector of inputs to the channel then the received signal can be expressed as 

where n is an N vector representing noise plus interference. The eigenvector decomposition of the Hermitian matrix formed by the product of the channel matrix with its conjugate transpose can be expressed as 

where the symbol denotes conjugate transpose E is the eigenvector matrix and is a diagonal matrix of eigenvalues both of dimension N N. The transmitter converts a set of Nmodulation symbols using the eigenvector matrix E. The transmitted modulation symbols from the Ntransmit antennas can thus be expressed as 

For all antennas the pre conditioning can thus be achieved by a matrix multiply operation expressed as 

where b b . . . and bare respectively the modulation symbols for a particular sub channel at transmit antennas . . . N where each modulation symbol can be generated using for example M PSK M QAM and so on as described below 

E is the eigenvector matrix related to the transmission loss from transmit antennas to the receive antennas and

Since H H is Hermitian the eigenvector matrix is unitary. Thus if the elements of have equal power the elements of also have equal power. The received signal may then be expressed as 

The receiver performs a channel matched filter operation followed by multiplication by the right eigenvectors. The result of the channel matched filter operation is the vector which can be expressed as Eq. 2 

i.e. the noise components are independent with variance given by the eigenvalues. The C I of the i th component of is the i th diagonal element of .

The transmitter unit can thus select a modulation alphabet i.e. signal constellation for each of the eigenvectors based on the C I that is given by the eigenvalue. Providing that the channel conditions do not change appreciably in the interval between the time the CSI is measured at the receiver and reported and used to precondition the transmission at the transmitter the performance of the communications system will then be equivalent to that of a set of independent AWGN channels with known C I s.

As an example assume that the MIMO communications mode is applied to a channel data stream that is transmitted on one particular sub channel from four transmit antennas. The channel data stream is demultiplexed into four data sub streams one data sub stream for each transmit antenna. Each data sub stream is then modulated using a particular modulation scheme e.g. M PSK M QAM or other selected based on the CSI for that sub band and for that transmit antenna. Four modulation sub streams are thus generated for the four data sub streams with each modulation sub streams including a stream of modulation symbols. The four modulation sub streams are then pre conditioned using the eigenvector matrix as expressed above in equation 1 to generate pre conditioned modulation symbols. The four streams of pre conditioned modulation symbols are respectively provided to the four combiners of the four transmit antennas. Each combiner combines the received pre conditioned modulation symbols with the modulation symbols for the other sub channels to generate a modulation symbol vector stream for the associated transmit antenna.

The full CSI based processing is typically employed in the MIMO communications mode where parallel data streams are transmitted to a specific user on each of the channel eigenmodes for the each of the allocated sub channels. Similar processing based on full CSI can be performed where transmission on only a subset of the available eigenmodes is accommodated in each of the allocated sub channels e.g. to implement beam steering . Because of the cost associated with the full CSI processing e.g. increased complexity at the transmitter and receiver units increased overhead for the transmission of the CSI from the receiver unit to the transmitter unit and so on full CSI processing can be applied in certain instances in the MIMO communications mode where the additional increase in performance and efficiency is justified.

In instances where full CSI is not available less descriptive information on the transmission path or partial CSI may be available and can be used to pre condition the data prior to transmission. For example the C I of each of the sub channels may be available. The C I information can then be used to control the transmission from various transmit antennas to provide the required performance in the sub channels of interest and increase system capacity.

As used herein full CSI based processing modes denote processing modes that use full CSI and partial CSI based processing modes denote processing modes that use partial CSI. The full CSI based processing modes include for example the full CSI MIMO mode that utilizes full CSI based processing in the MIMO communications mode. The partial CSI based modes include for example the partial CSI MIMO mode that utilizes partial CSI based processing in the MIMO communications mode.

In instances where full CSI or partial CSI processing is employed to allow the transmitter unit to pre condition the data using the available channel state information e.g. the eigenmodes or C I feedback information from the receiver unit is required which uses a portion of the reverse link capacity. Therefore there is a cost associated with the full CSI and the partial CSI based processing modes. The cost should to be factored into the choice of which processing mode to employ. The partial CSI based processing mode requires less overhead and may be more efficient in some instances. The no CSI based processing mode requires no overhead and may also be more efficient than the full CSI based processing mode or the partial CSI based processing mode under some other circumstances.

If the transmitter unit has CSI and uses the eigenmodes representative of the characteristics of the communications links to transmit independent channel data streams then the sub channels allocated in this case are typically uniquely assigned to a single user. On the other hand if the modulation and coding scheme employed is common for all users i.e. th CSI employed at the transmitter is not user specific then it is possible that information transmitted in this processing mode could be received and decoded by more than one user depending on their C I.

The available sub channels can be used to transmit signaling voice traffic data and others. In the example shown in the modulation symbol at time slot corresponds to pilot data which is periodically transmitted to assist the receiver units synchronize and perform channel estimation. Other techniques for distributing pilot data over time and frequency can also be used and are within the scope of the present invention. In addition it may be advantageous to utilize a particular modulation scheme during the pilot interval if all sub channels are employed e.g. a PN code with a chip duration of approximately 1 W . Transmission of the pilot modulation symbol typically occurs at a particular frame rate which is usually selected to be fast enough to permit accurate tracking of variations in the communications link.

The time slots not used for pilot transmissions can then be used to transmit various types of data. For example sub channels and may be reserved for the transmission of control and broadcast data to the receiver units. The data on these sub channels is generally intended to be received by all receiver units. However some of the messages on the control channel may be user specific and can be encoded accordingly.

Voice data and traffic data can be transmitted in the remaining sub channels. For the example shown in sub channel at time slots through is used for voice call sub channel at time slots through is used for voice call sub channel at time slots through is used for voice call and sub channel at time slots through is used for voice call .

The remaining available sub channels and time slots may be used for transmissions of traffic data. In the example shown in data transmission uses sub channels through at time slot and sub channels through at time slot data transmission uses sub channels through at time slots and and sub channels through at time slots data transmission uses sub channels through at time slot data transmission uses sub channels through at time slot data transmission uses sub channels through at time slot and data transmission uses sub channels through at time slot . Data through transmissions can represent transmissions of traffic data to one or more receiver units.

The communications system of the invention flexibly supports the transmissions of traffic data. As shown in a particular data transmission e.g. data may occur over multiple sub channels and or multiple time slots and multiple data transmissions e.g. data and may occur at one time slot. A data transmission e.g. data may also occur over non contiguous time slots. The system can also be designed to support multiple data transmissions on one sub channel. For example voice data may be multiplexed with traffic data and transmitted on a single sub channel.

The multiplexing of the data transmissions can potentially change from OFDM symbol to symbol. Moreover the communications mode may be different from user to user e.g. from one voice or data transmission to other . For example the voice users may use the diversity communications mode and the data users may use the MIMO communications modes. These features concept can be extended to the sub channel level. For example a data user may use the MIMO communications mode in sub channels that have sufficient C I and the diversity communications mode in remaining sub channels.

Antenna frequency and temporal diversity may be respectively achieved by transmitting data from multiple antennas on multiple sub channels in different sub bands and over multiple time slots. For example antenna diversity for a particular transmission e.g. voice call may be achieved by transmitting the voice data on a particular sub channel e.g. sub channel over two or more antennas. Frequency diversity for a particular transmission e.g. voice call may be achieved by transmitting the data on two or more sub channels in different sub bands e.g. sub channels and . A combination of antenna and frequency diversity may be obtained by transmitting data from two or more antennas and on two or more sub channels. Temporal diversity may be achieved by transmitting data over multiple time slots. For example as shown in data transmission at time slot is a portion e.g. new or repeated of the data transmission at time slot .

The same or different data may be transmitted from multiple antennas and or on multiple sub bands to obtain the desired diversity. For example the data may be transmitted on 1 one sub channel from one antenna 2 one sub channel e.g. sub channel from multiple antennas 3 one sub channel from all Nantennas 4 a set of sub channels e.g. sub channels and from one antenna 5 a set of sub channels from multiple antennas 6 a set of sub channels from all Nantennas or 7 a set of channels from a set of antennas e.g. sub channel from antennas and at one time slot sub channels and from antenna at another time slot and so on . Thus any combination of sub channels and antennas may be used to provide antenna and frequency diversity.

In accordance with certain embodiments of the invention that provide the most flexibility and are capable of achieving high performance and efficiency each sub channel at each time slot for each transmit antenna may be viewed as an independent unit of transmission i.e. a modulation symbol that can be used to transmit any type of data such as pilot signaling broadcast voice traffic data and others or a combination thereof e.g. multiplexed voice and traffic data . In such design a voice call may be dynamically assigned different sub channels over time.

Flexibility performance and efficiency are further achieved by allowing for independence among the modulation symbols as described below. For example each modulation symbol may be generated from a modulation scheme e.g. M PSK M QAM and others that results in the best use of the resource at that particular time frequency and space.

A number of constraints may be placed to simplify the design and implementation of the transmitter and receiver units. For example a voice call may be assigned to a particular sub channel for the duration of the call or until such time as a sub channel reassignment is performed. Also signaling and or broadcast data may be designated to some fixed sub channels e.g. sub channel for control data and sub channel for broadcast data as shown so that the receiver units know a priori which sub channels to demodulate to receive the data.

Also each data transmission channel or sub channel may be restricted to a particular modulation scheme e.g. M PSK M QAM for the duration of the transmission or until such time as a new modulation scheme is assigned. For example in voice call on sub channel may use QPSK voice call on sub channel may use 16 QAM data transmission at time slot may use 8 PSK data transmission at time slots through may use 16 QAM and so on.

The use of TDM allows for greater flexibility in the transmission of voice data and traffic data and various assignments of resources can be contemplated. For example a user can be assigned one sub channel for each time slot or equivalently four sub channels every fourth time slot or some other allocations. TDM allows for data to be aggregated and transmitted at designated time slot s for improved efficiency.

If voice activity is implemented at the transmitter then in the intervals where no voice is being transmitted the transmitter may assign other users to the sub channel so that the sub channel efficiency is maximized. In the event that no data is available to transmit during the idle voice periods the transmitter can decrease or turn off the power transmitted in the sub channel reducing the interference levels presented to other users in the system that are using the same sub channel in another cell in the network. The same feature can be also extended to the overhead control data and other channels.

Allocation of a small portion of the available resources over a continuous time period typically results in lower delays and may be better suited for delay sensitive services such as voice. Transmission using TDM can provide higher efficiency at the cost of possible additional delays. The communications system of the invention can allocate resources to satisfy user requirements and achieve high efficiency and performance.

The encoding may include error correction coding or error detection coding or both used to increase the reliability of the link. More specifically such encoding may include for example interleaving convolutional coding Turbo coding Trellis coding block coding e.g. Reed Solomon coding cyclic redundancy check CRC coding and others. Turbo encoding is described in further detail in U.S. patent application Ser. No. 09 205 511 filed Dec. 4 1998 entitled Turbo Code Interleaver Using Linear Congruential Sequences and in a document entitled The cdma2000 ITU R RTT Candidate Submission hereinafter referred to as the IS 2000 standard both of which are incorporated herein by reference.

The encoding can be performed on a per channel basis i.e. on each channel data stream as shown in . However the encoding may also be performed on the aggregate input data stream on a number of channel data streams on a portion of a channel data stream across a set of antennas across a set of sub channels across a set of sub channels and antennas across each sub channel on each modulation symbol or on some other unit of time space and frequency. The encoded data from encoders through is then provided to a data processor that processes the data to generate modulation symbols.

In one implementation data processor assigns each channel data stream to one or more sub channels at one or more time slots and on one or more antennas. For example for a channel data stream corresponding to a voice call data processor may assign one sub channel on one antenna if transmit diversity is not used or multiple antennas if transmit diversity is used for as many time slots as needed for that call. For a channel data stream corresponding to a signaling or broadcast channel data processor may assign the designated sub channel s on one or more antennas again depending on whether transmit diversity is used. Data processor then assigns the remaining available resources for channel data streams corresponding to data transmissions. Because of the burstiness nature of data transmissions and the greater tolerance to delays data processor can assign the available resources such that the system goals of high performance and high efficiency are achieved. The data transmissions are thus scheduled to achieve the system goals.

After assigning each channel data stream to its respective time slot s sub channel s and antenna s the data in the channel data stream is modulated using multi carrier modulation. In an embodiment OFDM modulation is used to provide numerous advantages. In one implementation of OFDM modulation the data in each channel data stream is grouped to blocks with each block having a particular number of data bits. The data bits in each block are then assigned to one or more sub channels associated with that channel data stream.

The bits in each block are then demultiplexed into separate sub channels with each of the sub channels conveying a potentially different number of bits i.e. based on C I of the sub channel and whether MIMO processing is employed . For each of these sub channels the bits are grouped into modulation symbols using a particular modulation scheme e.g. M PSK or M QAM associated with that sub channel. For example with 16 QAM the signal constellation is composed of 16 points in a complex plane i.e. a j b with each point in the complex plane conveying 4 bits of information. In the MIMO processing mode each modulation symbol in the sub channel represents a linear combination of modulation symbols each of which may be selected from a different constellation.

The collection of L modulation symbols form a modulation symbol vector V of dimensionality L. Each element of the modulation symbol vector V is associated with a specific sub channel having a unique frequency or tone on which the modulation symbols is conveyed. The collection of these L modulation symbols are all orthogonal to one another. At each time slot and for each antenna the L modulation symbols corresponding to the L sub channels are combined into an OFDM symbol using an inverse fast Fourier transform IFFT . Each OFDM symbol includes data from the channel data streams assigned to the L sub channels.

OFDM modulation is described in further detail in a paper entitled Multicarrier Modulation for Data Transmission An Idea Whose Time Has Come by John A. C. Bingham IEEE Communications Magazine May 1990 which is incorporated herein by reference.

Data processor thus receives and processes the encoded data corresponding to K channel data streams to provide Nmodulation symbol vectors Vthrough V one modulation symbol vector for each transmit antenna. In some implementations some of the modulation symbol vectors may have duplicate information on specific sub channels intended for different transmit antennas. The modulation symbol vectors Vthrough Vare provided to modulators through respectively.

In the embodiment shown in each modulator includes an IFFT cycle prefix generator and an upconverter . IFFT converts the received modulation symbol vectors into their time domain representations called OFDM symbols. IFFT can be designed to perform the IFFT on any number of sub channels e.g. 8 16 32 and so on . In an embodiment for each modulation symbol vector converted to an OFDM symbol cycle prefix generator repeats a portion of the time domain representation of the OFDM symbol to form the transmission symbol for the specific antenna. The cyclic prefix insures that the transmission symbol retains its orthogonal properties in the presence of multipath delay spread thereby improving performance against deleterious path effects as described below. The implementation of IFFT and cycle prefix generator is known in the art and not described in detail herein.

The time domain representations from each cycle prefix generator i.e. the transmission symbols for each antenna are then processed by upconverter converted into an analog signal modulated to a RF frequency and conditioned e.g. amplified and filtered to generate an RF modulated signal that is then transmitted from the respective antenna .

In a design that provides the most flexibility best performance and highest efficiency the modulation symbol to be transmitted at each time slot on each sub channel can be individually and independently selected. This feature allows for the best use of the available resource over all three dimensions time frequency and space. The number of data bits transmitted by each modulation symbol may thus differ.

Within channel data processor a demultiplexer receives and demultiplexes the encoded data stream X into a number of sub channel data streams Xthrough X one sub channel data stream for each sub channel being used to transmit data. The data demultiplexing can be uniform or non uniform. For example if some information about the transmission paths is known i.e. full CSI or partial CSI is known demultiplexer may direct more data bits to the sub channels capable of transmitting more bps Hz. However if no CSI is known demultiplexer may uniformly directs approximately equal number of bits to each of the allocated sub channels.

Each sub channel data stream is then provided to a respective spatial division processor . Each spatial division processor may further demultiplex the received sub channel data stream into a number of up to N data sub streams one data sub stream for each antenna used to transmit the data. Thus after demultiplexer and spatial division processor the encoded data stream Xmay be demultiplexed into up to L Ndata sub streams to be transmitted on up to L sub channels from up to Nantennas.

At any particular time slot up to Nmodulation symbols may be generated by each spatial division processor and provided to Ncombiners through . For example spatial division processor assigned to sub channel may provide up to Nmodulation symbols for sub channel of antennas through N. Similarly spatial division processor assigned to sub channel k may provide up to Nsymbols for sub channel k of antennas through N. Each combiner receives the modulation symbols for the L sub channels combines the symbols for each time slot into a modulation symbol vector and provides the modulation symbol vectors as a modulation symbol vector stream V to the next processing stage e.g. modulator .

Channel data processor may also be designed to provide the necessary processing to implement the full CSI or partial CSI processing modes described above. The CSI processing may be performed based on the available CSI information and on selected channel data streams sub channels antennas etc. The CSI processing may also be enabled and disabled selectively and dynamically. For example the CSI processing may be enabled for a particular transmission and disabled for some other transmissions. The CSI processing may be enabled under certain conditions for example when the transmission link has adequate C I.

Channel data processor in provides a high level of flexibility. However such flexibility is typically not needed for all channel data streams. For example the data for a voice call is typically transmitted over one sub channel for the duration of the call or until such time as the sub channel is reassigned. The design of the channel data processor can be greatly simplified for these channel data streams.

A specific implementation of a transmitter unit capable of generating the transmit signal shown in is now described for a better understanding of the invention. At time slot in control data is transmitted on sub channel broadcast data is transmitted on sub channel voice calls and are assigned to sub channels and respectively and traffic data is transmitted on sub channels through . In this example the transmitter unit is assumed to include four transmit antennas i.e. N 4 and four transmit signals i.e. four RF modulated signals are generated for the four antennas.

In this example channel data streams Sthrough Sare transmitted using transmit diversity. Thus each of the encoded data streams Xthrough Xis provided to a respective channel data processor that generates the modulation symbols for that stream. The modulation symbols from each of the channel data processors through are then provided to all four combiners through . Each combiner receives the modulation symbols for all 16 sub channels designated for the antenna associated with the combiner combines the symbols on each sub channel at each time slot to generate a modulation symbol vector and provides the modulation symbol vectors as a modulation symbol vector stream V to an associated modulator . As indicated in channel data stream Sis transmitted on sub channel from all four antennas channel data stream Sis transmitted on sub channel from all four antennas and channel data stream Sis transmitted on sub channel from all four antennas.

In the embodiment described for a sub channel data stream is processed to generate a sub channel symbol stream that is then demultiplexed into four symbol sub streams one symbol sub stream for a particular sub channel of each antenna. This implementation is a different from that described for . In the embodiment described for the sub channel data stream designated for a particular sub channel is demultiplexed into a number of data sub streams one data sub stream for each antenna and then processed to generate the corresponding symbol sub streams. The demultiplexing in is performed after the symbol modulation whereas the demultiplexing in is performed before the symbol modulation. Other implementations may also be used and are within the scope of the present invention.

Each combination of sub channel data processor and demultiplexer in performs in similar manner as the combination of sub channel data processor and demultiplexer in . The rate of each symbol sub stream from each demultiplexer is on the average a quarter of the rate of the symbol stream from the associated channel data processor .

Each FFT processor generates transformed representations of the received samples and provides a respective stream of modulation symbol vectors. The modulation symbol vector streams from FFT processors through are then provided to demultiplexer and combiners which channelizes the stream of modulation symbol vectors from each FFT processor into a number of up to L sub channel symbol streams. The sub channel symbol streams from all FFT processors are then processed based on the e.g. diversity or MIMO communications mode used prior to demodulation and decoding.

For a channel data stream transmitted using the diversity communications mode the sub channel symbol streams from all antennas used for the transmission of the channel data stream are presented to a combiner that combines the redundant information across time space and frequency. The stream of combined modulation symbols are then provided to a diversity channel processor and demodulated accordingly.

For a channel data stream transmitted using the MIMO communications mode all sub channel symbol streams used for the transmission of the channel data stream are presented to a MIMO processor that orthogonalizes the received modulation symbols in each sub channel into the distinct eigenmodes. The MIMO processor performs the processing described by equation 2 above and generates a number of independent symbol sub streams corresponding to the number of eigenmodes used at the transmitter unit. For example MIMO processor can perform multiplication of the received modulation symbols with the left eigenvectors to generate post conditioned modulation symbols which correspond to the modulation symbols prior to the full CSI processor at the transmitter unit. The post conditioned symbol sub streams are then provided to a MIMO channel processor and demodulated accordingly. Thus each channel processor receives a stream of modulation symbols for the diversity communications mode or a number of symbol sub streams for the MIMO communications mode . Each stream or sub stream of modulation symbols is then provided to a respective demodulator DEMOD that implements a demodulation scheme e.g. M PSK M QAM or others that is complementary to the modulation scheme used at the transmitter unit for the sub channel being processed. For the MIMO communications mode the demodulated data from all assigned demodulators may then be decoded independently or multiplexed into one channel data stream and then decoded depending upon the coding and modulation method employed at the transmitter unit. For both the diversity and MIMO communications modes the channel data stream from channel processor may then provided to a respective decoder that implements a decoding scheme complementary to that used at the transmitter unit for the channel data stream. The decoded data from each decoder represents an estimate of the transmitted data for that channel data stream.

As noted above multi carrier modulation is used in the communications system of the invention. In particular OFDM modulation can be employed to provide a number of benefits including improved performance in a multipath environment reduced implementation complexity in a relative sense for the MIMO mode of operation and flexibility. However other variants of multi carrier modulation can also be used and are within the scope of the present invention.

OFDM modulation can improve system performance due to multipath delay spread or differential path delay introduced by the propagation environment between the transmitting antenna and the receiver antenna. The communications link i.e. the RF channel has a delay spread that may potentially be greater than the reciprocal of the system operating bandwidth W. Because of this a communications system employing a modulation scheme that has a transmit symbol duration of less than the delay spread will experience inter symbol interference ISI . The ISI distorts the received symbol and increases the likelihood of incorrect detection.

With OFDM modulation the transmission channel or operating bandwidth is essentially divided into a large number of parallel sub channels or sub bands that are used to communicate the data. Because each of the sub channels has a bandwidth that is typically much less than the coherence bandwidth of the communications link ISI due to delay spread in the link is significantly reduced or eliminated using OFDM modulation. In contrast most conventional modulation schemes e.g. QPSK are sensitive to ISI unless the transmission symbol rate is small compared to the delay spread of the communications link.

As noted above cyclic prefix can be used to combat the deleterious effects of multipath. A cyclic prefix is a portion of an OFDM symbol usually the front portion after the IFFT that is wrapped around to the back of the symbol. The cyclic prefix is used to retain orthogonality of the OFDM symbol which is typically destroyed by multipath.

As an example consider a communications system in which the channel delay spread is less than 10 sec. Each OFDM symbol has appended onto it a cyclic prefix that insures that the overall symbol retains its orthogonal properties in the presence of multipath delay spread. Since the cyclic prefix conveys no additional information it is essentially overhead. To maintain good efficiency the duration of the cyclic prefix is selected to be a small fraction of the overall transmission symbol duration. For the above example using a 5 overhead to account for the cyclic prefix an transmission symbol duration of 200 sec is adequate for a 10 sec maximum channel delay spread. The 200 sec transmission symbol duration corresponds to a bandwidth of 5 kHz for each of the sub bands. If the overall system bandwidth is 1.2288 MHz 250 sub channels of approximately 5 kHz can be provided. In practice it is convenient for the number of sub channels to be a power of two. Thus if the transmission symbol duration is increased to 205 sec and the system bandwidth is divided into M 256 sub bands each sub channel will have a bandwidth of 4.88 kHz.

In certain embodiments of the invention OFDM modulation can reduce the complexity of the system. When the communications system incorporates MIMO technology the complexity associated with the receiver unit can be significant particularly when multipath is present. The use of OFDM modulation allows each of the sub channels to be treated in an independent manner by the MIMO processing employed. Thus OFDM modulation can significantly simplify the signal processing at the receiver unit when MIMO technology is used.

OFDM modulation can also afford added flexibility in sharing the system bandwidth W among multiple users. Specifically the available transmission space for OFDM symbols can be shared among a group of users. For example low rate voice users can be allocated a sub channel or a fraction of a sub channel in OFDM symbol while the remaining sub channels can be allocated to data users based on aggregate demand. In addition overhead broadcast and control data can be conveyed in some of the available sub channels or possibly in a portion of a sub channel.

As described above each sub channel at each time slot is associated with a modulation symbol that is selected from some alphabet such as M PSK or M QAM. In certain embodiments the modulation symbol in each of the L sub channels can be selected such that the most efficient use is made of that sub channel. For example sub channel can be generated using QPSK sub channel can be generate using BPSK sub channel can be generated using 16 QAM and so on. Thus for each time slot up to L modulation symbols for the L sub channels are generated and combined to generate the modulation symbol vector for that time slot.

One or more sub channels can be allocated to one or more users. For example each voice user may be allocated a single sub channel. The remaining sub channels can be dynamically allocated to data users. In this case the remaining sub channels can be allocated to a single data user or divided among multiple data users. In addition some sub channels can be reserved for transmitting overhead broadcast and control data. In certain embodiments of the invention it may be desirable to change the sub channel assignment from possibly modulation symbol to symbol in a pseudo random manner to increase diversity and provide some interference averaging.

In a CDMA system the transmit power on each reverse link transmission is controlled such that the required frame error rate FER is achieved at the base station at the minimal transmit power thereby minimizing interference to other users in the system. On the forward link of the CDMA system the transmit power is also adjusted to increase system capacity.

In the communications system of the invention the transmit power on the forward and reverse links can be controlled to minimize interference and maximize system capacity. Power control can be achieved in various manners. For example power control can be performed on each channel data stream on each sub channel on each antenna or on some other unit of measurements. When operating in the diversity communications mode if the path loss from a particular antenna is great transmission from this antenna can be reduced or muted since little may be gained at the receiver unit. Similarly if transmission occurs over multiple sub channels less power may be transmitted on the sub channel s experiencing the most path loss.

In an implementation power control can be achieved with a feedback mechanism similar to that used in the CDMA system. Power control information can be sent periodically or autonomously from the receiver unit to the transmitter unit to direct the transmitter unit to increase or decrease its transmit power. The power control bits may be generated based on for example the BER or FER at the receiver unit.

As shown in the plots the number of bits per symbol for a given BER ranges from less than 1 bps Hz to almost 20 bps Hz. At low values of C I the spectral efficiency of the diversity communications mode and MIMO communications mode is similar and the improvement in efficiency is less noticeable. However at higher values of C I the increase in spectral efficiency with the use of the MIMO communications mode becomes more dramatic. In certain MIMO configurations and for certain conditions the instantaneous improvement can reach up to 20 times.

From these plots it can be observed that spectral efficiency generally increases as the number of transmit and receive antennas increases. The improvement is also generally limited to the lower of Nand N. For example the diversity configurations 1 2 and 1 4 both asymptotically reach approximately 6 bps Hz.

In examining the various data rates achievable the spectral efficiency values given in can be applied to the results on a sub channel basis to obtain the range of data rates possible for the sub channel. As an example for a subscriber unit operating at a C I of 5 dB the spectral efficiency achievable for this subscriber unit is between 1 bps Hz and 2.25 bps Hz depending on the communications mode employed. Thus in a 5 kHz sub channel this subscriber unit can sustain a peak data rate in the range of 5 kbps to 10.5 kbps. If the C I is 10 dB the same subscriber unit can sustain peak data rates in the range of 10.5 kbps to 25 kbps per sub channel. With 256 sub channels available the peak sustained data rate for a subscriber unit operating at 10 dB C I is then 6.4 Mbps. Thus given the data rate requirements of the subscriber unit and the operating C I for the subscriber unit the system can allocate the necessary number of sub channels to meet the requirements. In the case of data services the number of sub channels allocated per time slot may vary depending on for example other traffic loading.

The reverse link of the communications system can be designed similar in structure to the forward link. However instead of broadcast and common control channels there may be random access channels defined in specific sub channels or in specific modulation symbol positions of the frame or both. These may be used by some or all subscriber units to send short requests e.g. registration request for resources and so on to the central station. In the common access channels the subscriber units may employ common modulation and coding. The remaining channels may be allocated to separate users as in the forward link. In an embodiment allocation and de allocation of resources on both the forward and reverse links are controlled by the system and communicated on the control channel in the forward link.

One design consideration for on the reverse link is the maximum differential propagation delay between the closest subscriber unit and the furthest subscriber unit. In systems where this delay is small relative to the cyclic prefix duration it may not be necessary to perform correction at the transmitter unit. However in systems in which the delay is significant the cyclic prefix can be extended to account for the incremental delay. In some instances it may be possible to make a reasonable estimate of the round trip delay and correct the time of transmit so that the symbol arrives at the central station at the correct instant. Usually there is some residual error so the cyclic prefix may also further be extended to accommodate this residual error.

In the communications system some subscriber units in the coverage area may be able to receive signals from more than one central station. If the information transmitted by multiple central stations is redundant on two or more sub channels and or from two or more antennas the received signals can be combined and demodulated by the subscriber unit using a diversity combining scheme. If the cyclic prefix employed is sufficient to handle the differential propagation delay between the earliest and latest arrival the signals can be optimally combined in the receiver and demodulated correctly. This diversity reception is well known in broadcast applications of OFDM. When the sub channels are allocated to specific subscriber units it is possible for the same information on a specific sub channel to be transmitted from a number of central stations to a specific subscriber unit. This concept is similar to the soft handoff used in CDMA systems.

The communications system described above can be used for various applications and to provide various services. Such services may include for example real time services non real time services or both real time and non real time services multiplexed together. The services to be supported by the communications system can be defined and categorized in various manners e.g. by the quality of service QoS associated with the services . As an example the supported services can be categorized into three types defined as follow 

Half duplex real time HDRT services services that can tolerate longer one way delay as long as the delay does not vary by a large amount e.g. video audio and

Additional and or different services can also be supported and are within the scope of the invention. For example broadcast services paging services and others can be supported. Similarly additional and or different types of services can also be defined and are within the scope of the invention.

Once the services have been defined and categorized they can be multiplexed in numerous manners. For example HDRT and NRT services can be multiplexed in a single data transmission with the HDRT services being given higher priority. FDRT services can also be multiplexed with HDRT and NRT services possibly using a different multiplexing scheme. Various multiplexing schemes can be used to transmit the supported services. Some of these schemes are described in further detail below.

The partition used to support FDRT services and the partition used to support HDRT and NRT services can each be shared by multiple users. The sharing of a partition can be achieved by various multiplexing schemes. For example the sharing can be achieved by 

These multiplexing schemes are described in further detail below. Other multiplexing schemes can also be defined and are within the scope of the invention.

The scaled data streams from multipliers through are then provided to a parallel to serial converter P S that multiplexes the received data streams into a combined data stream. A symbol mapping element then receives the combined data stream and interleaves i.e. reorders the data in the stream to provide temporal diversity. Symbol mapping element further maps the data in each received data stream to the tones assigned to the data stream as described below. The output from symbol mapping element is a stream of modulation symbol vectors V which is provided to modulator .

Within modulator an IFFT receives and converts the modulation symbol vectors V into their time domain representations called OFDM symbols. In an embodiment for each modulation symbol vector converted to an OFDM symbol cycle prefix generator repeats a portion of the time domain representation of the OFDM symbol to form a transmission symbol. The cyclic prefix ensures that the transmission symbol retains its orthogonal properties in the presence of multipath delay spread thereby improving performance against deleterious path effects as described above. The transmission symbols from cycle prefix generator are then processed by upconverter converted into an analog signal modulated to a RF frequency and conditioned e.g. amplified and filtered to generate an RF modulated signal that is then transmitted from an antenna .

In an embodiment symbol mapping element maps the symbols for each channel data stream e.g. each user to a set of tones that are assigned to the channel. Referring back to each partition includes a number of OFDM symbols and referring back to each OFDM symbol includes a number of tones transmitted on a number of sub channels. Thus a number of tones in each partition are available for transmitting the channel data streams.

In an embodiment the available tones in each multi user partition are grouped to a number of sets of tones. Each set of tones is referred to as a circuit and is assigned to a particular channel. The L channel data streams can thus be assigned to L circuits. A particular channel data stream may also be assigned multiple circuits in one or more partitions e.g. one or more circuits in partition and one or more circuits in partition . Also a user may be assigned with multiple channel data streams or a channel data stream may be shared between multiple users. Multiple channel data streams may also share the same circuit.

Each of the circuits can be defined to include any number of tones. More tones may be allocated to high rate circuits and fewer tones may be allocated to low rate circuits. Also each circuit may be assigned with any tone from any OFDM symbol. The tones of each OFDM symbol may thus be assigned to one or more circuits. For improved frequency and temporal diversity the tones for each circuit can be selected such that different tones from different OFDM symbols are assigned to the circuit. For example a particular circuit may be assigned with tone of the first OFDM symbol tone of the second OFDM symbol and so on.

Different types of circuits can be defined and used for different types of services. For example a first circuit type can be defined to include different tones from different OFDM symbols and a second circuit type can be defined to include all tones from one or more OFDM symbols. The first circuit type e.g. in partition can be used to support FDRT services and the second circuit type e.g. in partition can be used to support HDRT and NRT services. With the second circuit type each OFDM symbol can be assigned to a particular HDRT or NRT user.

The circuits may be defined as static sets of tones or may be dynamically configurable. For example the communications system may define each of the circuits available for assignment and thereafter informs each user terminal of the assigned circuit and its definition e.g. during session initiation . The dynamic definition of the circuits allows for customization of the circuits to match the services being supported and can result in improved utilization of the available resources.

The circuits may be defined to be equal size with each circuit having the capacity to carry a particular number of bits. Alternatively the circuits may be designed to have different sizes. The circuit sizes may be based on the statistics of the users in the communications system or some other criteria. For example more low rate circuits can be defined if more users are utilizing low rate services. Alternatively or additionally the circuits may be defined based on the particular services being supported and or user requirements. High rate circuits with more tones can be assigned to high rate services and low rate circuits with fewer tones or transmitted less frequently can be assigned to low rate services.

The circuits are typically defined a priori prior to a call processing e.g. circuit include tones x y z and so on . One or more circuits can be assigned for a particular communications session and the assigned circuits can be provided to a user terminal for example via control channel system parameter messages that describe how the forward link is configured.

If packet type field indicates that the circuit to be used for the next packet will be different then circuit identifier field can be used to identify the particular circuit to be used for the next packet. Circuit identifier field can provide the identity of the new circuit as well as other information e.g. the transmission scheme as described below. Circuit identifier field is typically used only if there is information to be sent e.g. for a change in circuit or transmission scheme . Otherwise circuit identifier field is a null field.

Data field can be used to carry the payload e.g. data for the transmission. Data field may also be used to carry other information such as for example control data CRC bits and so on.

Packet type field can be implemented with few bits e.g. 2 bits and circuit identifier field can be implemented with a small number of bits e.g. 8 10 bits . The remaining bits in each packet can be used for data field . This results in an efficient packet format in which few overhead bits are required.

Each packet can be dimensioned to fit into one circuit in one slot. However a packet may also be segmented and transmitted using multiple circuits over one or more slots. The size of the packet can be selected for efficient data transmission. For services that can tolerate longer processing delays low rate transmissions can be collected and assembled into a larger packet e.g. 20 msec or 40 msec of data that can be more efficiently processed and transmitted.

Packet structure supports inband signaling of a change in circuit assignment and the identity of the new circuit. This information can also be provided via a control channel. The user terminal would then process the control channel to receive changes in circuit assignment. Other signaling schemes to communicate circuit information to the user terminal can also be used and are within the scope of the invention.

For voice data various transmission schemes can be used to reduce the amount of transmission during periods of silence e.g. pauses or low activity. During silence periods comfort noise is typically sent to the user terminal. This noise can be sent at a lower rate than for full speech. In one transmission scheme during silence periods a full rate packet is sent every X slots e.g. X can be 4 8 16 or some other value . This scheme allows up to X users to share the same circuit during silence periods with each user being assigned to one of the X slots. In another transmission scheme a low rate circuit that includes fewer tones can be used to send comfort noise. This low rate circuit can be sent every slot or every few slots but typically more frequent than every X slots . In yet another transmission scheme a full rate circuit can be sent for comfort noise but at a lower rate e.g. using a low rate code . This full rate circuit is typically the same as that used for active speech. The transmit power can be reduced for this full rate circuit during silence periods. Various other transmission schemes to send comfort noise or other data at lower bit rate can also be contemplated and are within the scope of the invention.

The transmission schemes described above to reduce the amount of transmission during silence periods can also be used for any data being sent at less than full rate. For example speech activity having low frequency contents may be represented using fewer bits and can be sent using a low rate circuit or a full rate circuit transmitted less frequently. The user terminal can be informed accordingly whenever a change in circuit and or transmission scheme is about to be made.

Packet format supports the use of different circuits for voice activity and silence. When a user changes state from activity to silence packet type field for the user s packet can be appropriately set to inform the user terminal to use the circuit identified in circuit identifier field for the next e.g. noise packet. Circuit identifier field can also identify the particular slot used to carry comfort noise for this user terminal. Thereafter during periods of silence the noise packet can be sent every X slots in one transmission scheme to update the comfort noise that is played at the terminal. In this way each circuit used for silence can be shared by up to X users.

In a complementary manner a full rate circuit is requested when a user changes state from silence to activity. A scheduler receives the request and assigns to the user a full rate circuit selected from a pool of available full rate circuits. The identity of the assigned circuit is sent to the user terminal in the next packet.

If the pool of available full rate circuits is empty speech clipping can occur until a circuit becomes available. The probability of speech clipping can be reduced by properly regulating the number of calls that are connected which is a parameter that can be adjusted by a call admission policy if speech clipping is detected. If a large number of users are multiplexed together the statistical multiplexing gain from voice activity is greater and the probability of speech clipping is reduced. A channel and circuit assignment protocol can be designed to minimize the probability of speech clipping without significantly reducing the statistical multiplexing gain from voice activity.

Various signaling schemes can be used to signal to the user terminal that speech activity has changed from silence to active. In one scheme the signaling is achieved inband using for example packet type field in the comfort noise packet. As noted above the noise packet may be sent every Xslots for some transmission schemes. To reduce the signaling delays during silence periods smaller noise packets can be sent at a higher rate using smaller circuits. In another signaling scheme a control channel can be used to inform the user terminal that transition to full rate voice has occurred and to send the identity of the circuit that will be used for the next full rate packet. For this signaling scheme terminals that are in silence periods monitor the control channel to receive the circuit information.

Various mechanisms can be implemented to ensure that changes to new circuits are properly achieved. In one mechanism the user terminal sends an acknowledgment to the base station whenever it receives a packet that contains a circuit change. To reduce the amount of overhead the terminal can send a single bit to the base station after receipt of a circuit change packet. This acknowledgment bit informs the base station that the terminal has successfully decoded the previous packet and is ready to receive data using the new circuit. The base station can continue to transmit using the old circuit until it receives the acknowledgment. Upon receipt of the acknowledgment the base station transmits using the new circuit and the old circuit is placed back in the pool of available circuits.

Several schemes can be used to handle false acknowledgments of circuit changes that may result for various reasons. For example a false acknowledgment may result from a user terminal decoding the packet in error and not sending an acknowledgment bit but the base station falsely detecting a transmission of the acknowledgment bit. In this case the base station starts transmitting on the new circuit while the terminal continues decoding the old circuit. A false acknowledgment may also result from the user terminal properly decoding the packet and sending an acknowledgment bit but the base station failing to detect the acknowledgment. In this case the base station continues to transmit on the old circuit while the terminal starts decoding the new circuit.

The probability of false acknowledgment can be reduced by using an enhanced acknowledgment protocol. For example the acknowledgment bit can be coded such that transmission error can be detected and or corrected. A recovery scheme can also be implemented whereby the user terminal informs the base station whenever it loses the forward link e.g. as a result of the terminal decoding the new circuit while the base station transmits on the old circuit or vice versa . As part of the recovery scheme the base station can send a circuit assignment message to the terminal on a control channel whenever it receives a channel lost message. The terminal can then restart using the information included in the circuit assignment message. Other mechanisms to ensure that changes in circuits are properly implemented can be designed and are within the scope of the invention.

As noted above a partition can be shared by multiplexing multiple users on the same OFDM symbols using packet switching. In this multiplexing scheme each packet includes an identification of the specific user for which the packet is intended. Each packet can be transmitted for example using one of the circuits described above. However in this scheme the circuits are not individually assigned to the users. Instead each user terminal processes all transmitted packets extracts the user identification in each packet decodes packet directed toward the terminal and ignores remaining packets. Circuits of different sizes can be defined and used to efficiently transmit data.

User ID field can be implemented as a preamble using a coding scheme that is different than that used for data field . For example the user ID can be a particular Walsh sequence or PN offset assigned to the user terminal. This allows the user terminal to quickly determine whether the packet is intended for it. Alternatively the user ID can be implemented as a coded sequence.

An 8 bit user ID field can support up to 256 users. For a full rate packet the user ID overhead does not significantly impact the efficiency of the transmission. For lower rate packets the overhead can be a larger portion of the packet and efficiency may be compromised. The overhead for lower rate packets can be reduced by accumulating and transmitting lower rate data in full rate packets that may be sent less frequently.

The scaled data streams from multipliers through are then provided to respective multipliers through which also receive respective Walsh sequences Wthrough W. Each multiplier covers the received data stream with the received Walsh sequence to provide a covered data stream. The covered data streams from multipliers through are provided to and combined by a summer to generate a combined data stream. A symbol mapping element receives the combined data stream and interleaves the data in the stream to provide temporal diversity. The output from symbol mapping element is a stream of modulation symbol vectors V which is then provided to modulator .

Modulator includes an IFFT a cyclic prefix generator and an upconverter that operate in similar manner as IFFT cyclic prefix generator and upconverter respectively in . Modulator generates an RF modulated signal that is transmitted from an antenna .

In the embodiment shown in the data for each user is covered with a respective Walsh sequence and transmitted over common tones. These tones carry data associated with one or more users. For multiple users orthogonality for the user data is maintained through the use of the Walsh sequences.

In a specific embodiment the length of the Walsh sequences is matched to the number of tones for each OFDM symbol. For example Walsh sequences of length 128 can be used for OFDM symbols having 128 tones. The 128 chips of each Walsh sequence can be transmitted on the 128 tones of one OFDM symbol. However other Walsh sequence lengths can also be used and are within the scope of the invention. Moreover each Walsh sequence can be mapped to multiple OFDM symbols or a portion of one OFDM symbol and these variations are within the scope of the invention. For example if the Walsh sequences have length of 64 and each OFDM symbol has 128 tones then two sets of Walsh sequences can be mapped to each OFDM symbol.

Various modulation schemes can be used to modulate ODFM symbols that have been covered. These modulation schemes include QPSK QAM and others.

At a user terminal the tones are processed and decovered with the particular Walsh sequence assigned to that terminal. Since the data for multiple users has been covered with orthogonal Walsh sequences the data previously covered with the particular Walsh sequence can be recovered by decovering with the same Walsh sequence. The data previously covered with other Walsh sequences is orthogonal and ideally sums to zero in the decovering.

If the Walsh covered data i.e. the Walsh sequences is transmitted across multiple tones of the OFDM symbol orthogonality of the Walsh sequences may be diminished if the tones fade independently. This may occur for example with frequency selective fading. If the frequency response of the transmission channel is not flat channel equalization may be used to regain orthogonality. Equalization can be achieved by determining the channel gain for each tone in the OFDM symbol and using the determined channel gains to equalize the channel and make it approximately flat. For example if a particular tone has a channel loss of Y dB from a nominal value that tone can be boosted by Y dB by the user terminal. In this manner orthogonality may be preserved in the presence of frequency selective fading.

Since multiple users share the same tones in this multiplexing scheme the transmit power for each user can be controlled to efficiently utilize the available resource. The transmit power for users having higher signal to noise plus interference Eb Io ratios can be reduced while maintaining a particular level of performance. The saving in transmit power can then be used for some other users. Power control can be achieved for example using a scheme similar to that used in the IS 95 CDMA system whereby a user terminal sends a power control command e.g. a frame erasure bit to the base station which then adjusts it transmit power to this terminal accordingly.

The multiplexing schemes described above can be used for various applications. For example these schemes can be used for mobile fixed and other applications.

For fixed application a directional antenna can be used at the base station for forward link transmissions and two receive antennas can be provided at the user terminal to achieve receive diversity. This configuration can provide a high carrier to interference ratio C I which results in a large capacity e.g. a hundred or more voice users may be serviced by 1.25 MHz on the forward link . For the Walsh cover multiplexing scheme the channel estimates can be more accurate for fixed applications and where directional antennas are deployed. This allows for more accurate equalization of the transmission channel to maintain orthogonality of the Walsh covered data.

For mobile application soft handoff such as that employed in IS 95 CDMA systems can be used to transfer a mobile user terminal from one base station to another. To achieve soft handoff a base station controller can request that all base stations in soft handoff send the user s packets on a common circuit or common OFDM tones. The base stations can be coordinated to achieve this. Alternatively the base stations in soft handoff can transmit packets on circuits available to them. The user terminal can digitize the received signal and process the samples to recover the packets transmitted by the base stations. The processing of the transmissions from the base stations can be performed using different parameters e.g. different PN offsets different circuits . The user terminal can also combine the processed results similar to that performed by a rake receiver to generate a combined result having improved performance.

The above multiplexing transmission and signaling schemes have been described for the forward link transmission from the base station to the user terminal. At least some of the concepts described herein can be applied for the reverse link transmission from the user terminal to the base station.

As shown above the transmitter unit and receiver unit are each implemented with various processing units that include various types of data processor encoders IFFTs FFTs demultiplexers combiners and so on. These processing units can be implemented in various manners such as an application specific integrated circuit ASIC a digital signal processor a microcontroller a microprocessor or other electronic circuits designed to perform the functions described herein. Also the processing units can be implemented with a general purpose processor or a specially designed processor operated to execute instruction codes that achieve the functions described herein. Thus the processing units described herein can be implemented using hardware software or a combination thereof.

The foregoing description of the preferred embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without the use of the inventive faculty. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

