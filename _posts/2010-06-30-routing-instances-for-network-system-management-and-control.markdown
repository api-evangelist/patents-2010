---

title: Routing instances for network system management and control
abstract: A network system uses a management routing instance to route management information between elements involved in management of the system. The system registers each element in the management routing instance when the element comes on line. Based on the management routing instance, the system creates management forwarding tables. The system then uses the management forwarding tables to route management information between the elements. Multiple systems, for example systems connected by a network, may exchange management routing instance information to allow elements in different systems to communicate management information with each other.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07975070&OS=07975070&RS=07975070
owner: Juniper Networks, Inc.
number: 07975070
owner_city: Sunnyvale
owner_country: US
publication_date: 20100630
---
This application is a continuation of U.S. patent application Ser. No. 11 682 153 filed Mar. 5 2007 which is a continuation of U.S. patent application Ser. No. 10 063 358 filed Apr. 15 2002 now U.S. Pat. No. 7 206 856 which are incorporated herein by reference.

The present invention relates to management of a system and more particularly to facilitating exchange of management information among elements of a system or elements in different systems.

A conventional network system typically performs a particular function in a network. For example a router routes packets in a network. The network system also performs management tasks that support that function. The management tasks are performed by certain elements within the system.

As part of performing the management tasks the elements exchange management information with each other. For example in a router an element may monitor activities in the system. The monitoring may result in creation of management information that the element forwards to other elements in the system. The other elements may also create management information and forward it to one or more other elements in the system.

Communication of management information between elements is carried out in conventional systems using simple mechanisms that lack security and robustness. Moreover conventional management information communication mechanisms require special purpose hardware and software dedicated to communicating the management information.

There is a need for management information communication mechanisms that allow elements of a system to communicate in a secure and robust manner in a way that overcomes limitations of conventional management information communication mechanisms.

According to an embodiment of an apparatus consistent with the principles of the invention management information transmitted from a source element is received by a routing element which forwards the management information to a destination element based on management routing information. The management routing information may be a routing element such as a management routing table or a management forwarding table.

According to an embodiment of a method consistent with the principles of the invention management routing information is created and used for forwarding management information from a source element to a destination element based on management routing information. The management routing information may be a routing element such as a management routing table or a management forwarding table.

According to other embodiments consistent with the principles of the invention a source element in a first system transmits management information to a destination element in a second system. The management information transmitted from the source element is received by a forwarding element that forwards the management information to the destination element in the second system based on management routing information such as a management routing table or a management forwarding table.

Further consistent with the principles of the invention embodiments of the invention may be implemented using an industry standard protocol such as the Internet protocol IP and use IP packets for transferring the management information. Moreover embodiments consistent with the principles of the invention may also use similar routing and forwarding infrastructure as is used in routing and forwarding network traffic.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory only and are not restrictive of the invention as claimed.

Reference will now be made in detail to embodiments consistent with the principles of the invention examples of which are illustrated in the accompanying drawings. The same reference numbers may be used in different drawings to refer to the same or like parts.

According to embodiments consistent with the principles of the invention elements that handle management tasks in a system use established routing infrastructure to transfer management information in the system. For example the system may create a management routing instance that is used by the elements to route management information to one another. The elements may be registered in a routing table of the management routing instance. In one embodiment the elements use the Internet protocol IP and IP packets to route management information to each other.

PICs and are each connected to a network link. Each link may be connected to another system or a network and may be one of many types of transport media such as optical fiber or Ethernet cable. The data on the link is formatted according to one of several protocols such as the synchronous optical network SONET standard or Ethernet. For example PICs and may forward The packets from the links to one of FPCs . FPCs are each connected to RE switch fabric and PICs . FPCs may use network forwarding tables to determine the destination of each packet and transmit the packet to the PIC connected to the destination link.

Network packets received on the links from other network systems may be destined for RE . For example network systems need to communicate network topology information and other types of network related information to each other.

System as part of processing incoming and outgoing network traffic needs to perform management tasks to coordinate the traffic processing and general functioning of system . In one embodiment consistent with the principles of the invention system transfers management information in the system using routing infrastructure that is similar to the routing infrastructure the system uses for network traffic processing.

Elements in system manage certain areas and tasks in system and may exchange management information with each other as part of performing those management tasks. For example an element in system may monitor a part of system and report the monitoring results to one or more other elements. Elements may also perform other management tasks such as management tasks that support network traffic processing in system .

In the embodiment illustrated in elements involved in management of system are illustrated as CPUs . CPUs and are located in RE switch fabric and PICS and . CPU is connected to PIC . Each of CPUs may perform various tasks in managing system . For example CPUs may collect information and monitor conditions in particular areas of system . CPUs may also perform non management tasks for system in addition to their management tasks. Although the elements illustrated in are CPUs in other embodiments consistent with the principles of the invention the elements may comprise any type of element involved in management of system .

CPUs are located in various parts of system and perform a variety of functions. CPUs are located on PICs respectively. Each of PICs are connected to a link and perform operations that may include transfer of data over a link. CPUs may perform network traffic tasks for incoming and outgoing network traffic in addition to management tasks related to management of system .

CPUs and are located on PICs and respectively. PICs and are service PICs which are not connected to a link. Service PICs and perform special purpose tasks in system . For example service PIC may set up manage and tear down tunnels for network traffic. CPUs and may take part in performing the special purpose tasks.

CPUs and may also perform management tasks for system and send to other elements management information related to the special purpose tasks or the management tasks. For example service PIC may send management information regarding the tunnels to other elements in system . Service PIC may also exchange management information with another element such as service PIC . For example service PIC may handle tunnel support tasks such as maintaining context for each tunnel.

CPU is connected to PIC and is located external to system . CPU may be connected to other elements and may perform tasks related to the network traffic processing of system as well as management tasks.

CPU is located in switch fabric and may perform switch fabric processing and management processing related to switch fabric . For example CPU may assist in transferring network traffic between FPCs and switch fabric and assist in transferring network traffic through switch fabric . CPU may also perform management tasks for system such as monitoring network traffic in switch fabric or collecting switch fabric data.

CPU is located in RE . CPU may perform tasks that directly support RE as well as management tasks for system .

To coordinate management tasks CPUs may exchange management information with each other. Management information is transferred between CPUs using packets. For example CPUs may communicate packets to CPU of RE as part of the management of system such as by sending management information to CPU that requests modification of network routing instances used by system when routing network traffic. Service PIC may request CPU to modify a particular network routing instance that is affected by changes in the tunnels managed by service PIC . CPU on PIC may send the request in the form of management information in one or more packets to FPC destined for CPU on RE . FPC looks up the destination of each packet in a management forwarding table determines that each packet is destined for CPU and forwards the packets to CPU . CPU receives the packets extracts the management information and responds to the management information accordingly.

In order to forward management information to the appropriate destination each of FPCs must be properly configured with management routing information that allows it to determine where to send the management information. In one embodiment RE is responsible for configuring FPCs .

RE maintains a management routing instance that defines characteristics of CPUs . A routing instance is a software object that defines a group of entities in this case management related elements that may communicate with each other. Whenever a management related element comes on line in system RE registers the element in the management routing instance. The routing instance created by RE includes a routing table that defines the logical interfaces that identify the management related elements registered in the routing instance. RE creates forwarding tables based on the routing instance and forwards them to FPCs to configure them.

RE may perform a variety of routing instance operations such as creating altering and killing a routing instance. RE makes itself a member of each routing instance so it can exchange information with other members of a particular routing instance.

RE creates management forwarding tables based on the management routing instance and configures each of FPCs with a management forwarding table. FPCs use the management forwarding table to determine how management information from CPUs should be forwarded to destinations specified by the management information.

In one embodiment consistent with the principles of the invention the Internet protocol IP and IP packets are used for transferring management information among CPUs . In this embodiment when FPC receives a management information in packet from CPU it first analyzes the layer 2 L2 information in the packet. The L2 information includes the source address in this case address of CPU . In one embodiment the address is a logical interface identifier of CPU . In other embodiments other layers of a protocol may also be used. FPC upon receiving the packet uses the logical interface identifier to determine which forwarding table to use to determine the destination of the packet. FPC then determines from the forwarding table the physical interface of the destination CPU in this case CPU based on the logical interface information in the forwarding table. FPC then forwards the packet s to CPU based on the physical interface information.

CPU may register the logical interfaces for CPUs and in the management routing instance in a variety of ways. Logical interfaces may be registered automatically without human intervention. For example at the time one of CPUs comes on line it may send a message to RE indicating that it has come on line. RE will register the new element in the appropriate management routing instances. Instead of automatic registration a user may manually register logical interfaces in one or more management routing instances. For example an administrator of system may use a command line interface or some other configuration mechanism not shown to enter the logical interfaces for one or more of CPUs and in the management routing instance.

CPUs may also use the management routing instance to send heartbeat messages to each other. For example in the embodiment of CPUs periodically send heartbeat messages to other elements registered in a management routing instance. Heartbeat messages may serve several purposes. For example if a CPU tracks heartbeat messages from other CPUs it can determine when another CPU goes down. CPUs can also use heartbeat messages for determining when a CPU has been registered with the management routing instance.

CPUs may use heartbeat messages to perform management tasks. For example if one of CPUs is designated as a master CPU it can track the other CPUs in system and allocate work accordingly. If one CPU goes down another CPU can be allocated the tasks of the CPU that went down. In one embodiment one CPU is designated a master. The master CPU reallocates tasks from one CPU to another CPU. The master CPU may monitor heartbeat messages and upon detecting a down CPU allocate the tasks of the down CPU to live CPUs. Other tasks may also be carried out based on the heartbeat messages.

In embodiments consistent with the principles of the invention system may use the existing routing infrastructure of system i.e. the routing infrastructure that is used for routing network traffic for routing management information between CPUs . Using the existing routing infrastructure of system leverages hardware software and firmware routing functionality already available in system for routing network traffic. The routing infrastructure includes for example routing instances routing protocols and standard sockets application programming interfaces APIs and other routing infrastructure features. Using management routing instances also provides security among the elements because only elements that are part of a management routing instance can transfer management information to each other.

In the embodiment illustrated in RE is responsible for creating and maintaining management routing instances in system . In other embodiments consistent with the principles of the invention routing instances may be created and maintained by one or more other elements in system . For example any element in system whether directly involved with management or not may create and maintain routing instances in system . Routing instances may also be created and maintained in a distributed fashion in system by multiple elements in the system.

Upon receiving the new element indicator RE determines what type of element it is. For example RE may determine element type from the received new element indicator or by communicating directly with the new element. Based on the element type RE notifies other elements and processes. If the new element needs to be part of one or more management routing instances RE registers the new element in the appropriate management routing instances.

In response to determining that the new element is a management element act RE determines whether to register the new element in an existing management routing instance or to create a new management routing instance act . If a management routing instance already exists RE proceeds directly to creating a logical interface for the new element act . If a management routing instance does not already exist RE creates a management routing instance act . RE creates a logical interface for the new element act . RE then adds the new logical interface to the management routing instance act and sends confirmation to the new element act . The confirmation may include information the element needs in order to communicate management information based on the management routing instance. The process repeats when RE receives another indication of a new management related element act .

For example when CPU on PIC comes on line it sends a new element indicator to RE . If RE has not created a management routing instance for communicating management information it creates a management routing instance. RE then creates a logical interface for CPU and adds CPU to the routing table in the management routing instance. As additional elements come on line they also send a new element indicator to RE and RE registers them in the management routing instance.

RE may create multiple management routing instances. In some systems a single management routing instance may be all that is needed for the elements exchanging management information. Multiple management routing instances may also be used however and each element may be registered as a logical interface in one or more management routing instances. RE may modify management routing instances or tear down management routing instances that are no longer needed.

The management tasks support system as it receives and transmits network traffic. System generally receives and transmits two types of network traffic 1 network data flowing between sources and destinations and 2 network information exchanged by systems in the network to facilitate network traffic flow between systems. Network traffic comes in on the network links connected to PICs and and goes out on the network links. System must process the incoming network traffic to determine which particular PIC the network traffic should go out on.

Processing incoming network traffic requires proper configuration of system so that the traffic is properly forwarded toward its destination. In the embodiment illustrated in system may be configured by RE .

In one embodiment consistent with the principles of the invention processing network traffic may use the same routing infrastructure used by system to configure system and transfer management information. To configure system for processing network traffic RE first collects information regarding network characteristics of the network and characteristics of system . RE collects information regarding characteristics of the network from network information received from other systems in the network. The network information may for example provide information regarding network characteristics such as topology or path characteristics between entities in the network. RE may also forward this type of network information to other systems in the network. The other systems use the network information in a similar manner to configure that system so it interacts correctly with other systems in the network. RE collects characteristics of system by tracking which elements are on line that may be involved in processing incoming and outgoing network traffic.

Using the information regarding characteristics of the network and characteristics of system RE creates network routing instances that define groups of network entities that may communicate with each other. The network routing instances are similar to management routing instances but are used by system to route network traffic rather than management information.

RE creates a routing instance for network systems that communicate with each other. Like the management routing instances each network routing instance may include a routing table having information identifying the network systems. RE uses the routing instances to create network forwarding tables. Basically the network forwarding tables associate network destinations with particular PICs in system . For example a network forwarding table might associate destination A in the network with PIC because the link connected to PIC is determined by RE to be connected to a system on a potential path to destination A.

RE forwards the network forwarding tables to FPCs and which use the tables to forward network traffic through system . More particularly FPCs receive network traffic from PICs and determine destination information from the network traffic and use the network forwarding tables to determine based on the destination information which of PICs and the network traffic should be sent out on. Thus system forwards network traffic using network forwarding tables created from network routing instances.

The other type of information received by system from other network systems network information also comes into system on one or more of PICs and and like the network traffic is forwarded by the PICs to FPCs . For network information however FPCs forward the information to RE . Network information includes information that is used by systems in the network to coordinate transfer of network traffic. Network information might for example include network topology information such as link state characteristics.

In other embodiments consistent with the invention network forwarding tables are not necessary because network routing tables may be used directly to forward packets through system .

In one embodiment elements in one router are registered in the management routing instance of one or more other routers in the network. This allows elements in different routers to communicate management information with each other. In for example ISP A uses routers A and A as gateways. Routers A and A may be configured as shown and described in . To allow elements of router A to exchange management information with elements in router A as part of the management of routers A and A of ISP A the RE of router A sends information to the RE of router A that defines one or more elements in router A that are members of the A management routing instance. The RE of router A uses this information to register the elements of router A in the A management routing instance. Similarly the RE of router A sends information to the RE of router A that defines one or more elements that are members of the A management routing instance. The RE of router A uses this information to register the elements of router A in the A management routing instance.

Exchanging management routing instance information between REs on different routers may be carried out by any suitable communication exchange mechanism. In one embodiment REs exchange management routing instance information using a routing protocol.

Each RE then creates forwarding tables based on the management routing instances which are forwarded to the FPCs in each router. Management information may then be transmitted between elements on routers A and A using known network data transfer mechanisms such as secure tunnels. Thus elements in different routers may transmit management information to one another using management routing instances that include elements in different routers.

Other embodiments of the invention will be apparent to those skilled in the art from consideration of the specification and practice of the invention disclosed herein. For example while the invention has been described in connection with a router the invention may also be used in a switch or other system in which elements exchange management information. The invention may also be used in systems that do not use forwarding tables. In some systems routing may be determined directly from information in the routing table without using forwarding tables. It is intended that the specification and examples be considered as exemplary only with a true scope and spirit of the invention being indicated by the following claims.

